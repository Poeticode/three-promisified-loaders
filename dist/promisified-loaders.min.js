!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(e,t,r){"use strict";function n(){}function i(e,t){this.x=e||0,this.y=t||0}function a(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0===n?1:n}function o(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function s(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function c(e,t,r,n,a,o,u,l,h,p){Object.defineProperty(this,"id",{value:mc++}),this.uuid=lc.generateUUID(),this.name="",this.image=void 0===e?c.DEFAULT_IMAGE:e,this.mipmaps=[],this.mapping=void 0===t?c.DEFAULT_MAPPING:t,this.wrapS=void 0===r?Wo:r,this.wrapT=void 0===n?Wo:n,this.magFilter=void 0===a?Ko:a,this.minFilter=void 0===o?Qo:o,this.anisotropy=void 0===h?1:h,this.format=void 0===u?ds:u,this.type=void 0===l?$o:l,this.offset=new i(0,0),this.repeat=new i(1,1),this.center=new i(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new s,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0===p?Zs:p,this.version=0,this.onUpdate=null}function u(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0===n?1:n}function l(e,t,r){this.width=e,this.height=t,this.scissor=new u(0,0,e,t),this.scissorTest=!1,this.viewport=new u(0,0,e,t),r=r||{},this.texture=new c(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0===r.minFilter?Ko:r.minFilter,this.depthBuffer=!(void 0!==r.depthBuffer)||r.depthBuffer,this.stencilBuffer=!(void 0!==r.stencilBuffer)||r.stencilBuffer,this.depthTexture=void 0===r.depthTexture?null:r.depthTexture}function h(e,t,r){l.call(this,e,t,r),this.samples=4}function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function d(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||d.DefaultOrder}function f(){this.mask=1}function m(){Object.defineProperty(this,"id",{value:vc++}),this.uuid=lc.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=m.DefaultUp.clone();var e=new o,t=new d,r=new a,n=new o(1,1,1);t._onChange(function(){r.setFromEuler(t,!1)}),r._onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new p},normalMatrix:{value:new s}}),this.matrix=new p,this.matrixWorld=new p,this.matrixAutoUpdate=m.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new f,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function g(){m.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function v(e,t){this.min=void 0===e?new o(1/0,1/0,1/0):e,this.max=void 0===t?new o(-1/0,-1/0,-1/0):t}function y(e,t){this.center=void 0===e?new o:e,this.radius=void 0===t?0:t}function b(e,t){this.origin=void 0===e?new o:e,this.direction=void 0===t?new o:t}function x(e,t,r){this.a=void 0===e?new o:e,this.b=void 0===t?new o:t,this.c=void 0===r?new o:r}function w(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function _(e,t,r){return 0>r&&(r+=1),1<r&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}function T(e){return.04045>e?.0773993808*e:Ma(.9478672986*e+.0521327014,2.4)}function E(e){return.0031308>e?12.92*e:1.055*Ma(e,.41666)-.055}function A(e,t,r,n,i,a){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new o,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new w,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0===a?0:a}function S(){Object.defineProperty(this,"id",{value:bc++}),this.uuid=lc.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Qa,this.side=Wa,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=Ya,this.opacity=1,this.transparent=!1,this.blendSrc=po,this.blendDst=fo,this.blendEquation=no,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=To,this.depthTest=!0,this.depthWrite=!0,this.stencilFunc=uc,this.stencilRef=0,this.stencilMask=255,this.stencilFail=cc,this.stencilZFail=cc,this.stencilZPass=cc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function M(e){S.call(this),this.type="MeshBasicMaterial",this.color=new w(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function L(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0===e?0:e.length/t,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function N(e,t,r){L.call(this,new Int8Array(e),t,r)}function R(e,t,r){L.call(this,new Uint8Array(e),t,r)}function C(e,t,r){L.call(this,new Uint8ClampedArray(e),t,r)}function I(e,t,r){L.call(this,new Int16Array(e),t,r)}function O(e,t,r){L.call(this,new Uint16Array(e),t,r)}function P(e,t,r){L.call(this,new Int32Array(e),t,r)}function F(e,t,r){L.call(this,new Uint32Array(e),t,r)}function k(e,t,r){L.call(this,new Float32Array(e),t,r)}function D(e,t,r){L.call(this,new Float64Array(e),t,r)}function U(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function B(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}function z(){Object.defineProperty(this,"id",{value:xc+=2}),this.uuid=lc.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function G(e,t){m.call(this),this.type="Mesh",this.geometry=void 0===e?new z:e,this.material=void 0===t?new M({color:16777215*Math.random()}):t,this.drawMode=Ys,this.updateMorphTargets()}function j(){Object.defineProperty(this,"id",{value:wc+=2}),this.uuid=lc.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function V(e,t,r,n,i,a){j.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new H(e,t,r,n,i,a)),this.mergeVertices()}function H(e,t,r,n,i,a){function s(e,t,r,n,i,a,s,m,g,v,y){var b,x,w=g+1,_=0,T=0,E=new o;for(x=0;x<v+1;x++){var A=x*(s/v)-s/2;for(b=0;b<w;b++){var S=b*(a/g)-a/2;E[e]=S*n,E[t]=A*i,E[r]=m/2,l.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[r]=0<m?1:-1,h.push(E.x,E.y,E.z),p.push(b/g),p.push(1-x/v),_+=1}}for(x=0;x<v;x++)for(b=0;b<g;b++){var M=d+b+w*x,L=d+b+w*(x+1),N=d+(b+1)+w*(x+1),R=d+(b+1)+w*x;u.push(M,L,R),u.push(L,N,R),T+=6}c.addGroup(f,T,y),f+=T,d+=_}z.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};var c=this;e=e||1,t=t||1,r=r||1,n=Fa(n)||1,i=Fa(i)||1,a=Fa(a)||1;var u=[],l=[],h=[],p=[],d=0,f=0;s("z","y","x",-1,-1,r,t,e,a,i,0),s("z","y","x",1,-1,r,t,-e,a,i,1),s("x","z","y",1,1,e,r,t,n,a,2),s("x","z","y",1,-1,e,r,-t,n,a,3),s("x","y","z",1,-1,e,t,r,n,i,4),s("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(u),this.addAttribute("position",new k(l,3)),this.addAttribute("normal",new k(h,3)),this.addAttribute("uv",new k(p,2))}function W(e){var t={};for(var r in e)for(var n in t[r]={},e[r]){var i=e[r][n];t[r][n]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?i.clone():Array.isArray(i)?i.slice():i}return t}function J(e){for(var t,r={},n=0;n<e.length;n++)for(var i in t=W(e[n]))r[i]=t[i];return r}function X(e){S.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Tc,this.fragmentShader=Ec,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Y(){m.call(this),this.type="Camera",this.matrixWorldInverse=new p,this.projectionMatrix=new p,this.projectionMatrixInverse=new p}function q(e,t,r,n){Y.call(this),this.type="PerspectiveCamera",this.fov=void 0===e?50:e,this.zoom=1,this.near=void 0===r?.1:r,this.far=void 0===n?2e3:n,this.focus=10,this.aspect=void 0===t?1:t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function K(e,t,r,n){m.call(this),this.type="CubeCamera";var i=new q(Ac,Sc,e,t);i.up.set(0,-1,0),i.lookAt(new o(1,0,0)),this.add(i);var a=new q(Ac,Sc,e,t);a.up.set(0,-1,0),a.lookAt(new o(-1,0,0)),this.add(a);var s=new q(Ac,Sc,e,t);s.up.set(0,0,1),s.lookAt(new o(0,1,0)),this.add(s);var c=new q(Ac,Sc,e,t);c.up.set(0,0,-1),c.lookAt(new o(0,-1,0)),this.add(c);var u=new q(Ac,Sc,e,t);u.up.set(0,-1,0),u.lookAt(new o(0,0,1)),this.add(u);var l=new q(Ac,Sc,e,t);l.up.set(0,-1,0),l.lookAt(new o(0,0,-1)),this.add(l),n=n||{format:ps,magFilter:Ko,minFilter:Ko},this.renderTarget=new Z(r,r,n),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=e.getRenderTarget(),n=this.renderTarget,o=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,c),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=o,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(r)},this.clear=function(e,t,r,n){for(var i=e.getRenderTarget(),a=this.renderTarget,o=0;6>o;o++)e.setRenderTarget(a,o),e.clear(t,r,n);e.setRenderTarget(i)}}function Z(e,t,r){l.call(this,e,t,r)}function Q(e,t,r,n,i,a,o,s,u,l,h,p){c.call(this,null,a,o,s,u,l,n,i,h,p),this.image={data:e,width:t,height:r},this.magFilter=void 0===u?Xo:u,this.minFilter=void 0===l?Xo:l,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function $(e,t){this.normal=void 0===e?new o(1,0,0):e,this.constant=void 0===t?0:t}function ee(e,t,r,n,i,a){this.planes=[void 0===e?new $:e,void 0===t?new $:t,void 0===r?new $:r,void 0===n?new $:n,void 0===i?new $:i,void 0===a?new $:a]}function te(){function e(i,a){!1===r||(n(i,a),t.requestAnimationFrame(e))}var t=null,r=!1,n=null;return{start:function(){1==r||null===n||(t.requestAnimationFrame(e),r=!0)},stop:function(){r=!1},setAnimationLoop:function(e){n=e},setContext:function(e){t=e}}}function re(e){function t(t,r){var n=t.array,i=t.dynamic?35048:35044,a=e.createBuffer();e.bindBuffer(r,a),e.bufferData(r,n,i),t.onUploadCallback();var o=5126;return n instanceof Float32Array?o=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=5123:n instanceof Int16Array?o=5122:n instanceof Uint32Array?o=5125:n instanceof Int32Array?o=5124:n instanceof Int8Array?o=5120:n instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}function r(t,r,n){var i=r.array,a=r.updateRange;e.bindBuffer(n,t),!1===r.dynamic?e.bufferData(n,i,35044):-1===a.count?e.bufferSubData(n,0,i):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}var n=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),n.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var r=n.get(t);r&&(e.deleteBuffer(r.buffer),n.delete(t))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var a=n.get(e);void 0===a?n.set(e,t(e,i)):a.version<e.version&&(r(a.buffer,e,i),a.version=e.version)}}}function ne(e,t,r,n){j.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new ie(e,t,r,n)),this.mergeVertices()}function ie(e,t,r,n){z.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i,a,o=(e=e||1)/2,s=(t=t||1)/2,c=Fa(r)||1,u=Fa(n)||1,l=c+1,h=e/c,p=t/u,d=[],f=[],m=[],g=[];for(a=0;a<u+1;a++){var v=a*p-s;for(i=0;i<l;i++){var y=i*h-o;f.push(y,-v,0),m.push(0,0,1),g.push(i/c),g.push(1-a/u)}}for(a=0;a<u;a++)for(i=0;i<c;i++){var b=i+l*a,x=i+l*(a+1),w=i+1+l*(a+1),_=i+1+l*a;d.push(b,x,_),d.push(x,w,_)}this.setIndex(d),this.addAttribute("position",new k(f,3)),this.addAttribute("normal",new k(m,3)),this.addAttribute("uv",new k(g,2))}function ae(e,t,r,n){function i(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}var a,o,s=new w(0),c=0,u=null,l=0;return{getClearColor:function(){return s},setClearColor:function(e,t){s.set(e),i(s,c=void 0===t?1:t)},getClearAlpha:function(){return c},setClearAlpha:function(e){i(s,c=e)},render:function(t,n,h,p){var d=n.background,f=e.vr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(d=null),null===d?(i(s,c),u=null,l=0):d&&d.isColor&&(i(d,1),p=!0,u=null,l=0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLRenderTargetCube)){void 0===o&&((o=new G(new H(1,1,1),new X({type:"BackgroundCubeMaterial",uniforms:W(Nc.cube.uniforms),vertexShader:Nc.cube.vertexShader,fragmentShader:Nc.cube.fragmentShader,side:Ja,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.tCube.value}}),r.update(o));var g=d.isWebGLRenderTargetCube?d.texture:d;o.material.uniforms.tCube.value=g,o.material.uniforms.tFlip.value=d.isWebGLRenderTargetCube?1:-1,(u!==d||l!==g.version)&&(o.material.needsUpdate=!0,u=d,l=g.version),t.unshift(o,o.geometry,o.material,0,0,null)}else d&&d.isTexture&&(void 0===a&&((a=new G(new ie(2,2),new X({type:"BackgroundMaterial",uniforms:W(Nc.background.uniforms),vertexShader:Nc.background.vertexShader,fragmentShader:Nc.background.fragmentShader,side:Wa,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),a.material.uniforms.uvTransform.value.copy(d.matrix),(u!==d||l!==d.version)&&(a.material.needsUpdate=!0,u=d,l=d.version),t.unshift(a,a.geometry,a.material,0,0,null))}}}function oe(e,t,r,n){var i;this.setMode=function(e){i=e},this.render=function(t,n){e.drawArrays(i,t,n),r.update(n,i)},this.renderInstances=function(a,o,s){var c;if(n.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[n.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,o,s,a.maxInstancedCount),r.update(s,i,a.maxInstancedCount)}}function se(e,t,r){function n(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var i,a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,o=void 0===r.precision?"highp":r.precision,s=n(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var c=!0===r.logarithmicDepthBuffer,u=e.getParameter(34930),l=e.getParameter(35660),h=e.getParameter(3379),p=e.getParameter(34076),d=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=0<l,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;var r=t.get("EXT_texture_filter_anisotropic");return i=null===r?0:e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)},getMaxPrecision:n,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:p,maxAttributes:d,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function ce(){function e(){l.value!==n&&(l.value=n,l.needsUpdate=0<i),r.numPlanes=i,r.numIntersection=0}function t(e,t,n,i){var a=null===e?0:e.length,o=null;if(0!==a){if(o=l.value,!0!==i||null===o){var s=n+4*a,h=t.matrixWorldInverse;u.getNormalMatrix(h),(null===o||o.length<s)&&(o=new Float32Array(s));for(var p=0,d=n;p!==a;++p,d+=4)c.copy(e[p]).applyMatrix4(h,u),c.normal.toArray(o,d),o[d+3]=c.constant}l.value=o,l.needsUpdate=!0}return r.numPlanes=a,o}var r=this,n=null,i=0,a=!1,o=!1,c=new $,u=new s,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,o){var s=0!==e.length||r||0!==i||a;return a=r,n=t(e,o,0),i=e.length,s},this.beginShadows=function(){o=!0,t(null)},this.endShadows=function(){o=!1,e()},this.setState=function(r,s,c,u,h,p){if(!a||null===r||0===r.length||o&&!c)o?t(null):e();else{var d=o?0:i,f=4*d,m=h.clippingState||null;l.value=m,m=t(r,u,f,p);for(var g=0;g!==f;++g)m[g]=n[g];h.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=d}}}function ue(e){var t={};return{get:function(r){return void 0!==t[r]?t[r]:(null===(n="WEBGL_depth_texture"===r?e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture"):"EXT_texture_filter_anisotropic"===r?e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"):"WEBGL_compressed_texture_s3tc"===r?e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"):"WEBGL_compressed_texture_pvrtc"===r?e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"):e.getExtension(r))&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n);var n}}}function le(e,t,r){function n(e){var i=e.target,s=a[i.id];for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);i.removeEventListener("dispose",n),delete a[i.id];var u=o[s.id];u&&(t.remove(u),delete o[s.id]),r.memory.geometries--}function i(e){var r=[],n=e.index,i=e.attributes.position,a=0;if(null!==n){var s=n.array;a=n.version;for(var c=0,u=s.length;c<u;c+=3){var l=s[c+0],h=s[c+1],p=s[c+2];r.push(l,h,h,p,p,l)}}else{s=i.array;a=i.version;for(c=0,u=s.length/3-1;c<u;c+=3){l=c+0,h=c+1,p=c+2;r.push(l,h,h,p,p,l)}}var d=new(65535<B(r)?F:O)(r,1);d.version=a,t.update(d,34963);var f=o[e.id];f&&t.remove(f),o[e.id]=d}var a={},o={};return{get:function(e,t){var i=a[t.id];return i||(t.addEventListener("dispose",n),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new z).setFromObject(e)),i=t._bufferGeometry),a[t.id]=i,r.memory.geometries++,i)},update:function(e){var r=e.index,n=e.attributes;for(var i in null!==r&&t.update(r,34963),n)t.update(n[i],34962);var a=e.morphAttributes;for(var i in a)for(var o=a[i],s=0,c=o.length;s<c;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=o[e.id];if(t){var r=e.index;null!==r&&t.version<r.version&&i(e)}else i(e);return o[e.id]}}}function he(e,t,r,n){var i,a,o;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,n){e.drawElements(i,n,a,t*o),r.update(n,i)},this.renderInstances=function(s,c,u){var l;if(n.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[n.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,u,a,c*o,s.maxInstancedCount),r.update(u,i,s.maxInstancedCount)}}function pe(){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,r,n){switch(n=n||1,e.calls++,r){case 4:e.triangles+=n*(t/3);break;case 5:case 6:e.triangles+=n*(t-2);break;case 1:e.lines+=n*(t/2);break;case 3:e.lines+=n*(t-1);break;case 2:e.lines+=n*t;break;case 0:e.points+=n*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function de(e,t){return Ea(t[1])-Ea(e[1])}function fe(e){var t={},r=new Float32Array(8);return{update:function(n,i,a,o){var s=n.morphTargetInfluences,c=s.length,u=t[i.id];if(void 0===u){u=[];for(var l=0;l<c;l++)u[l]=[l,0];t[i.id]=u}var h,p=a.morphTargets&&i.morphAttributes.position,d=a.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++)0!==(h=u[l])[1]&&(p&&i.removeAttribute("morphTarget"+l),d&&i.removeAttribute("morphNormal"+l));for(l=0;l<c;l++)(h=u[l])[0]=l,h[1]=s[l];for(u.sort(de),l=0;8>l;l++){if(h=u[l]){var f=h[0],m=h[1];if(m){p&&i.addAttribute("morphTarget"+l,p[f]),d&&i.addAttribute("morphNormal"+l,d[f]),r[l]=m;continue}}r[l]=0}o.getUniforms().setValue(e,"morphTargetInfluences",r)}}}function me(e,t){var r={};return{update:function(n){var i=t.render.frame,a=n.geometry,o=e.get(n,a);return r[o.id]!==i&&(a.isGeometry&&o.updateFromObject(n),e.update(o),r[o.id]=i),o},dispose:function(){r={}}}}function ge(e,t,r,n,i,a,o,s,u,l){e=void 0===e?[]:e,t=void 0===t?Do:t,o=void 0===o?ps:o,c.call(this,e,t,r,n,i,a,o,s,u,l),this.flipY=!1}function ve(e,t,r,n){c.call(this,null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=Xo,this.minFilter=Xo,this.wrapR=Wo,this.generateMipmaps=!1,this.flipY=!1}function ye(e,t,r,n){c.call(this,null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=Xo,this.minFilter=Xo,this.wrapR=Wo,this.generateMipmaps=!1,this.flipY=!1}function be(e,t,r){var n=e[0];if(0>=n||0<n)return e;var i=t*r,a=Pc[i];if(void 0===a&&(a=new Float32Array(i),Pc[i]=a),0!==t){n.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=r,e[o].toArray(a,s)}return a}function xe(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function we(e,t){for(var r=0,n=t.length;r<n;r++)e[r]=t[r]}function _e(e,t){var r=Fc[t];void 0===r&&(r=new Int32Array(t),Fc[t]=r);for(var n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function Te(e,t){var r=this.cache;r[0]===t||(e.uniform1f(this.addr,t),r[0]=t)}function Ee(e,t){var r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(xe(r,t))return;e.uniform2fv(this.addr,t),we(r,t)}}function Ae(e,t){var r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(xe(r,t))return;e.uniform3fv(this.addr,t),we(r,t)}}function Se(e,t){var r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(xe(r,t))return;e.uniform4fv(this.addr,t),we(r,t)}}function Me(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(xe(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),we(r,t)}else{if(xe(r,n))return;Uc.set(n),e.uniformMatrix2fv(this.addr,!1,Uc),we(r,n)}}function Le(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(xe(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),we(r,t)}else{if(xe(r,n))return;Dc.set(n),e.uniformMatrix3fv(this.addr,!1,Dc),we(r,n)}}function Ne(e,t){var r=this.cache,n=t.elements;if(void 0===n){if(xe(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),we(r,t)}else{if(xe(r,n))return;kc.set(n),e.uniformMatrix4fv(this.addr,!1,kc),we(r,n)}}function Re(e,t,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.safeSetTexture2D(t||Rc,i)}function Ce(e,t,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||Cc,i)}function Ie(e,t,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||Ic,i)}function Oe(e,t,r){var n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.safeSetTextureCube(t||Oc,i)}function Pe(e,t){var r=this.cache;r[0]===t||(e.uniform1i(this.addr,t),r[0]=t)}function Fe(e,t){var r=this.cache;xe(r,t)||(e.uniform2iv(this.addr,t),we(r,t))}function ke(e,t){var r=this.cache;xe(r,t)||(e.uniform3iv(this.addr,t),we(r,t))}function De(e,t){var r=this.cache;xe(r,t)||(e.uniform4iv(this.addr,t),we(r,t))}function Ue(e,t){e.uniform1fv(this.addr,t)}function Be(e,t){e.uniform1iv(this.addr,t)}function ze(e,t){e.uniform2iv(this.addr,t)}function Ge(e,t){e.uniform3iv(this.addr,t)}function je(e,t){e.uniform4iv(this.addr,t)}function Ve(e,t){var r=be(t,this.size,2);e.uniform2fv(this.addr,r)}function He(e,t){var r=be(t,this.size,3);e.uniform3fv(this.addr,r)}function We(e,t){var r=be(t,this.size,4);e.uniform4fv(this.addr,r)}function Je(e,t){var r=be(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function Xe(e,t){var r=be(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Ye(e,t){var r=be(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function qe(e,t,r){var n=t.length,i=_e(r,n);e.uniform1iv(this.addr,i);for(var a=0;a!==n;++a)r.safeSetTexture2D(t[a]||Rc,i[a])}function Ke(e,t,r){var n=t.length,i=_e(r,n);e.uniform1iv(this.addr,i);for(var a=0;a!==n;++a)r.safeSetTextureCube(t[a]||Oc,i[a])}function Ze(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){return 5126===e?Te:35664===e?Ee:35665===e?Ae:35666===e?Se:35674===e?Me:35675===e?Le:35676===e?Ne:35678===e||36198===e?Re:35679===e?Ie:35680===e?Oe:36289===e?Ce:5124===e||35670===e?Pe:35667===e||35671===e?Fe:35668===e||35672===e?ke:35669===e||35673===e?De:void 0}(t.type)}function Qe(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){return 5126===e?Ue:35664===e?Ve:35665===e?He:35666===e?We:35674===e?Je:35675===e?Xe:35676===e?Ye:35678===e?qe:35680===e?Ke:5124===e||35670===e?Be:35667===e||35671===e?ze:35668===e||35672===e?Ge:35669===e||35673===e?je:void 0}(t.type)}function $e(e){this.id=e,this.seq=[],this.map={}}function et(e,t){e.seq.push(t),e.map[t.id]=t}function tt(e,t,r){var n=e.name,i=n.length;for(Bc.lastIndex=0;;){var a=Bc.exec(n),o=Bc.lastIndex,s=a[1],c="]"===a[2],u=a[3];if(c&&(s|=0),void 0===u||"["===u&&o+2===i){et(r,void 0===u?new Ze(s,e,t):new Qe(s,e,t));break}var l=r.map[s];void 0===l&&et(r,l=new $e(s)),r=l}}function rt(e,t){this.seq=[],this.map={};for(var r=e.getProgramParameter(t,35718),n=0;n<r;++n){var i=e.getActiveUniform(t,n);tt(i,e.getUniformLocation(t,i.name),this)}}function nt(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function it(e){switch(e){case Zs:return["Linear","( value )"];case Qs:return["sRGB","( value )"];case ec:return["RGBE","( value )"];case tc:return["RGBM","( value, 7.0 )"];case rc:return["RGBM","( value, 16.0 )"];case nc:return["RGBD","( value, 256.0 )"];case $s:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function at(e,t,r){var n=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return n&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+i+function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}(e.getShaderSource(t))}function ot(e,t){var r=it(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function st(e,t){var r=it(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function ct(e,t){var r;switch(t){case Io:r="Linear";break;case Oo:r="Reinhard";break;case Po:r="Uncharted2";break;case Fo:r="OptimizedCineon";break;case ko:r="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function ut(e){return""!==e}function lt(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function ht(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function pt(e){return e.replace(/^[ \t]*#include +<([\w\d.\/]+)>/gm,function(e,t){var r=Mc[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return pt(r)})}function dt(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,r,n){for(var i="",a=parseInt(t);a<parseInt(r);a++)i+=n.replace(/\[ i \]/g,"[ "+a+" ]");return i})}function ft(e,t,r,n,i,a,o){var s=e.getContext(),c=n.defines,u=i.vertexShader,l=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";a.shadowMapType===Va?h="SHADOWMAP_TYPE_PCF":a.shadowMapType===Ha&&(h="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(n.envMap.mapping){case Do:case Uo:p="ENVMAP_TYPE_CUBE";break;case jo:case Vo:p="ENVMAP_TYPE_CUBE_UV";break;case Bo:case zo:p="ENVMAP_TYPE_EQUIREC";break;case Go:p="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case Uo:case zo:d="ENVMAP_MODE_REFRACTION"}switch(n.combine){case Lo:f="ENVMAP_BLENDING_MULTIPLY";break;case No:f="ENVMAP_BLENDING_MIX";break;case Ro:f="ENVMAP_BLENDING_ADD"}}var m,g,v=0<e.gammaFactor?e.gammaFactor:1,y=o.isWebGL2?"":function(e,t,r){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ut).join("\n")}(n.extensions,a,t),b=function(e){var t=[];for(var r in e){var n=e[r];!1===n||t.push("#define "+r+" "+n)}return t.join("\n")}(c),x=s.createProgram();if(n.isRawShaderMaterial?(0<(m=[b].filter(ut).join("\n")).length&&(m+="\n"),0<(g=[y,b].filter(ut).join("\n")).length&&(g+="\n")):(m=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,b,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+h:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ut).join("\n"),g=[y,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,b,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+v,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+p:"",a.envMap?"#define "+d:"",a.envMap?"#define "+f:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+h:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&(o.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping===Co?"":"#define TONE_MAPPING",a.toneMapping===Co?"":Mc.tonemapping_pars_fragment,a.toneMapping===Co?"":ct("toneMapping",a.toneMapping),a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?Mc.encodings_pars_fragment:"",a.mapEncoding?ot("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?ot("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?ot("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?ot("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?st("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ut).join("\n")),u=ht(u=lt(u=pt(u),a),a),l=ht(l=lt(l=pt(l),a),a),u=dt(u),l=dt(l),o.isWebGL2&&!n.isRawShaderMaterial){var w=!1,_=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==u.match(_)&&null!==l.match(_)&&(w=!0,u=u.replace(_,""),l=l.replace(_,"")),m="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+m,g=["#version 300 es\n","#define varying in",w?"":"out highp vec4 pc_fragColor;",w?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g}var T,E,A=g+l,S=nt(s,35633,m+u),M=nt(s,35632,A);if(s.attachShader(x,S),s.attachShader(x,M),void 0===n.index0AttributeName?!0===a.morphTargets&&s.bindAttribLocation(x,0,"position"):s.bindAttribLocation(x,0,n.index0AttributeName),s.linkProgram(x),e.debug.checkShaderErrors){var L=s.getProgramInfoLog(x).trim(),N=s.getShaderInfoLog(S).trim(),R=s.getShaderInfoLog(M).trim(),C=!0,I=!0;if(!1===s.getProgramParameter(x,35714)){C=!1;var O=at(s,S,"vertex"),P=at(s,M,"fragment");console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(x,35715),"gl.getProgramInfoLog",L,O,P)}else""===L?(""===N||""===R)&&(I=!1):console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",L);I&&(this.diagnostics={runnable:C,material:n,programLog:L,vertexShader:{log:N,prefix:m},fragmentShader:{log:R,prefix:g}})}return s.deleteShader(S),s.deleteShader(M),this.getUniforms=function(){return null==T&&(T=new rt(s,x)),T},this.getAttributes=function(){return void 0===E&&(E=function(e,t){for(var r={},n=e.getProgramParameter(t,35721),i=0;i<n;i++){var a=e.getActiveAttrib(t,i).name;r[a]=e.getAttribLocation(t,a)}return r}(s,x)),E},this.destroy=function(){s.deleteProgram(x),this.program=void 0},this.name=i.name,this.id=zc++,this.code=r,this.usedTimes=1,this.program=x,this.vertexShader=S,this.fragmentShader=M,this}function mt(e,t,r){function n(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=Zs,r===Zs&&t&&(r=$s),r}var i=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(t,i,o,s,c,u,l){var h=a[t.type],p=l.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms,i=Fa((n-20)/4),a=Ia(i,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(l):0,d=r.precision;null!==t.precision&&((d=r.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",d,"instead."));var f=e.getRenderTarget();return{shaderID:h,precision:d,supportsVertexTextures:r.vertexTextures,outputEncoding:n(f?f.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:n(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:n(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:n(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===jo||t.envMap.mapping===Vo),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:n(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===sc,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:t.skinning&&0<p,maxBones:p,useVertexTexture:r.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numClippingPlanes:c,numClipIntersection:u,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&0<o.length,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===Xa,flipSided:t.side===Ja,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var a=0;a<o.length;a++)n.push(r[o[a]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.push(e.gammaFactor),n.join()},this.acquireProgram=function(n,a,o,s){for(var c,u,l=0,h=i.length;l<h;l++)if((u=i[l]).code===s){++(c=u).usedTimes;break}return void 0===c&&(c=new ft(e,t,s,n,a,o,r),i.push(c)),c},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function gt(){var e=new WeakMap;return{get:function(t){var r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function vt(e,t){return e.groupOrder===t.groupOrder?e.renderOrder===t.renderOrder?e.program===t.program?e.material.id===t.material.id?e.z===t.z?e.id-t.id:e.z-t.z:e.material.id-t.material.id:e.program.id-t.program.id:e.renderOrder-t.renderOrder:e.groupOrder-t.groupOrder}function yt(e,t){return e.groupOrder===t.groupOrder?e.renderOrder===t.renderOrder?e.z===t.z?e.id-t.id:t.z-e.z:e.renderOrder-t.renderOrder:e.groupOrder-t.groupOrder}function bt(){function e(e,n,i,o,s,c){var u=t[r];return void 0===u?(u={id:e.id,object:e,geometry:n,material:i,program:i.program||a,groupOrder:o,renderOrder:e.renderOrder,z:s,group:c},t[r]=u):(u.id=e.id,u.object=e,u.geometry=n,u.material=i,u.program=i.program||a,u.groupOrder=o,u.renderOrder=e.renderOrder,u.z=s,u.group=c),r++,u}var t=[],r=0,n=[],i=[],a={id:-1};return{opaque:n,transparent:i,init:function(){r=0,n.length=0,i.length=0},push:function(t,r,a,o,s,c){var u=e(t,r,a,o,s,c);(!0===a.transparent?i:n).push(u)},unshift:function(t,r,a,o,s,c){var u=e(t,r,a,o,s,c);(!0===a.transparent?i:n).unshift(u)},sort:function(){1<n.length&&n.sort(vt),1<i.length&&i.sort(yt)}}}function xt(){function e(r){var n=r.target;n.removeEventListener("dispose",e),delete t[n.id]}var t={};return{get:function(r,n){var i,a=t[r.id];return void 0===a?(i=new bt,t[r.id]={},t[r.id][n.id]=i,r.addEventListener("dispose",e)):void 0===(i=a[n.id])&&(i=new bt,a[n.id]=i),i},dispose:function(){t={}}}}function wt(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new o,color:new w,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":r={position:new o,direction:new o,color:new w,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":r={position:new o,color:new w,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new o,skyColor:new w,groundColor:new w};break;case"RectAreaLight":r={color:new w,position:new o,halfWidth:new o,halfHeight:new o}}return e[t.id]=r,r}}}function _t(){for(var e=new wt,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;9>r;r++)t.probe.push(new o);var n=new o,i=new p,a=new p;return{setup:function(r,o,s){for(var c=0,u=0,l=0,h=0;9>h;h++)t.probe[h].set(0,0,0);for(var p=0,d=0,f=0,m=0,g=0,v=s.matrixWorldInverse,y=(h=0,r.length);h<y;h++){var b=r[h],x=b.color,w=b.intensity,_=b.distance,T=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)c+=x.r*w,u+=x.g*w,l+=x.b*w;else if(b.isLightProbe)for(var E=0;9>E;E++)t.probe[E].addScaledVector(b.sh.coefficients[E],w);else if(b.isDirectionalLight){if((S=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),S.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(v),S.shadow=b.castShadow,b.castShadow){var A=b.shadow;S.shadowBias=A.bias,S.shadowRadius=A.radius,S.shadowMapSize=A.mapSize}t.directionalShadowMap[p]=T,t.directionalShadowMatrix[p]=b.shadow.matrix,t.directional[p]=S,p++}else if(b.isSpotLight){if((S=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),S.color.copy(x).multiplyScalar(w),S.distance=_,S.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(v),S.coneCos=_a(b.angle),S.penumbraCos=_a(b.angle*(1-b.penumbra)),S.decay=b.decay,S.shadow=b.castShadow,b.castShadow){A=b.shadow;S.shadowBias=A.bias,S.shadowRadius=A.radius,S.shadowMapSize=A.mapSize}t.spotShadowMap[f]=T,t.spotShadowMatrix[f]=b.shadow.matrix,t.spot[f]=S,f++}else if(b.isRectAreaLight){(S=e.get(b)).color.copy(x).multiplyScalar(w),S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),a.identity(),i.copy(b.matrixWorld),i.premultiply(v),a.extractRotation(i),S.halfWidth.set(.5*b.width,0,0),S.halfHeight.set(0,.5*b.height,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),t.rectArea[m]=S,m++}else if(b.isPointLight){if((S=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),S.color.copy(b.color).multiplyScalar(b.intensity),S.distance=b.distance,S.decay=b.decay,S.shadow=b.castShadow,b.castShadow){A=b.shadow;S.shadowBias=A.bias,S.shadowRadius=A.radius,S.shadowMapSize=A.mapSize,S.shadowCameraNear=A.camera.near,S.shadowCameraFar=A.camera.far}t.pointShadowMap[d]=T,t.pointShadowMatrix[d]=b.shadow.matrix,t.point[d]=S,d++}else if(b.isHemisphereLight){var S;(S=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(v),S.direction.normalize(),S.skyColor.copy(b.color).multiplyScalar(w),S.groundColor.copy(b.groundColor).multiplyScalar(w),t.hemi[g]=S,g++}}t.ambient[0]=c,t.ambient[1]=u,t.ambient[2]=l;var M=t.hash;(M.directionalLength!==p||M.pointLength!==d||M.spotLength!==f||M.rectAreaLength!==m||M.hemiLength!==g||M.shadowsLength!==o.length)&&(t.directional.length=p,t.spot.length=f,t.rectArea.length=m,t.point.length=d,t.hemi.length=g,M.directionalLength=p,M.pointLength=d,M.spotLength=f,M.rectAreaLength=m,M.hemiLength=g,M.shadowsLength=o.length,t.version=Gc++)},state:t}}function Tt(){var e=new _t,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(n){e.setup(t,r,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function Et(){function e(r){var n=r.target;n.removeEventListener("dispose",e),delete t[n.id]}var t={};return{get:function(r,n){var i;return void 0===t[r.id]?(i=new Tt,t[r.id]={},t[r.id][n.id]=i,r.addEventListener("dispose",e)):void 0===t[r.id][n.id]?(i=new Tt,t[r.id][n.id]=i):i=t[r.id][n.id],i},dispose:function(){t={}}}}function At(e){S.call(this),this.type="MeshDepthMaterial",this.depthPacking=ic,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function St(e){S.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new o,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Mt(e,t,r){function n(t,r,n,i,a,o){var s=t.geometry,c=null,u=y,l=t.customDepthMaterial;if(n&&(u=b,l=t.customDistanceMaterial),l)c=l;else{var h=!1;r.morphTargets&&(s&&s.isBufferGeometry?h=s.morphAttributes&&s.morphAttributes.position&&0<s.morphAttributes.position.length:s&&s.isGeometry&&(h=s.morphTargets&&0<s.morphTargets.length)),t.isSkinnedMesh&&!1===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var p=t.isSkinnedMesh&&r.skinning,d=0;h&&(d|=g),p&&(d|=v),c=u[d]}if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var f=c.uuid,m=r.uuid,_=x[f];void 0===_&&(_={},x[f]=_);var T=_[m];void 0===T&&(T=c.clone(),_[m]=T),c=T}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=null==r.shadowSide?w[r.side]:r.shadowSide,c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,n&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=a,c.farDistance=o),c}function a(r,i,o,c){if(!1!==r.visible){if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||s.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var u=t.update(r),l=r.material;if(Array.isArray(l))for(var h=u.groups,p=0,d=h.length;p<d;p++){var f=h[p],g=l[f.materialIndex];if(g&&g.visible){var v=n(r,g,c,m,o.near,o.far);e.renderBufferDirect(o,null,u,v,r,f)}}else if(l.visible){v=n(r,l,c,m,o.near,o.far);e.renderBufferDirect(o,null,u,v,r,null)}}for(var y=r.children,b=0,x=y.length;b<x;b++)a(y[b],i,o,c)}}for(var s=new ee,c=new p,h=new i,d=new i(r,r),f=new o,m=new o,g=1,v=2,y=[,,,,],b=[,,,,],x={},w={0:Ja,1:Wa,2:Xa},_=[new o(1,0,0),new o(-1,0,0),new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0)],T=[new o(0,1,0),new o(0,1,0),new o(0,1,0),new o(0,1,0),new o(0,0,1),new o(0,0,-1)],E=[new u,new u,new u,new u,new u,new u],A=0;A!==1+(g|v);++A){var S=0!=(A&g),M=0!=(A&v),L=new At({depthPacking:ac,morphTargets:S,skinning:M});y[A]=L;var N=new St({morphTargets:S,skinning:M});b[A]=N}var R=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Va,this.render=function(t,r,n){if(!1!==R.enabled&&(!1!==R.autoUpdate||!1!==R.needsUpdate)&&0!==t.length){var i=e.getRenderTarget(),o=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),p=e.state;p.setBlending(Za),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var g,v=0,y=t.length;v<y;v++){var b=t[v],x=b.shadow,w=b&&b.isPointLight;if(void 0!==x){var A=x.camera;if(h.copy(x.mapSize),h.min(d),w){var S=h.x,M=h.y;E[0].set(2*S,M,S,M),E[1].set(0,M,S,M),E[2].set(3*S,M,S,M),E[3].set(S,M,S,M),E[4].set(3*S,0,S,M),E[5].set(S,0,S,M),h.x*=4,h.y*=2}null===x.map&&(x.map=new l(h.x,h.y,{minFilter:Xo,magFilter:Xo,format:ds}),x.map.texture.name=b.name+".shadowMap",A.updateProjectionMatrix()),x.isSpotLightShadow&&x.update(b);var L=x.map,N=x.matrix;m.setFromMatrixPosition(b.matrixWorld),A.position.copy(m),w?(g=6,N.makeTranslation(-m.x,-m.y,-m.z)):(g=1,f.setFromMatrixPosition(b.target.matrixWorld),A.lookAt(f),A.updateMatrixWorld(),N.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),N.multiply(A.projectionMatrix),N.multiply(A.matrixWorldInverse)),e.setRenderTarget(L),e.clear();for(var C=0;C<g;C++){if(w){f.copy(A.position),f.add(_[C]),A.up.copy(T[C]),A.lookAt(f),A.updateMatrixWorld();var I=E[C];p.viewport(I)}c.multiplyMatrices(A.projectionMatrix,A.matrixWorldInverse),s.setFromMatrix(c),a(r,n,A,w)}}else console.warn("THREE.WebGLShadowMap:",b,"has no shadow.")}R.needsUpdate=!1,e.setRenderTarget(i,o,u)}}}function Lt(e,t,r,n){function i(t,r,n){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<n;o++)e.texImage2D(r+o,0,6408,1,1,0,6408,5121,i);return a}function a(r,i){(y[r]=1,0===b[r]&&(e.enableVertexAttribArray(r),b[r]=1),x[r]!==i)&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,i),x[r]=i)}function o(t){!0!==w[t]&&(e.enable(t),w[t]=!0)}function s(t){!1!==w[t]&&(e.disable(t),w[t]=!1)}function c(t,n,i,a,c,u,l,h){return t===Za?void(E&&(s(3042),E=!1)):(E||(o(3042),E=!0),t===ro?(c=c||n,u=u||i,l=l||a,(n!==S||c!==N)&&(e.blendEquationSeparate(r.convert(n),r.convert(c)),S=n,N=c),(i!==M||a!==L||u!==R||l!==C)&&(e.blendFuncSeparate(r.convert(i),r.convert(a),r.convert(u),r.convert(l)),M=i,L=a,R=u,C=l),A=t,void(I=null)):void((t!==A||h!==I)&&((S!==no||N!==no)&&(e.blendEquation(32774),S=no,N=no),h?t===Qa?e.blendFuncSeparate(1,771,1,771):t===$a?e.blendFunc(1,1):t===eo?e.blendFuncSeparate(0,0,769,771):t===to?e.blendFuncSeparate(0,768,0,770):console.error("THREE.WebGLState: Invalid blending: ",t):t===Qa?e.blendFuncSeparate(770,771,1,771):t===$a?e.blendFunc(770,1):t===eo?e.blendFunc(0,769):t===to?e.blendFunc(0,768):console.error("THREE.WebGLState: Invalid blending: ",t),M=null,L=null,R=null,C=null,A=t,I=h)))}function l(t){O!==t&&(t?e.frontFace(2304):e.frontFace(2305),O=t)}function h(t){t===za?s(2884):(o(2884),t!==P&&(t===Ga?e.cullFace(1029):t===ja?e.cullFace(1028):e.cullFace(1032))),P=t}function p(t,r,n){t?(o(32823),(k!==r||D!==n)&&(e.polygonOffset(r,n),k=r,D=n)):s(32823)}function d(t){void 0===t&&(t=33984+U-1),j!==t&&(e.activeTexture(t),j=t)}var f=new function(){var t=!1,r=new u,n=null,i=new u(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,a,o,s){!0===s&&(t*=o,n*=o,a*=o),r.set(t,n,a,o),!1===i.equals(r)&&(e.clearColor(t,n,a,o),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},m=new function(){var t=!1,r=null,n=null,i=null;return{setTest:function(e){e?o(2929):s(2929)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){n!==t&&(t?t===xo?e.depthFunc(512):t===wo?e.depthFunc(519):t===_o?e.depthFunc(513):t===To?e.depthFunc(515):t===Eo?e.depthFunc(514):t===Ao?e.depthFunc(518):t===So?e.depthFunc(516):t===Mo?e.depthFunc(517):e.depthFunc(515):e.depthFunc(515),n=t)},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},g=new function(){var t=!1,r=null,n=null,i=null,a=null,c=null,u=null,l=null,h=null;return{setTest:function(e){e?o(2960):s(2960)},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,o){(n!==t||i!==r||a!==o)&&(e.stencilFunc(t,r,o),n=t,i=r,a=o)},setOp:function(t,r,n){(c!==t||u!==r||l!==n)&&(e.stencilOp(t,r,n),c=t,u=r,l=n)},setLocked:function(e){t=e},setClear:function(t){h!==t&&(e.clearStencil(t),h=t)},reset:function(){t=!1,r=null,n=null,i=null,a=null,c=null,u=null,l=null,h=null}}},v=e.getParameter(34921),y=new Uint8Array(v),b=new Uint8Array(v),x=new Uint8Array(v),w={},_=null,T=null,E=null,A=null,S=null,M=null,L=null,N=null,R=null,C=null,I=!1,O=null,P=null,F=null,k=null,D=null,U=e.getParameter(35661),B=!1,z=0,G=e.getParameter(7938);-1===G.indexOf("WebGL")?-1!==G.indexOf("OpenGL ES")&&(z=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(G)[1]),B=2<=z):(z=parseFloat(/^WebGL\ ([0-9])/.exec(G)[1]),B=1<=z);var j=null,V={},H=new u,W=new u,J={};return J[3553]=i(3553,3553,1),J[34067]=i(34067,34069,6),f.setClear(0,0,0,1),m.setClear(1),g.setClear(0),o(2929),m.setFunc(To),l(!1),h(Ga),o(2884),c(Za),{buffers:{color:f,depth:m,stencil:g},initAttributes:function(){for(var e=0,t=y.length;e<t;e++)y[e]=0},enableAttribute:function(e){a(e,0)},enableAttributeAndDivisor:a,disableUnusedAttributes:function(){for(var t=0,r=b.length;t!==r;++t)b[t]!==y[t]&&(e.disableVertexAttribArray(t),b[t]=0)},enable:o,disable:s,getCompressedTextureFormats:function(){if(null===_&&(_=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var r=e.getParameter(34467),n=0;n<r.length;n++)_.push(r[n]);return _},useProgram:function(t){return T!==t&&(e.useProgram(t),T=t,!0)},setBlending:c,setMaterial:function(e,t){e.side===Xa?s(2884):o(2884);var r=e.side===Ja;t&&(r=!r),l(r),e.blending===Qa&&!1===e.transparent?c(Za):c(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),m.setFunc(e.depthFunc),m.setTest(e.depthTest),m.setMask(e.depthWrite),f.setMask(e.colorWrite);var n=e.stencilWrite;g.setTest(n),n&&(g.setFunc(e.stencilFunc,e.stencilRef,e.stencilMask),g.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),p(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:l,setCullFace:h,setLineWidth:function(t){t!==F&&(B&&e.lineWidth(t),F=t)},setPolygonOffset:p,setScissorTest:function(e){e?o(3089):s(3089)},activeTexture:d,bindTexture:function(t,r){null===j&&d();var n=V[j];void 0===n&&(n={type:void 0,texture:void 0},V[j]=n),(n.type!==t||n.texture!==r)&&(e.bindTexture(t,r||J[t]),n.type=t,n.texture=r)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===H.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),H.copy(t))},viewport:function(t){!1===W.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),W.copy(t))},reset:function(){for(var t=0;t<b.length;t++)1===b[t]&&(e.disableVertexAttribArray(t),b[t]=0);w={},_=null,j=null,V={},T=null,A=null,O=null,P=null,f.reset(),m.reset(),g.reset()}}}function Nt(e,t,r,n,i,a,o){function s(e,t){return R?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function c(e,t,r,n){var i=1;if((e.width>n||e.height>n)&&(i=n/Ca(e.width,e.height)),1>i||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?lc.floorPowerOfTwo:Fa,o=a(i*e.width),c=a(i*e.height);void 0===L&&(L=s(o,c));var u=r?s(o,c):L;return u.width=o,u.height=c,u.getContext("2d").drawImage(e,0,0,o,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+c+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function u(e){return lc.isPowerOfTwo(e.width)&&lc.isPowerOfTwo(e.height)}function l(e,t){return e.generateMipmaps&&t&&e.minFilter!==Xo&&e.minFilter!==Ko}function h(t,r,i,a){e.generateMipmap(t),n.get(r).__maxMipLevel=Ra(Ca(i,a))*Math.LOG2E}function p(e,r){if(!i.isWebGL2)return e;var n=e;return 6403===e&&(5126===r&&(n=33326),5131===r&&(n=33325),5121===r&&(n=33321)),6407===e&&(5126===r&&(n=34837),5131===r&&(n=34843),5121===r&&(n=32849)),6408===e&&(5126===r&&(n=34836),5131===r&&(n=34842),5121===r&&(n=32856)),33325===n||33326===n||34842===n||34836===n?t.get("EXT_color_buffer_float"):(34843==n||34837==n)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),n}function d(e){return e===Xo||e===Yo||e===qo?9728:9729}function f(e){var t=e.target;t.removeEventListener("dispose",f),g(t),t.isVideoTexture&&delete N[t.id],o.memory.textures--}function m(e){var t=e.target;t.removeEventListener("dispose",m),v(t),o.memory.textures--}function g(t){var r=n.get(t);void 0===r.__webglInit||(e.deleteTexture(r.__webglTexture),n.remove(t))}function v(t){var r=n.get(t),i=n.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(var a=0;6>a;a++)e.deleteFramebuffer(r.__webglFramebuffer[a]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[a]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}}function y(e,t){var i=n.get(e);if(e.isVideoTexture&&function(e){var t=e.id,r=o.render.frame;N[t]!==r&&(N[t]=r,e.update())}(e),0<e.version&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void T(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(33984+t),r.bindTexture(3553,i.__webglTexture)}function b(t,o){var s=n.get(t);if(6===t.image.length)if(0<t.version&&s.__version!==t.version){_(s,t),r.activeTexture(33984+o),r.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,t.flipY);for(var d=t&&t.isCompressedTexture,f=t.image[0]&&t.image[0].isDataTexture,m=[],g=0;6>g;g++)m[g]=d||f?f?t.image[g].image:t.image[g]:c(t.image[g],!1,!0,i.maxCubemapSize);var v=m[0],y=u(v)||i.isWebGL2,b=a.convert(t.format),x=a.convert(t.type),T=p(b,x);w(34067,t,y);for(g=0;6>g;g++)if(d)for(var E,A=m[g].mipmaps,S=0,M=A.length;S<M;S++)E=A[S],t.format!==ds&&t.format!==ps?-1<r.getCompressedTextureFormats().indexOf(b)?r.compressedTexImage2D(34069+g,S,T,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+g,S,T,E.width,E.height,0,b,x,E.data);else f?r.texImage2D(34069+g,0,T,m[g].width,m[g].height,0,b,x,m[g].data):r.texImage2D(34069+g,0,T,b,x,m[g]);s.__maxMipLevel=d?A.length-1:0,l(t,y)&&h(34067,t,v.width,v.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(33984+o),r.bindTexture(34067,s.__webglTexture)}function x(e,t){r.activeTexture(33984+t),r.bindTexture(34067,n.get(e).__webglTexture)}function w(r,o,s){var c;if(s?(e.texParameteri(r,10242,a.convert(o.wrapS)),e.texParameteri(r,10243,a.convert(o.wrapT)),(32879===r||35866===r)&&e.texParameteri(r,32882,a.convert(o.wrapR)),e.texParameteri(r,10240,a.convert(o.magFilter)),e.texParameteri(r,10241,a.convert(o.minFilter))):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),(32879===r||35866===r)&&e.texParameteri(r,32882,33071),(o.wrapS!==Wo||o.wrapT!==Wo)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,10240,d(o.magFilter)),e.texParameteri(r,10241,d(o.minFilter)),o.minFilter!==Xo&&o.minFilter!==Ko&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),c=t.get("EXT_texture_filter_anisotropic")){if(o.type===as&&null===t.get("OES_texture_float_linear"))return;if(o.type===os&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(1<o.anisotropy||n.get(o).__currentAnisotropy)&&(e.texParameterf(r,c.TEXTURE_MAX_ANISOTROPY_EXT,Ia(o.anisotropy,i.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function _(t,r){void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",f),t.__webglTexture=e.createTexture(),o.memory.textures++)}function T(t,n,o){var s=3553;n.isDataTexture2DArray&&(s=35866),n.isDataTexture3D&&(s=32879),_(t,n),r.activeTexture(33984+o),r.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,n.flipY),e.pixelStorei(37441,n.premultiplyAlpha),e.pixelStorei(3317,n.unpackAlignment);var d=function(e){return!i.isWebGL2&&(e.wrapS!==Wo||e.wrapT!==Wo||e.minFilter!==Xo&&e.minFilter!==Ko)}(n)&&!1===u(n.image),f=c(n.image,d,!1,i.maxTextureSize),m=u(f)||i.isWebGL2,g=a.convert(n.format),v=a.convert(n.type),y=p(g,v);w(s,n,m);var b,x=n.mipmaps;if(n.isDepthTexture){if(y=6402,n.type===as){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");y=36012}else i.isWebGL2&&(y=33189);n.format===vs&&6402===y&&n.type!==rs&&n.type!==is&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=rs,v=a.convert(n.type)),n.format===ys&&(y=34041,n.type!==ls&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=ls,v=a.convert(n.type))),r.texImage2D(3553,0,y,f.width,f.height,0,g,v,null)}else if(n.isDataTexture)if(0<x.length&&m){for(var T=0,E=x.length;T<E;T++)b=x[T],r.texImage2D(3553,T,y,b.width,b.height,0,g,v,b.data);n.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else r.texImage2D(3553,0,y,f.width,f.height,0,g,v,f.data),t.__maxMipLevel=0;else if(n.isCompressedTexture){for(T=0,E=x.length;T<E;T++)b=x[T],n.format!==ds&&n.format!==ps?-1<r.getCompressedTextureFormats().indexOf(g)?r.compressedTexImage2D(3553,T,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,T,y,b.width,b.height,0,g,v,b.data);t.__maxMipLevel=x.length-1}else if(n.isDataTexture2DArray)r.texImage3D(35866,0,y,f.width,f.height,f.depth,0,g,v,f.data),t.__maxMipLevel=0;else if(n.isDataTexture3D)r.texImage3D(32879,0,y,f.width,f.height,f.depth,0,g,v,f.data),t.__maxMipLevel=0;else if(0<x.length&&m){for(T=0,E=x.length;T<E;T++)b=x[T],r.texImage2D(3553,T,y,g,v,b);n.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else r.texImage2D(3553,0,y,g,v,f),t.__maxMipLevel=0;l(n,m)&&h(3553,n,f.width,f.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function E(t,i,o,s){var c=a.convert(i.texture.format),u=a.convert(i.texture.type),l=p(c,u);r.texImage2D(s,0,l,i.width,i.height,0,c,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,n.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function A(t,r,n){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){if(n){var i=M(r);e.renderbufferStorageMultisample(36161,i,33189,r.width,r.height)}else e.renderbufferStorage(36161,33189,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){if(n){i=M(r);e.renderbufferStorageMultisample(36161,i,35056,r.width,r.height)}else e.renderbufferStorage(36161,34041,r.width,r.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var o=p(a.convert(r.texture.format),a.convert(r.texture.type));if(n){i=M(r);e.renderbufferStorageMultisample(36161,i,o,r.width,r.height)}else e.renderbufferStorage(36161,o,r.width,r.height)}e.bindRenderbuffer(36161,null)}function S(t){var r=n.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),y(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===vs)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(r.depthTexture.format!==ys)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(var a=0;6>a;a++)e.bindFramebuffer(36160,r.__webglFramebuffer[a]),r.__webglDepthbuffer[a]=e.createRenderbuffer(),A(r.__webglDepthbuffer[a],t)}else e.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),A(r.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function M(e){return i.isWebGL2&&e.isWebGLMultisampleRenderTarget?Ia(i.maxSamples,e.samples):0}var L,N={},R="undefined"!=typeof OffscreenCanvas,C=0,I=!1,O=!1;this.allocateTextureUnit=function(){var e=C;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=y,this.setTexture2DArray=function(e,t){var i=n.get(e);return 0<e.version&&i.__version!==e.version?void T(i,e,t):(r.activeTexture(33984+t),void r.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=n.get(e);return 0<e.version&&i.__version!==e.version?void T(i,e,t):(r.activeTexture(33984+t),void r.bindTexture(32879,i.__webglTexture))},this.setTextureCube=b,this.setTextureCubeDynamic=x,this.setupRenderTarget=function(t){var s=n.get(t),c=n.get(t.texture);t.addEventListener("dispose",m),c.__webglTexture=e.createTexture(),o.memory.textures++;var d=!0===t.isWebGLRenderTargetCube,f=!0===t.isWebGLMultisampleRenderTarget,g=u(t)||i.isWebGL2;if(d){s.__webglFramebuffer=[];for(var v=0;6>v;v++)s.__webglFramebuffer[v]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),f)if(i.isWebGL2){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var y=p(a.convert(t.texture.format),a.convert(t.texture.type)),b=M(t);e.renderbufferStorageMultisample(36161,b,y,t.width,t.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),A(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(d){r.bindTexture(34067,c.__webglTexture),w(34067,t.texture,g);for(v=0;6>v;v++)E(s.__webglFramebuffer[v],t,36064,34069+v);l(t.texture,g)&&h(34067,t.texture,t.width,t.height),r.bindTexture(34067,null)}else r.bindTexture(3553,c.__webglTexture),w(3553,t.texture,g),E(s.__webglFramebuffer,t,36064,3553),l(t.texture,g)&&h(3553,t.texture,t.width,t.height),r.bindTexture(3553,null);t.depthBuffer&&S(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(l(t,u(e)||i.isWebGL2)){var a=e.isWebGLRenderTargetCube?34067:3553,o=n.get(t).__webglTexture;r.bindTexture(a,o),h(a,t,e.width,e.height),r.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(i.isWebGL2){var r=n.get(t);e.bindFramebuffer(36008,r.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,r.__webglFramebuffer);var a=t.width,o=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===I&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),I=!0),e=e.texture),y(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===O&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),O=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?b(e,t):x(e,t)}}function Rt(e,t,r){return{convert:function(e){var n;if(e===Ho)return 10497;if(e===Wo)return 33071;if(e===Jo)return 33648;if(e===Xo)return 9728;if(e===Yo)return 9984;if(e===qo)return 9986;if(e===Ko)return 9729;if(e===Zo)return 9985;if(e===Qo)return 9987;if(e===$o)return 5121;if(e===ss)return 32819;if(e===cs)return 32820;if(e===us)return 33635;if(e===es)return 5120;if(e===ts)return 5122;if(e===rs)return 5123;if(e===ns)return 5124;if(e===is)return 5125;if(e===as)return 5126;if(e===os){if(r.isWebGL2)return 5131;if(null!==(n=t.get("OES_texture_half_float")))return n.HALF_FLOAT_OES}if(e===hs)return 6406;if(e===ps)return 6407;if(e===ds)return 6408;if(e===fs)return 6409;if(e===ms)return 6410;if(e===vs)return 6402;if(e===ys)return 34041;if(e===bs)return 6403;if(e===no)return 32774;if(e===io)return 32778;if(e===ao)return 32779;if(e===co)return 0;if(e===uo)return 1;if(e===lo)return 768;if(e===ho)return 769;if(e===po)return 770;if(e===fo)return 771;if(e===mo)return 772;if(e===go)return 773;if(e===vo)return 774;if(e===yo)return 775;if(e===bo)return 776;if((e===xs||e===ws||e===_s||e===Ts)&&null!==(n=t.get("WEBGL_compressed_texture_s3tc"))){if(e===xs)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ws)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===_s)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ts)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===Es||e===As||e===Ss||e===Ms)&&null!==(n=t.get("WEBGL_compressed_texture_pvrtc"))){if(e===Es)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===As)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ss)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Ms)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===Ls&&null!==(n=t.get("WEBGL_compressed_texture_etc1")))return n.COMPRESSED_RGB_ETC1_WEBGL;if((e===Ns||e===Rs||e===Cs||e===Is||e===Os||e===Ps||e===Fs||e===ks||e===Ds||e===Us||e===Bs||e===zs||e===Gs||e===js)&&null!==(n=t.get("WEBGL_compressed_texture_astc")))return e;if(e===oo||e===so){if(r.isWebGL2){if(e===oo)return 32775;if(e===so)return 32776}if(null!==(n=t.get("EXT_blend_minmax"))){if(e===oo)return n.MIN_EXT;if(e===so)return n.MAX_EXT}}if(e===ls){if(r.isWebGL2)return 34042;if(null!==(n=t.get("WEBGL_depth_texture")))return n.UNSIGNED_INT_24_8_WEBGL}return 0}}}function Ct(){m.call(this),this.type="Group"}function It(e){q.call(this),this.cameras=e||[]}function Ot(e,t,r){Vc.setFromMatrixPosition(t.matrixWorld),Hc.setFromMatrixPosition(r.matrixWorld);var n=Vc.distanceTo(Hc),i=t.projectionMatrix.elements,a=r.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],u=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(a[8]+1)/a[0],p=n/(-l+h),d=p*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(d),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var f=o+p,m=s+p;e.projectionMatrix.makePerspective(o*l-d,o*h+(n-d),c*s/m*f,u*s/m*f,f,m)}function Pt(e){function t(){return null!==f&&!0===f.isPresenting}function r(){if(t()){var r=f.getEyeParameters("left");l=2*r.renderWidth*x,h=r.renderHeight*x,L=e.getPixelRatio(),e.getSize(N),e.setDrawingBufferSize(l,h,1),A.viewport.set(0,0,l/2,h),S.viewport.set(l/2,0,l/2,h),C.start(),d.dispatchEvent({type:"sessionstart"})}else d.enabled&&e.setDrawingBufferSize(N.width,N.height,L),C.stop(),d.dispatchEvent({type:"sessionend"})}function n(e){for(var t,r=navigator.getGamepads&&navigator.getGamepads(),n=0,i=0,a=r.length;n<a;n++)if((t=r[n])&&("Daydream Controller"===t.id||"Gear VR Controller"===t.id||"Oculus Go Controller"===t.id||"OpenVR Gamepad"===t.id||t.id.startsWith("Oculus Touch")||t.id.startsWith("HTC Vive Focus")||t.id.startsWith("Spatial Controller"))){if(i===e)return t;i++}}function s(){for(var e=0;e<v.length;e++){var t=v[e],r=n(e);if(void 0!==r&&void 0!==r.pose){if(null===r.pose)return;var i=r.pose;!1===i.hasPosition&&t.position.set(.2,-.6,-.05),null!==i.position&&t.position.fromArray(i.position),null!==i.orientation&&t.quaternion.fromArray(i.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(y),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var a="Daydream Controller"===r.id?0:1;void 0===R[e]&&(R[e]=!1),R[e]!==r.buttons[a].pressed&&(R[e]=r.buttons[a].pressed,!0===R[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}function c(e,t){null!==t&&4===t.length&&e.set(t[0]*l,t[1]*h,t[2]*l,t[3]*h)}var l,h,d=this,f=null,m=null,g=null,v=[],y=new p,b=new p,x=1,w="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(m=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",r,!1));var _=new p,T=new a,E=new o,A=new q;A.viewport=new u,A.layers.enable(1);var S=new q;S.viewport=new u,S.layers.enable(2);var M=new It([A,S]);M.layers.enable(1),M.layers.enable(2);var L,N=new i,R=[];this.enabled=!1,this.getController=function(e){var t=v[e];return void 0===t&&((t=new Ct).matrixAutoUpdate=!1,t.visible=!1,v[e]=t),t},this.getDevice=function(){return f},this.setDevice=function(e){void 0!==e&&(f=e),C.setContext(e)},this.setFramebufferScaleFactor=function(e){x=e},this.setReferenceSpaceType=function(e){w=e},this.setPoseTarget=function(e){void 0!==e&&(g=e)},this.getCamera=function(e){var r="local-floor"===w?1.6:0;if(!1===t())return e.position.set(0,r,0),e.rotation.set(0,0,0),e;if(f.depthNear=e.near,f.depthFar=e.far,f.getFrameData(m),"local-floor"===w){var n=f.stageParameters;n?y.fromArray(n.sittingToStandingTransform):y.makeTranslation(0,r,0)}var i=m.pose,a=null===g?e:g;a.matrix.copy(y),a.matrix.decompose(a.position,a.quaternion,a.scale),null!==i.orientation&&(T.fromArray(i.orientation),a.quaternion.multiply(T)),null!==i.position&&(T.setFromRotationMatrix(y),E.fromArray(i.position),E.applyQuaternion(T),a.position.add(E)),a.updateMatrixWorld(),A.near=e.near,S.near=e.near,A.far=e.far,S.far=e.far,A.matrixWorldInverse.fromArray(m.leftViewMatrix),S.matrixWorldInverse.fromArray(m.rightViewMatrix),b.getInverse(y),"local-floor"===w&&(A.matrixWorldInverse.multiply(b),S.matrixWorldInverse.multiply(b));var o=a.parent;null!==o&&(_.getInverse(o.matrixWorld),A.matrixWorldInverse.multiply(_),S.matrixWorldInverse.multiply(_)),A.matrixWorld.getInverse(A.matrixWorldInverse),S.matrixWorld.getInverse(S.matrixWorldInverse),A.projectionMatrix.fromArray(m.leftProjectionMatrix),S.projectionMatrix.fromArray(m.rightProjectionMatrix),Ot(M,A,S);var u=f.getLayers();if(u.length){var l=u[0];c(A.viewport,l.leftBounds),c(S.viewport,l.rightBounds)}return s(),M},this.getStandingMatrix=function(){return y},this.isPresenting=t;var C=new te;this.setAnimationLoop=function(e){C.setAnimationLoop(e),t()&&C.start()},this.submitFrame=function(){t()&&f.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",r)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function Ft(e,t){function r(){return null!==c&&null!==l}function n(e){for(var t=0;t<f.length;t++)m[t]===e.inputSource&&f[t].dispatchEvent({type:e.type})}function i(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),x.stop(),s.dispatchEvent({type:"sessionend"})}function a(e){l=e,x.setContext(c),x.start(),s.dispatchEvent({type:"sessionstart"})}function o(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}var s=this,c=null,l=null,h="local-floor",d=null,f=[],m=[],g=new q;g.layers.enable(1),g.viewport=new u;var v=new q;v.layers.enable(2),v.viewport=new u;var y=new It([g,v]);y.layers.enable(1),y.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=f[e];return void 0===t&&((t=new Ct).matrixAutoUpdate=!1,t.visible=!1,f[e]=t),t},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(e){h=e},this.getSession=function(){return c},this.setSession=function(e){null!==(c=e)&&(c.addEventListener("select",n),c.addEventListener("selectstart",n),c.addEventListener("selectend",n),c.addEventListener("end",i),c.updateRenderState({baseLayer:new XRWebGLLayer(c,t)}),c.requestReferenceSpace(h).then(a),m=c.inputSources,c.addEventListener("inputsourceschange",function(){m=c.inputSources,console.log(m);for(var e=0;e<f.length;e++)f[e].userData.inputSource=m[e]}))},this.getCamera=function(e){if(r()){var t=e.parent,n=y.cameras;o(y,t);for(var i=0;i<n.length;i++)o(n[i],t);e.matrixWorld.copy(y.matrixWorld);for(var a=e.children,s=(i=0,a.length);i<s;i++)a[i].updateMatrixWorld(!0);return Ot(y,g,v),y}return e},this.isPresenting=r;var b=null,x=new te;x.setAnimationLoop(function(t,r){if(null!==(d=r.getViewerPose(l))){var n=d.views,i=c.renderState.baseLayer;e.setFramebuffer(i.framebuffer);for(var a=0;a<n.length;a++){var o=n[a],s=i.getViewport(o),u=o.transform.inverse.matrix,h=y.cameras[a];h.matrix.fromArray(u).getInverse(h.matrix),h.projectionMatrix.fromArray(o.projectionMatrix),h.viewport.set(s.x,s.y,s.width,s.height),0===a&&y.matrix.copy(h.matrix)}}for(a=0;a<f.length;a++){var p=f[a],g=m[a];if(g){var v=r.getPose(g.targetRaySpace,l);if(null!==v){p.matrix.fromArray(v.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.visible=!0;continue}}p.visible=!1}b&&b(t)}),this.setAnimationLoop=function(e){b=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new p},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function kt(e){function t(){return null===de?Se:1}function r(){I=new ue(C),(O=new se(C,I,e)).isWebGL2||(I.get("WEBGL_depth_texture"),I.get("OES_texture_float"),I.get("OES_texture_half_float"),I.get("OES_texture_half_float_linear"),I.get("OES_standard_derivatives"),I.get("OES_element_index_uint"),I.get("ANGLE_instanced_arrays")),I.get("OES_texture_float_linear"),q=new Rt(C,I,O),(P=new Lt(C,I,q,O)).scissor(_e.copy(Le).multiplyScalar(Se).floor()),P.viewport(we.copy(Me).multiplyScalar(Se).floor()),F=new pe(C),k=new gt,D=new Nt(C,I,P,k,O,q,F),U=new re(C),B=new le(C,U,F),z=new me(B,F),J=new fe(C),G=new mt(K,I,O),j=new xt,V=new Et,H=new ae(K,P,z,A),X=new oe(C,I,F,O),Y=new he(C,I,F,O),F.programs=G.programs,K.capabilities=O,K.extensions=I,K.properties=k,K.renderLists=j,K.state=P,K.info=F}function n(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Z=!0}function a(){console.log("THREE.WebGLRenderer: Context Restored."),Z=!1,r()}function s(e){var t=e.target;t.removeEventListener("dispose",s),function(e){c(e),k.remove(e)}(t)}function c(e){var t=k.get(e).program;e.program=void 0,void 0!==t&&G.releaseProgram(t)}function l(e,t,r,n){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)R.pushLight(e),e.castShadow&&R.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||Re.intersectsSprite(e)){n&&Fe.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Pe);var i=z.update(e);(a=e.material).visible&&N.push(e,i,a,r,Fe.z,null)}}else if(e.isImmediateRenderObject)n&&Fe.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Pe),N.push(e,null,e.material,r,Fe.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||Re.intersectsObject(e))){n&&Fe.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Pe);i=z.update(e);var a=e.material;if(Array.isArray(a))for(var o=i.groups,s=0,c=o.length;s<c;s++){var u=o[s],h=a[u.materialIndex];h&&h.visible&&N.push(e,i,h,r,Fe.z,u)}else a.visible&&N.push(e,i,a,r,Fe.z,null)}var p=e.children;for(s=0,c=p.length;s<c;s++)l(p[s],t,r,n)}}function h(e,t,r,n){for(var i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,c=o.geometry,u=void 0===n?o.material:n,l=o.group;if(r.isArrayCamera){xe=r;for(var h,p=r.cameras,f=0,m=p.length;f<m;f++)h=p[f],s.layers.test(h.layers)&&(P.viewport(we.copy(h.viewport)),R.setupLights(h),d(s,t,h,c,u,l))}else xe=null,d(s,t,r,c,u,l)}}function d(e,t,r,n,i,a){if(e.onBeforeRender(K,t,r,n,i,a),R=V.get(t,xe||r),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){P.setMaterial(i);var o=m(r,t.fog,i,e);ye.geometry=null,ye.program=null,ye.wireframe=!1,function(e,t){e.render(function(e){K.renderBufferImmediate(e,t)})}(e,o)}else K.renderBufferDirect(r,t.fog,n,i,e,a);e.onAfterRender(K,t,r,n,i,a),R=V.get(t,xe||r)}function f(e,t,r){var n=k.get(e),i=R.state.lights,a=R.state.shadowsArray,o=i.state.version,u=G.getParameters(e,i.state,a,t,Ce.numPlanes,Ce.numIntersection,r),l=G.getProgramCode(e,u),h=n.program,p=!0;if(void 0===h)e.addEventListener("dispose",s);else if(h.code!==l)c(e);else if(n.lightsStateVersion!==o)n.lightsStateVersion=o,p=!1;else{if(void 0!==u.shaderID)return;p=!1}if(p){if(u.shaderID){var d=Nc[u.shaderID];n.shader={name:e.type,uniforms:W(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader,K),l=G.getProgramCode(e,u),h=G.acquireProgram(e,n.shader,u,l),n.program=h,e.program=h}var f=h.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var m=0;m<K.maxMorphTargets;m++)0<=f["morphTarget"+m]&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(m=0;m<K.maxMorphNormals;m++)0<=f["morphNormal"+m]&&e.numSupportedMorphNormals++}var g=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=Ce.numPlanes,n.numIntersection=Ce.numIntersection,g.clippingPlanes=Ce.uniform),n.fog=t,n.lightsStateVersion=o,e.lights&&(g.ambientLightColor.value=i.state.ambient,g.lightProbe.value=i.state.probe,g.directionalLights.value=i.state.directional,g.spotLights.value=i.state.spot,g.rectAreaLights.value=i.state.rectArea,g.pointLights.value=i.state.point,g.hemisphereLights.value=i.state.hemi,g.directionalShadowMap.value=i.state.directionalShadowMap,g.directionalShadowMatrix.value=i.state.directionalShadowMatrix,g.spotShadowMap.value=i.state.spotShadowMap,g.spotShadowMatrix.value=i.state.spotShadowMatrix,g.pointShadowMap.value=i.state.pointShadowMap,g.pointShadowMatrix.value=i.state.pointShadowMatrix);var v=n.program.getUniforms(),y=rt.seqWithValue(v.seq,g);n.uniformsList=y}function m(e,t,r,n){D.resetTextureUnits();var i=k.get(r),a=R.state.lights;if(Ie&&(Oe||e!==be)){var o=e===be&&r.id===ve;Ce.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,o)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==t?r.needsUpdate=!0:r.lights&&i.lightsStateVersion!==a.state.version?r.needsUpdate=!0:void 0!==i.numClippingPlanes&&(i.numClippingPlanes!==Ce.numPlanes||i.numIntersection!==Ce.numIntersection)&&(r.needsUpdate=!0)),r.needsUpdate&&(f(r,t,n),r.needsUpdate=!1);var s=!1,c=!1,u=!1,l=i.program,h=l.getUniforms(),p=i.shader.uniforms;if(P.useProgram(l.program)&&(s=!0,c=!0,u=!0),r.id!==ve&&(ve=r.id,c=!0),s||be!==e){if(h.setValue(C,"projectionMatrix",e.projectionMatrix),O.logarithmicDepthBuffer&&h.setValue(C,"logDepthBufFC",2/(Ra(e.far+1)/Na)),be!==e&&(be=e,c=!0,u=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var d=h.map.cameraPosition;void 0!==d&&d.setValue(C,Fe.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&h.setValue(C,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){h.setOptional(C,n,"bindMatrix"),h.setOptional(C,n,"bindMatrixInverse");var m=n.skeleton;if(m){var b=m.bones;if(O.floatVertexTextures){if(void 0===m.boneTexture){var x=Aa(4*b.length);x=lc.ceilPowerOfTwo(x),x=Ca(x,4);var w=new Float32Array(x*x*4);w.set(m.boneMatrices);var _=new Q(w,x,x,ds,as);_.needsUpdate=!0,m.boneMatrices=w,m.boneTexture=_,m.boneTextureSize=x}h.setValue(C,"boneTexture",m.boneTexture,D),h.setValue(C,"boneTextureSize",m.boneTextureSize)}else h.setOptional(C,m,"boneMatrices")}}return c&&(h.setValue(C,"toneMappingExposure",K.toneMappingExposure),h.setValue(C,"toneMappingWhitePoint",K.toneMappingWhitePoint),r.lights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(p,u),t&&r.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(p,t),r.isMeshBasicMaterial?g(p,r):r.isMeshLambertMaterial?(g(p,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(p,r)):r.isMeshPhongMaterial?(g(p,r),r.isMeshToonMaterial?function(e,t){v(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(p,r):v(p,r)):r.isMeshStandardMaterial?(g(p,r),r.isMeshPhysicalMaterial?function(e,t){y(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(p,r):y(p,r)):r.isMeshMatcapMaterial?(g(p,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ja&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ja&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,r)):r.isMeshDepthMaterial?(g(p,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,r)):r.isMeshDistanceMaterial?(g(p,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(p,r)):r.isMeshNormalMaterial?(g(p,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ja&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ja&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(p,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(p,r)):r.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*Se,e.scale.value=.5*Ae,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(p,r):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(p,r):r.isShadowMaterial&&(p.color.value.copy(r.color),p.opacity.value=r.opacity),void 0!==p.ltc_1&&(p.ltc_1.value=Lc.LTC_1),void 0!==p.ltc_2&&(p.ltc_2.value=Lc.LTC_2),rt.upload(C,i.uniformsList,p,D)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(rt.upload(C,i.uniformsList,p,D),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&h.setValue(C,"center",n.center),h.setValue(C,"modelViewMatrix",n.modelViewMatrix),h.setValue(C,"normalMatrix",n.normalMatrix),h.setValue(C,"modelMatrix",n.matrixWorld),l}function g(e,t){var r;e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=k.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}function v(e,t){e.specular.value.copy(t.specular),e.shininess.value=Ca(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ja&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ja&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function y(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ja&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ja&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}console.log("THREE.WebGLRenderer",Ba);var b=void 0===(e=e||{}).canvas?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):e.canvas,x=void 0===e.context?null:e.context,w=void 0!==e.alpha&&e.alpha,_=!(void 0!==e.depth)||e.depth,T=!(void 0!==e.stencil)||e.stencil,E=void 0!==e.antialias&&e.antialias,A=!(void 0!==e.premultipliedAlpha)||e.premultipliedAlpha,S=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,M=void 0===e.powerPreference?"default":e.powerPreference,L=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,N=null,R=null;this.domElement=b,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Io,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var C,I,O,P,F,k,D,U,B,z,G,j,V,H,J,X,Y,q,K=this,Z=!1,$=null,ne=0,ie=0,de=null,ge=null,ve=-1,ye={geometry:null,program:null,wireframe:!1},be=null,xe=null,we=new u,_e=new u,Te=null,Ee=b.width,Ae=b.height,Se=1,Me=new u(0,0,Ee,Ae),Le=new u(0,0,Ee,Ae),Ne=!1,Re=new ee,Ce=new ce,Ie=!1,Oe=!1,Pe=new p,Fe=new o;try{var ke={alpha:w,depth:_,stencil:T,antialias:E,premultipliedAlpha:A,preserveDrawingBuffer:S,powerPreference:M,failIfMajorPerformanceCaveat:L,xrCompatible:!0};if(b.addEventListener("webglcontextlost",n,!1),b.addEventListener("webglcontextrestored",a,!1),null===(C=x||b.getContext("webgl",ke)||b.getContext("experimental-webgl",ke)))throw null!==b.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===C.getShaderPrecisionFormat&&(C.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}r();var De="undefined"!=typeof navigator&&"xr"in navigator&&"supportsSession"in navigator.xr?new Ft(K,C):new Pt(K);this.vr=De;var Ue=new Mt(K,z,O.maxTextureSize);this.shadowMap=Ue,this.getContext=function(){return C},this.getContextAttributes=function(){return C.getContextAttributes()},this.forceContextLoss=function(){var e=I.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=I.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Se},this.setPixelRatio=function(e){void 0===e||(Se=e,this.setSize(Ee,Ae,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new i),e.set(Ee,Ae)},this.setSize=function(e,t,r){return De.isPresenting()?void console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ee=e,Ae=t,b.width=Fa(e*Se),b.height=Fa(t*Se),!1!==r&&(b.style.width=e+"px",b.style.height=t+"px"),void this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new i),e.set(Ee*Se,Ae*Se).floor()},this.setDrawingBufferSize=function(e,t,r){Ee=e,Ae=t,Se=r,b.width=Fa(e*r),b.height=Fa(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new u),e.copy(we)},this.getViewport=function(e){return e.copy(Me)},this.setViewport=function(e,t,r,n){e.isVector4?Me.set(e.x,e.y,e.z,e.w):Me.set(e,t,r,n),P.viewport(we.copy(Me).multiplyScalar(Se).floor())},this.getScissor=function(e){return e.copy(Le)},this.setScissor=function(e,t,r,n){e.isVector4?Le.set(e.x,e.y,e.z,e.w):Le.set(e,t,r,n),P.scissor(_e.copy(Le).multiplyScalar(Se).floor())},this.getScissorTest=function(){return Ne},this.setScissorTest=function(e){P.setScissorTest(Ne=e)},this.getClearColor=function(){return H.getClearColor()},this.setClearColor=function(){H.setClearColor.apply(H,arguments)},this.getClearAlpha=function(){return H.getClearAlpha()},this.setClearAlpha=function(){H.setClearAlpha.apply(H,arguments)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=16384),(void 0===t||t)&&(n|=256),(void 0===r||r)&&(n|=1024),C.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){b.removeEventListener("webglcontextlost",n,!1),b.removeEventListener("webglcontextrestored",a,!1),j.dispose(),V.dispose(),k.dispose(),z.dispose(),De.dispose(),ze.stop()},this.renderBufferImmediate=function(e,t){P.initAttributes();var r=k.get(e);e.hasPositions&&!r.position&&(r.position=C.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=C.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=C.createBuffer()),e.hasColors&&!r.color&&(r.color=C.createBuffer());var n=t.getAttributes();e.hasPositions&&(C.bindBuffer(34962,r.position),C.bufferData(34962,e.positionArray,35048),P.enableAttribute(n.position),C.vertexAttribPointer(n.position,3,5126,!1,0,0)),e.hasNormals&&(C.bindBuffer(34962,r.normal),C.bufferData(34962,e.normalArray,35048),P.enableAttribute(n.normal),C.vertexAttribPointer(n.normal,3,5126,!1,0,0)),e.hasUvs&&(C.bindBuffer(34962,r.uv),C.bufferData(34962,e.uvArray,35048),P.enableAttribute(n.uv),C.vertexAttribPointer(n.uv,2,5126,!1,0,0)),e.hasColors&&(C.bindBuffer(34962,r.color),C.bufferData(34962,e.colorArray,35048),P.enableAttribute(n.color),C.vertexAttribPointer(n.color,3,5126,!1,0,0)),P.disableUnusedAttributes(),C.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,r,n,i,a,o){var s=a.isMesh&&0>a.matrixWorld.determinant();P.setMaterial(i,s);var c=m(e,r,i,a),u=!1;(ye.geometry!==n.id||ye.program!==c.id||ye.wireframe!==(!0===i.wireframe))&&(ye.geometry=n.id,ye.program=c.id,ye.wireframe=!0===i.wireframe,u=!0),a.morphTargetInfluences&&(J.update(a,n,i,c),u=!0);var l=n.index,h=n.attributes.position,p=1;!0===i.wireframe&&(l=B.getWireframeAttribute(n),p=2);var d,f=X;null!==l&&(d=U.get(l),(f=Y).setIndex(d)),u&&(function(e,t,r){if(r&&r.isInstancedBufferGeometry&&!O.isWebGL2&&null===I.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{P.initAttributes();var n=r.attributes,i=t.getAttributes(),a=e.defaultAttributeValues;for(var o in i){var s=i[o];if(0<=s){var c=n[o];if(void 0!==c){var u=c.normalized,l=c.itemSize,h=U.get(c);if(void 0===h)continue;var p=h.buffer,d=h.type,f=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data,g=m.stride,v=c.offset;m&&m.isInstancedInterleavedBuffer?(P.enableAttributeAndDivisor(s,m.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=m.meshPerAttribute*m.count)):P.enableAttribute(s),C.bindBuffer(34962,p),C.vertexAttribPointer(s,l,d,u,g*f,v*f)}else c.isInstancedBufferAttribute?(P.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=c.meshPerAttribute*c.count)):P.enableAttribute(s),C.bindBuffer(34962,p),C.vertexAttribPointer(s,l,d,u,0,0)}else if(void 0!==a){var y=a[o];if(void 0!==y)switch(y.length){case 2:C.vertexAttrib2fv(s,y);break;case 3:C.vertexAttrib3fv(s,y);break;case 4:C.vertexAttrib4fv(s,y);break;default:C.vertexAttrib1fv(s,y)}}}}P.disableUnusedAttributes()}}(i,c,n),null!==l&&C.bindBuffer(34963,d.buffer));var g=1/0;null===l?void 0!==h&&(g=h.count):g=l.count;var v=n.drawRange.start*p,y=n.drawRange.count*p,b=null===o?0:o.start*p,x=null===o?1/0:o.count*p,w=Ca(v,b),_=Ia(g,v+y,b+x)-1,T=Ca(0,_-w+1);if(0!==T){if(a.isMesh)if(!0===i.wireframe)P.setLineWidth(i.wireframeLinewidth*t()),f.setMode(1);else switch(a.drawMode){case Ys:f.setMode(4);break;case qs:f.setMode(5);break;case Ks:f.setMode(6)}else if(a.isLine){var E=i.linewidth;void 0===E&&(E=1),P.setLineWidth(E*t()),a.isLineSegments?f.setMode(1):a.isLineLoop?f.setMode(2):f.setMode(3)}else a.isPoints?f.setMode(0):a.isSprite&&f.setMode(4);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&f.renderInstances(n,w,T):f.render(w,T)}},this.compile=function(e,t){(R=V.get(e,t)).init(),e.traverse(function(e){e.isLight&&(R.pushLight(e),e.castShadow&&R.pushShadow(e))}),R.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)f(t.material[r],e.fog,t);else f(t.material,e.fog,t)})};var Be=null,ze=new te;ze.setAnimationLoop(function(e){De.isPresenting()||Be&&Be(e)}),"undefined"!=typeof window&&ze.setContext(window),this.setAnimationLoop=function(e){Be=e,De.setAnimationLoop(e),ze.start()},this.render=function(e,t){var r,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),t&&t.isCamera){if(!Z){ye.geometry=null,ye.program=null,ye.wireframe=!1,ve=-1,be=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),De.enabled&&(t=De.getCamera(t)),(R=V.get(e,t)).init(),e.onBeforeRender(K,e,t,r||de),Pe.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Re.setFromMatrix(Pe),Oe=this.localClippingEnabled,Ie=Ce.init(this.clippingPlanes,Oe,t),(N=j.get(e,t)).init(),l(e,t,0,K.sortObjects),!0===K.sortObjects&&N.sort(),Ie&&Ce.beginShadows();var i=R.state.shadowsArray;Ue.render(i,e,t),R.setupLights(t),Ie&&Ce.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),H.render(N,e,t,n);var a=N.opaque,o=N.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&h(a,e,t,s),o.length&&h(o,e,t,s)}else a.length&&h(a,e,t),o.length&&h(o,e,t);e.onAfterRender(K,e,t),null!==de&&(D.updateRenderTargetMipmap(de),D.updateMultisampleRenderTarget(de)),P.buffers.depth.setTest(!0),P.buffers.depth.setMask(!0),P.buffers.color.setMask(!0),P.setPolygonOffset(!1),De.enabled&&De.submitFrame(),N=null,R=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){$!==e&&C.bindFramebuffer(36160,e),$=e},this.getActiveCubeFace=function(){return ne},this.getActiveMipmapLevel=function(){return ie},this.getRenderTarget=function(){return de},this.setRenderTarget=function(e,t,r){de=e,ne=t,ie=r,e&&void 0===k.get(e).__webglFramebuffer&&D.setupRenderTarget(e);var n=$,i=!1;if(e){var a=k.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(n=a[t||0],i=!0):n=e.isWebGLMultisampleRenderTarget?k.get(e).__webglMultisampledFramebuffer:a,we.copy(e.viewport),_e.copy(e.scissor),Te=e.scissorTest}else we.copy(Me).multiplyScalar(Se).floor(),_e.copy(Le).multiplyScalar(Se).floor(),Te=Ne;if(ge!==n&&(C.bindFramebuffer(36160,n),ge=n),P.viewport(we),P.scissor(_e),P.setScissorTest(Te),i){var o=k.get(e.texture);C.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,r||0)}},this.readRenderTargetPixels=function(e,t,r,n,i,a,o){if(e&&e.isWebGLRenderTarget){var s=k.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube&&void 0!==o&&(s=s[o]),s){var c=!1;s!==ge&&(C.bindFramebuffer(36160,s),c=!0);try{var u=e.texture,l=u.format,h=u.type;if(l!==ds&&q.convert(l)!==C.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===$o||q.convert(h)===C.getParameter(35738)||h===as&&(O.isWebGL2||I.get("OES_texture_float")||I.get("WEBGL_color_buffer_float"))||h===os&&(O.isWebGL2?I.get("EXT_color_buffer_float"):I.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===C.checkFramebufferStatus(36160)?0<=t&&t<=e.width-n&&0<=r&&r<=e.height-i&&C.readPixels(t,r,n,i,q.convert(l),q.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&C.bindFramebuffer(36160,ge)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,r){var n=t.image.width,i=t.image.height,a=q.convert(t.format);D.setTexture2D(t,0),C.copyTexImage2D(3553,r||0,a,e.x,e.y,n,i,0)},this.copyTextureToTexture=function(e,t,r,n){var i=t.image.width,a=t.image.height,o=q.convert(r.format),s=q.convert(r.type);D.setTexture2D(r,0),t.isDataTexture?C.texSubImage2D(3553,n||0,e.x,e.y,i,a,o,s,t.image.data):C.texSubImage2D(3553,n||0,e.x,e.y,o,s,t.image)},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Dt(e,t){this.name="",this.color=new w(e),this.density=void 0===t?25e-5:t}function Ut(e,t,r){this.name="",this.color=new w(e),this.near=void 0===t?1:t,this.far=void 0===r?1e3:r}function Bt(e,t){this.array=e,this.stride=t,this.count=void 0===e?0:e.length/t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function zt(e,t,r,n){this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function Gt(e){S.call(this),this.type="SpriteMaterial",this.color=new w(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function jt(e){if(m.call(this),this.type="Sprite",void 0===jc){jc=new z;var t=new Bt(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);jc.setIndex([0,1,2,0,2,3]),jc.addAttribute("position",new zt(t,3,0,!1)),jc.addAttribute("uv",new zt(t,2,3,!1))}this.geometry=jc,this.material=void 0===e?new Gt:e,this.center=new i(.5,.5)}function Vt(){m.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Ht(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),G.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new p,this.bindMatrixInverse=new p}function Wt(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new p)}}function Jt(){m.call(this),this.type="Bone"}function Xt(e){S.call(this),this.type="LineBasicMaterial",this.color=new w(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Yt(e,t,r){1===r&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),m.call(this),this.type="Line",this.geometry=void 0===e?new z:e,this.material=void 0===t?new Xt({color:16777215*Math.random()}):t}function qt(e,t){Yt.call(this,e,t),this.type="LineSegments"}function Kt(e,t){Yt.call(this,e,t),this.type="LineLoop"}function Zt(e){S.call(this),this.type="PointsMaterial",this.color=new w(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Qt(e,t){m.call(this),this.type="Points",this.geometry=void 0===e?new z:e,this.material=void 0===t?new Zt({color:16777215*Math.random()}):t,this.updateMorphTargets()}function $t(e,t,r,n,i,a,o,s,u){c.call(this,e,t,r,n,i,a,o,s,u),this.format=void 0===o?ps:o,this.minFilter=void 0===a?Ko:a,this.magFilter=void 0===i?Ko:i,this.generateMipmaps=!1}function er(e,t,r,n,i,a,o,s,u,l,h,p){c.call(this,null,a,o,s,u,l,n,i,h,p),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function tr(e,t,r,n,i,a,o,s,u){c.call(this,e,t,r,n,i,a,o,s,u),this.needsUpdate=!0}function rr(e,t,r,n,i,a,o,s,u,l){if((l=void 0===l?vs:l)!==vs&&l!==ys)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&l===vs&&(r=rs),void 0===r&&l===ys&&(r=ls),c.call(this,null,n,i,a,o,s,l,r,u),this.image={width:e,height:t},this.magFilter=void 0===o?Xo:o,this.minFilter=void 0===s?Xo:s,this.flipY=!1,this.generateMipmaps=!1}function nr(e){z.call(this),this.type="WireframeGeometry";var t,r,n,i,a,s,c,u,l,h,p=[],d=[0,0],f={},m=["a","b","c"];if(e&&e.isGeometry){var g=e.faces;for(t=0,n=g.length;t<n;t++){var v=g[t];for(r=0;3>r;r++)c=v[m[r]],u=v[m[(r+1)%3]],d[0]=Ia(c,u),d[1]=Ca(c,u),void 0===f[l=d[0]+","+d[1]]&&(f[l]={index1:d[0],index2:d[1]})}for(l in f)s=f[l],h=e.vertices[s.index1],p.push(h.x,h.y,h.z),h=e.vertices[s.index2],p.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var y,b,x,w,_,T,E;if(h=new o,null!==e.index){for(y=e.attributes.position,b=e.index,0===(x=e.groups).length&&(x=[{start:0,count:b.count,materialIndex:0}]),i=0,a=x.length;i<a;++i)for(t=_=(w=x[i]).start,n=_+w.count;t<n;t+=3)for(r=0;3>r;r++)c=b.getX(t+r),u=b.getX(t+(r+1)%3),d[0]=Ia(c,u),d[1]=Ca(c,u),void 0===f[l=d[0]+","+d[1]]&&(f[l]={index1:d[0],index2:d[1]});for(l in f)s=f[l],h.fromBufferAttribute(y,s.index1),p.push(h.x,h.y,h.z),h.fromBufferAttribute(y,s.index2),p.push(h.x,h.y,h.z)}else for(t=0,n=(y=e.attributes.position).count/3;t<n;t++)for(r=0;3>r;r++)T=3*t+r,h.fromBufferAttribute(y,T),p.push(h.x,h.y,h.z),E=3*t+(r+1)%3,h.fromBufferAttribute(y,E),p.push(h.x,h.y,h.z)}this.addAttribute("position",new k(p,3))}function ir(e,t,r){j.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new ar(e,t,r)),this.mergeVertices()}function ar(e,t,r){z.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,a=[],s=[],c=[],u=[],l=1e-5,h=new o,p=new o,d=new o,f=new o,m=new o;3>e.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var g=t+1;for(n=0;n<=r;n++){var v=n/r;for(i=0;i<=t;i++){var y=i/t;e(y,v,p),s.push(p.x,p.y,p.z),0<=y-l?(e(y-l,v,d),f.subVectors(p,d)):(e(y+l,v,d),f.subVectors(d,p)),0<=v-l?(e(y,v-l,d),m.subVectors(p,d)):(e(y,v+l,d),m.subVectors(d,p)),h.crossVectors(f,m).normalize(),c.push(h.x,h.y,h.z),u.push(y,v)}}for(n=0;n<r;n++)for(i=0;i<t;i++){var b=n*g+i,x=n*g+i+1,w=(n+1)*g+i+1,_=(n+1)*g+i;a.push(b,x,_),a.push(x,w,_)}this.setIndex(a),this.addAttribute("position",new k(s,3)),this.addAttribute("normal",new k(c,3)),this.addAttribute("uv",new k(u,2))}function or(e,t,r,n){j.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new sr(e,t,r,n)),this.mergeVertices()}function sr(e,t,r,n){function a(e,t,r,n){var i,a,o=Ma(2,n),c=[];for(i=0;i<=o;i++){c[i]=[];var u=e.clone().lerp(r,i/o),l=t.clone().lerp(r,i/o),h=o-i;for(a=0;a<=h;a++)c[i][a]=0===a&&i===o?u:u.clone().lerp(l,a/h)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var p=Fa(a/2);0==a%2?(s(c[i][p+1]),s(c[i+1][p]),s(c[i][p])):(s(c[i][p+1]),s(c[i+1][p+1]),s(c[i+1][p]))}}function s(e){p.push(e.x,e.y,e.z)}function c(t,r){var n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function u(e,t,r,n){0>n&&1===e.x&&(d[t]=e.x-1),0===r.x&&0===r.z&&(d[t]=n/2/Oa+.5)}function l(e){return Ta(e.z,-e.x)}function h(e){return Ta(-e.y,Aa(e.x*e.x+e.z*e.z))}z.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1;var p=[],d=[];(function(e){for(var r=new o,n=new o,i=new o,s=0;s<t.length;s+=3)c(t[s+0],r),c(t[s+1],n),c(t[s+2],i),a(r,n,i,e)})(n=n||0),function(e){for(var t=new o,r=0;r<p.length;r+=3)t.x=p[r+0],t.y=p[r+1],t.z=p[r+2],t.normalize().multiplyScalar(e),p[r+0]=t.x,p[r+1]=t.y,p[r+2]=t.z}(r),function(){for(var e=new o,t=0;t<p.length;t+=3){e.x=p[t+0],e.y=p[t+1],e.z=p[t+2];var r=l(e)/2/Oa+.5,n=h(e)/Oa+.5;d.push(r,1-n)}(function(){for(var e=new o,t=new o,r=new o,n=new o,a=new i,s=new i,c=new i,h=0,f=0;h<p.length;h+=9,f+=6){e.set(p[h+0],p[h+1],p[h+2]),t.set(p[h+3],p[h+4],p[h+5]),r.set(p[h+6],p[h+7],p[h+8]),a.set(d[f+0],d[f+1]),s.set(d[f+2],d[f+3]),c.set(d[f+4],d[f+5]),n.copy(e).add(t).add(r).divideScalar(3);var m=l(n);u(a,f+0,e,m),u(s,f+2,t,m),u(c,f+4,r,m)}})(),function(){for(var e=0;e<d.length;e+=6){var t=d[e+0],r=d[e+2],n=d[e+4],i=Ca(t,r,n),a=Ia(t,r,n);.9<i&&.1>a&&(.2>t&&(d[e+0]+=1),.2>r&&(d[e+2]+=1),.2>n&&(d[e+4]+=1))}}()}(),this.addAttribute("position",new k(p,3)),this.addAttribute("normal",new k(p.slice(),3)),this.addAttribute("uv",new k(d,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function cr(e,t){j.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ur(e,t)),this.mergeVertices()}function ur(e,t){sr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function lr(e,t){j.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new hr(e,t)),this.mergeVertices()}function hr(e,t){sr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function pr(e,t){j.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new dr(e,t)),this.mergeVertices()}function dr(e,t){var r=1.618033988749895;sr.call(this,[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function fr(e,t){j.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new mr(e,t)),this.mergeVertices()}function mr(e,t){var r=1.618033988749895,n=1/r;sr.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function gr(e,t,r,n,i,a){j.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new vr(e,t,r,n,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function vr(e,t,r,n,a){function s(i){f=e.getPointAt(i/t,f);var a=c.normals[i],o=c.binormals[i];for(l=0;l<=n;l++){var s=l/n*Oa*2,u=wa(s),d=-_a(s);p.x=d*a.x+u*o.x,p.y=d*a.y+u*o.y,p.z=d*a.z+u*o.z,p.normalize(),g.push(p.x,p.y,p.z),h.x=f.x+r*p.x,h.y=f.y+r*p.y,h.z=f.z+r*p.z,m.push(h.x,h.y,h.z)}}z.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:a},t=t||64,r=r||1,n=n||8,a=a||!1;var c=e.computeFrenetFrames(t,a);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;var u,l,h=new o,p=new o,d=new i,f=new o,m=[],g=[],v=[],y=[];(function(){for(u=0;u<t;u++)s(u);s(!1===a?t:0),function(){for(u=0;u<=t;u++)for(l=0;l<=n;l++)d.x=u/t,d.y=l/n,v.push(d.x,d.y)}(),function(){for(l=1;l<=t;l++)for(u=1;u<=n;u++){var e=(n+1)*(l-1)+(u-1),r=(n+1)*l+(u-1),i=(n+1)*l+u,a=(n+1)*(l-1)+u;y.push(e,r,a),y.push(r,i,a)}}()})(),this.setIndex(y),this.addAttribute("position",new k(m,3)),this.addAttribute("normal",new k(g,3)),this.addAttribute("uv",new k(v,2))}function yr(e,t,r,n,i,a,o){j.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new br(e,t,r,n,i,a)),this.mergeVertices()}function br(e,t,r,n,i,a){function s(e,t,r,n,i){var a=_a(e),o=wa(e),s=r/t*e,c=_a(s);i.x=n*(2+c)*.5*a,i.y=n*(2+c)*o*.5,i.z=n*wa(s)*.5}z.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a},e=e||1,t=t||.4,r=Fa(r)||64,n=Fa(n)||8,i=i||2,a=a||3;var c,u,l=[],h=[],p=[],d=[],f=new o,m=new o,g=new o,v=new o,y=new o,b=new o,x=new o;for(c=0;c<=r;++c){var w=c/r*i*Oa*2;for(s(w,i,a,e,g),s(w+.01,i,a,e,v),b.subVectors(v,g),x.addVectors(v,g),y.crossVectors(b,x),x.crossVectors(y,b),y.normalize(),x.normalize(),u=0;u<=n;++u){var _=u/n*Oa*2,T=-t*_a(_),E=t*wa(_);f.x=g.x+(T*x.x+E*y.x),f.y=g.y+(T*x.y+E*y.y),f.z=g.z+(T*x.z+E*y.z),h.push(f.x,f.y,f.z),m.subVectors(f,g).normalize(),p.push(m.x,m.y,m.z),d.push(c/r),d.push(u/n)}}for(u=1;u<=r;u++)for(c=1;c<=n;c++){var A=(n+1)*(u-1)+(c-1),S=(n+1)*u+(c-1),M=(n+1)*u+c,L=(n+1)*(u-1)+c;l.push(A,S,L),l.push(S,M,L)}this.setIndex(l),this.addAttribute("position",new k(h,3)),this.addAttribute("normal",new k(p,3)),this.addAttribute("uv",new k(d,2))}function xr(e,t,r,n,i){j.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new wr(e,t,r,n,i)),this.mergeVertices()}function wr(e,t,r,n,i){z.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||1,t=t||.4,r=Fa(r)||8,n=Fa(n)||6,i=i||2*Oa;var a,s,c=[],u=[],l=[],h=[],p=new o,d=new o,f=new o;for(a=0;a<=r;a++)for(s=0;s<=n;s++){var m=s/n*i,g=a/r*Oa*2;d.x=(e+t*_a(g))*_a(m),d.y=(e+t*_a(g))*wa(m),d.z=t*wa(g),u.push(d.x,d.y,d.z),p.x=e*_a(m),p.y=e*wa(m),f.subVectors(d,p).normalize(),l.push(f.x,f.y,f.z),h.push(s/n),h.push(a/r)}for(a=1;a<=r;a++)for(s=1;s<=n;s++){var v=(n+1)*a+s-1,y=(n+1)*(a-1)+s-1,b=(n+1)*(a-1)+s,x=(n+1)*a+s;c.push(v,y,x),c.push(y,b,x)}this.setIndex(c),this.addAttribute("position",new k(u,3)),this.addAttribute("normal",new k(l,3)),this.addAttribute("uv",new k(h,2))}function _r(e,t,r,n,i){var a,o;if(i===0<function(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,r,n))for(a=t;a<r;a+=n)o=zr(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=zr(a,e[a],e[a+1],o);return o&&kr(o,o.next)&&(Gr(o),o=o.next),o}function Tr(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!kr(n,n.next)&&0!==Fr(n.prev,n,n.next))n=n.next;else{if(Gr(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function Er(e,t,r,n,i,a,o){if(e){!o&&a&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=Cr(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,s,c,u=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(c=u;0<s||0<c&&n;)0!==s&&(0===c||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(1<o)}(i)}(e,n,i,a);for(var s,c,u=e;e.prev!==e.next;)if(s=e.prev,c=e.next,a?Sr(e,n,i,a):Ar(e))t.push(s.i/r),t.push(e.i/r),t.push(c.i/r),Gr(e),e=c.next,u=c.next;else if((e=c)===u){o?1===o?Er(e=Mr(e,t,r),t,r,n,i,a,2):2==o&&Lr(e,t,r,n,i,a):Er(Tr(e),t,r,n,i,a,1);break}}}function Ar(e){var t=e.prev,r=e,n=e.next;if(0<=Fr(t,r,n))return!1;for(var i=e.next.next;i!==e.prev;){if(Or(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&0<=Fr(i.prev,i,i.next))return!1;i=i.next}return!0}function Sr(e,t,r,n){var i=e.prev,a=e,o=e.next;if(0<=Fr(i,a,o))return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,l=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=Cr(s,c,t,r,n),p=Cr(u,l,t,r,n),d=e.prevZ,f=e.nextZ;d&&d.z>=h&&f&&f.z<=p;){if(d!==e.prev&&d!==e.next&&Or(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&0<=Fr(d.prev,d,d.next))return!1;if(d=d.prevZ,f!==e.prev&&f!==e.next&&Or(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=Fr(f.prev,f,f.next))return!1;f=f.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&Or(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&0<=Fr(d.prev,d,d.next))return!1;d=d.prevZ}for(;f&&f.z<=p;){if(f!==e.prev&&f!==e.next&&Or(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=Fr(f.prev,f,f.next))return!1;f=f.nextZ}return!0}function Mr(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!kr(i,a)&&Dr(i,n,n.next,a)&&Ur(i,a)&&Ur(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),Gr(n),Gr(n.next),n=e=a),n=n.next}while(n!==e);return n}function Lr(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Pr(o,s)){var c=Br(o,s);return o=Tr(o,o.next),c=Tr(c,c.next),Er(o,t,r,n,i,a),void Er(c,t,r,n,i,a)}s=s.next}o=o.next}while(o!==e)}function Nr(e,t){return e.x-t.x}function Rr(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r.prev;var c,u=r,l=r.x,h=r.y,p=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&Or(a<h?i:o,a,l,h,a<h?o:i,a,n.x,n.y)&&((c=Ea(a-n.y)/(i-n.x))<p||c===p&&n.x>r.x)&&Ur(n,e)&&(r=n,p=c),n=n.next;return r}(e,t)){var r=Br(t,e);Tr(r,r.next)}}function Cr(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ir(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Or(e,t,r,n,i,a,o,s){return 0<=(i-o)*(t-s)-(e-o)*(a-s)&&0<=(e-o)*(n-s)-(r-o)*(t-s)&&0<=(r-o)*(a-s)-(i-o)*(n-s)}function Pr(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Dr(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&Ur(e,t)&&Ur(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function Fr(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function kr(e,t){return e.x===t.x&&e.y===t.y}function Dr(e,t,r,n){return!!(kr(e,r)&&kr(t,n)||kr(e,n)&&kr(r,t))||0<Fr(e,t,r)!=0<Fr(e,t,n)&&0<Fr(r,n,e)!=0<Fr(r,n,t)}function Ur(e,t){return 0>Fr(e.prev,e,e.next)?0<=Fr(e,t,e.next)&&0<=Fr(e,e.prev,t):0>Fr(e,t,e.prev)||0>Fr(e,e.next,t)}function Br(e,t){var r=new jr(e.i,e.x,e.y),n=new jr(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function zr(e,t,r,n){var i=new jr(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Gr(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function jr(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vr(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function Hr(e,t){for(var r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}function Wr(e,t){j.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Jr(e,t)),this.mergeVertices()}function Jr(e,t){function r(e){function r(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}function c(e,t,r){var n,a,o,s=e.x-t.x,c=e.y-t.y,u=r.x-e.x,l=r.y-e.y,h=s*s+c*c;if(Ea(s*l-c*u)>Da){var p=Aa(h),d=Aa(u*u+l*l),f=t.x-c/p,m=t.y+s/p,g=((r.x-l/d-f)*l-(r.y+u/d-m)*u)/(s*l-c*u),v=(n=f+s*g-e.x)*n+(a=m+c*g-e.y)*a;if(2>=v)return new i(n,a);o=Aa(v/2)}else{var y=!1;s>Da?u>Da&&(y=!0):s<-Da?u<-Da&&(y=!0):Pa(c)===Pa(l)&&(y=!0),y?(n=-c,a=s,o=Aa(h)):(n=s,a=c,o=Aa(h/2))}return new i(n/o,a/o)}function u(e,t){var r,n;for(q=e.length;0<=--q;){r=q,0>(n=q-1)&&(n=e.length-1);var i=0,a=v+2*T;for(i=0;i<a;i++){var o=J*i,s=J*(i+1);p(t+r+o,t+n+o,t+n+s,t+r+s)}}}function l(e,t,r){m.push(e),m.push(t),m.push(r)}function h(e,t,r){d(e),d(t),d(r);var i=a.length/3,o=A.generateTopUV(n,a,i-3,i-2,i-1);f(o[0]),f(o[1]),f(o[2])}function p(e,t,r,i){d(e),d(t),d(i),d(t),d(r),d(i);var o=a.length/3,s=A.generateSideWallUV(n,a,o-6,o-3,o-2,o-1);f(s[0]),f(s[1]),f(s[3]),f(s[1]),f(s[2]),f(s[3])}function d(e){a.push(m[3*e+0]),a.push(m[3*e+1]),a.push(m[3*e+2])}function f(e){s.push(e.x),s.push(e.y)}var m=[],g=void 0===t.curveSegments?12:t.curveSegments,v=void 0===t.steps?1:t.steps,y=void 0===t.depth?100:t.depth,b=!(void 0!==t.bevelEnabled)||t.bevelEnabled,x=void 0===t.bevelThickness?6:t.bevelThickness,w=void 0===t.bevelSize?x-2:t.bevelSize,_=void 0===t.bevelOffset?0:t.bevelOffset,T=void 0===t.bevelSegments?3:t.bevelSegments,E=t.extrudePath,A=void 0===t.UVGenerator?Xc:t.UVGenerator;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=t.amount);var S,M,L,N,R,C=!1;E&&(S=E.getSpacedPoints(v),C=!0,b=!1,M=E.computeFrenetFrames(v,!1),L=new o,N=new o,R=new o),b||(T=0,x=0,w=0,_=0);var I,O,P,F=e.extractPoints(g),k=F.shape,D=F.holes;if(!Jc.isClockWise(k))for(k=k.reverse(),O=0,P=D.length;O<P;O++)I=D[O],Jc.isClockWise(I)&&(D[O]=I.reverse());var U=Jc.triangulateShape(k,D),B=k;for(O=0,P=D.length;O<P;O++)I=D[O],k=k.concat(I);for(var z,G,j,V,H,W,J=k.length,X=U.length,Y=[],q=0,K=B.length,Z=K-1,Q=q+1;q<K;q++,Z++,Q++)Z===K&&(Z=0),Q===K&&(Q=0),Y[q]=c(B[q],B[Z],B[Q]);var $,ee,te=[],re=Y.concat();for(O=0,P=D.length;O<P;O++){for(I=D[O],$=[],q=0,Z=(K=I.length)-1,Q=q+1;q<K;q++,Z++,Q++)Z===K&&(Z=0),Q===K&&(Q=0),$[q]=c(I[q],I[Z],I[Q]);te.push($),re=re.concat($)}for(z=0;z<T;z++){for(V=x*_a((j=z/T)*Oa/2),G=w*wa(j*Oa/2)+_,q=0,K=B.length;q<K;q++)l((H=r(B[q],Y[q],G)).x,H.y,-V);for(O=0,P=D.length;O<P;O++)for(I=D[O],$=te[O],q=0,K=I.length;q<K;q++)l((H=r(I[q],$[q],G)).x,H.y,-V)}for(G=w+_,q=0;q<J;q++)H=b?r(k[q],re[q],G):k[q],C?(N.copy(M.normals[0]).multiplyScalar(H.x),L.copy(M.binormals[0]).multiplyScalar(H.y),R.copy(S[0]).add(N).add(L),l(R.x,R.y,R.z)):l(H.x,H.y,0);for(ee=1;ee<=v;ee++)for(q=0;q<J;q++)H=b?r(k[q],re[q],G):k[q],C?(N.copy(M.normals[ee]).multiplyScalar(H.x),L.copy(M.binormals[ee]).multiplyScalar(H.y),R.copy(S[ee]).add(N).add(L),l(R.x,R.y,R.z)):l(H.x,H.y,y/v*ee);for(z=T-1;0<=z;z--){for(V=x*_a((j=z/T)*Oa/2),G=w*wa(j*Oa/2)+_,q=0,K=B.length;q<K;q++)l((H=r(B[q],Y[q],G)).x,H.y,y+V);for(O=0,P=D.length;O<P;O++)for(I=D[O],$=te[O],q=0,K=I.length;q<K;q++)H=r(I[q],$[q],G),C?l(H.x,H.y+S[v-1].y,S[v-1].x+V):l(H.x,H.y,y+V)}(function(){var e=a.length/3;if(b){var t=0,r=J*t;for(q=0;q<X;q++)h((W=U[q])[2]+r,W[1]+r,W[0]+r);for(r=J*(t=v+2*T),q=0;q<X;q++)h((W=U[q])[0]+r,W[1]+r,W[2]+r)}else{for(q=0;q<X;q++)h((W=U[q])[2],W[1],W[0]);for(q=0;q<X;q++)h((W=U[q])[0]+J*v,W[1]+J*v,W[2]+J*v)}n.addGroup(e,a.length/3-e,0)})(),function(){var e=a.length/3,t=0;for(u(B,t),t+=B.length,O=0,P=D.length;O<P;O++)u(I=D[O],t),t+=I.length;n.addGroup(e,a.length/3-e,1)}()}z.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,a=[],s=[],c=0,u=e.length;c<u;c++)r(e[c]);this.addAttribute("position",new k(a,3)),this.addAttribute("uv",new k(s,2)),this.computeVertexNormals()}function Xr(e,t,r){if(r.shapes=[],Array.isArray(e))for(var n,i=0,a=e.length;i<a;i++)n=e[i],r.shapes.push(n.uuid);else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}function Yr(e,t){j.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new qr(e,t)),this.mergeVertices()}function qr(e,t){var r=(t=t||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new j;var n=r.generateShapes(e,t.size);t.depth=void 0===t.height?50:t.height,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Jr.call(this,n,t),this.type="TextBufferGeometry"}function Kr(e,t,r,n,i,a,o){j.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Zr(e,t,r,n,i,a,o)),this.mergeVertices()}function Zr(e,t,r,n,i,a,s){z.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:s},e=e||1,t=Ca(3,Fa(t)||8),r=Ca(2,Fa(r)||6),n=void 0===n?0:n,i=void 0===i?2*Oa:i;var c,u,l=Ia((a=void 0===a?0:a)+(s=void 0===s?Oa:s),Math.PI),h=0,p=[],d=new o,f=new o,m=[],g=[],v=[],y=[];for(u=0;u<=r;u++){var b=[],x=u/r,w=0;for(0==u&&0==a?w=.5/t:u==r&&l==Oa&&(w=-.5/t),c=0;c<=t;c++){var _=c/t;d.x=-e*_a(n+_*i)*wa(a+x*s),d.y=e*_a(a+x*s),d.z=e*wa(n+_*i)*wa(a+x*s),g.push(d.x,d.y,d.z),f.copy(d).normalize(),v.push(f.x,f.y,f.z),y.push(_+w,1-x),b.push(h++)}p.push(b)}for(u=0;u<r;u++)for(c=0;c<t;c++){var T=p[u][c+1],E=p[u][c],A=p[u+1][c],S=p[u+1][c+1];(0!==u||0<a)&&m.push(T,E,S),(u!==r-1||l<Oa)&&m.push(E,A,S)}this.setIndex(m),this.addAttribute("position",new k(g,3)),this.addAttribute("normal",new k(v,3)),this.addAttribute("uv",new k(y,2))}function Qr(e,t,r,n,i,a){j.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new $r(e,t,r,n,i,a)),this.mergeVertices()}function $r(e,t,r,n,a,s){z.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:a,thetaLength:s},e=e||.5,t=t||1,a=void 0===a?0:a,s=void 0===s?2*Oa:s,r=void 0===r?8:Ca(3,r);var c,u,l,h=[],p=[],d=[],f=[],m=e,g=(t-e)/(n=void 0===n?1:Ca(1,n)),v=new o,y=new i;for(u=0;u<=n;u++){for(l=0;l<=r;l++)c=a+l/r*s,v.x=m*_a(c),v.y=m*wa(c),p.push(v.x,v.y,v.z),d.push(0,0,1),y.x=(v.x/t+1)/2,y.y=(v.y/t+1)/2,f.push(y.x,y.y);m+=g}for(u=0;u<n;u++){var b=u*(r+1);for(l=0;l<r;l++){var x=c=l+b,w=c+r+1,_=c+r+2,T=c+1;h.push(x,w,T),h.push(w,_,T)}}this.setIndex(h),this.addAttribute("position",new k(p,3)),this.addAttribute("normal",new k(d,3)),this.addAttribute("uv",new k(f,2))}function en(e,t,r,n){j.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new tn(e,t,r,n)),this.mergeVertices()}function tn(e,t,r,n){z.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Fa(t)||12,r=r||0,n=n||2*Oa,n=lc.clamp(n,0,2*Oa);var a,s,c,u=[],l=[],h=[],p=1/t,d=new o,f=new i;for(s=0;s<=t;s++){var m=r+s*p*n,g=wa(m),v=_a(m);for(c=0;c<=e.length-1;c++)d.x=e[c].x*g,d.y=e[c].y,d.z=e[c].x*v,l.push(d.x,d.y,d.z),f.x=s/t,f.y=c/(e.length-1),h.push(f.x,f.y)}for(s=0;s<t;s++)for(c=0;c<e.length-1;c++){var y=a=c+s*e.length,b=a+e.length,x=a+e.length+1,w=a+1;u.push(y,b,w),u.push(b,x,w)}if(this.setIndex(u),this.addAttribute("position",new k(l,3)),this.addAttribute("uv",new k(h,2)),this.computeVertexNormals(),n===2*Oa){var _=this.attributes.normal.array,T=new o,E=new o,A=new o;for(a=t*e.length*3,s=0,c=0;s<e.length;s++,c+=3)T.x=_[c+0],T.y=_[c+1],T.z=_[c+2],E.x=_[a+c+0],E.y=_[a+c+1],E.z=_[a+c+2],A.addVectors(T,E).normalize(),_[c+0]=_[a+c+0]=A.x,_[c+1]=_[a+c+1]=A.y,_[c+2]=_[a+c+2]=A.z}}function rn(e,t){j.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new nn(e,t)),this.mergeVertices()}function nn(e,t){function r(e){var r,s,u,l=i.length/3,h=e.extractPoints(t),p=h.shape,d=h.holes;for(!1===Jc.isClockWise(p)&&(p=p.reverse()),r=0,s=d.length;r<s;r++)u=d[r],!0===Jc.isClockWise(u)&&(d[r]=u.reverse());var f=Jc.triangulateShape(p,d);for(r=0,s=d.length;r<s;r++)u=d[r],p=p.concat(u);for(r=0,s=p.length;r<s;r++){var m=p[r];i.push(m.x,m.y,0),a.push(0,0,1),o.push(m.x,m.y)}for(r=0,s=f.length;r<s;r++){var g=f[r],v=g[0]+l,y=g[1]+l,b=g[2]+l;n.push(v,y,b),c+=3}}z.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],i=[],a=[],o=[],s=0,c=0;if(!1===Array.isArray(e))r(e);else for(var u=0;u<e.length;u++)r(e[u]),this.addGroup(s,c,u),s+=c,c=0;this.setIndex(n),this.addAttribute("position",new k(i,3)),this.addAttribute("normal",new k(a,3)),this.addAttribute("uv",new k(o,2))}function an(e,t){if(t.shapes=[],Array.isArray(e))for(var r,n=0,i=e.length;n<i;n++)r=e[n],t.shapes.push(r.uuid);else t.shapes.push(e.uuid);return t}function on(e,t){z.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0===t?1:t;var r,n,i,a,o=[],s=_a(lc.DEG2RAD*t),c=[0,0],u={},l=["a","b","c"];e.isBufferGeometry?(a=new j).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h,p=a.vertices,d=a.faces,f=0,m=d.length;f<m;f++){h=d[f];for(var g=0;3>g;g++)r=h[l[g]],n=h[l[(g+1)%3]],c[0]=Ia(r,n),c[1]=Ca(r,n),void 0===u[i=c[0]+","+c[1]]?u[i]={index1:c[0],index2:c[1],face1:f,face2:void 0}:u[i].face2=f}for(i in u){var v=u[i];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=p[v.index1];o.push(y.x,y.y,y.z),y=p[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new k(o,3))}function sn(e,t,r,n,i,a,o,s){j.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new cn(e,t,r,n,i,a,o,s)),this.mergeVertices()}function cn(e,t,r,n,a,s,c,u){function l(r){var a,s,l,v=new i,x=new o,w=0,_=!0===r?e:t,T=!0===r?1:-1;for(s=g,a=1;a<=n;a++)d.push(0,y*T,0),f.push(0,T,0),m.push(.5,.5),g++;for(l=g,a=0;a<=n;a++){var E=a/n*u+c,A=_a(E),S=wa(E);x.x=_*S,x.y=y*T,x.z=_*A,d.push(x.x,x.y,x.z),f.push(0,T,0),v.x=.5*A+.5,v.y=.5*S*T+.5,m.push(v.x,v.y),g++}for(a=0;a<n;a++){var M=s+a,L=l+a;!0===r?p.push(L,L+1,M):p.push(L+1,L,M),w+=3}h.addGroup(b,w,!0===r?1:2),b+=w}z.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:a,openEnded:s,thetaStart:c,thetaLength:u};var h=this;e=void 0===e?1:e,t=void 0===t?1:t,r=r||1,n=Fa(n)||8,a=Fa(a)||1,s=void 0!==s&&s,c=void 0===c?0:c,u=void 0===u?2*Oa:u;var p=[],d=[],f=[],m=[],g=0,v=[],y=r/2,b=0;(function(){var i,s,l=new o,x=new o,w=0,_=(t-e)/r;for(s=0;s<=a;s++){var T=[],E=s/a,A=E*(t-e)+e;for(i=0;i<=n;i++){var S=i/n,M=S*u+c,L=wa(M),N=_a(M);x.x=A*L,x.y=-E*r+y,x.z=A*N,d.push(x.x,x.y,x.z),l.set(L,_,N).normalize(),f.push(l.x,l.y,l.z),m.push(S,1-E),T.push(g++)}v.push(T)}for(i=0;i<n;i++)for(s=0;s<a;s++){var R=v[s][i],C=v[s+1][i],I=v[s+1][i+1],O=v[s][i+1];p.push(R,C,O),p.push(C,I,O),w+=6}h.addGroup(b,w,0),b+=w})(),!1===s&&(0<e&&l(!0),0<t&&l(!1)),this.setIndex(p),this.addAttribute("position",new k(d,3)),this.addAttribute("normal",new k(f,3)),this.addAttribute("uv",new k(m,2))}function un(e,t,r,n,i,a,o){sn.call(this,0,e,t,r,n,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function ln(e,t,r,n,i,a,o){cn.call(this,0,e,t,r,n,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function hn(e,t,r,n){j.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new pn(e,t,r,n)),this.mergeVertices()}function pn(e,t,r,n){z.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||1,t=void 0===t?8:Ca(3,t),r=void 0===r?0:r,n=void 0===n?2*Oa:n;var a,s,c=[],u=[],l=[],h=[],p=new o,d=new i;for(u.push(0,0,0),l.push(0,0,1),h.push(.5,.5),s=0,a=3;s<=t;s++,a+=3){var f=r+s/t*n;p.x=e*_a(f),p.y=e*wa(f),u.push(p.x,p.y,p.z),l.push(0,0,1),d.x=(u[a]/e+1)/2,d.y=(u[a+1]/e+1)/2,h.push(d.x,d.y)}for(a=1;a<=t;a++)c.push(a,a+1,0);this.setIndex(c),this.addAttribute("position",new k(u,3)),this.addAttribute("normal",new k(l,3)),this.addAttribute("uv",new k(h,2))}function dn(e){S.call(this),this.type="ShadowMaterial",this.color=new w(0),this.transparent=!0,this.setValues(e)}function fn(e){X.call(this,e),this.type="RawShaderMaterial"}function mn(e){S.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new w(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new w(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oc,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function gn(e){mn.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function vn(e){S.call(this),this.type="MeshPhongMaterial",this.color=new w(16777215),this.specular=new w(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new w(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oc,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function yn(e){vn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function bn(e){S.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oc,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function xn(e){S.call(this),this.type="MeshLambertMaterial",this.color=new w(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new w(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function wn(e){S.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new w(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oc,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function _n(e){Xt.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function Tn(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0===n?new t.constructor(r):n,this.sampleValues=t,this.valueSize=r}function En(e,t,r,n){Tn.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function An(e,t,r,n){Tn.call(this,e,t,r,n)}function Sn(e,t,r,n){Tn.call(this,e,t,r,n)}function Mn(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kc.convertArray(t,this.TimeBufferType),this.values=Kc.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function Ln(e,t,r){Mn.call(this,e,t,r)}function Nn(e,t,r,n){Mn.call(this,e,t,r,n)}function Rn(e,t,r,n){Mn.call(this,e,t,r,n)}function Cn(e,t,r,n){Tn.call(this,e,t,r,n)}function In(e,t,r,n){Mn.call(this,e,t,r,n)}function On(e,t,r,n){Mn.call(this,e,t,r,n)}function Pn(e,t,r,n){Mn.call(this,e,t,r,n)}function Fn(e,t,r){this.name=e,this.tracks=r,this.duration=void 0===t?-1:t,this.uuid=lc.generateUUID(),0>this.duration&&this.resetDuration()}function kn(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Rn;case"vector":case"vector2":case"vector3":case"vector4":return Pn;case"color":return Nn;case"quaternion":return In;case"bool":case"boolean":return Ln;case"string":return On}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var r=[],n=[];Kc.flattenJSON(e.keys,r,n,"value"),e.times=r,e.values=n}return void 0===t.parse?new t(e.name,e.times,e.values,e.interpolation):t.parse(e)}function Dn(e,t,r){var n=this,i=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){o++,0==i&&void 0!==n.onStart&&n.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==n.onProgress&&n.onProgress(e,a,o),a==o&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}function Un(e){this.manager=void 0===e?Qc:e}function Bn(e){this.manager=void 0===e?Qc:e}function zn(e){this.manager=void 0===e?Qc:e,this._parser=null}function Gn(e){this.manager=void 0===e?Qc:e,this._parser=null}function jn(e){this.manager=void 0===e?Qc:e}function Vn(e){this.manager=void 0===e?Qc:e}function Hn(e){this.manager=void 0===e?Qc:e}function Wn(){this.type="Curve",this.arcLengthDivisions=200}function Jn(e,t,r,n,i,a,o,s){Wn.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Oa,this.aClockwise=o||!1,this.aRotation=s||0}function Xn(e,t,r,n,i,a){Jn.call(this,e,t,r,r,n,i,a),this.type="ArcCurve"}function Yn(){function e(e,a,o,s){t=e,r=o,n=-3*e+3*a-2*o-s,i=2*e-2*a+o+s}var t=0,r=0,n=0,i=0;return{initCatmullRom:function(t,r,n,i,a){e(r,n,a*(n-t),a*(i-r))},initNonuniformCatmullRom:function(t,r,n,i,a,o,s){var c=(r-t)/a-(n-t)/(a+o)+(n-r)/o,u=(n-r)/o-(i-r)/(o+s)+(i-n)/s;e(r,n,c*=o,u*=o)},calc:function(e){var a=e*e;return t+r*e+n*a+i*(a*e)}}}function qn(e,t,r,n){Wn.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=n||.5}function Kn(e,t,r,n,i){var a=.5*(n-t),o=.5*(i-r),s=e*e;return(2*r-2*n+a+o)*(e*s)+(-3*r+3*n-2*a-o)*s+a*e+r}function Zn(e,t,r,n){return function(e,t){var r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,n)}function Qn(e,t,r,n,i){return function(e,t){var r=1-e;return r*r*r*t}(e,t)+function(e,t){var r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,i)}function $n(e,t,r,n){Wn.call(this),this.type="CubicBezierCurve",this.v0=e||new i,this.v1=t||new i,this.v2=r||new i,this.v3=n||new i}function ei(e,t,r,n){Wn.call(this),this.type="CubicBezierCurve3",this.v0=e||new o,this.v1=t||new o,this.v2=r||new o,this.v3=n||new o}function ti(e,t){Wn.call(this),this.type="LineCurve",this.v1=e||new i,this.v2=t||new i}function ri(e,t){Wn.call(this),this.type="LineCurve3",this.v1=e||new o,this.v2=t||new o}function ni(e,t,r){Wn.call(this),this.type="QuadraticBezierCurve",this.v0=e||new i,this.v1=t||new i,this.v2=r||new i}function ii(e,t,r){Wn.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new o,this.v1=t||new o,this.v2=r||new o}function ai(e){Wn.call(this),this.type="SplineCurve",this.points=e||[]}function oi(){Wn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function si(e){oi.call(this),this.type="Path",this.currentPoint=new i,e&&this.setFromPoints(e)}function ci(e){si.call(this,e),this.uuid=lc.generateUUID(),this.type="Shape",this.holes=[]}function ui(e,t){m.call(this),this.type="Light",this.color=new w(e),this.intensity=void 0===t?1:t,this.receiveShadow=void 0}function li(e,t,r){ui.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(m.DefaultUp),this.updateMatrix(),this.groundColor=new w(t)}function hi(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new p}function pi(){hi.call(this,new q(50,1,.5,500))}function di(e,t,r,n,i,a){ui.call(this,e,t),this.type="SpotLight",this.position.copy(m.DefaultUp),this.updateMatrix(),this.target=new m,Object.defineProperty(this,"power",{get:function(){return this.intensity*Oa},set:function(e){this.intensity=e/Oa}}),this.distance=void 0===r?0:r,this.angle=void 0===n?Oa/3:n,this.penumbra=void 0===i?0:i,this.decay=void 0===a?1:a,this.shadow=new pi}function fi(e,t,r,n){ui.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Oa},set:function(e){this.intensity=e/(4*Oa)}}),this.distance=void 0===r?0:r,this.decay=void 0===n?1:n,this.shadow=new hi(new q(90,1,.5,500))}function mi(e,t,r,n,i,a){Y.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0===e?-1:e,this.right=void 0===t?1:t,this.top=void 0===r?1:r,this.bottom=void 0===n?-1:n,this.near=void 0===i?.1:i,this.far=void 0===a?2e3:a,this.updateProjectionMatrix()}function gi(){hi.call(this,new mi(-5,5,5,-5,.5,500))}function vi(e,t){ui.call(this,e,t),this.type="DirectionalLight",this.position.copy(m.DefaultUp),this.updateMatrix(),this.target=new m,this.shadow=new gi}function yi(e,t){ui.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function bi(e,t,r,n){ui.call(this,e,t),this.type="RectAreaLight",this.width=void 0===r?10:r,this.height=void 0===n?10:n}function xi(e){this.manager=void 0===e?Qc:e,this.textures={}}function wi(){z.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function _i(e,t,r,n){"number"==typeof r&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),L.call(this,e,t,r),this.meshPerAttribute=n||1}function Ti(e){this.manager=void 0===e?Qc:e}function Ei(e){this.manager=void 0===e?Qc:e,this.resourcePath=""}function Ai(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0===e?Qc:e,this.options=void 0}function Si(){this.type="ShapePath",this.color=new w,this.subPaths=[],this.currentPath=null}function Mi(e){this.type="Font",this.data=e}function Li(e,t,r,n,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,c,u,l,h,p,d,f=new Si;if(a.o)for(var m,g=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,y=g.length;v<y;)"m"===(m=g[v++])?(o=g[v++]*t+r,s=g[v++]*t+n,f.moveTo(o,s)):"l"===m?(o=g[v++]*t+r,s=g[v++]*t+n,f.lineTo(o,s)):"q"===m?(c=g[v++]*t+r,u=g[v++]*t+n,l=g[v++]*t+r,h=g[v++]*t+n,f.quadraticCurveTo(l,h,c,u)):"b"===m&&(c=g[v++]*t+r,u=g[v++]*t+n,l=g[v++]*t+r,h=g[v++]*t+n,p=g[v++]*t+r,d=g[v++]*t+n,f.bezierCurveTo(l,h,p,d,c,u));return{offsetX:a.ha*t,path:f}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}function Ni(e){this.manager=void 0===e?Qc:e}function Ri(){}function Ci(e){this.manager=void 0===e?Qc:e}function Ii(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new o)}function Oi(e,t){ui.call(this,void 0,t),this.sh=void 0===e?new Ii:e}function Pi(e,t,r){Oi.call(this,void 0,r);var n=(new w).set(e),i=(new w).set(t),a=new o(n.r,n.g,n.b),s=new o(i.r,i.g,i.b),c=Aa(Math.PI);this.sh.coefficients[0].copy(a).add(s).multiplyScalar(c),this.sh.coefficients[1].copy(a).sub(s).multiplyScalar(.8660254037844386*c)}function Fi(e,t){Oi.call(this,void 0,t);var r=(new w).set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Aa(Math.PI))}function ki(e){this.autoStart=!(void 0!==e)||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Di(){m.call(this),this.type="AudioListener",this.context=hu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Ui(e){m.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Bi(e){Ui.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function zi(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0===t?2048:t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Gi(e,t,r){this.binding=e,this.valueSize=r;var n,i=Float64Array;"quaternion"===t?n=this._slerp:"string"===t||"bool"===t?(i=Array,n=this._select):n=this._lerp,this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function ji(e,t,r){var n=r||Vi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Vi(e,t,r){this.path=t,this.parsedPath=r||Vi.parseTrackName(t),this.node=Vi.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Hi(e,t,r){this._mixer=e,this._clip=t,this._localRoot=r||null;for(var n,i=t.tracks,a=i.length,o=Array(a),s={endingStart:Js,endingEnd:Js},c=0;c!==a;++c)n=i[c].createInterpolant(null),o[c]=n,n.settings=s;this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Vs,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Wi(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Ji(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Xi(e,t,r){Bt.call(this,e,t),this.meshPerAttribute=r||1}function Yi(e,t){return e.distance-t.distance}function qi(e,t,r,n){if(!1!==e.visible&&(e.raycast(t,r),!0===n))for(var i=e.children,a=0,o=i.length;a<o;a++)qi(i[a],t,r,!0)}function Ki(e,t){this.min=void 0===e?new i(1/0,1/0):e,this.max=void 0===t?new i(-1/0,-1/0):t}function Zi(e,t){this.start=void 0===e?new o:e,this.end=void 0===t?new o:t}function Qi(e){m.call(this),this.material=e,this.render=function(){}}function $i(e,t,r,n){this.object=e,this.size=void 0===t?1:t;var i=void 0===r?16711680:r,a=void 0===n?1:n,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new z,u=new k(2*o*3,3);c.addAttribute("position",u),qt.call(this,c,new Xt({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function ea(e,t){m.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var r=new z,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Oa*2,s=a/32*Oa*2;n.push(_a(o),wa(o),1,_a(s),wa(s),1)}r.addAttribute("position",new k(n,3));var c=new Xt({fog:!1});this.cone=new qt(r,c),this.add(this.cone),this.update()}function ta(e){for(var t,r=function e(t){var r=[];t&&t.isBone&&r.push(t);for(var n=0;n<t.children.length;n++)r.push.apply(r,e(t.children[n]));return r}(e),n=new z,i=[],a=[],o=new w(0,0,1),s=new w(0,1,0),c=0;c<r.length;c++)(t=r[c]).parent&&t.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),a.push(o.r,o.g,o.b),a.push(s.r,s.g,s.b));n.addAttribute("position",new k(i,3)),n.addAttribute("color",new k(a,3));var u=new Xt({vertexColors:Ka,depthTest:!1,depthWrite:!1,transparent:!0});qt.call(this,n,u),this.root=e,this.bones=r,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function ra(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;var n=new Zr(t,4,2),i=new M({wireframe:!0,fog:!1});G.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function na(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var r=new z;r.addAttribute("position",new k([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere();var n=new Xt({fog:!1});Yt.call(this,r,n);var i=new z;i.addAttribute("position",new k([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new G(i,new M({side:Ja,fog:!1}))),this.update()}function ia(e,t,r){m.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new hr(t);n.rotateY(.5*Oa),this.material=new M({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=Ka);var i=n.getAttribute("position"),a=new Float32Array(3*i.count);n.addAttribute("color",new L(a,3)),this.add(new G(n,this.material)),this.update()}function aa(e,t){this.lightProbe=e,this.size=t;var r=new X({defines:{GAMMA_OUTPUT:""},uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:"varying vec3 vNormal;\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define RECIPROCAL_PI 0.318309886\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\t// matrix is assumed to be orthogonal\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 linearToOutput( in vec3 a ) {\n\t#ifdef GAMMA_OUTPUT\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\t// normal is assumed to have unit length\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\t// band 0\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\t// band 1\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\t// band 2\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nuniform vec3 sh[ 9 ]; // sh coefficients\nuniform float intensity; // light probe intensity\nvarying vec3 vNormal;\nvoid main() {\n\tvec3 normal = normalize( vNormal );\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );\n\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;\n\toutgoingLight = linearToOutput( outgoingLight );\n\tgl_FragColor = vec4( outgoingLight, 1.0 );\n}"}),n=new Zr(1,32,16);G.call(this,n,r),this.onBeforeRender()}function oa(e,t,r,n){e=e||10,t=t||10,r=new w(void 0===r?4473924:r),n=new w(void 0===n?8947848:n);for(var i=t/2,a=e/t,o=e/2,s=[],c=[],u=0,l=0,h=-o;u<=t;u++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var p=u===i?r:n;p.toArray(c,l),l+=3,p.toArray(c,l),l+=3,p.toArray(c,l),l+=3,p.toArray(c,l),l+=3}var d=new z;d.addAttribute("position",new k(s,3)),d.addAttribute("color",new k(c,3));var f=new Xt({vertexColors:Ka});qt.call(this,d,f)}function sa(e,t,r,n,i,a){e=e||10,t=t||16,r=r||8,n=n||64,i=new w(void 0===i?4473924:i),a=new w(void 0===a?8947848:a);var o,s,c,u,l,h,p,d=[],f=[];for(u=0;u<=t;u++)o=wa(c=u/t*(2*Oa))*e,s=_a(c)*e,d.push(0,0,0),d.push(o,0,s),p=1&u?i:a,f.push(p.r,p.g,p.b),f.push(p.r,p.g,p.b);for(u=0;u<=r;u++)for(p=1&u?i:a,h=e-e/r*u,l=0;l<n;l++)o=wa(c=l/n*(2*Oa))*h,s=_a(c)*h,d.push(o,0,s),f.push(p.r,p.g,p.b),o=wa(c=(l+1)/n*(2*Oa))*h,s=_a(c)*h,d.push(o,0,s),f.push(p.r,p.g,p.b);var m=new z;m.addAttribute("position",new k(d,3)),m.addAttribute("color",new k(f,3));var g=new Xt({vertexColors:Ka});qt.call(this,m,g)}function ca(e,t,r,n){this.audio=e,this.range=t||1,this.divisionsInnerAngle=r||16,this.divisionsOuterAngle=n||2;var i=new z,a=this.divisionsInnerAngle+2*this.divisionsOuterAngle,o=new Float32Array(3*(3*a+3));i.addAttribute("position",new L(o,3));var s=new Xt({color:65280}),c=new Xt({color:16776960});Yt.call(this,i,[c,s]),this.update()}function ua(e,t,r,n){this.object=e,this.size=void 0===t?1:t;var i=void 0===r?16776960:r,a=void 0===n?1:n,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new z,u=new k(2*o*3,3);c.addAttribute("position",u),qt.call(this,c,new Xt({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function la(e,t,r){m.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);var n=new z;n.addAttribute("position",new k([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new Xt({fog:!1});this.lightPlane=new Yt(n,i),this.add(this.lightPlane),(n=new z).addAttribute("position",new k([0,0,0,0,0,1],3)),this.targetLine=new Yt(n,i),this.add(this.targetLine),this.update()}function ha(e){function t(e,t,n){r(e,n),r(t,n)}function r(e,t){a.push(0,0,0),o.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(a.length/3-1)}var n=new z,i=new Xt({color:16777215,vertexColors:qa}),a=[],o=[],s={},c=new w(16755200),u=new w(16711680),l=new w(43775),h=new w(16777215),p=new w(3355443);t("n1","n2",c),t("n2","n4",c),t("n4","n3",c),t("n3","n1",c),t("f1","f2",c),t("f2","f4",c),t("f4","f3",c),t("f3","f1",c),t("n1","f1",c),t("n2","f2",c),t("n3","f3",c),t("n4","f4",c),t("p","n1",u),t("p","n2",u),t("p","n3",u),t("p","n4",u),t("u1","u2",l),t("u2","u3",l),t("u3","u1",l),t("c","t",h),t("p","c",p),t("cn1","cn2",p),t("cn3","cn4",p),t("cf1","cf2",p),t("cf3","cf4",p),n.addAttribute("position",new k(a,3)),n.addAttribute("color",new k(o,3)),qt.call(this,n,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function pa(e,t){this.object=e,void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new z;i.setIndex(new L(r,1)),i.addAttribute("position",new L(n,3)),qt.call(this,i,new Xt({color:t})),this.matrixAutoUpdate=!1,this.update()}function da(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new z;n.setIndex(new L(r,1)),n.addAttribute("position",new k([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),qt.call(this,n,new Xt({color:t})),this.geometry.computeBoundingSphere()}function fa(e,t,r){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0===r?16776960:r,i=new z;i.addAttribute("position",new k([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Yt.call(this,i,new Xt({color:n}));var a=new z;a.addAttribute("position",new k([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new G(a,new M({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function ma(e,t,r,n,i,a){m.call(this),void 0===e&&(e=new o(0,0,1)),void 0===t&&(t=new o(0,0,0)),void 0===r&&(r=1),void 0===n&&(n=16776960),void 0===i&&(i=.2*r),void 0===a&&(a=.2*i),void 0===fu&&((fu=new z).addAttribute("position",new k([0,0,0,0,1,0],3)),(mu=new cn(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Yt(fu,new Xt({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new G(mu,new M({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,a)}function ga(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new z;r.addAttribute("position",new k(t,3)),r.addAttribute("color",new k([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new Xt({vertexColors:Ka});qt.call(this,r,n)}function va(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),qn.call(this,e),this.type="catmullrom"}var ya=Math.tan,ba=Math.atan,xa=Math.acos,wa=Math.sin,_a=Math.cos,Ta=Math.atan2,Ea=Math.abs,Aa=Math.sqrt,Sa=Math.round,Ma=Math.pow,La=Math.ceil,Na=Math.LN2,Ra=Math.log,Ca=Math.max,Ia=Math.min,Oa=Math.PI,Pa=Math.sign,Fa=Math.floor,ka=Number.isInteger,Da=Number.EPSILON;r.d(t,"a",function(){return Ro}),r.d(t,"b",function(){return $a}),r.d(t,"c",function(){return yi}),r.d(t,"d",function(){return Fn}),r.d(t,"e",function(){return Bn}),r.d(t,"f",function(){return Wi}),r.d(t,"g",function(){return Ci}),r.d(t,"h",function(){return Ja}),r.d(t,"i",function(){return Jt}),r.d(t,"j",function(){return H}),r.d(t,"k",function(){return L}),r.d(t,"l",function(){return z}),r.d(t,"m",function(){return Ti}),r.d(t,"n",function(){return Wo}),r.d(t,"o",function(){return w}),r.d(t,"p",function(){return er}),r.d(t,"q",function(){return zn}),r.d(t,"r",function(){return ln}),r.d(t,"s",function(){return Do}),r.d(t,"t",function(){return Uo}),r.d(t,"u",function(){return ge}),r.d(t,"v",function(){return Vn}),r.d(t,"w",function(){return jo}),r.d(t,"x",function(){return Vo}),r.d(t,"y",function(){return Wn}),r.d(t,"z",function(){return ro}),r.d(t,"A",function(){return cn}),r.d(t,"B",function(){return Q}),r.d(t,"C",function(){return Gn}),r.d(t,"D",function(){return Qc}),r.d(t,"E",function(){return vi}),r.d(t,"F",function(){return Xa}),r.d(t,"G",function(){return mo}),r.d(t,"H",function(){return Bo}),r.d(t,"I",function(){return zo}),r.d(t,"J",function(){return d}),r.d(t,"K",function(){return n}),r.d(t,"L",function(){return Un}),r.d(t,"M",function(){return k}),r.d(t,"N",function(){return as}),r.d(t,"O",function(){return Ni}),r.d(t,"P",function(){return Wa}),r.d(t,"Q",function(){return $s}),r.d(t,"R",function(){return Ct}),r.d(t,"S",function(){return os}),r.d(t,"T",function(){return li}),r.d(t,"U",function(){return Ai}),r.d(t,"V",function(){return jn}),r.d(t,"W",function(){return I}),r.d(t,"X",function(){return P}),r.d(t,"Y",function(){return N}),r.d(t,"Z",function(){return Bt}),r.d(t,"ab",function(){return zt}),r.d(t,"bb",function(){return Tn}),r.d(t,"cb",function(){return Hs}),r.d(t,"db",function(){return Ws}),r.d(t,"eb",function(){return To}),r.d(t,"fb",function(){return Yt}),r.d(t,"gb",function(){return Xt}),r.d(t,"hb",function(){return Kt}),r.d(t,"ib",function(){return qt}),r.d(t,"jb",function(){return Zs}),r.d(t,"kb",function(){return Ko}),r.d(t,"lb",function(){return Qo}),r.d(t,"mb",function(){return Zo}),r.d(t,"nb",function(){return Ri}),r.d(t,"ob",function(){return au}),r.d(t,"pb",function(){return Dn}),r.d(t,"qb",function(){return S}),r.d(t,"rb",function(){return xi}),r.d(t,"sb",function(){return lc}),r.d(t,"tb",function(){return s}),r.d(t,"ub",function(){return p}),r.d(t,"vb",function(){return G}),r.d(t,"wb",function(){return M}),r.d(t,"xb",function(){return xn}),r.d(t,"yb",function(){return vn}),r.d(t,"zb",function(){return gn}),r.d(t,"Ab",function(){return mn}),r.d(t,"Bb",function(){return yn}),r.d(t,"Cb",function(){return Jo}),r.d(t,"Db",function(){return Lo}),r.d(t,"Eb",function(){return Xo}),r.d(t,"Fb",function(){return qo}),r.d(t,"Gb",function(){return Yo}),r.d(t,"Hb",function(){return Ya}),r.d(t,"Ib",function(){return Qa}),r.d(t,"Jb",function(){return Rn}),r.d(t,"Kb",function(){return m}),r.d(t,"Lb",function(){return Ei}),r.d(t,"Mb",function(){return fo}),r.d(t,"Nb",function(){return mi}),r.d(t,"Ob",function(){return si}),r.d(t,"Pb",function(){return q}),r.d(t,"Qb",function(){return ie}),r.d(t,"Rb",function(){return fi}),r.d(t,"Sb",function(){return Qt}),r.d(t,"Tb",function(){return Zt}),r.d(t,"Ub",function(){return Vi}),r.d(t,"Vb",function(){return a}),r.d(t,"Wb",function(){return In}),r.d(t,"Xb",function(){return ds}),r.d(t,"Yb",function(){return Ms}),r.d(t,"Zb",function(){return Ss}),r.d(t,"ac",function(){return _s}),r.d(t,"bc",function(){return Ts}),r.d(t,"cc",function(){return nc}),r.d(t,"dc",function(){return ec}),r.d(t,"ec",function(){return gs}),r.d(t,"fc",function(){return ps}),r.d(t,"gc",function(){return rc}),r.d(t,"hc",function(){return tc}),r.d(t,"ic",function(){return Ls}),r.d(t,"jc",function(){return As}),r.d(t,"kc",function(){return Es}),r.d(t,"lc",function(){return xs}),r.d(t,"mc",function(){return Ho}),r.d(t,"nc",function(){return g}),r.d(t,"oc",function(){return Nc}),r.d(t,"pc",function(){return X}),r.d(t,"qc",function(){return Si}),r.d(t,"rc",function(){return Wt}),r.d(t,"sc",function(){return Ht}),r.d(t,"tc",function(){return Zr}),r.d(t,"uc",function(){return Go}),r.d(t,"vc",function(){return di}),r.d(t,"wc",function(){return po}),r.d(t,"xc",function(){return c}),r.d(t,"yc",function(){return Hn}),r.d(t,"zc",function(){return Ks}),r.d(t,"Ac",function(){return qs}),r.d(t,"Bc",function(){return Ys}),r.d(t,"Cc",function(){return O}),r.d(t,"Dc",function(){return F}),r.d(t,"Ec",function(){return R}),r.d(t,"Fc",function(){return Lc}),r.d(t,"Gc",function(){return _c}),r.d(t,"Hc",function(){return $o}),r.d(t,"Ic",function(){return i}),r.d(t,"Jc",function(){return o}),r.d(t,"Kc",function(){return u}),r.d(t,"Lc",function(){return Pn}),r.d(t,"Mc",function(){return Ka}),r.d(t,"Nc",function(){return l}),r.d(t,"Oc",function(){return Qs}),void 0===Da&&(Da=2220446049250313e-31),void 0===ka&&(ka=function(e){return"number"==typeof e&&isFinite(e)&&Fa(e)===e}),void 0===Pa&&(Pa=function(e){return 0>e?-1:0<e?1:+e}),0=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t,r=Object(e),n=1;n<arguments.length;n++)if(null!=(t=arguments[n]))for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i]);return r}),Object.assign(n.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=t.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,e)}}}});var Ua,Ba="107",za=0,Ga=1,ja=2,Va=1,Ha=2,Wa=0,Ja=1,Xa=2,Ya=0,qa=1,Ka=2,Za=0,Qa=1,$a=2,eo=3,to=4,ro=5,no=100,io=101,ao=102,oo=103,so=104,co=200,uo=201,lo=202,ho=203,po=204,fo=205,mo=206,go=207,vo=208,yo=209,bo=210,xo=0,wo=1,_o=2,To=3,Eo=4,Ao=5,So=6,Mo=7,Lo=0,No=1,Ro=2,Co=0,Io=1,Oo=2,Po=3,Fo=4,ko=5,Do=301,Uo=302,Bo=303,zo=304,Go=305,jo=306,Vo=307,Ho=1e3,Wo=1001,Jo=1002,Xo=1003,Yo=1004,qo=1005,Ko=1006,Zo=1007,Qo=1008,$o=1009,es=1010,ts=1011,rs=1012,ns=1013,is=1014,as=1015,os=1016,ss=1017,cs=1018,us=1019,ls=1020,hs=1021,ps=1022,ds=1023,fs=1024,ms=1025,gs=ds,vs=1026,ys=1027,bs=1028,xs=33776,ws=33777,_s=33778,Ts=33779,Es=35840,As=35841,Ss=35842,Ms=35843,Ls=36196,Ns=37808,Rs=37809,Cs=37810,Is=37811,Os=37812,Ps=37813,Fs=37814,ks=37815,Ds=37816,Us=37817,Bs=37818,zs=37819,Gs=37820,js=37821,Vs=2201,Hs=2300,Ws=2301,Js=2400,Xs=2401,Ys=0,qs=1,Ks=2,Zs=3e3,Qs=3001,$s=3007,ec=3002,tc=3004,rc=3005,nc=3006,ic=3200,ac=3201,oc=0,sc=1,cc=7680,uc=519,lc={DEG2RAD:Oa/180,RAD2DEG:180/Oa,generateUUID:function(){for(var e=[],t=0;256>t;t++)e[t]=(16>t?"0":"")+t.toString(16);return function(){var t=0|4294967295*Math.random(),r=0|4294967295*Math.random(),n=0|4294967295*Math.random(),i=0|4294967295*Math.random();return(e[255&t]+e[255&t>>8]+e[255&t>>16]+e[255&t>>24]+"-"+e[255&r]+e[255&r>>8]+"-"+e[64|15&r>>16]+e[255&r>>24]+"-"+e[128|63&n]+e[255&n>>8]+"-"+e[255&n>>16]+e[255&n>>24]+e[255&i]+e[255&i>>8]+e[255&i>>16]+e[255&i>>24]).toUpperCase()}}(),clamp:function(e,t,r){return Ca(t,Ia(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Fa(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*lc.DEG2RAD},radToDeg:function(e){return e*lc.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Ma(2,La(Ra(e)/Na))},floorPowerOfTwo:function(e){return Ma(2,Fa(Ra(e)/Na))}};Object.defineProperties(i.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(i.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this):(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this):(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this},min:function(e){return this.x=Ia(this.x,e.x),this.y=Ia(this.y,e.y),this},max:function(e){return this.x=Ca(this.x,e.x),this.y=Ca(this.y,e.y),this},clamp:function(e,t){return this.x=Ca(e.x,Ia(t.x,this.x)),this.y=Ca(e.y,Ia(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Ca(e,Ia(t,this.x)),this.y=Ca(e,Ia(t,this.y)),this},clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Ca(e,Ia(t,r)))},floor:function(){return this.x=Fa(this.x),this.y=Fa(this.y),this},ceil:function(){return this.x=La(this.x),this.y=La(this.y),this},round:function(){return this.x=Sa(this.x),this.y=Sa(this.y),this},roundToZero:function(){return this.x=0>this.x?La(this.x):Fa(this.x),this.y=0>this.y?La(this.y):Fa(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Aa(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Ea(this.x)+Ea(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Ta(this.y,this.x);return 0>e&&(e+=2*Oa),e},distanceTo:function(e){return Aa(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Ea(this.x-e.x)+Ea(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var r=_a(t),n=wa(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*r-a*n+e.x,this.y=i*n+a*r+e.y,this}}),Object.assign(a,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,a,o){var s=r[n+0],c=r[n+1],u=r[n+2],l=r[n+3],h=i[a+0],p=i[a+1],d=i[a+2],f=i[a+3];if(l!==f||s!==h||c!==p||u!==d){var m=1-o,g=s*h+c*p+u*d+l*f,v=0<=g?1:-1,y=1-g*g;if(y>Da){var b=Aa(y),x=Ta(b,g*v);m=wa(m*x)/b,o=wa(o*x)/b}var w=o*v;if(s=s*m+h*w,c=c*m+p*w,u=u*m+d*w,l=l*m+f*w,m==1-o){var _=1/Aa(s*s+c*c+u*u+l*l);s*=_,c*=_,u*=_,l*=_}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l}}),Object.defineProperties(a.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(a.prototype,{isQuaternion:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,n=e._y,i=e._z,a=e.order,o=_a,s=wa,c=o(r/2),u=o(n/2),l=o(i/2),h=s(r/2),p=s(n/2),d=s(i/2);return"XYZ"===a?(this._x=h*u*l+c*p*d,this._y=c*p*l-h*u*d,this._z=c*u*d+h*p*l,this._w=c*u*l-h*p*d):"YXZ"===a?(this._x=h*u*l+c*p*d,this._y=c*p*l-h*u*d,this._z=c*u*d-h*p*l,this._w=c*u*l+h*p*d):"ZXY"===a?(this._x=h*u*l-c*p*d,this._y=c*p*l+h*u*d,this._z=c*u*d+h*p*l,this._w=c*u*l-h*p*d):"ZYX"===a?(this._x=h*u*l-c*p*d,this._y=c*p*l+h*u*d,this._z=c*u*d-h*p*l,this._w=c*u*l+h*p*d):"YZX"===a?(this._x=h*u*l+c*p*d,this._y=c*p*l+h*u*d,this._z=c*u*d-h*p*l,this._w=c*u*l-h*p*d):"XZY"===a&&(this._x=h*u*l-c*p*d,this._y=c*p*l-h*u*d,this._z=c*u*d+h*p*l,this._w=c*u*l+h*p*d),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=wa(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=_a(r),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],a=r[8],o=r[1],s=r[5],c=r[9],u=r[2],l=r[6],h=r[10],p=n+s+h;return 0<p?(t=.5/Aa(p+1),this._w=.25/t,this._x=(l-c)*t,this._y=(a-u)*t,this._z=(o-i)*t):n>s&&n>h?(t=2*Aa(1+n-s-h),this._w=(l-c)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+u)/t):s>h?(t=2*Aa(1+s-n-h),this._w=(a-u)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(c+l)/t):(t=2*Aa(1+h-n-s),this._w=(o-i)/t,this._x=(a+u)/t,this._y=(c+l)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var r=e.dot(t)+1;return r<1e-6?(r=0,Ea(e.x)>Ea(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()},angleTo:function(e){return 2*xa(Ea(lc.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var r=this.angleTo(e);if(0===r)return this;var n=Ia(1,t/r);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Aa(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this._onChangeCallback(),this},multiply:function(e,t){return void 0===t?this.multiplyQuaternions(this,e):(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t))},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,a=e._w,o=t._x,s=t._y,c=t._z,u=t._w;return this._x=r*u+a*o+n*c-i*s,this._y=n*u+a*s+i*o-r*c,this._z=i*u+a*c+r*s-n*o,this._w=a*u-r*o-n*s-i*c,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,a=this._w,o=a*e._w+r*e._x+n*e._y+i*e._z;if(0>o?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),1<=o)return this._w=a,this._x=r,this._y=n,this._z=i,this;var s=1-o*o;if(s<=Da){var c=1-t;return this._w=c*a+t*this._w,this._x=c*r+t*this._x,this._y=c*n+t*this._y,this._z=c*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Aa(s),l=Ta(u,o),h=wa((1-t)*l)/u,p=wa(t*l)/u;return this._w=a*h+this._w*p,this._x=r*h+this._x*p,this._y=n*h+this._y*p,this._z=i*h+this._z*p,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(o.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this):(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this):(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0===t?(this.x*=e.x,this.y*=e.y,this.z*=e.z,this):(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t))},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new a;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new a;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,o=e.z,s=e.w,c=s*t+a*n-o*r,u=s*r+o*t-i*n,l=s*n+i*r-a*t,h=-i*t-a*r-o*n;return this.x=c*s+h*-i+u*-o-l*-a,this.y=u*s+h*-a+l*-i-c*-o,this.z=l*s+h*-o+c*-a-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Ia(this.x,e.x),this.y=Ia(this.y,e.y),this.z=Ia(this.z,e.z),this},max:function(e){return this.x=Ca(this.x,e.x),this.y=Ca(this.y,e.y),this.z=Ca(this.z,e.z),this},clamp:function(e,t){return this.x=Ca(e.x,Ia(t.x,this.x)),this.y=Ca(e.y,Ia(t.y,this.y)),this.z=Ca(e.z,Ia(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Ca(e,Ia(t,this.x)),this.y=Ca(e,Ia(t,this.y)),this.z=Ca(e,Ia(t,this.z)),this},clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Ca(e,Ia(t,r)))},floor:function(){return this.x=Fa(this.x),this.y=Fa(this.y),this.z=Fa(this.z),this},ceil:function(){return this.x=La(this.x),this.y=La(this.y),this.z=La(this.z),this},round:function(){return this.x=Sa(this.x),this.y=Sa(this.y),this.z=Sa(this.z),this},roundToZero:function(){return this.x=0>this.x?La(this.x):Fa(this.x),this.y=0>this.y?La(this.y):Fa(this.y),this.z=0>this.z?La(this.z):Fa(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Aa(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Ea(this.x)+Ea(this.y)+Ea(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){return void 0===t?this.crossVectors(this,e):(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t))},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-i*o,this.y=i*a-r*s,this.z=r*o-n*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new o;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new o;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Aa(this.lengthSq()*e.lengthSq());return xa(lc.clamp(t,-1,1))},distanceTo:function(e){return Aa(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Ea(this.x-e.x)+Ea(this.y-e.y)+Ea(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){var n=wa(t)*e;return this.x=n*wa(r),this.y=_a(t)*e,this.z=n*_a(r),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){return this.x=e*wa(t),this.y=r,this.z=e*_a(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(s.prototype,{isMatrix3:!0,set:function(e,t,r,n,i,a,o,s,c){var u=this.elements;return u[0]=e,u[1]=n,u[2]=o,u[3]=t,u[4]=i,u[5]=s,u[6]=r,u[7]=a,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(e){void 0===Ua&&(Ua=new o);for(var t=0,r=e.count;t<r;t++)Ua.x=e.getX(t),Ua.y=e.getY(t),Ua.z=e.getZ(t),Ua.applyMatrix3(this),e.setXYZ(t,Ua.x,Ua.y,Ua.z);return e},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[3],s=r[6],c=r[1],u=r[4],l=r[7],h=r[2],p=r[5],d=r[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],b=n[7],x=n[2],w=n[5],_=n[8];return i[0]=a*f+o*v+s*x,i[3]=a*m+o*y+s*w,i[6]=a*g+o*b+s*_,i[1]=c*f+u*v+l*x,i[4]=c*m+u*y+l*w,i[7]=c*g+u*b+l*_,i[2]=h*f+p*v+d*x,i[5]=h*m+p*y+d*w,i[8]=h*g+p*b+d*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],u=e[8];return t*a*u-t*o*c-r*i*u+r*o*s+n*i*c-n*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,n=this.elements,i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],u=r[5],l=r[6],h=r[7],p=r[8],d=p*c-u*h,f=u*l-p*s,m=h*s-c*l,g=i*d+a*f+o*m;if(0==g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=d*y,n[1]=(o*h-p*a)*y,n[2]=(u*a-o*c)*y,n[3]=f*y,n[4]=(p*i-o*l)*y,n[5]=(o*s-u*i)*y,n[6]=m*y,n[7]=(a*l-h*i)*y,n[8]=(c*i-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,n,i,a,o){var s=_a(i),c=wa(i);this.set(r*s,r*c,-r*(s*a+c*o)+a+e,-n*c,n*s,-n*(-c*a+s*o)+o+t,0,0,1)},scale:function(e,t){var r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){var t=_a(e),r=wa(e),n=this.elements,i=n[0],a=n[3],o=n[6],s=n[1],c=n[4],u=n[7];return n[0]=t*i+r*s,n[3]=t*a+r*c,n[6]=t*o+r*u,n[1]=-r*i+t*s,n[4]=-r*a+t*c,n[7]=-r*o+t*u,this},translate:function(e,t){var r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;9>n;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;9>r;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});var hc,pc,dc,fc={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===hc&&(hc=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),hc.width=e.width,hc.height=e.height;var r=hc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=hc}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},mc=0;c.DEFAULT_IMAGE=void 0,c.DEFAULT_MAPPING=300,c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=lc.generateUUID()),!t&&void 0===e.images[n.uuid]){var i;if(Array.isArray(n)){i=[];for(var a=0,o=n.length;a<o;a++)i.push(fc.getDataURL(n[a]))}else i=fc.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case Ho:e.x-=Fa(e.x);break;case Wo:e.x=0>e.x?0:1;break;case Jo:1===Ea(Fa(e.x)%2)?e.x=La(e.x)-e.x:e.x-=Fa(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case Ho:e.y-=Fa(e.y);break;case Wo:e.y=0>e.y?0:1;break;case Jo:1===Ea(Fa(e.y)%2)?e.y=La(e.y)-e.y:e.y-=Fa(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(c.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(u.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(u.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0===e.w?1:e.w,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this):(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this):(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*xa(e.w);var t=Aa(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,a=.01,o=e.elements,s=o[0],c=o[4],u=o[8],l=o[1],h=o[5],p=o[9],d=o[2],f=o[6],m=o[10];if(Ea(c-l)<a&&Ea(u-d)<a&&Ea(p-f)<a){if(Ea(c+l)<.1&&Ea(u+d)<.1&&Ea(p+f)<.1&&Ea(s+h+m-3)<.1)return this.set(1,0,0,0),this;t=Oa;var g=(s+1)/2,v=(h+1)/2,y=(m+1)/2,b=(c+l)/4,x=(u+d)/4,w=(p+f)/4;return g>v&&g>y?g<a?(r=0,n=.707106781,i=.707106781):(n=b/(r=Aa(g)),i=x/r):v>y?v<a?(r=.707106781,n=0,i=.707106781):(r=b/(n=Aa(v)),i=w/n):y<a?(r=.707106781,n=.707106781,i=0):(r=x/(i=Aa(y)),n=w/i),this.set(r,n,i,t),this}var _=Aa((f-p)*(f-p)+(u-d)*(u-d)+(l-c)*(l-c));return.001>Ea(_)&&(_=1),this.x=(f-p)/_,this.y=(u-d)/_,this.z=(l-c)/_,this.w=xa((s+h+m-1)/2),this},min:function(e){return this.x=Ia(this.x,e.x),this.y=Ia(this.y,e.y),this.z=Ia(this.z,e.z),this.w=Ia(this.w,e.w),this},max:function(e){return this.x=Ca(this.x,e.x),this.y=Ca(this.y,e.y),this.z=Ca(this.z,e.z),this.w=Ca(this.w,e.w),this},clamp:function(e,t){return this.x=Ca(e.x,Ia(t.x,this.x)),this.y=Ca(e.y,Ia(t.y,this.y)),this.z=Ca(e.z,Ia(t.z,this.z)),this.w=Ca(e.w,Ia(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Ca(e,Ia(t,this.x)),this.y=Ca(e,Ia(t,this.y)),this.z=Ca(e,Ia(t,this.z)),this.w=Ca(e,Ia(t,this.w)),this},clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Ca(e,Ia(t,r)))},floor:function(){return this.x=Fa(this.x),this.y=Fa(this.y),this.z=Fa(this.z),this.w=Fa(this.w),this},ceil:function(){return this.x=La(this.x),this.y=La(this.y),this.z=La(this.z),this.w=La(this.w),this},round:function(){return this.x=Sa(this.x),this.y=Sa(this.y),this.z=Sa(this.z),this.w=Sa(this.w),this},roundToZero:function(){return this.x=0>this.x?La(this.x):Fa(this.x),this.y=0>this.y?La(this.y):Fa(this.y),this.z=0>this.z?La(this.z):Fa(this.z),this.w=0>this.w?La(this.w):Fa(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Aa(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Ea(this.x)+Ea(this.y)+Ea(this.z)+Ea(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),h.prototype=Object.assign(Object.create(l.prototype),{constructor:h,isWebGLMultisampleRenderTarget:!0,copy:function(e){return l.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(p.prototype,{isMatrix4:!0,set:function(e,t,r,n,i,a,o,s,c,u,l,h,p,d,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=u,g[10]=l,g[14]=h,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new p).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(){var e=new o;return function(t){var r=this.elements,n=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),a=1/e.setFromMatrixColumn(t,1).length(),o=1/e.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*a,r[5]=n[5]*a,r[6]=n[6]*a,r[7]=0,r[8]=n[8]*o,r[9]=n[9]*o,r[10]=n[10]*o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,a=_a(r),o=wa(r),s=_a(n),c=wa(n),u=_a(i),l=wa(i);if("XYZ"===e.order){var h=a*u,p=a*l,d=o*u,f=o*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=p+d*c,t[5]=h-f*c,t[9]=-o*s,t[2]=f-h*c,t[6]=d+p*c,t[10]=a*s}else if("YXZ"===e.order){var m=s*u,g=s*l,v=c*u,y=c*l;t[0]=m+y*o,t[4]=v*o-g,t[8]=a*c,t[1]=a*l,t[5]=a*u,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*u,g=s*l,v=c*u,y=c*l;t[0]=m-y*o,t[4]=-a*l,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*u,t[9]=y-m*o,t[2]=-a*c,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){h=a*u,p=a*l,d=o*u,f=o*l;t[0]=s*u,t[4]=d*c-p,t[8]=h*c+f,t[1]=s*l,t[5]=f*c+h,t[9]=p*c-d,t[2]=-c,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var b=a*s,x=a*c,w=o*s,_=o*c;t[0]=s*u,t[4]=_-b*l,t[8]=w*l+x,t[1]=l,t[5]=a*u,t[9]=-o*u,t[2]=-c*u,t[6]=x*l+w,t[10]=b-_*l}else if("XZY"===e.order){b=a*s,x=a*c,w=o*s,_=o*c;t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=b*l+_,t[5]=a*u,t[9]=x*l-w,t[2]=w*l-x,t[6]=o*u,t[10]=_*l+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(){var e=new o(0,0,0),t=new o(1,1,1);return function(r){return this.compose(e,r,t)}}(),lookAt:function(){var e=new o,t=new o,r=new o;return function(n,i,a){var o=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),e.crossVectors(a,r),0===e.lengthSq()&&(1===Ea(a.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),e.crossVectors(a,r)),e.normalize(),t.crossVectors(r,e),o[0]=e.x,o[4]=t.x,o[8]=r.x,o[1]=e.y,o[5]=t.y,o[9]=r.y,o[2]=e.z,o[6]=t.z,o[10]=r.z,this}}(),multiply:function(e,t){return void 0===t?this.multiplyMatrices(this,e):(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t))},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[4],s=r[8],c=r[12],u=r[1],l=r[5],h=r[9],p=r[13],d=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],b=r[11],x=r[15],w=n[0],_=n[4],T=n[8],E=n[12],A=n[1],S=n[5],M=n[9],L=n[13],N=n[2],R=n[6],C=n[10],I=n[14],O=n[3],P=n[7],F=n[11],k=n[15];return i[0]=a*w+o*A+s*N+c*O,i[4]=a*_+o*S+s*R+c*P,i[8]=a*T+o*M+s*C+c*F,i[12]=a*E+o*L+s*I+c*k,i[1]=u*w+l*A+h*N+p*O,i[5]=u*_+l*S+h*R+p*P,i[9]=u*T+l*M+h*C+p*F,i[13]=u*E+l*L+h*I+p*k,i[2]=d*w+f*A+m*N+g*O,i[6]=d*_+f*S+m*R+g*P,i[10]=d*T+f*M+m*C+g*F,i[14]=d*E+f*L+m*I+g*k,i[3]=v*w+y*A+b*N+x*O,i[7]=v*_+y*S+b*R+x*P,i[11]=v*T+y*M+b*C+x*F,i[15]=v*E+y*L+b*I+x*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new o;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],o=e[5],s=e[9],c=e[13],u=e[2],l=e[6],h=e[10],p=e[14];return e[3]*(+i*s*l-n*c*l-i*o*h+r*c*h+n*o*p-r*s*p)+e[7]*(+t*s*p-t*c*h+i*a*h-n*a*p+n*c*u-i*s*u)+e[11]*(+t*c*l-t*o*p-i*a*l+r*a*p+i*o*u-r*c*u)+e[15]*(-n*o*u-t*s*l+t*o*h+n*a*l-r*a*h+r*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,r){var n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],p=n[8],d=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],b=n[15],x=d*y*h-v*f*h+v*l*m-u*y*m-d*l*b+u*f*b,w=g*f*h-p*y*h-g*l*m+c*y*m+p*l*b-c*f*b,_=p*v*h-g*d*h+g*u*m-c*v*m-p*u*b+c*d*b,T=g*d*l-p*v*l-g*u*f+c*v*f+p*u*y-c*d*y,E=i*x+a*w+o*_+s*T;if(0==E){var A="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(A);return console.warn(A),this.identity()}var S=1/E;return r[0]=x*S,r[1]=(v*f*s-d*y*s-v*o*m+a*y*m+d*o*b-a*f*b)*S,r[2]=(u*y*s-v*l*s+v*o*h-a*y*h-u*o*b+a*l*b)*S,r[3]=(d*l*s-u*f*s-d*o*h+a*f*h+u*o*m-a*l*m)*S,r[4]=w*S,r[5]=(p*y*s-g*f*s+g*o*m-i*y*m-p*o*b+i*f*b)*S,r[6]=(g*l*s-c*y*s-g*o*h+i*y*h+c*o*b-i*l*b)*S,r[7]=(c*f*s-p*l*s+p*o*h-i*f*h-c*o*m+i*l*m)*S,r[8]=_*S,r[9]=(g*d*s-p*v*s-g*a*m+i*v*m+p*a*b-i*d*b)*S,r[10]=(c*v*s-g*u*s+g*a*h-i*v*h-c*a*b+i*u*b)*S,r[11]=(p*u*s-c*d*s-p*a*h+i*d*h+c*a*m-i*u*m)*S,r[12]=T*S,r[13]=(p*v*o-g*d*o+g*a*f-i*v*f-p*a*y+i*d*y)*S,r[14]=(g*u*o-c*v*o-g*a*l+i*v*l+c*a*y-i*u*y)*S,r[15]=(c*d*o-p*u*o+p*a*l-i*d*l-c*a*f+i*u*f)*S,this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Aa(Ca(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=_a(e),r=wa(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=_a(e),r=wa(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=_a(e),r=wa(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=_a(t),n=wa(t),i=1-r,a=e.x,o=e.y,s=e.z,c=i*a,u=i*o;return this.set(c*a+r,c*o-n*s,c*s+n*o,0,c*o+n*s,u*o+r,u*s-n*a,0,c*s-n*o,u*s+n*a,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){var n=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,c=i+i,u=a+a,l=o+o,h=i*c,p=i*u,d=i*l,f=a*u,m=a*l,g=o*l,v=s*c,y=s*u,b=s*l,x=r.x,w=r.y,_=r.z;return n[0]=(1-(f+g))*x,n[1]=(p+b)*x,n[2]=(d-y)*x,n[3]=0,n[4]=(p-b)*w,n[5]=(1-(h+g))*w,n[6]=(m+v)*w,n[7]=0,n[8]=(d+y)*_,n[9]=(m-v)*_,n[10]=(1-(h+f))*_,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(){var e=new o,t=new p;return function(r,n,i){var a=this.elements,o=e.set(a[0],a[1],a[2]).length(),s=e.set(a[4],a[5],a[6]).length(),c=e.set(a[8],a[9],a[10]).length();0>this.determinant()&&(o=-o),r.x=a[12],r.y=a[13],r.z=a[14],t.copy(this);var u=1/o,l=1/s,h=1/c;return t.elements[0]*=u,t.elements[1]*=u,t.elements[2]*=u,t.elements[4]*=l,t.elements[5]*=l,t.elements[6]*=l,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),i.x=o,i.y=s,i.z=c,this}}(),makePerspective:function(e,t,r,n,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements;return o[0]=2*i/(t-e),o[4]=0,o[8]=(t+e)/(t-e),o[12]=0,o[1]=0,o[5]=2*i/(r-n),o[9]=(r+n)/(r-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(a+i)/(a-i),o[14]=-2*a*i/(a-i),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,r,n,i,a){var o=this.elements,s=1/(t-e),c=1/(r-n),u=1/(a-i);return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-(t+e)*s,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-(r+n)*c,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-(a+i)*u,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;16>n;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;16>r;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),d.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],d.DefaultOrder="XYZ",Object.defineProperties(d.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(d.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=Math.asin,i=lc.clamp,a=e.elements,o=a[0],s=a[4],c=a[8],u=a[1],l=a[5],h=a[9],p=a[2],d=a[6],f=a[10];return"XYZ"===(t=t||this._order)?(this._y=n(i(c,-1,1)),.99999>Ea(c)?(this._x=Ta(-h,f),this._z=Ta(-s,o)):(this._x=Ta(d,l),this._z=0)):"YXZ"===t?(this._x=n(-i(h,-1,1)),.99999>Ea(h)?(this._y=Ta(c,f),this._z=Ta(u,l)):(this._y=Ta(-p,o),this._z=0)):"ZXY"===t?(this._x=n(i(d,-1,1)),.99999>Ea(d)?(this._y=Ta(-p,f),this._z=Ta(-s,l)):(this._y=0,this._z=Ta(u,o))):"ZYX"===t?(this._y=n(-i(p,-1,1)),.99999>Ea(p)?(this._x=Ta(d,f),this._z=Ta(u,o)):(this._x=0,this._z=Ta(-s,l))):"YZX"===t?(this._z=n(i(u,-1,1)),.99999>Ea(u)?(this._x=Ta(-h,l),this._y=Ta(-p,o)):(this._x=0,this._y=Ta(c,f))):"XZY"===t?(this._z=n(-i(s,-1,1)),.99999>Ea(s)?(this._x=Ta(d,l),this._y=Ta(c,o)):(this._x=Ta(-h,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,r){return null==pc&&(pc=new p),pc.makeRotationFromQuaternion(e),this.setFromRotationMatrix(pc,t,r)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return null==dc&&(dc=new a),dc.setFromEuler(this),this.setFromQuaternion(dc,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new o(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(f.prototype,{set:function(e){this.mask=0|1<<e},enable:function(e){this.mask|=0|1<<e},toggle:function(e){this.mask^=0|1<<e},disable:function(e){this.mask&=~(0|1<<e)},test:function(e){return 0!=(this.mask&e.mask)}});var gc,vc=0;m.DefaultUp=new o(0,1,0),m.DefaultMatrixAutoUpdate=!0,m.prototype=Object.assign(Object.create(n.prototype),{constructor:m,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new a;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new a;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new o(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new o(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new o(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new o;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new o(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new o(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new o(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new p;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new a,t=new p,r=new o,n=new o;return function(i,a,o){i.isVector3?r.copy(i):r.set(i,a,o);var s=this.parent;this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(n,r,this.up):t.lookAt(r,n,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent({type:"added"})):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var r=this.children.indexOf(e);return-1!==r&&(e.parent=null,this.children.splice(r,1),e.dispatchEvent({type:"removed"})),this},attach:function(){var e=new p;return function(t){return this.updateWorldMatrix(!0,!1),e.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),e.multiply(t.parent.matrixWorld)),t.applyMatrix(e),t.updateWorldMatrix(!1,!1),this.add(t),this}}(),getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new o),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new o,t=new o;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,r,t),r}}(),getWorldScale:function(){var e=new o,t=new a;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new o),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,r),r}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new o),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var n=this.children,i=0,a=n.length;i<a;i++)n[i].updateWorldMatrix(!1,!0)},toJSON:function(e){function t(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}function r(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}var n=void 0===e||"string"==typeof e,i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var a={};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==Ys&&(a.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){a.geometry=t(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var s=o.shapes;if(Array.isArray(s))for(var c,u=0,l=s.length;u<l;u++)c=s[u],t(e.shapes,c);else t(e.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var h=[];for(u=0,l=this.material.length;u<l;u++)h.push(t(e.materials,this.material[u]));a.material=h}else a.material=t(e.materials,this.material);if(0<this.children.length){a.children=[];for(u=0;u<this.children.length;u++)a.children.push(this.children[u].toJSON(e).object)}if(n){var p=r(e.geometries),d=r(e.materials),f=r(e.textures),m=r(e.images);s=r(e.shapes);0<p.length&&(i.geometries=p),0<d.length&&(i.materials=d),0<f.length&&(i.textures=f),0<m.length&&(i.images=m),0<s.length&&(i.shapes=s)}return i.object=a,i},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r,n=0;n<e.children.length;n++)r=e.children[n],this.add(r.clone());return this}}),g.prototype=Object.assign(Object.create(m.prototype),{constructor:g,isScene:!0,copy:function(e,t){return m.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=m.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(v.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2];u<t&&(t=u),l<r&&(r=l),h<n&&(n=h),u>i&&(i=u),l>a&&(a=l),h>o&&(o=h)}return this.min.set(t,r,n),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),h=e.getZ(s);u<t&&(t=u),l<r&&(r=l),h<n&&(n=h),u>i&&(i=u),l>a&&(a=l),h>o&&(o=h)}return this.min.set(t,r,n),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new o;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new o),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new o),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){function e(e){var a=e.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(r=0,n=o.length;r<n;r++)i.copy(o[r]),i.applyMatrix4(e.matrixWorld),t.expandByPoint(i)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(r=0,n=s.count;r<n;r++)i.fromBufferAttribute(s,r).applyMatrix4(e.matrixWorld),t.expandByPoint(i)}}var t,r,n,i=new o;return function(r){return t=this,r.updateMatrixWorld(!0),r.traverse(e),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new o),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new o;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;return 0<e.normal.x?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant},intersectsTriangle:function(){function e(e){var i,a;for(i=0,a=e.length-3;i<=a;i+=3){c.fromArray(e,i);var o=l.x*Ea(c.x)+l.y*Ea(c.y)+l.z*Ea(c.z),s=t.dot(c),u=r.dot(c),h=n.dot(c);if(Ca(-Ca(s,u,h),Ia(s,u,h))>o)return!1}return!0}var t=new o,r=new o,n=new o,i=new o,a=new o,s=new o,c=new o,u=new o,l=new o,h=new o;return function(o){if(this.isEmpty())return!1;this.getCenter(u),l.subVectors(this.max,u),t.subVectors(o.a,u),r.subVectors(o.b,u),n.subVectors(o.c,u),i.subVectors(r,t),a.subVectors(n,r),s.subVectors(t,n);var c=[0,-i.z,i.y,0,-a.z,a.y,0,-s.z,s.y,i.z,0,-i.x,a.z,0,-a.x,s.z,0,-s.x,-i.y,i.x,0,-a.y,a.x,0,-s.y,s.x,0];return!!e(c)&&!!e(c=[1,0,0,0,1,0,0,0,1])&&(h.crossVectors(i,a),e(c=[h.x,h.y,h.z]))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new o),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new o;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new o;return function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new o,new o,new o,new o,new o,new o,new o,new o];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(y.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){null==gc&&(gc=new v);var r=this.center;void 0===t?gc.setFromPoints(e).getCenter(r):r.copy(t);for(var n=0,i=0,a=e.length;i<a;i++)n=Ca(n,r.distanceToSquared(e[i]));return this.radius=Aa(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Ea(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new o),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new v),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(b.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new o),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new o;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new o),t.subVectors(e,this.origin);var r=t.dot(this.direction);return 0>r?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Aa(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new o;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new o,t=new o,r=new o;return function(n,i,a,o){e.copy(n).add(i).multiplyScalar(.5),t.copy(i).sub(n).normalize(),r.copy(this.origin).sub(e);var s,c,u,l,h=.5*n.distanceTo(i),p=-this.direction.dot(t),d=r.dot(this.direction),f=-r.dot(t),m=r.lengthSq(),g=Ea(1-p*p);if(0<g)if(c=p*d-f,l=h*g,0<=(s=p*f-d))if(c>=-l)if(c<=l){var v=1/g;u=(s*=v)*(s+p*(c*=v)+2*d)+c*(p*s+c+2*f)+m}else u=-(s=Ca(0,-(p*(c=h)+d)))*s+c*(c+2*f)+m;else u=-(s=Ca(0,-(p*(c=-h)+d)))*s+c*(c+2*f)+m;else c<=-l?u=-(s=Ca(0,-(-p*h+d)))*s+(c=0<s?-h:Ia(Ca(-h,-f),h))*(c+2*f)+m:c<=l?(s=0,u=(c=Ia(Ca(-h,-f),h))*(c+2*f)+m):u=-(s=Ca(0,-(p*h+d)))*s+(c=0<s?h:Ia(Ca(-h,-f),h))*(c+2*f)+m;else u=-(s=Ca(0,-(p*(c=0<p?-h:h)+d)))*s+c*(c+2*f)+m;return a&&a.copy(this.direction).multiplyScalar(s).add(this.origin),o&&o.copy(t).multiplyScalar(c).add(e),u}}(),intersectSphere:function(){var e=new o;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,a=t.radius*t.radius;if(i>a)return null;var o=Aa(a-i),s=n-o,c=n+o;return 0>s&&0>c?null:0>s?this.at(c,r):this.at(s,r)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=r?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||!!(0>e.normal.dot(this.direction)*t)},intersectBox:function(e,t){var r,n,i,a,o,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,h=this.origin;return 0<=c?(r=(e.min.x-h.x)*c,n=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,n=(e.min.x-h.x)*c),0<=u?(i=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),r>a||i>n?null:((i>r||r!=r)&&(r=i),(a<n||n!=n)&&(n=a),0<=l?(o=(e.min.z-h.z)*l,s=(e.max.z-h.z)*l):(o=(e.max.z-h.z)*l,s=(e.min.z-h.z)*l),r>s||o>n?null:((o>r||r!=r)&&(r=o),(s<n||n!=n)&&(n=s),0>n?null:this.at(0<=r?r:n,t)))},intersectsBox:function(){var e=new o;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new o,t=new o,r=new o,n=new o;return function(i,a,o,s,c){t.subVectors(a,i),r.subVectors(o,i),n.crossVectors(t,r);var u,l=this.direction.dot(n);if(0<l){if(s)return null;u=1}else{if(!(0>l))return null;u=-1,l=-l}e.subVectors(this.origin,i);var h=u*this.direction.dot(r.crossVectors(e,r));if(0>h)return null;var p=u*this.direction.dot(t.cross(e));if(0>p)return null;if(h+p>l)return null;var d=-u*e.dot(n);return 0>d?null:this.at(d/l,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(x,{getNormal:function(){var e=new o;return function(t,r,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new o),i.subVectors(n,r),e.subVectors(t,r),i.cross(e);var a=i.lengthSq();return 0<a?i.multiplyScalar(1/Aa(a)):i.set(0,0,0)}}(),getBarycoord:function(){var e=new o,t=new o,r=new o;return function(n,i,a,s,c){e.subVectors(s,i),t.subVectors(a,i),r.subVectors(n,i);var u=e.dot(e),l=e.dot(t),h=e.dot(r),p=t.dot(t),d=t.dot(r),f=u*p-l*l;if(void 0===c&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),c=new o),0==f)return c.set(-2,-1,-1);var m=1/f,g=(p*h-l*d)*m,v=(u*d-l*h)*m;return c.set(1-g-v,v,g)}}(),containsPoint:function(){var e=new o;return function(t,r,n,i){return x.getBarycoord(t,r,n,i,e),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),getUV:function(){var e=new o;return function(t,r,n,i,a,o,s,c){return this.getBarycoord(t,r,n,i,e),c.set(0,0),c.addScaledVector(a,e.x),c.addScaledVector(o,e.y),c.addScaledVector(s,e.z),c}}(),isFrontFacing:function(){var e=new o,t=new o;return function(r,n,i,a){return e.subVectors(i,n),t.subVectors(r,n),!!(0>e.cross(t).dot(a))}}()}),Object.assign(x.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new o,t=new o;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new o),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return x.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new o),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return x.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,r,n,i){return x.getUV(e,this.a,this.b,this.c,t,r,n,i)},containsPoint:function(e){return x.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return x.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new o,t=new o,r=new o,n=new o,i=new o,a=new o;return function(s,c){void 0===c&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),c=new o);var u,l,h=this.a,p=this.b,d=this.c;e.subVectors(p,h),t.subVectors(d,h),n.subVectors(s,h);var f=e.dot(n),m=t.dot(n);if(0>=f&&0>=m)return c.copy(h);i.subVectors(s,p);var g=e.dot(i),v=t.dot(i);if(0<=g&&v<=g)return c.copy(p);var y=f*v-g*m;if(0>=y&&0<=f&&0>=g)return u=f/(f-g),c.copy(h).addScaledVector(e,u);a.subVectors(s,d);var b=e.dot(a),x=t.dot(a);if(0<=x&&b<=x)return c.copy(d);var w=b*m-f*x;if(0>=w&&0<=m&&0>=x)return l=m/(m-x),c.copy(h).addScaledVector(t,l);var _=g*x-b*v;if(0>=_&&0<=v-g&&0<=b-x)return r.subVectors(d,p),l=(v-g)/(v-g+(b-x)),c.copy(p).addScaledVector(r,l);var T=1/(_+w+y);return u=w*T,l=y*T,c.copy(h).addScaledVector(e,u).addScaledVector(t,l)}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var yc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(w.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Fa(e),this.r=(255&e>>16)/255,this.g=(255&e>>8)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(e,t,r){if(e=lc.euclideanModulo(e,1),t=lc.clamp(t,0,1),r=lc.clamp(r,0,1),0===t)this.r=this.g=this.b=r;else{var n=.5>=r?r*(1+t):r+t-r*t,i=2*r-n;this.r=_(i,n,e+1/3),this.g=_(i,n,e),this.b=_(i,n,e-1/3)}return this},setStyle:function(e){function t(t){void 0===t||1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,i=r[1],a=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Ia(255,parseInt(n[1],10))/255,this.g=Ia(255,parseInt(n[2],10))/255,this.b=Ia(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Ia(100,parseInt(n[1],10))/100,this.g=Ia(100,parseInt(n[2],10))/100,this.b=Ia(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(o,s,c)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u,l=(u=r[1]).length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}e&&0<e.length&&(void 0===(u=yc[e])?console.warn("THREE.Color: Unknown color "+e):this.setHex(u));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Ma(e.r,t),this.g=Ma(e.g,t),this.b=Ma(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=0<t?1/t:1;return this.r=Ma(e.r,r),this.g=Ma(e.g,r),this.b=Ma(e.b,r),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=T(e.r),this.g=T(e.g),this.b=T(e.b),this},copyLinearToSRGB:function(e){return this.r=E(e.r),this.g=E(e.g),this.b=E(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,r,n=this.r,i=this.g,a=this.b,o=Ca(n,i,a),s=Ia(n,i,a),c=(s+o)/2;if(s===o)t=0,r=0;else{var u=o-s;r=.5>=c?u/(o+s):u/(2-o-s),o===n?t=(i-a)/u+(i<a?6:0):o===i?t=(a-n)/u+2:o===a&&(t=(n-i)/u+4),t/=6}return e.h=t,e.s=r,e.l=c,e},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(){var e={};return function(t,r,n){return this.getHSL(e),e.h+=t,e.s+=r,e.l+=n,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Ca(0,this.r-e.r),this.g=Ca(0,this.g-e.g),this.b=Ca(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(){var e={h:0,s:0,l:0},t={h:0,s:0,l:0};return function(r,n){this.getHSL(e),r.getHSL(t);var i=lc.lerp(e.h,t.h,n),a=lc.lerp(e.s,t.s,n),o=lc.lerp(e.l,t.l,n);return this.setHSL(i,a,o),this}}(),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Object.assign(A.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var bc=0;S.prototype=Object.assign(Object.create(n.prototype),{constructor:S,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r)if("shading"!=t){var n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){function t(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}var r=void 0===e||"string"==typeof e;r&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Qa&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==Wa&&(n.side=this.side),this.vertexColors!==Ya&&(n.vertexColors=this.vertexColors),1>this.opacity&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilMask=this.stencilMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),r){var i=t(e.textures),a=t(e.images);0<i.length&&(n.textures=i),0<a.length&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWrite=e.stencilWrite,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilMask=e.stencilMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var n=t.length;r=Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),M.prototype=Object.create(S.prototype),M.prototype.constructor=M,M.prototype.isMeshBasicMaterial=!0,M.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.defineProperty(L.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(L.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0===e?0:e.length/this.itemSize,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t,r=this.array,n=0,i=0,a=e.length;i<a;i++)void 0===(t=e[i])&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),t=new w),r[n++]=t.r,r[n++]=t.g,r[n++]=t.b;return this},copyVector2sArray:function(e){for(var t,r=this.array,n=0,a=0,o=e.length;a<o;a++)void 0===(t=e[a])&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",a),t=new i),r[n++]=t.x,r[n++]=t.y;return this},copyVector3sArray:function(e){for(var t,r=this.array,n=0,i=0,a=e.length;i<a;i++)void 0===(t=e[i])&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),t=new o),r[n++]=t.x,r[n++]=t.y,r[n++]=t.z;return this},copyVector4sArray:function(e){for(var t,r=this.array,n=0,i=0,a=e.length;i<a;i++)void 0===(t=e[i])&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),t=new u),r[n++]=t.x,r[n++]=t.y,r[n++]=t.z,r[n++]=t.w;return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),N.prototype=Object.create(L.prototype),N.prototype.constructor=N,R.prototype=Object.create(L.prototype),R.prototype.constructor=R,C.prototype=Object.create(L.prototype),C.prototype.constructor=C,I.prototype=Object.create(L.prototype),I.prototype.constructor=I,O.prototype=Object.create(L.prototype),O.prototype.constructor=O,P.prototype=Object.create(L.prototype),P.prototype.constructor=P,F.prototype=Object.create(L.prototype),F.prototype.constructor=F,k.prototype=Object.create(L.prototype),k.prototype.constructor=k,D.prototype=Object.create(L.prototype),D.prototype.constructor=D,Object.assign(U.prototype,{computeGroups:function(e){for(var t,r,n=[],i=void 0,a=e.faces,o=0;o<a.length;o++)(r=a[o]).materialIndex!==i&&(i=r.materialIndex,null!=t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:i});void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,r=e.faces,n=e.vertices,a=e.faceVertexUvs,o=a[0]&&0<a[0].length,s=a[1]&&0<a[1].length,c=e.morphTargets,u=c.length;if(0<u){t=[];for(var l=0;l<u;l++)t[l]={name:c[l].name,data:[]};this.morphTargets.position=t}var h,p=e.morphNormals,d=p.length;if(0<d){h=[];for(l=0;l<d;l++)h[l]={name:p[l].name,data:[]};this.morphTargets.normal=h}var f=e.skinIndices,m=e.skinWeights,g=f.length===n.length,v=m.length===n.length;0<n.length&&0===r.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");var y;for(l=0;l<r.length;l++){y=r[l],this.vertices.push(n[y.a],n[y.b],n[y.c]);var b=y.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var x=y.normal;this.normals.push(x,x,x)}var w,_=y.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var T=y.color;this.colors.push(T,T,T)}if(!0===o)void 0===(w=a[0][l])?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new i,new i,new i)):this.uvs.push(w[0],w[1],w[2]);if(!0===s)void 0===(w=a[1][l])?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new i,new i,new i)):this.uvs2.push(w[0],w[1],w[2]);for(var E,A=0;A<u;A++)E=c[A].vertices,t[A].data.push(E[y.a],E[y.b],E[y.c]);var S;for(A=0;A<d;A++)S=p[A].vertexNormals[l],h[A].data.push(S.a,S.b,S.c);g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var xc=1;z.prototype=Object.assign(Object.create(n.prototype),{constructor:z,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){this.index=Array.isArray(e)?new(65535<B(e)?F:O)(e,1):e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new L(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0===r?0:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new s).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);var n=this.attributes.tangent;void 0!==n&&((new s).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new p;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new p;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new p;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new p;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new p;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new m;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new o;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new k(3*t.vertices.length,3),n=new k(3*t.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new k(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t,r=[],n=0,i=e.length;n<i;n++)t=e[n],r.push(t.x,t.y,t.z||0);return this.addAttribute("position",new k(r,3)),this},updateFromObject:function(e){var t,r=e.geometry;if(e.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(r.vertices),t.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(r.normals),t.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(r.colors),t.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(r.uvs),t.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(r.lineDistances),t.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(e.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new U).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new L(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new L(r,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new L(n,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new L(i,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new L(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[o],u=0,l=c.length;u<l;u++){var h=c[u],p=new k(3*h.data.length,3);p.name=h.name,s.push(p.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(0<e.skinIndices.length){var d=new k(4*e.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var f=new k(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){var e=new v;return function(){null===this.boundingBox&&(this.boundingBox=new v);var t=this.attributes.position,r=this.morphAttributes.position;if(void 0===t)this.boundingBox.makeEmpty();else if(this.boundingBox.setFromBufferAttribute(t),r)for(var n,i=0,a=r.length;i<a;i++)n=r[i],e.setFromBufferAttribute(n),this.boundingBox.expandByPoint(e.min),this.boundingBox.expandByPoint(e.max);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new v,t=new v,r=new o;return function(){null===this.boundingSphere&&(this.boundingSphere=new y);var n=this.attributes.position,i=this.morphAttributes.position;if(n){var a=this.boundingSphere.center;if(e.setFromBufferAttribute(n),i)for(var o=0,s=i.length;o<s;o++)u=i[o],t.setFromBufferAttribute(u),e.expandByPoint(t.min),e.expandByPoint(t.max);e.getCenter(a);var c=0;for(o=0,s=n.count;o<s;o++)r.fromBufferAttribute(n,o),c=Ca(c,a.distanceToSquared(r));if(i){var u;for(o=0,s=i.length;o<s;o++)for(var l=0,h=(u=i[o]).count;l<h;l++)r.fromBufferAttribute(u,l),c=Ca(c,a.distanceToSquared(r))}this.boundingSphere.radius=Aa(c),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new L(new Float32Array(r.length),3));else for(var n=t.normal.array,i=0,a=n.length;i<a;i++)n[i]=0;var s,c,u,l=t.normal.array,h=new o,p=new o,d=new o,f=new o,m=new o;if(e){var g=e.array;for(i=0,a=e.count;i<a;i+=3)s=3*g[i+0],c=3*g[i+1],u=3*g[i+2],h.fromArray(r,s),p.fromArray(r,c),d.fromArray(r,u),f.subVectors(d,p),m.subVectors(h,p),f.cross(m),l[s]+=f.x,l[s+1]+=f.y,l[s+2]+=f.z,l[c]+=f.x,l[c+1]+=f.y,l[c+2]+=f.z,l[u]+=f.x,l[u+1]+=f.y,l[u+2]+=f.z}else for(i=0,a=r.length;i<a;i+=9)h.fromArray(r,i),p.fromArray(r,i+3),d.fromArray(r,i+6),f.subVectors(d,p),m.subVectors(h,p),f.cross(m),l[i]=f.x,l[i+1]=f.y,l[i+2]=f.z,l[i+3]=f.x,l[i+4]=f.y,l[i+5]=f.z,l[i+6]=f.x,l[i+7]=f.y,l[i+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,a=e.attributes[n],o=a.array,s=a.itemSize*t,c=Ia(o.length,i.length-s),u=0,l=s;u<c;u++,l++)i[l]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new o;return function(){for(var t=this.attributes.normal,r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.normalize(),t.setXYZ(r,e.x,e.y,e.z)}}(),toNonIndexed:function(){function e(e,t){for(var r=e.array,n=e.itemSize,i=new r.constructor(t.length*n),a=0,o=0,s=0,c=t.length;s<c;s++){a=t[s]*n;for(var u=0;u<n;u++)i[o++]=r[a++]}return new L(i,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new z,r=this.index.array,n=this.attributes;for(var i in n){var a=e(n[i],r);t.addAttribute(i,a)}var o=this.morphAttributes;for(i in o){for(var s=[],c=o[i],u=0,l=c.length;u<l;u++){a=e(c[u],r);s.push(a)}t.morphAttributes[i]=s}for(var h,p=this.groups,d=(u=0,p.length);u<d;u++)h=p[u],t.addGroup(h.start,h.count,h.materialIndex);return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var i=this.attributes;for(var r in i){var a=(p=i[r]).toJSON();""!==p.name&&(a.name=p.name),e.data.attributes[r]=a}var o={},s=!1;for(var r in this.morphAttributes){for(var c=this.morphAttributes[r],u=[],l=0,h=c.length;l<h;l++){var p;a=(p=c[l]).toJSON();""!==p.name&&(a.name=p.name),u.push(a)}0<u.length&&(o[r]=u,s=!0)}s&&(e.data.morphAttributes=o);var d=this.groups;0<d.length&&(e.data.groups=JSON.parse(JSON.stringify(d)));var f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e},clone:function(){return(new z).copy(this)},copy:function(e){var t,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var c=[],u=s[t];for(r=0,n=u.length;r<n;r++)c.push(u[r].clone());this.morphAttributes[t]=c}var l=e.groups;for(r=0,n=l.length;r<n;r++){var h=l[r];this.addGroup(h.start,h.count,h.materialIndex)}var p=e.boundingBox;null!==p&&(this.boundingBox=p.clone());var d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),G.prototype=Object.assign(Object.create(m.prototype),{constructor:G,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return m.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,a=Object.keys(i);if(0<a.length){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)r=o[e].name||e+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;void 0!==s&&0<s.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(){function e(e,t,r,n,i,a,o,s){if(null===(t.side===Ja?n.intersectTriangle(o,a,i,!0,s):n.intersectTriangle(i,a,o,t.side!==Xa,s)))return null;E.copy(s),E.applyMatrix4(e.matrixWorld);var c=r.ray.origin.distanceTo(E);return c<r.near||c>r.far?null:{distance:c,point:E.clone(),object:e}}function t(t,r,n,a,o,p,y,b,E,S,M){s.fromBufferAttribute(o,E),c.fromBufferAttribute(o,S),u.fromBufferAttribute(o,M);var L=t.morphTargetInfluences;if(r.morphTargets&&p&&L){f.set(0,0,0),m.set(0,0,0),g.set(0,0,0);for(var N=0,R=p.length;N<R;N++){var C=L[N],I=p[N];0===C||(l.fromBufferAttribute(I,E),h.fromBufferAttribute(I,S),d.fromBufferAttribute(I,M),f.addScaledVector(l.sub(s),C),m.addScaledVector(h.sub(c),C),g.addScaledVector(d.sub(u),C))}s.add(f),c.add(m),u.add(g)}var O=e(t,r,n,a,s,c,u,T);if(O){y&&(v.fromBufferAttribute(y,E),w.fromBufferAttribute(y,S),_.fromBufferAttribute(y,M),O.uv=x.getUV(T,s,c,u,v,w,_,new i)),b&&(v.fromBufferAttribute(b,E),w.fromBufferAttribute(b,S),_.fromBufferAttribute(b,M),O.uv2=x.getUV(T,s,c,u,v,w,_,new i));var P=new A(E,S,M);x.getNormal(s,c,u,P.normal),O.face=P}return O}var r=new p,n=new b,a=new y,s=new o,c=new o,u=new o,l=new o,h=new o,d=new o,f=new o,m=new o,g=new o,v=new i,w=new i,_=new i,T=new o,E=new o;return function(o,s){var c,u=this.geometry,l=this.material,h=this.matrixWorld;if(void 0!==l&&(null===u.boundingSphere&&u.computeBoundingSphere(),a.copy(u.boundingSphere),a.applyMatrix4(h),!1!==o.ray.intersectsSphere(a))&&(r.getInverse(h),n.copy(o.ray).applyMatrix4(r),null===u.boundingBox||!1!==n.intersectsBox(u.boundingBox)))if(u.isBufferGeometry){var p,d,f,m,g,y,b,E,A,S=u.index,M=u.attributes.position,L=u.morphAttributes.position,N=u.attributes.uv,R=u.attributes.uv2,C=u.groups,I=u.drawRange;if(null!==S)if(Array.isArray(l))for(m=0,y=C.length;m<y;m++)for(A=l[(E=C[m]).materialIndex],g=Ca(E.start,I.start),b=Ia(E.start+E.count,I.start+I.count);g<b;g+=3)p=S.getX(g),d=S.getX(g+1),f=S.getX(g+2),(c=t(this,A,o,n,M,L,N,R,p,d,f))&&(c.faceIndex=Fa(g/3),c.face.materialIndex=E.materialIndex,s.push(c));else for(m=Ca(0,I.start),y=Ia(S.count,I.start+I.count);m<y;m+=3)p=S.getX(m),d=S.getX(m+1),f=S.getX(m+2),(c=t(this,l,o,n,M,L,N,R,p,d,f))&&(c.faceIndex=Fa(m/3),s.push(c));else if(void 0!==M)if(Array.isArray(l))for(m=0,y=C.length;m<y;m++)for(A=l[(E=C[m]).materialIndex],g=Ca(E.start,I.start),b=Ia(E.start+E.count,I.start+I.count);g<b;g+=3)(c=t(this,A,o,n,M,L,N,R,p=g,d=g+1,f=g+2))&&(c.faceIndex=Fa(g/3),c.face.materialIndex=E.materialIndex,s.push(c));else for(m=Ca(0,I.start),y=Ia(M.count,I.start+I.count);m<y;m+=3)(c=t(this,l,o,n,M,L,N,R,p=m,d=m+1,f=m+2))&&(c.faceIndex=Fa(m/3),s.push(c))}else if(u.isGeometry){var O,P,F,k,D=Array.isArray(l),U=u.vertices,B=u.faces,z=u.faceVertexUvs[0];0<z.length&&(k=z);for(var G=0,j=B.length;G<j;G++){var V=B[G],H=D?l[V.materialIndex]:l;if(void 0!==H&&(O=U[V.a],P=U[V.b],F=U[V.c],c=e(this,H,o,n,O,P,F,T))){if(k&&k[G]){var W=k[G];v.copy(W[0]),w.copy(W[1]),_.copy(W[2]),c.uv=x.getUV(T,O,P,F,v,w,_,new i)}c.face=V,c.faceIndex=G,s.push(c)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var wc=0;j.prototype=Object.assign(Object.create(n.prototype),{constructor:j,isGeometry:!0,applyMatrix:function(e){for(var t=(new s).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++)this.vertices[r].applyMatrix4(e);var i;for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).normal.applyMatrix3(t).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new p;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new p;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new p;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new p;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new p;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new m;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){function t(e,t,n,a){var s=void 0===u?[]:[r.colors[e].clone(),r.colors[t].clone(),r.colors[n].clone()],p=new A(e,t,n,void 0===c?[]:[(new o).fromArray(c,3*e),(new o).fromArray(c,3*t),(new o).fromArray(c,3*n)],s,a);r.faces.push(p),void 0!==l&&r.faceVertexUvs[0].push([(new i).fromArray(l,2*e),(new i).fromArray(l,2*t),(new i).fromArray(l,2*n)]),void 0!==h&&r.faceVertexUvs[1].push([(new i).fromArray(h,2*e),(new i).fromArray(h,2*t),(new i).fromArray(h,2*n)])}var r=this,n=null===e.index?void 0:e.index.array,a=e.attributes,s=a.position.array,c=void 0===a.normal?void 0:a.normal.array,u=void 0===a.color?void 0:a.color.array,l=void 0===a.uv?void 0:a.uv.array,h=void 0===a.uv2?void 0:a.uv2.array;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var p=0;p<s.length;p+=3)r.vertices.push((new o).fromArray(s,p)),void 0!==u&&r.colors.push((new w).fromArray(u,p));var d=e.groups;if(0<d.length)for(p=0;p<d.length;p++)for(var f=d[p],m=f.start,g=f.count,v=m;v<m+g;v+=3)void 0===n?t(v,v+1,v+2,f.materialIndex):t(n[v],n[v+1],n[v+2],f.materialIndex);else if(void 0!==n)for(p=0;p<n.length;p+=3)t(n[p],n[p+1],n[p+2]);else for(p=0;p<s.length/3;p+=3)t(p,p+1,p+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new o;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new p;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new o,t=new o,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],a=this.vertices[i.a],s=this.vertices[i.b],c=this.vertices[i.c];e.subVectors(c,s),t.subVectors(a,s),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,i,a,s;for(void 0===e&&(e=!0),s=Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)s[t]=new o;if(e){var c,u,l,h=new o,p=new o;for(n=0,i=this.faces.length;n<i;n++)a=this.faces[n],c=this.vertices[a.a],u=this.vertices[a.b],l=this.vertices[a.c],h.subVectors(l,u),p.subVectors(c,u),h.cross(p),s[a.a].add(h),s[a.b].add(h),s[a.c].add(h)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)s[(a=this.faces[n]).a].add(a.normal),s[a.b].add(a.normal),s[a.c].add(a.normal);for(t=0,r=this.vertices.length;t<r;t++)s[t].normalize();for(n=0,i=this.faces.length;n<i;n++){var d=(a=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(s[a.a]),d[1].copy(s[a.b]),d[2].copy(s[a.c])):(d[0]=s[a.a].clone(),d[1]=s[a.b].clone(),d[2]=s[a.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(r=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var a=new j;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var s=this.morphNormals[e].faceNormals,c=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)u=new o,l={a:new o,b:new o,c:new o},s.push(u),c.push(l)}var u,l,h=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],u=h.faceNormals[r],l=h.vertexNormals[r],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new v),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new y),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e&&e.isGeometry){var n,i=this.vertices.length,a=this.vertices,o=e.vertices,c=this.faces,u=e.faces,l=this.colors,h=e.colors;void 0===r&&(r=0),void 0!==t&&(n=(new s).getNormalMatrix(t));for(var p=0,d=o.length;p<d;p++){var f=o[p].clone();void 0!==t&&f.applyMatrix4(t),a.push(f)}for(p=0,d=h.length;p<d;p++)l.push(h[p].clone());for(p=0,d=u.length;p<d;p++){var m,g,v,y=u[p],b=y.vertexNormals,x=y.vertexColors;(m=new A(y.a+i,y.b+i,y.c+i)).normal.copy(y.normal),void 0!==n&&m.normal.applyMatrix3(n).normalize();for(var w=0,_=b.length;w<_;w++)g=b[w].clone(),void 0!==n&&g.applyMatrix3(n).normalize(),m.vertexNormals.push(g);m.color.copy(y.color);for(w=0,_=x.length;w<_;w++)v=x[w],m.vertexColors.push(v.clone());m.materialIndex=y.materialIndex+r,c.push(m)}var T;for(p=0,d=e.faceVertexUvs.length;p<d;p++){T=e.faceVertexUvs[p],void 0===this.faceVertexUvs[p]&&(this.faceVertexUvs[p]=[]);for(w=0,_=T.length;w<_;w++){for(var E=T[w],S=[],M=0,L=E.length;M<L;M++)S.push(E[M].clone());this.faceVertexUvs[p].push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){return e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),void this.merge(e.geometry,e.matrix)):void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,r,n,i,a,o,s,c={},u=[],l=[];for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],void 0===c[t=Sa(1e4*e.x)+"_"+Sa(1e4*e.y)+"_"+Sa(1e4*e.z)]?(c[t]=r,u.push(this.vertices[r]),l[r]=u.length-1):l[r]=l[c[t]];var h=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],a=[i.a,i.b,i.c];for(var p=0;3>p;p++)if(a[p]===a[(p+1)%3]){h.push(r);break}}for(r=h.length-1;0<=r;r--){var d=h[r];for(this.faces.splice(d,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(d,1)}var f=this.vertices.length-u.length;return this.vertices=u,f},setFromPoints:function(e){this.vertices=[];for(var t,r=0,n=e.length;r<n;r++)t=e[r],this.vertices.push(new o(t.x,t.y,t.z||0));return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(n=[]),o&&o.length===t&&(i=[]);var s;for(r=0;r<t;r++)s=e[r]._id,n&&n.push(a[s]),i&&i.push(o[s]);n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function e(e,t,r){return r?e|1<<t:e&~(1<<t)}function t(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0===p[t]?(p[t]=h.length/3,h.push(e.x,e.y,e.z),p[t]):p[t]}function r(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0===f[t]?(f[t]=d.length,d.push(e.getHex()),f[t]):f[t]}function n(e){var t=e.x.toString()+e.y.toString();return void 0===g[t]?(g[t]=m.length/2,m.push(e.x,e.y),g[t]):g[t]}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var a=this.parameters;for(var o in a)void 0!==a[o]&&(i[o]=a[o]);return i}for(var s,c=[],u=0;u<this.vertices.length;u++)s=this.vertices[u],c.push(s.x,s.y,s.z);var l=[],h=[],p={},d=[],f={},m=[],g={};for(u=0;u<this.faces.length;u++){var v=this.faces[u],y=void 0!==this.faceVertexUvs[0][u],b=0<v.normal.length(),x=0<v.vertexNormals.length,w=1!==v.color.r||1!==v.color.g||1!==v.color.b,_=0<v.vertexColors.length,T=0;if(T=e(T,0,0),T=e(T,1,!0),T=e(T,2,!1),T=e(T,3,y),T=e(T,4,b),T=e(T,5,x),T=e(T,6,w),T=e(T,7,_),l.push(T),l.push(v.a,v.b,v.c),l.push(v.materialIndex),y){var E=this.faceVertexUvs[0][u];l.push(n(E[0]),n(E[1]),n(E[2]))}if(b&&l.push(t(v.normal)),x){var A=v.vertexNormals;l.push(t(A[0]),t(A[1]),t(A[2]))}if(w&&l.push(r(v.color)),_){var S=v.vertexColors;l.push(r(S[0]),r(S[1]),r(S[2]))}}return i.data={},i.data.vertices=c,i.data.normals=h,0<d.length&&(i.data.colors=d),0<m.length&&(i.data.uvs=[m]),i.data.faces=l,i},clone:function(){return(new j).copy(this)},copy:function(e){var t,r,n,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,r=c.length;t<r;t++)this.colors.push(c[t].clone());var u=e.faces;for(t=0,r=u.length;t<r;t++)this.faces.push(u[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var l=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,i=l.length;n<i;n++){var h=l[n],p=[];for(a=0,o=h.length;a<o;a++){var d=h[a];p.push(d.clone())}this.faceVertexUvs[t].push(p)}}var f=e.morphTargets;for(t=0,r=f.length;t<r;t++){var m={name:f[t].name};if(void 0!==f[t].vertices)for(m.vertices=[],n=0,i=f[t].vertices.length;n<i;n++)m.vertices.push(f[t].vertices[n].clone());if(void 0!==f[t].normals)for(m.normals=[],n=0,i=f[t].normals.length;n<i;n++)m.normals.push(f[t].normals[n].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,r=g.length;t<r;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],n=0,i=g[t].vertexNormals.length;n<i;n++){var y=g[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],n=0,i=g[t].faceNormals.length;n<i;n++)v.faceNormals.push(g[t].faceNormals[n].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(t=0,r=x.length;t<r;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,r=w.length;t<r;t++)this.skinIndices.push(w[t].clone());var _=e.lineDistances;for(t=0,r=_.length;t<r;t++)this.lineDistances.push(_[t]);var T=e.boundingBox;null!==T&&(this.boundingBox=T.clone());var E=e.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),V.prototype=Object.create(j.prototype),V.prototype.constructor=V,H.prototype=Object.create(z.prototype),H.prototype.constructor=H;var _c={clone:W,merge:J},Tc="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Ec="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";X.prototype=Object.create(S.prototype),X.prototype.constructor=X,X.prototype.isShaderMaterial=!0,X.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=W(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},X.prototype.toJSON=function(e){var t=S.prototype.toJSON.call(this,e);for(var r in t.uniforms={},this.uniforms){var n=this.uniforms[r].value;t.uniforms[r]=n&&n.isTexture?{type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return 0<Object.keys(i).length&&(t.extensions=i),t},Y.prototype=Object.assign(Object.create(m.prototype),{constructor:Y,isCamera:!0,copy:function(e,t){return m.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new o),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){m.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),q.prototype=Object.assign(Object.create(Y.prototype),{constructor:q,isPerspectiveCamera:!0,copy:function(e,t){return Y.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*lc.RAD2DEG*ba(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=ya(.5*lc.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*lc.RAD2DEG*ba(ya(.5*lc.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Ia(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Ca(this.aspect,1)},setViewOffset:function(e,t,r,n,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*ya(.5*lc.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*n/o,t-=a.offsetY*r/s,n*=a.width/o,r*=a.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=m.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Ac=90,Sc=1;K.prototype=Object.create(m.prototype),K.prototype.constructor=K,Z.prototype=Object.create(l.prototype),Z.prototype.constructor=Z,Z.prototype.isWebGLRenderTargetCube=!0,Z.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var r=new g,n="varying vec3 vWorldDirection;\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",i="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}",a=new X({type:"CubemapFromEquirect",uniforms:W({tEquirect:{value:null}}),vertexShader:n,fragmentShader:i,side:Ja,blending:Za});a.uniforms.tEquirect.value=t;var o=new G(new H(5,5,5),a);r.add(o);var s=new K(1,10,1);return s.renderTarget=this,s.renderTarget.texture.name="CubeCameraTexture",s.update(e,r),o.geometry.dispose(),o.material.dispose(),this},Q.prototype=Object.create(c.prototype),Q.prototype.constructor=Q,Q.prototype.isDataTexture=!0,Object.assign($.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new o,t=new o;return function(r,n,i){var a=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new o),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new o;return function(t,r){void 0===r&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new o);var n=t.delta(e),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?r.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/i;return 0>a||1<a?void 0:r.copy(n).multiplyScalar(a).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return 0>t&&0<r||0>r&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new o),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new o,t=new s;return function(r,n){var i=n||t.getNormalMatrix(r),a=this.coplanarPoint(e).applyMatrix4(r),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(ee.prototype,{set:function(e,t,r,n,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;6>r;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],c=r[5],u=r[6],l=r[7],h=r[8],p=r[9],d=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(o-n,l-s,f-h,y-m).normalize(),t[1].setComponents(o+n,l+s,f+h,y+m).normalize(),t[2].setComponents(o+i,l+c,f+p,y+g).normalize(),t[3].setComponents(o-i,l-c,f-p,y-g).normalize(),t[4].setComponents(o-a,l-u,f-d,y-v).normalize(),t[5].setComponents(o+a,l+u,f+d,y+v).normalize(),this},intersectsObject:function(){var e=new y;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new y;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;6>i;i++)if(t[i].distanceToPoint(r)<n)return!1;return!0},intersectsBox:function(){var e=new o;return function(t){for(var r,n=this.planes,i=0;6>i;i++)if(r=n[i],e.x=0<r.normal.x?t.max.x:t.min.x,e.y=0<r.normal.y?t.max.y:t.min.y,e.z=0<r.normal.z?t.max.z:t.min.z,0>r.distanceToPoint(e))return!1;return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;6>r;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}});var Mc={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Lc={common:{diffuse:{value:new w(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new s},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new w(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new w(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new s}},sprite:{diffuse:{value:new w(15658734)},opacity:{value:1},center:{value:new i(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new s}}},Nc={basic:{uniforms:J([Lc.common,Lc.specularmap,Lc.envmap,Lc.aomap,Lc.lightmap,Lc.fog]),vertexShader:Mc.meshbasic_vert,fragmentShader:Mc.meshbasic_frag},lambert:{uniforms:J([Lc.common,Lc.specularmap,Lc.envmap,Lc.aomap,Lc.lightmap,Lc.emissivemap,Lc.fog,Lc.lights,{emissive:{value:new w(0)}}]),vertexShader:Mc.meshlambert_vert,fragmentShader:Mc.meshlambert_frag},phong:{uniforms:J([Lc.common,Lc.specularmap,Lc.envmap,Lc.aomap,Lc.lightmap,Lc.emissivemap,Lc.bumpmap,Lc.normalmap,Lc.displacementmap,Lc.gradientmap,Lc.fog,Lc.lights,{emissive:{value:new w(0)},specular:{value:new w(1118481)},shininess:{value:30}}]),vertexShader:Mc.meshphong_vert,fragmentShader:Mc.meshphong_frag},standard:{uniforms:J([Lc.common,Lc.envmap,Lc.aomap,Lc.lightmap,Lc.emissivemap,Lc.bumpmap,Lc.normalmap,Lc.displacementmap,Lc.roughnessmap,Lc.metalnessmap,Lc.fog,Lc.lights,{emissive:{value:new w(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Mc.meshphysical_vert,fragmentShader:Mc.meshphysical_frag},matcap:{uniforms:J([Lc.common,Lc.bumpmap,Lc.normalmap,Lc.displacementmap,Lc.fog,{matcap:{value:null}}]),vertexShader:Mc.meshmatcap_vert,fragmentShader:Mc.meshmatcap_frag},points:{uniforms:J([Lc.points,Lc.fog]),vertexShader:Mc.points_vert,fragmentShader:Mc.points_frag},dashed:{uniforms:J([Lc.common,Lc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Mc.linedashed_vert,fragmentShader:Mc.linedashed_frag},depth:{uniforms:J([Lc.common,Lc.displacementmap]),vertexShader:Mc.depth_vert,fragmentShader:Mc.depth_frag},normal:{uniforms:J([Lc.common,Lc.bumpmap,Lc.normalmap,Lc.displacementmap,{opacity:{value:1}}]),vertexShader:Mc.normal_vert,fragmentShader:Mc.normal_frag},sprite:{uniforms:J([Lc.sprite,Lc.fog]),vertexShader:Mc.sprite_vert,fragmentShader:Mc.sprite_frag},background:{uniforms:{uvTransform:{value:new s},t2D:{value:null}},vertexShader:Mc.background_vert,fragmentShader:Mc.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Mc.cube_vert,fragmentShader:Mc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Mc.equirect_vert,fragmentShader:Mc.equirect_frag},distanceRGBA:{uniforms:J([Lc.common,Lc.displacementmap,{referencePosition:{value:new o},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Mc.distanceRGBA_vert,fragmentShader:Mc.distanceRGBA_frag},shadow:{uniforms:J([Lc.lights,Lc.fog,{color:{value:new w(0)},opacity:{value:1}}]),vertexShader:Mc.shadow_vert,fragmentShader:Mc.shadow_frag}};Nc.physical={uniforms:J([Nc.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Mc.meshphysical_vert,fragmentShader:Mc.meshphysical_frag},ne.prototype=Object.create(j.prototype),ne.prototype.constructor=ne,ie.prototype=Object.create(z.prototype),ie.prototype.constructor=ie,ge.prototype=Object.create(c.prototype),ge.prototype.constructor=ge,ge.prototype.isCubeTexture=!0,Object.defineProperty(ge.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),ve.prototype=Object.create(c.prototype),ve.prototype.constructor=ve,ve.prototype.isDataTexture2DArray=!0,ye.prototype=Object.create(c.prototype),ye.prototype.constructor=ye,ye.prototype.isDataTexture3D=!0;var Rc=new c,Cc=new ve,Ic=new ye,Oc=new ge,Pc=[],Fc=[],kc=new Float32Array(16),Dc=new Float32Array(9),Uc=new Float32Array(4);Qe.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),we(t,e)},$e.prototype.setValue=function(e,t,r){for(var n,i=this.seq,a=0,o=i.length;a!==o;++a)(n=i[a]).setValue(e,t[n.id],r)};var Bc=/([\w\d_]+)(\])?(\[|\.)?/g;rt.prototype.setValue=function(e,t,r,n){var i=this.map[t];void 0!==i&&i.setValue(e,r,n)},rt.prototype.setOptional=function(e,t,r){var n=t[r];void 0!==n&&this.setValue(e,r,n)},rt.upload=function(e,t,r,n){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=r[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,n)}},rt.seqWithValue=function(e,t){for(var r,n=[],i=0,a=e.length;i!==a;++i)(r=e[i]).id in t&&n.push(r);return n};var zc=0,Gc=0;At.prototype=Object.create(S.prototype),At.prototype.constructor=At,At.prototype.isMeshDepthMaterial=!0,At.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},St.prototype=Object.create(S.prototype),St.prototype.constructor=St,St.prototype.isMeshDistanceMaterial=!0,St.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Ct.prototype=Object.assign(Object.create(m.prototype),{constructor:Ct,isGroup:!0}),It.prototype=Object.assign(Object.create(q.prototype),{constructor:It,isArrayCamera:!0});var jc,Vc=new o,Hc=new o;Object.assign(Pt.prototype,n.prototype),Object.assign(Ft.prototype,n.prototype),Object.assign(Dt.prototype,{isFogExp2:!0,clone:function(){return new Dt(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Ut.prototype,{isFog:!0,clone:function(){return new Ut(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Bt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Bt.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0===e?0:e.length/this.stride,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(zt.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(zt.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}}),Gt.prototype=Object.create(S.prototype),Gt.prototype.constructor=Gt,Gt.prototype.isSpriteMaterial=!0,Gt.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},jt.prototype=Object.assign(Object.create(m.prototype),{constructor:jt,isSprite:!0,raycast:function(){function e(e,t,r,n,i,o){a.subVectors(e,r).addScalar(.5).multiply(n),void 0===i?s.copy(a):(s.x=o*a.x-i*a.y,s.y=i*a.x+o*a.y),e.copy(t),e.x+=s.x,e.y+=s.y,e.applyMatrix4(c)}var t=new o,r=new o,n=new o,a=new i,s=new i,c=new p,u=new o,l=new o,h=new o,d=new i,f=new i,m=new i;return function(a,o){r.setFromMatrixScale(this.matrixWorld),c.copy(a._camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(a._camera.matrixWorldInverse,this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix),a._camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&r.multiplyScalar(-n.z);var s,p,g=this.material.rotation;0!==g&&(p=_a(g),s=wa(g));var v=this.center;e(u.set(-.5,-.5,0),n,v,r,s,p),e(l.set(.5,-.5,0),n,v,r,s,p),e(h.set(.5,.5,0),n,v,r,s,p),d.set(0,0),f.set(1,0),m.set(1,1);var y=a.ray.intersectTriangle(u,l,h,!1,t);if(null!==y||(e(l.set(-.5,.5,0),n,v,r,s,p),f.set(0,1),null!==(y=a.ray.intersectTriangle(u,h,l,!1,t)))){var b=a.ray.origin.distanceTo(t);b<a.near||b>a.far||o.push({distance:b,point:t.clone(),uv:x.getUV(t,u,l,h,d,f,m,new i),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return m.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),Vt.prototype=Object.assign(Object.create(m.prototype),{constructor:Vt,isLOD:!0,copy:function(e){m.prototype.copy.call(this,e,!1);for(var t,r=e.levels,n=0,i=r.length;n<i;n++)t=r[n],this.addLevel(t.object.clone(),t.distance);return this},addLevel:function(e,t){void 0===t&&(t=0),t=Ea(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object},raycast:function(){var e=new o;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),update:function(){var e=new o,t=new o;return function(r){var n=this.levels;if(1<n.length){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);n[0].object.visible=!0;for(var a=1,o=n.length;a<o&&i>=n[a].distance;a++)n[a-1].object.visible=!1,n[a].object.visible=!0;for(;a<o;a++)n[a].object.visible=!1}}}(),toJSON:function(e){var t=m.prototype.toJSON.call(this,e);t.object.levels=[];for(var r,n=this.levels,i=0,a=n.length;i<a;i++)r=n[i],t.object.levels.push({object:r.object.uuid,distance:r.distance});return t}}),Ht.prototype=Object.assign(Object.create(G.prototype),{constructor:Ht,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new u,t=this.geometry.attributes.skinWeight,r=0,n=t.count;r<n;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);var i=1/e.manhattanLength();i==1/0?e.set(1,0,0,0):e.multiplyScalar(i),t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){G.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(Wt.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e,t=0,r=this.bones.length;t<r;t++)e=new p,this.bones[t]&&e.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(e)},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new p,t=new p;return function(){for(var r,n=this.bones,i=this.boneInverses,a=this.boneMatrices,o=this.boneTexture,s=0,c=n.length;s<c;s++)r=n[s]?n[s].matrixWorld:t,e.multiplyMatrices(r,i[s]),e.toArray(a,16*s);void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Wt(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t,r=0,n=this.bones.length;r<n;r++)if((t=this.bones[r]).name===e)return t}}),Jt.prototype=Object.assign(Object.create(m.prototype),{constructor:Jt,isBone:!0}),Xt.prototype=Object.create(S.prototype),Xt.prototype.constructor=Xt,Xt.prototype.isLineBasicMaterial=!0,Xt.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Yt.prototype=Object.assign(Object.create(m.prototype),{constructor:Yt,isLine:!0,computeLineDistances:function(){var e=new o,t=new o;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[0],a=1,o=n.count;a<o;a++)e.fromBufferAttribute(n,a-1),t.fromBufferAttribute(n,a),i[a]=i[a-1],i[a]+=e.distanceTo(t);r.addAttribute("lineDistance",new k(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;(i=r.lineDistances)[0]=0;for(a=1,o=s.length;a<o;a++)i[a]=i[a-1],i[a]+=s[a-1].distanceTo(s[a])}return this}}(),raycast:function(){var e=new p,t=new b,r=new y;return function(n,i){var a=n.linePrecision,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(c),r.radius+=a,!1!==n.ray.intersectsSphere(r)){e.getInverse(c),t.copy(n.ray).applyMatrix4(e);var u=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,h=new o,p=new o,d=new o,f=new o,m=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var g=s.index,v=s.attributes.position.array;if(null!==g)for(var y=g.array,b=0,x=y.length-1;b<x;b+=m){var w=y[b],_=y[b+1];if(h.fromArray(v,3*w),p.fromArray(v,3*_),!(t.distanceSqToSegment(h,p,f,d)>l))f.applyMatrix4(this.matrixWorld),(A=n.ray.origin.distanceTo(f))<n.near||A>n.far||i.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}else for(b=0,x=v.length/3-1;b<x;b+=m){if(h.fromArray(v,3*b),p.fromArray(v,3*b+3),!(t.distanceSqToSegment(h,p,f,d)>l))f.applyMatrix4(this.matrixWorld),(A=n.ray.origin.distanceTo(f))<n.near||A>n.far||i.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else if(s.isGeometry){var T=s.vertices,E=T.length;for(b=0;b<E-1;b+=m)if(!(t.distanceSqToSegment(T[b],T[b+1],f,d)>l)){var A;f.applyMatrix4(this.matrixWorld),(A=n.ray.origin.distanceTo(f))<n.near||A>n.far||i.push({distance:A,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),qt.prototype=Object.assign(Object.create(Yt.prototype),{constructor:qt,isLineSegments:!0,computeLineDistances:function(){var e=new o,t=new o;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[],a=0,o=n.count;a<o;a+=2)e.fromBufferAttribute(n,a),t.fromBufferAttribute(n,a+1),i[a]=0==a?0:i[a-1],i[a+1]=i[a]+e.distanceTo(t);r.addAttribute("lineDistance",new k(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var s=r.vertices;for(i=r.lineDistances,a=0,o=s.length;a<o;a+=2)e.copy(s[a]),t.copy(s[a+1]),i[a]=0==a?0:i[a-1],i[a+1]=i[a]+e.distanceTo(t)}return this}}()}),Kt.prototype=Object.assign(Object.create(Yt.prototype),{constructor:Kt,isLineLoop:!0}),Zt.prototype=Object.create(S.prototype),Zt.prototype.constructor=Zt,Zt.prototype.isPointsMaterial=!0,Zt.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Qt.prototype=Object.assign(Object.create(m.prototype),{constructor:Qt,isPoints:!0,raycast:function(){var e=new p,t=new b,r=new y;return function(n,i){function a(e,r){var a=t.distanceSqToPoint(e);if(a<p){t.closestPointToPoint(e,f),f.applyMatrix4(u);var o=n.ray.origin.distanceTo(f);if(o<n.near||o>n.far)return;i.push({distance:o,distanceToRay:Aa(a),point:f.clone(),index:r,face:null,object:s})}}var s=this,c=this.geometry,u=this.matrixWorld,l=n.params.Points.threshold;if(null===c.boundingSphere&&c.computeBoundingSphere(),r.copy(c.boundingSphere),r.applyMatrix4(u),r.radius+=l,!1!==n.ray.intersectsSphere(r)){e.getInverse(u),t.copy(n.ray).applyMatrix4(e);var h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,d=new o,f=new o;if(c.isBufferGeometry){var m=c.index,g=c.attributes.position.array;if(null!==m)for(var v,y=m.array,b=0,x=y.length;b<x;b++)v=y[b],d.fromArray(g,3*v),a(d,v);else{b=0;for(var w=g.length/3;b<w;b++)d.fromArray(g,3*b),a(d,b)}}else{var _=c.vertices;for(b=0,w=_.length;b<w;b++)a(_[b],b)}}}}(),updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,a=Object.keys(i);if(0<a.length){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)r=o[e].name||e+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;void 0!==s&&0<s.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),$t.prototype=Object.assign(Object.create(c.prototype),{constructor:$t,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),er.prototype=Object.create(c.prototype),er.prototype.constructor=er,er.prototype.isCompressedTexture=!0,tr.prototype=Object.create(c.prototype),tr.prototype.constructor=tr,tr.prototype.isCanvasTexture=!0,rr.prototype=Object.create(c.prototype),rr.prototype.constructor=rr,rr.prototype.isDepthTexture=!0,nr.prototype=Object.create(z.prototype),nr.prototype.constructor=nr,ir.prototype=Object.create(j.prototype),ir.prototype.constructor=ir,ar.prototype=Object.create(z.prototype),ar.prototype.constructor=ar,or.prototype=Object.create(j.prototype),or.prototype.constructor=or,sr.prototype=Object.create(z.prototype),sr.prototype.constructor=sr,cr.prototype=Object.create(j.prototype),cr.prototype.constructor=cr,ur.prototype=Object.create(sr.prototype),ur.prototype.constructor=ur,lr.prototype=Object.create(j.prototype),lr.prototype.constructor=lr,hr.prototype=Object.create(sr.prototype),hr.prototype.constructor=hr,pr.prototype=Object.create(j.prototype),pr.prototype.constructor=pr,dr.prototype=Object.create(sr.prototype),dr.prototype.constructor=dr,fr.prototype=Object.create(j.prototype),fr.prototype.constructor=fr,mr.prototype=Object.create(sr.prototype),mr.prototype.constructor=mr,gr.prototype=Object.create(j.prototype),gr.prototype.constructor=gr,vr.prototype=Object.create(z.prototype),vr.prototype.constructor=vr,vr.prototype.toJSON=function(){var e=z.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},yr.prototype=Object.create(j.prototype),yr.prototype.constructor=yr,br.prototype=Object.create(z.prototype),br.prototype.constructor=br,xr.prototype=Object.create(j.prototype),xr.prototype.constructor=xr,wr.prototype=Object.create(z.prototype),wr.prototype.constructor=wr;var Wc=function(e,t,r){r=r||2;var n,i,a,o,s,c,u,l=t&&t.length,h=l?t[0]*r:e.length,p=_r(e,0,h,r,!0),d=[];if(!p||p.next===p.prev)return d;if(l&&(p=function(e,t,r,n){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=_r(e,t[i]*n,i<a-1?t[i+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),s.push(Ir(o));for(s.sort(Nr),i=0;i<s.length;i++)Rr(s[i],r),r=Tr(r,r.next);return r}(e,t,p,r)),e.length>80*r){n=a=e[0],i=o=e[1];for(var f=r;f<h;f+=r)(s=e[f])<n&&(n=s),(c=e[f+1])<i&&(i=c),s>a&&(a=s),c>o&&(o=c);u=0===(u=Ca(a-n,o-i))?0:1/u}return Er(p,d,r,n,i,u),d},Jc={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},isClockWise:function(e){return 0>Jc.area(e)},triangulateShape:function(e,t){var r=[],n=[],i=[];Vr(e),Hr(r,e);var a=e.length;t.forEach(Vr);for(var o=0;o<t.length;o++)n.push(a),a+=t[o].length,Hr(r,t[o]);var s=Wc(r,n);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};Wr.prototype=Object.create(j.prototype),Wr.prototype.constructor=Wr,Wr.prototype.toJSON=function(){var e=j.prototype.toJSON.call(this);return Xr(this.parameters.shapes,this.parameters.options,e)},Jr.prototype=Object.create(z.prototype),Jr.prototype.constructor=Jr,Jr.prototype.toJSON=function(){var e=z.prototype.toJSON.call(this);return Xr(this.parameters.shapes,this.parameters.options,e)};var Xc={generateTopUV:function(e,t,r,n,a){var o=t[3*r],s=t[3*r+1],c=t[3*n],u=t[3*n+1],l=t[3*a],h=t[3*a+1];return[new i(o,s),new i(c,u),new i(l,h)]},generateSideWallUV:function(e,t,r,n,a,o){var s=t[3*r],c=t[3*r+1],u=t[3*r+2],l=t[3*n],h=t[3*n+1],p=t[3*n+2],d=t[3*a],f=t[3*a+1],m=t[3*a+2],g=t[3*o],v=t[3*o+1],y=t[3*o+2];return.01>Ea(c-h)?[new i(s,1-u),new i(l,1-p),new i(d,1-m),new i(g,1-y)]:[new i(c,1-u),new i(h,1-p),new i(f,1-m),new i(v,1-y)]}};Yr.prototype=Object.create(j.prototype),Yr.prototype.constructor=Yr,qr.prototype=Object.create(Jr.prototype),qr.prototype.constructor=qr,Kr.prototype=Object.create(j.prototype),Kr.prototype.constructor=Kr,Zr.prototype=Object.create(z.prototype),Zr.prototype.constructor=Zr,Qr.prototype=Object.create(j.prototype),Qr.prototype.constructor=Qr,$r.prototype=Object.create(z.prototype),$r.prototype.constructor=$r,en.prototype=Object.create(j.prototype),en.prototype.constructor=en,tn.prototype=Object.create(z.prototype),tn.prototype.constructor=tn,rn.prototype=Object.create(j.prototype),rn.prototype.constructor=rn,rn.prototype.toJSON=function(){var e=j.prototype.toJSON.call(this);return an(this.parameters.shapes,e)},nn.prototype=Object.create(z.prototype),nn.prototype.constructor=nn,nn.prototype.toJSON=function(){var e=z.prototype.toJSON.call(this);return an(this.parameters.shapes,e)},on.prototype=Object.create(z.prototype),on.prototype.constructor=on,sn.prototype=Object.create(j.prototype),sn.prototype.constructor=sn,cn.prototype=Object.create(z.prototype),cn.prototype.constructor=cn,un.prototype=Object.create(sn.prototype),un.prototype.constructor=un,ln.prototype=Object.create(cn.prototype),ln.prototype.constructor=ln,hn.prototype=Object.create(j.prototype),hn.prototype.constructor=hn,pn.prototype=Object.create(z.prototype),pn.prototype.constructor=pn;var Yc=Object.freeze({WireframeGeometry:nr,ParametricGeometry:ir,ParametricBufferGeometry:ar,TetrahedronGeometry:cr,TetrahedronBufferGeometry:ur,OctahedronGeometry:lr,OctahedronBufferGeometry:hr,IcosahedronGeometry:pr,IcosahedronBufferGeometry:dr,DodecahedronGeometry:fr,DodecahedronBufferGeometry:mr,PolyhedronGeometry:or,PolyhedronBufferGeometry:sr,TubeGeometry:gr,TubeBufferGeometry:vr,TorusKnotGeometry:yr,TorusKnotBufferGeometry:br,TorusGeometry:xr,TorusBufferGeometry:wr,TextGeometry:Yr,TextBufferGeometry:qr,SphereGeometry:Kr,SphereBufferGeometry:Zr,RingGeometry:Qr,RingBufferGeometry:$r,PlaneGeometry:ne,PlaneBufferGeometry:ie,LatheGeometry:en,LatheBufferGeometry:tn,ShapeGeometry:rn,ShapeBufferGeometry:nn,ExtrudeGeometry:Wr,ExtrudeBufferGeometry:Jr,EdgesGeometry:on,ConeGeometry:un,ConeBufferGeometry:ln,CylinderGeometry:sn,CylinderBufferGeometry:cn,CircleGeometry:hn,CircleBufferGeometry:pn,BoxGeometry:V,BoxBufferGeometry:H});dn.prototype=Object.create(S.prototype),dn.prototype.constructor=dn,dn.prototype.isShadowMaterial=!0,dn.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this},fn.prototype=Object.create(X.prototype),fn.prototype.constructor=fn,fn.prototype.isRawShaderMaterial=!0,mn.prototype=Object.create(S.prototype),mn.prototype.constructor=mn,mn.prototype.isMeshStandardMaterial=!0,mn.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},gn.prototype=Object.create(mn.prototype),gn.prototype.constructor=gn,gn.prototype.isMeshPhysicalMaterial=!0,gn.prototype.copy=function(e){return mn.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},vn.prototype=Object.create(S.prototype),vn.prototype.constructor=vn,vn.prototype.isMeshPhongMaterial=!0,vn.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},yn.prototype=Object.create(vn.prototype),yn.prototype.constructor=yn,yn.prototype.isMeshToonMaterial=!0,yn.prototype.copy=function(e){return vn.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},bn.prototype=Object.create(S.prototype),bn.prototype.constructor=bn,bn.prototype.isMeshNormalMaterial=!0,bn.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},xn.prototype=Object.create(S.prototype),xn.prototype.constructor=xn,xn.prototype.isMeshLambertMaterial=!0,xn.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},wn.prototype=Object.create(S.prototype),wn.prototype.constructor=wn,wn.prototype.isMeshMatcapMaterial=!0,wn.prototype.copy=function(e){return S.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},_n.prototype=Object.create(Xt.prototype),_n.prototype.constructor=_n,_n.prototype.isLineDashedMaterial=!0,_n.prototype.copy=function(e){return Xt.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var qc=Object.freeze({ShadowMaterial:dn,SpriteMaterial:Gt,RawShaderMaterial:fn,ShaderMaterial:X,PointsMaterial:Zt,MeshPhysicalMaterial:gn,MeshStandardMaterial:mn,MeshPhongMaterial:vn,MeshToonMaterial:yn,MeshNormalMaterial:bn,MeshLambertMaterial:xn,MeshDepthMaterial:At,MeshDistanceMaterial:St,MeshBasicMaterial:M,MeshMatcapMaterial:wn,LineDashedMaterial:_n,LineBasicMaterial:Xt,Material:S}),Kc={arraySlice:function(e,t,r){return Kc.isTypedArray(e)?new e.constructor(e.subarray(t,void 0===r?e.length:r)):e.slice(t,r)},convertArray:function(e,t,r){return e&&(r||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=Array(t),n=0;n!==t;++n)r[n]=n;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){for(var n,i=e.length,a=new e.constructor(i),o=0,s=0;s!==i;++o){n=r[o]*t;for(var c=0;c!==t;++c)a[s++]=e[n+c]}return a},flattenJSON:function(e,t,r,n){for(var i=1,a=e[0];void 0!==a&&void 0===a[n];)a=e[i++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[n])&&(t.push(a.time),r.push.apply(r,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[n])&&(t.push(a.time),o.toArray(r,r.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[n])&&(t.push(a.time),r.push(o)),a=e[i++]}while(void 0!==a)}}};Object.assign(Tn.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var a;r:{n:if(!(e<n)){for(var o=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===o)break;if(i=n,e<(n=t[++r]))break t}a=t.length;break r}if(e>=i)break e;var s=t[1];e<s&&(r=2,i=s);for(o=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===o)break;if(n=i,e>=(i=t[--r-1]))break t}a=r,r=0}for(;r<a;){var c=r+a>>>1;e<t[c]?a=c:r=c+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=0;i!==n;++i)t[i]=r[e*n+i];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Tn.prototype,{beforeStart_:Tn.prototype.copySampleValue_,afterEnd_:Tn.prototype.copySampleValue_}),En.prototype=Object.assign(Object.create(Tn.prototype),{constructor:En,DefaultSettings_:{endingStart:Js,endingEnd:Js},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,a=e+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case Xs:i=e,o=2*t-r;break;case 2402:o=t+n[i=n.length-2]-n[i+1];break;default:i=e,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case Xs:a=e,s=2*r-t;break;case 2402:a=1,s=r+n[1]-n[0];break;default:a=e-1,s=t}var c=.5*(r-t),u=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(s-r),this._offsetPrev=i*u,this._offsetNext=a*u},interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=this._offsetPrev,u=this._offsetNext,l=this._weightPrev,h=this._weightNext,p=(r-t)/(n-t),d=p*p,f=d*p,m=0;m!==o;++m)i[m]=(-l*f+2*l*d-l*p)*a[c+m]+((1+l)*f+(-1.5-2*l)*d+(-.5+l)*p+1)*a[s-o+m]+((-1-h)*f+(1.5+h)*d+.5*p)*a[s+m]+(h*f-h*d)*a[u+m];return i}}),An.prototype=Object.assign(Object.create(Tn.prototype),{constructor:An,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=(r-t)/(n-t),u=0;u!==o;++u)i[u]=a[s-o+u]*(1-c)+a[s+u]*c;return i}}),Sn.prototype=Object.assign(Object.create(Tn.prototype),{constructor:Sn,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Mn,{toJSON:function(e){var t,r=e.constructor;if(void 0!==r.toJSON)t=r.toJSON(e);else{t={name:e.name,times:Kc.convertArray(e.times,Array),values:Kc.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(Mn.prototype,{constructor:Mn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Ws,InterpolantFactoryMethodDiscrete:function(e){return new Sn(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new An(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new En(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;if(e===Hs?t=this.InterpolantFactoryMethodDiscrete:e===Ws?t=this.InterpolantFactoryMethodLinear:2302===e&&(t=this.InterpolantFactoryMethodSmooth),void 0===t){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Hs;case this.InterpolantFactoryMethodLinear:return Ws;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,a=n-1;i!==n&&r[i]<e;)++i;for(;-1!==a&&r[a]>t;)--a;if(++a,0!==i||a!==n){i>=a&&(i=(a=Ca(a,1))-1);var o=this.getValueSize();this.times=Kc.arraySlice(r,i,a),this.values=Kc.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();0!=t-Fa(t)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a,o=null,s=0;s!==i;s++){if("number"==typeof(a=r[s])&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,a),e=!1;break}if(null!==o&&o>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,a,o),e=!1;break}o=a}if(void 0!==n&&Kc.isTypedArray(n)){s=0;for(var c,u=n.length;s!==u;++s)if(c=n[s],isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,c),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=2302===this.getInterpolation(),i=1,a=e.length-1,o=1;o<a;++o){var s=!1,c=e[o];if(c!==e[o+1]&&(1!==o||c!==c[0]))if(n)s=!0;else for(var u,l=o*r,h=0;h!==r;++h)if((u=t[l+h])!==t[l-r+h]||u!==t[l+r+h]){s=!0;break}if(s){if(o!==i){e[i]=e[o];var p=o*r,d=i*r;for(h=0;h!==r;++h)t[d+h]=t[p+h]}++i}}if(0<a){e[i]=e[a];for(p=a*r,d=i*r,h=0;h!==r;++h)t[d+h]=t[p+h];++i}return i!==e.length&&(this.times=Kc.arraySlice(e,0,i),this.values=Kc.arraySlice(t,0,i*r)),this},clone:function(){var e=Kc.arraySlice(this.times,0),t=Kc.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}),Ln.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Ln,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Hs,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Nn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Nn,ValueTypeName:"color"}),Rn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Rn,ValueTypeName:"number"}),Cn.prototype=Object.assign(Object.create(Tn.prototype),{constructor:Cn,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,c=e*s,u=c+s;c!==u;c+=4)a.slerpFlat(i,0,o,c-s,o,c,(r-t)/(n-t));return i}}),In.prototype=Object.assign(Object.create(Mn.prototype),{constructor:In,ValueTypeName:"quaternion",DefaultInterpolation:Ws,InterpolantFactoryMethodLinear:function(e){return new Cn(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),On.prototype=Object.assign(Object.create(Mn.prototype),{constructor:On,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Hs,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Pn.prototype=Object.assign(Object.create(Mn.prototype),{constructor:Pn,ValueTypeName:"vector"}),Object.assign(Fn,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,a=r.length;i!==a;++i)t.push(kn(r[i]).scale(n));return new Fn(e.name,e.duration,t)},toJSON:function(e){for(var t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,a=r.length;i!==a;++i)t.push(Mn.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],c=[];s.push((o+i-1)%i,o,(o+1)%i),c.push(0,1,0);var u=Kc.getKeyframeOrder(s);s=Kc.sortedArray(s,1,u),c=Kc.sortedArray(c,1,u),n||0!==s[0]||(s.push(i),c.push(c[0])),a.push(new Rn(".morphTargetInfluences["+t[o].name+"]",s,c).scale(1/r))}return new Fn(e,-1,a)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],c=s.name.match(i);if(c&&1<c.length){var u=n[h=c[1]];u||(n[h]=u=[]),u.push(s)}}var l=[];for(var h in n)l.push(Fn.CreateFromMorphTargetSequence(h,n[h],t,r));return l},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r,n=function(e,t,r,n,i){if(0!==r.length){var a=[],o=[];Kc.flattenJSON(r,a,o,n),0!==a.length&&i.push(new e(t,a,o))}},i=[],a=e.name||"default",o=e.length||-1,s=e.fps||30,c=e.hierarchy||[],u=0;u<c.length;u++)if((r=c[u].keys)&&0!==r.length)if(r[0].morphTargets){for(var l={},h=0;h<r.length;h++)if(r[h].morphTargets)for(var p=0;p<r[h].morphTargets.length;p++)l[r[h].morphTargets[p]]=-1;for(var d in l){var f,m=[],g=[];for(p=0;p!==r[h].morphTargets.length;++p)f=r[h],m.push(f.time),g.push(f.morphTarget===d?1:0);i.push(new Rn(".morphTargetInfluence["+d+"]",m,g))}o=l.length*(s||1)}else{var v=".bones["+t[u].name+"]";n(Pn,v+".position",r,"pos",i),n(In,v+".quaternion",r,"rot",i),n(Pn,v+".scale",r,"scl",i)}return 0===i.length?null:new Fn(a,o,i)}}),Object.assign(Fn.prototype,{resetDuration:function(){for(var e,t=0,r=0,n=this.tracks.length;r!==n;++r)e=this.tracks[r],t=Ca(t,e.times[e.times.length-1]);return this.duration=t,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Fn(this.name,this.duration,e)}});var Zc={enabled:!1,files:{},add:function(e,t){!1===this.enabled||(this.files[e]=t)},get:function(e){return!1===this.enabled?void 0:this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Qc=new Dn,$c={};Object.assign(Un.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Zc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;if(void 0===$c[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],c=!!o[2],u=o[3];u=decodeURIComponent(u),c&&(u=atob(u));try{var l,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(u.length),d=0;d<u.length;d++)p[d]=u.charCodeAt(d);l="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var f=new DOMParser;l=f.parseFromString(u,s);break;case"json":l=JSON.parse(u);break;default:l=u}setTimeout(function(){t&&t(l),i.manager.itemEnd(e)},0)}catch(t){setTimeout(function(){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)},0)}}else{$c[e]=[],$c[e].push({onLoad:t,onProgress:r,onError:n});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",function(t){var r=this.response;Zc.add(e,r);var n=$c[e];if(delete $c[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var a=0,o=n.length;a<o;a++)(s=n[a]).onLoad&&s.onLoad(r);i.manager.itemEnd(e)}else{var s;for(a=0,o=n.length;a<o;a++)(s=n[a]).onError&&s.onError(t);i.manager.itemError(e),i.manager.itemEnd(e)}},!1),m.addEventListener("progress",function(t){for(var r,n=$c[e],i=0,a=n.length;i<a;i++)(r=n[i]).onProgress&&r.onProgress(t)},!1),m.addEventListener("error",function(t){var r=$c[e];delete $c[e];for(var n,a=0,o=r.length;a<o;a++)(n=r[a]).onError&&n.onError(t);i.manager.itemError(e),i.manager.itemEnd(e)},!1),m.addEventListener("abort",function(t){var r=$c[e];delete $c[e];for(var n,a=0,o=r.length;a<o;a++)(n=r[a]).onError&&n.onError(t);i.manager.itemError(e),i.manager.itemEnd(e)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0===this.mimeType?"text/plain":this.mimeType),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}$c[e].push({onLoad:t,onProgress:r,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Bn.prototype,{load:function(e,t,r,n){var i=this,a=new Un(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){for(var t,r=[],n=0;n<e.length;n++)t=Fn.parse(e[n]),r.push(t);return r},setPath:function(e){return this.path=e,this}}),Object.assign(zn.prototype,{load:function(e,t,r,n){function i(i){c.load(e[i],function(e){var r=a._parser(e,!0);o[i]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(u+=1)&&(1===r.mipmapCount&&(s.minFilter=Ko),s.format=r.format,s.needsUpdate=!0,t&&t(s))},r,n)}var a=this,o=[],s=new er;s.image=o;var c=new Un(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,l=0,h=e.length;l<h;++l)i(l);else c.load(e,function(e){var r=a._parser(e,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,i=0;i<n;i++){o[i]={mipmaps:[]};for(var c=0;c<r.mipmapCount;c++)o[i].mipmaps.push(r.mipmaps[i*r.mipmapCount+c]),o[i].format=r.format,o[i].width=r.width,o[i].height=r.height}else s.image.width=r.width,s.image.height=r.height,s.mipmaps=r.mipmaps;1===r.mipmapCount&&(s.minFilter=Ko),s.format=r.format,s.needsUpdate=!0,t&&t(s)},r,n);return s},setPath:function(e){return this.path=e,this}}),Object.assign(Gn.prototype,{load:function(e,t,r,n){var i=this,a=new Q,o=new Un(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,function(e){var r=i._parser(e);r&&(void 0===r.image?void 0!==r.data&&(a.image.width=r.width,a.image.height=r.height,a.image.data=r.data):a.image=r.image,a.wrapS=void 0===r.wrapS?Wo:r.wrapS,a.wrapT=void 0===r.wrapT?Wo:r.wrapT,a.magFilter=void 0===r.magFilter?Ko:r.magFilter,a.minFilter=void 0===r.minFilter?Qo:r.minFilter,a.anisotropy=void 0===r.anisotropy?1:r.anisotropy,void 0!==r.format&&(a.format=r.format),void 0!==r.type&&(a.type=r.type),void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps),1===r.mipmapCount&&(a.minFilter=Ko),a.needsUpdate=!0,t&&t(a,r))},r,n),a},setPath:function(e){return this.path=e,this}}),Object.assign(jn.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){function i(){c.removeEventListener("load",i,!1),c.removeEventListener("error",a,!1),Zc.add(e,this),t&&t(this),o.manager.itemEnd(e)}function a(t){c.removeEventListener("load",i,!1),c.removeEventListener("error",a,!1),n&&n(t),o.manager.itemError(e),o.manager.itemEnd(e)}void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,s=Zc.get(e);if(void 0!==s)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;var c=document.createElementNS("http://www.w3.org/1999/xhtml","img");return c.addEventListener("load",i,!1),c.addEventListener("error",a,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(c.crossOrigin=this.crossOrigin),o.manager.itemStart(e),c.src=e,c},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Vn.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){function i(r){o.load(e[r],function(e){a.images[r]=e,6===++s&&(a.needsUpdate=!0,t&&t(a))},void 0,n)}var a=new ge,o=new jn(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);for(var s=0,c=0;c<e.length;++c)i(c);return a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Hn.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=new c,a=new jn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(r){i.image=r;var n=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data\:image\/jpeg/);i.format=n?ps:ds,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Wn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),a=0;for(n.push(0),r=1;r<=e;r++)a+=(t=this.getPoint(r/e)).distanceTo(i),n.push(a),i=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var r,n=this.getLengths(),i=0,a=n.length;r=t||e*n[a-1];for(var o,s=0,c=a-1;s<=c;)if(0>(o=n[i=Fa(s+(c-s)/2)]-r))s=i+1;else{if(!(0<o)){c=i;break}c=i-1}if(n[i=c]===r)return i/(a-1);var u=n[i];return(i+(r-u)/(n[i+1]-u))/(a-1)},getTangent:function(e){var t=e-1e-4,r=e+1e-4;0>t&&(t=0),1<r&&(r=1);var n=this.getPoint(t);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r,n,i,a=new o,s=[],c=[],u=[],l=new o,h=new p;for(r=0;r<=e;r++)n=r/e,s[r]=this.getTangentAt(n),s[r].normalize();c[0]=new o,u[0]=new o;var d=Number.MAX_VALUE,f=Ea(s[0].x),m=Ea(s[0].y),g=Ea(s[0].z);for(f<=d&&(d=f,a.set(1,0,0)),m<=d&&(d=m,a.set(0,1,0)),g<=d&&a.set(0,0,1),l.crossVectors(s[0],a).normalize(),c[0].crossVectors(s[0],l),u[0].crossVectors(s[0],c[0]),r=1;r<=e;r++)c[r]=c[r-1].clone(),u[r]=u[r-1].clone(),l.crossVectors(s[r-1],s[r]),l.length()>Da&&(l.normalize(),i=xa(lc.clamp(s[r-1].dot(s[r]),-1,1)),c[r].applyMatrix4(h.makeRotationAxis(l,i))),u[r].crossVectors(s[r],c[r]);if(!0===t)for(i=xa(lc.clamp(c[0].dot(c[e]),-1,1)),i/=e,0<s[0].dot(l.crossVectors(c[0],c[e]))&&(i=-i),r=1;r<=e;r++)c[r].applyMatrix4(h.makeRotationAxis(s[r],i*r)),u[r].crossVectors(s[r],c[r]);return{tangents:s,normals:c,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){return{metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"},arcLengthDivisions:this.arcLengthDivisions,type:this.type}},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Jn.prototype=Object.create(Wn.prototype),Jn.prototype.constructor=Jn,Jn.prototype.isEllipseCurve=!0,Jn.prototype.getPoint=function(e,t){for(var r=t||new i,n=2*Oa,a=this.aEndAngle-this.aStartAngle,o=Ea(a)<Da;0>a;)a+=n;for(;a>n;)a-=n;a<Da&&(a=o?0:n),!0!==this.aClockwise||o||(a===n?a=-n:a-=n);var s=this.aStartAngle+e*a,c=this.aX+this.xRadius*_a(s),u=this.aY+this.yRadius*wa(s);if(0!==this.aRotation){var l=_a(this.aRotation),h=wa(this.aRotation),p=c-this.aX,d=u-this.aY;c=p*l-d*h+this.aX,u=p*h+d*l+this.aY}return r.set(c,u)},Jn.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Jn.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Jn.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Xn.prototype=Object.create(Jn.prototype),Xn.prototype.constructor=Xn,Xn.prototype.isArcCurve=!0;var eu=new o,tu=new Yn,ru=new Yn,nu=new Yn;qn.prototype=Object.create(Wn.prototype),qn.prototype.constructor=qn,qn.prototype.isCatmullRomCurve3=!0,qn.prototype.getPoint=function(e,t){var r,n,i,a,s=t||new o,c=this.points,u=c.length,l=(u-(this.closed?0:1))*e,h=Fa(l),p=l-h;if(this.closed?h+=0<h?0:(Fa(Ea(h)/u)+1)*u:0==p&&h===u-1&&(h=u-2,p=1),this.closed||0<h?r=c[(h-1)%u]:(eu.subVectors(c[0],c[1]).add(c[0]),r=eu),n=c[h%u],i=c[(h+1)%u],this.closed||h+2<u?a=c[(h+2)%u]:(eu.subVectors(c[u-1],c[u-2]).add(c[u-1]),a=eu),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Ma(r.distanceToSquared(n),d),m=Ma(n.distanceToSquared(i),d),g=Ma(i.distanceToSquared(a),d);1e-4>m&&(m=1),1e-4>f&&(f=m),1e-4>g&&(g=m),tu.initNonuniformCatmullRom(r.x,n.x,i.x,a.x,f,m,g),ru.initNonuniformCatmullRom(r.y,n.y,i.y,a.y,f,m,g),nu.initNonuniformCatmullRom(r.z,n.z,i.z,a.z,f,m,g)}else"catmullrom"===this.curveType&&(tu.initCatmullRom(r.x,n.x,i.x,a.x,this.tension),ru.initCatmullRom(r.y,n.y,i.y,a.y,this.tension),nu.initCatmullRom(r.z,n.z,i.z,a.z,this.tension));return s.set(tu.calc(p),ru.calc(p),nu.calc(p)),s},qn.prototype.copy=function(e){Wn.prototype.copy.call(this,e),this.points=[];for(var t,r=0,n=e.points.length;r<n;r++)t=e.points[r],this.points.push(t.clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},qn.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);e.points=[];for(var t,r=0,n=this.points.length;r<n;r++)t=this.points[r],e.points.push(t.toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},qn.prototype.fromJSON=function(e){Wn.prototype.fromJSON.call(this,e),this.points=[];for(var t,r=0,n=e.points.length;r<n;r++)t=e.points[r],this.points.push((new o).fromArray(t));return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},$n.prototype=Object.create(Wn.prototype),$n.prototype.constructor=$n,$n.prototype.isCubicBezierCurve=!0,$n.prototype.getPoint=function(e,t){var r=t||new i,n=this.v0,a=this.v1,o=this.v2,s=this.v3;return r.set(Qn(e,n.x,a.x,o.x,s.x),Qn(e,n.y,a.y,o.y,s.y)),r},$n.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},$n.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},$n.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},ei.prototype=Object.create(Wn.prototype),ei.prototype.constructor=ei,ei.prototype.isCubicBezierCurve3=!0,ei.prototype.getPoint=function(e,t){var r=t||new o,n=this.v0,i=this.v1,a=this.v2,s=this.v3;return r.set(Qn(e,n.x,i.x,a.x,s.x),Qn(e,n.y,i.y,a.y,s.y),Qn(e,n.z,i.z,a.z,s.z)),r},ei.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ei.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ei.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},ti.prototype=Object.create(Wn.prototype),ti.prototype.constructor=ti,ti.prototype.isLineCurve=!0,ti.prototype.getPoint=function(e,t){var r=t||new i;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},ti.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},ti.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},ti.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ti.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ti.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ri.prototype=Object.create(Wn.prototype),ri.prototype.constructor=ri,ri.prototype.isLineCurve3=!0,ri.prototype.getPoint=function(e,t){var r=t||new o;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},ri.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},ri.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ri.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ri.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ni.prototype=Object.create(Wn.prototype),ni.prototype.constructor=ni,ni.prototype.isQuadraticBezierCurve=!0,ni.prototype.getPoint=function(e,t){var r=t||new i,n=this.v0,a=this.v1,o=this.v2;return r.set(Zn(e,n.x,a.x,o.x),Zn(e,n.y,a.y,o.y)),r},ni.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ni.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ni.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ii.prototype=Object.create(Wn.prototype),ii.prototype.constructor=ii,ii.prototype.isQuadraticBezierCurve3=!0,ii.prototype.getPoint=function(e,t){var r=t||new o,n=this.v0,i=this.v1,a=this.v2;return r.set(Zn(e,n.x,i.x,a.x),Zn(e,n.y,i.y,a.y),Zn(e,n.z,i.z,a.z)),r},ii.prototype.copy=function(e){return Wn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ii.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ii.prototype.fromJSON=function(e){return Wn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ai.prototype=Object.create(Wn.prototype),ai.prototype.constructor=ai,ai.prototype.isSplineCurve=!0,ai.prototype.getPoint=function(e,t){var r=t||new i,n=this.points,a=(n.length-1)*e,o=Fa(a),s=a-o,c=n[0===o?o:o-1],u=n[o],l=n[o>n.length-2?n.length-1:o+1],h=n[o>n.length-3?n.length-1:o+2];return r.set(Kn(s,c.x,u.x,l.x,h.x),Kn(s,c.y,u.y,l.y,h.y)),r},ai.prototype.copy=function(e){Wn.prototype.copy.call(this,e),this.points=[];for(var t,r=0,n=e.points.length;r<n;r++)t=e.points[r],this.points.push(t.clone());return this},ai.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);e.points=[];for(var t,r=0,n=this.points.length;r<n;r++)t=this.points[r],e.points.push(t.toArray());return e},ai.prototype.fromJSON=function(e){Wn.prototype.fromJSON.call(this,e),this.points=[];for(var t,r=0,n=e.points.length;r<n;r++)t=e.points[r],this.points.push((new i).fromArray(t));return this};var iu=Object.freeze({ArcCurve:Xn,CatmullRomCurve3:qn,CubicBezierCurve:$n,CubicBezierCurve3:ei,EllipseCurve:Jn,LineCurve:ti,LineCurve3:ri,QuadraticBezierCurve:ni,QuadraticBezierCurve3:ii,SplineCurve:ai});oi.prototype=Object.assign(Object.create(Wn.prototype),{constructor:oi,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ti(t,e))},getPoint:function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t){var i=r[n]-t,a=this.curves[n],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,r=[],n=0,i=this.curves;n<i.length;n++)for(var a,o=i[n],s=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,c=o.getPoints(s),u=0;u<c.length;u++)a=c[u],t&&t.equals(a)||(r.push(a),t=a);return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(e){Wn.prototype.copy.call(this,e),this.curves=[];for(var t,r=0,n=e.curves.length;r<n;r++)t=e.curves[r],this.curves.push(t.clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=Wn.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t,r=0,n=this.curves.length;r<n;r++)t=this.curves[r],e.curves.push(t.toJSON());return e},fromJSON:function(e){Wn.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t,r=0,n=e.curves.length;r<n;r++)t=e.curves[r],this.curves.push((new iu[t.type]).fromJSON(t));return this}}),si.prototype=Object.assign(Object.create(oi.prototype),{constructor:si,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new ti(this.currentPoint.clone(),new i(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var a=new ni(this.currentPoint.clone(),new i(e,t),new i(r,n));this.curves.push(a),this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,a,o){var s=new $n(this.currentPoint.clone(),new i(e,t),new i(r,n),new i(a,o));this.curves.push(s),this.currentPoint.set(a,o)},splineThru:function(e){var t=new ai([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+o,t+s,r,n,i,a)},absarc:function(e,t,r,n,i,a){this.absellipse(e,t,r,r,n,i,a)},ellipse:function(e,t,r,n,i,a,o,s){var c=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+c,t+u,r,n,i,a,o,s)},absellipse:function(e,t,r,n,i,a,o,s){var c=new Jn(e,t,r,n,i,a,o,s);if(0<this.curves.length){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)},copy:function(e){return oi.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=oi.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return oi.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),ci.prototype=Object.assign(Object.create(si.prototype),{constructor:ci,getPointsHoles:function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){si.prototype.copy.call(this,e),this.holes=[];for(var t,r=0,n=e.holes.length;r<n;r++)t=e.holes[r],this.holes.push(t.clone());return this},toJSON:function(){var e=si.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t,r=0,n=this.holes.length;r<n;r++)t=this.holes[r],e.holes.push(t.toJSON());return e},fromJSON:function(e){si.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t,r=0,n=e.holes.length;r<n;r++)t=e.holes[r],this.holes.push((new si).fromJSON(t));return this}}),ui.prototype=Object.assign(Object.create(m.prototype),{constructor:ui,isLight:!0,copy:function(e){return m.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=m.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),li.prototype=Object.assign(Object.create(ui.prototype),{constructor:li,isHemisphereLight:!0,copy:function(e){return ui.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(hi.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),pi.prototype=Object.assign(Object.create(hi.prototype),{constructor:pi,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*lc.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix())}}),di.prototype=Object.assign(Object.create(ui.prototype),{constructor:di,isSpotLight:!0,copy:function(e){return ui.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),fi.prototype=Object.assign(Object.create(ui.prototype),{constructor:fi,isPointLight:!0,copy:function(e){return ui.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),mi.prototype=Object.assign(Object.create(Y.prototype),{constructor:mi,isOrthographicCamera:!0,copy:function(e,t){return Y.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,a=r+e,o=n+t,s=n-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;a=(i+=l*(this.view.offsetX/c))+l*(this.view.width/c),s=(o-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=m.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),gi.prototype=Object.assign(Object.create(hi.prototype),{constructor:gi}),vi.prototype=Object.assign(Object.create(ui.prototype),{constructor:vi,isDirectionalLight:!0,copy:function(e){return ui.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),yi.prototype=Object.assign(Object.create(ui.prototype),{constructor:yi,isAmbientLight:!0}),bi.prototype=Object.assign(Object.create(ui.prototype),{constructor:bi,isRectAreaLight:!0,copy:function(e){return ui.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=ui.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(xi.prototype,{load:function(e,t,r,n){var i=this,a=new Un(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){function t(e){return void 0===r[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),r[e]}var r=this.textures,n=new qc[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(n.morphNormals=e.morphNormals),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.uniforms)for(var a in e.uniforms){var c=e.uniforms[a];switch(n.uniforms[a]={},c.type){case"t":n.uniforms[a].value=t(c.value);break;case"c":n.uniforms[a].value=(new w).setHex(c.value);break;case"v2":n.uniforms[a].value=(new i).fromArray(c.value);break;case"v3":n.uniforms[a].value=(new o).fromArray(c.value);break;case"v4":n.uniforms[a].value=(new u).fromArray(c.value);break;case"m3":n.uniforms[a].value=(new s).fromArray(c.value);case"m4":n.uniforms[a].value=(new p).fromArray(c.value);break;default:n.uniforms[a].value=c.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var l in e.extensions)n.extensions[l]=e.extensions[l];if(void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=t(e.map)),void 0!==e.matcap&&(n.matcap=t(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=t(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=t(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=t(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){var h=e.normalScale;!1===Array.isArray(h)&&(h=[h,h]),n.normalScale=(new i).fromArray(h)}return void 0!==e.displacementMap&&(n.displacementMap=t(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=t(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=t(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=t(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=t(e.specularMap)),void 0!==e.envMap&&(n.envMap=t(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=t(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=t(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=t(e.gradientMap)),n},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var au={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(r){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};wi.prototype=Object.assign(Object.create(z.prototype),{constructor:wi,isInstancedBufferGeometry:!0,copy:function(e){return z.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=z.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),_i.prototype=Object.assign(Object.create(L.prototype),{constructor:_i,isInstancedBufferAttribute:!0,copy:function(e){return L.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=L.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Object.assign(Ti.prototype,{load:function(e,t,r,n){var i=this,a=new Un(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=e.isInstancedBufferGeometry?new wi:new z,r=e.data.index;if(void 0!==r){var n=new ou[r.type](r.array);t.setIndex(new L(n,1))}var i=e.data.attributes;for(var a in i){var s=i[a],c=(n=new ou[s.type](s.array),new(s.isInstancedBufferAttribute?_i:L)(n,s.itemSize,s.normalized));void 0!==s.name&&(c.name=s.name),t.addAttribute(a,c)}var u=e.data.morphAttributes;if(u)for(var a in u){for(var l=u[a],h=[],p=0,d=l.length;p<d;p++){s=l[p],c=new L(n=new ou[s.type](s.array),s.itemSize,s.normalized);void 0!==s.name&&(c.name=s.name),h.push(c)}t.morphAttributes[a]=h}var f=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==f){p=0;for(var m,g=f.length;p!==g;++p)m=f[p],t.addGroup(m.start,m.count,m.materialIndex)}var v=e.data.boundingSphere;if(void 0!==v){var b=new o;void 0!==v.center&&b.fromArray(v.center),t.boundingSphere=new y(b,v.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var ou={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Object.assign(Ei.prototype,{crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,a=void 0===this.path?au.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new Un(i.manager);o.setPath(this.path),o.load(e,function(r){var a=null;try{a=JSON.parse(r)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;return void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase()?void console.error("THREE.ObjectLoader: Can't load "+e):void i.parse(a,t)},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var r=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,n,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),(void 0===e.images||0===e.images.length)&&void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var r,n=0,i=e.length;n<i;n++)t[(r=(new ci).fromJSON(e[n])).uuid]=r;return t},parseGeometries:function(e,t){var r={};if(void 0!==e)for(var n=new Ti,i=0,a=e.length;i<a;i++){var o,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Yc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Yc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Yc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Yc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Yc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Yc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Yc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Yc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Yc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Yc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Yc[s.type]((new iu[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Yc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Yc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],u=0,l=s.shapes.length;u<l;u++)h=t[s.shapes[u]],c.push(h);o=new Yc[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":var h;for(c=[],u=0,l=s.shapes.length;u<l;u++)h=t[s.shapes[u]],c.push(h);var p=s.options.extrudePath;void 0!==p&&(s.options.extrudePath=(new iu[p.type]).fromJSON(p)),o=new Yc[s.type](c,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=n.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)o=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),r[s.uuid]=o}return r},parseMaterials:function(e,t){var r={},n={};if(void 0!==e){var i=new xi;i.setTextures(t);for(var a,o=0,s=e.length;o<s;o++)if("MultiMaterial"===(a=e[o]).type){for(var c,u=[],l=0;l<a.materials.length;l++)void 0===r[(c=a.materials[l]).uuid]&&(r[c.uuid]=i.parse(c)),u.push(r[c.uuid]);n[a.uuid]=u}else void 0===r[a.uuid]&&(r[a.uuid]=i.parse(a)),n[a.uuid]=r[a.uuid]}return n},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=Fn.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),t.push(i)}return t},parseImages:function(e,t){function r(e){return n.manager.itemStart(e),a.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}var n=this,i={};if(void 0!==e&&0<e.length){var a=new jn(new Dn(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var c=e[o],u=c.url;if(Array.isArray(u)){i[c.uuid]=[];for(var l=0,h=u.length;l<h;l++){var p=u[l],d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;i[c.uuid].push(r(d))}}else{d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;i[c.uuid]=r(d)}}}return i},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var i,a=0,o=e.length;a<o;a++){var s;void 0===(i=e[a]).image&&console.warn('THREE.ObjectLoader: No "image" specified for',i.uuid),void 0===t[i.image]&&console.warn("THREE.ObjectLoader: Undefined image",i.image),(s=Array.isArray(t[i.image])?new ge(t[i.image]):new c(t[i.image])).needsUpdate=!0,s.uuid=i.uuid,void 0!==i.name&&(s.name=i.name),void 0!==i.mapping&&(s.mapping=r(i.mapping,su)),void 0!==i.offset&&s.offset.fromArray(i.offset),void 0!==i.repeat&&s.repeat.fromArray(i.repeat),void 0!==i.center&&s.center.fromArray(i.center),void 0!==i.rotation&&(s.rotation=i.rotation),void 0!==i.wrap&&(s.wrapS=r(i.wrap[0],cu),s.wrapT=r(i.wrap[1],cu)),void 0!==i.format&&(s.format=i.format),void 0!==i.type&&(s.type=i.type),void 0!==i.encoding&&(s.encoding=i.encoding),void 0!==i.minFilter&&(s.minFilter=r(i.minFilter,uu)),void 0!==i.magFilter&&(s.magFilter=r(i.magFilter,uu)),void 0!==i.anisotropy&&(s.anisotropy=i.anisotropy),void 0!==i.flipY&&(s.flipY=i.flipY),void 0!==i.premultiplyAlpha&&(s.premultiplyAlpha=i.premultiplyAlpha),void 0!==i.unpackAlignment&&(s.unpackAlignment=i.unpackAlignment),n[i.uuid]=s}return n},parseObject:function(e,t,r){function n(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function i(e){if(void 0!==e){if(Array.isArray(e)){for(var t,n=[],i=0,a=e.length;i<a;i++)t=e[i],void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n.push(r[t]);return n}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}var a;switch(e.type){case"Scene":a=new g,void 0!==e.background&&ka(e.background)&&(a.background=new w(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new Ut(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new Dt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new q(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new mi(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new yi(e.color,e.intensity);break;case"DirectionalLight":a=new vi(e.color,e.intensity);break;case"PointLight":a=new fi(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new bi(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new di(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new li(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=n(e.geometry),s=i(e.material);a=o.bones&&0<o.bones.length?new Ht(o,s):new G(o,s),void 0!==e.drawMode&&a.setDrawMode(e.drawMode);break;case"LOD":a=new Vt;break;case"Line":a=new Yt(n(e.geometry),i(e.material),e.mode);break;case"LineLoop":a=new Kt(n(e.geometry),i(e.material));break;case"LineSegments":a=new qt(n(e.geometry),i(e.material));break;case"PointCloud":case"Points":a=new Qt(n(e.geometry),i(e.material));break;case"Sprite":a=new jt(i(e.material));break;case"Group":a=new Ct;break;default:a=new m}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0===e.matrix?(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)):(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,u=0;u<c.length;u++)a.add(this.parseObject(c[u],t,r));if("LOD"===e.type)for(var l=e.levels,h=0;h<l.length;h++){var p=l[h],d=a.getObjectByProperty("uuid",p.object);void 0!==d&&a.addLevel(d,p.distance)}return a}});var su={UVMapping:300,CubeReflectionMapping:Do,CubeRefractionMapping:Uo,EquirectangularReflectionMapping:Bo,EquirectangularRefractionMapping:zo,SphericalReflectionMapping:Go,CubeUVReflectionMapping:jo,CubeUVRefractionMapping:Vo},cu={RepeatWrapping:Ho,ClampToEdgeWrapping:Wo,MirroredRepeatWrapping:Jo},uu={NearestFilter:Xo,NearestMipmapNearestFilter:Yo,NearestMipmapLinearFilter:qo,LinearFilter:Ko,LinearMipmapNearestFilter:Zo,LinearMipmapLinearFilter:Qo};Ai.prototype={constructor:Ai,setOptions:function(e){return this.options=e,this},load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Zc.get(e);return void 0===a?(fetch(e).then(function(e){return e.blob()}).then(function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)}).then(function(r){Zc.add(e,r),t&&t(r),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}),void i.manager.itemStart(e)):(i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Si.prototype,{moveTo:function(e,t){this.currentPath=new si,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,a){this.currentPath.bezierCurveTo(e,t,r,n,i,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],a=new ci;a.curves=i.curves,t.push(a)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,a=0;a<r;i=a++){var o=t[i],s=t[a],c=s.x-o.x,u=s.y-o.y;if(Ea(u)>Da){if(0>u&&(o=t[a],c=-c,s=t[i],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y!==o.y){var l=u*(e.x-o.x)-c*(e.y-o.y);if(0==l)return!0;if(0>l)continue;n=!n}else if(e.x===o.x)return!0}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return n}var i=Jc.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return r(a);var o,s,c,u=[];if(1===a.length)return s=a[0],(c=new ci).curves=s.curves,u.push(c),u;var l=!i(a[0].getPoints());l=e?!l:l;var h,p=[],d=[],f=[],m=0;d[m]=void 0,f[m]=[];for(var g=0,v=a.length;g<v;g++)o=i(h=(s=a[g]).getPoints()),(o=e?!o:o)?(!l&&d[m]&&m++,d[m]={s:new ci,p:h},d[m].s.curves=s.curves,l&&m++,f[m]=[]):f[m].push({h:s,p:h[0]});if(!d[0])return r(a);if(1<d.length){for(var y=!1,b=[],x=0,w=d.length;x<w;x++)p[x]=[];var _;for(x=0,w=d.length;x<w;x++){_=f[x];for(var T=0;T<_.length;T++){for(var E=_[T],A=!0,S=0;S<d.length;S++)n(E.p,d[S].p)&&(x!==S&&b.push({froms:x,tos:S,hole:T}),A?(A=!1,p[S].push(E)):y=!0);A&&p[x].push(E)}}0<b.length&&!y&&(f=p)}g=0;for(var M,L=d.length;g<L;g++){c=d[g].s,u.push(c);for(var N=0,R=(M=f[g]).length;N<R;N++)c.holes.push(M[N].h)}return u}}),Object.assign(Mi.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var r=[],n=function(e,t,r){for(var n,i=Array.from?Array.from(e):(e+"").split(""),a=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*a,s=[],c=0,u=0,l=0;l<i.length;l++)if("\n"===(n=i[l]))c=0,u-=o;else{var h=Li(n,a,c,u,r);c+=h.offsetX,s.push(h.path)}return s}(e,t,this.data),i=0,a=n.length;i<a;i++)Array.prototype.push.apply(r,n[i].toShapes());return r}}),Object.assign(Ni.prototype,{load:function(e,t,r,n){var i=this,a=new Un(this.manager);a.setPath(this.path),a.load(e,function(e){var r;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(r);t&&t(n)},r,n)},parse:function(e){return new Mi(e)},setPath:function(e){return this.path=e,this}}),Ri.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r],a=t[r+1];if(i.test(e))return a}return null}},Object.assign(Ri.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:function(){var e={NoBlending:Za,NormalBlending:Qa,AdditiveBlending:$a,SubtractiveBlending:eo,MultiplyBlending:to,CustomBlending:ro},t=new w,r=new Hn,n=new xi;return function(i,a,o){function s(e,t,n,i,s){var u,l=a+e,h=Ri.Handlers.get(l);null===h?(r.setCrossOrigin(o),u=r.load(l)):u=h.load(l),void 0!==t&&(u.repeat.fromArray(t),1!==t[0]&&(u.wrapS=Ho),1!==t[1]&&(u.wrapT=Ho)),void 0!==n&&u.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(u.wrapS=Ho),"mirror"===i[0]&&(u.wrapS=Jo),"repeat"===i[1]&&(u.wrapT=Ho),"mirror"===i[1]&&(u.wrapT=Jo)),void 0!==s&&(u.anisotropy=s);var p=lc.generateUUID();return c[p]=u,p}var c={},u={uuid:lc.generateUUID(),type:"MeshLambertMaterial"};for(var l in i){var h=i[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=e[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":u.color=t.fromArray(h).getHex();break;case"colorSpecular":u.specular=t.fromArray(h).getHex();break;case"colorEmissive":u.emissive=t.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=s(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=s(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=s(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=s(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=s(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=s(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=s(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=s(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=s(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=s(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=Ja;break;case"doubleSided":u.side=Xa;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[l]=h;break;case"vertexColors":!0===h&&(u.vertexColors=Ka),"face"===h&&(u.vertexColors=qa);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,h)}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,1>u.opacity&&(u.transparent=!0),n.setTextures(c),n.parse(u)}}()});var lu,hu={getContext:function(){return void 0===lu&&(lu=new(window.AudioContext||window.webkitAudioContext)),lu},setContext:function(e){lu=e}};Object.assign(Ci.prototype,{load:function(e,t,r,n){var i=new Un(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,function(e){var r=e.slice(0);hu.getContext().decodeAudioData(r,function(e){t(e)})},r,n)},setPath:function(e){return this.path=e,this}}),Object.assign(Ii.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;9>t;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScale(a[1],.488603*n),t.addScale(a[2],.488603*i),t.addScale(a[3],.488603*r),t.addScale(a[4],r*n*1.092548),t.addScale(a[5],n*i*1.092548),t.addScale(a[6],.315392*(3*i*i-1)),t.addScale(a[7],r*i*1.092548),t.addScale(a[8],.546274*(r*r-n*n)),t},getIrradianceAt:function(e,t){var r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScale(a[1],1.023328*n),t.addScale(a[2],1.023328*i),t.addScale(a[3],1.023328*r),t.addScale(a[4],.858086*r*n),t.addScale(a[5],.858086*n*i),t.addScale(a[6],.743125*i*i-.247708),t.addScale(a[7],.858086*r*i),t.addScale(a[8],.429043*(r*r-n*n)),t},add:function(e){for(var t=0;9>t;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;9>t;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var r=0;9>r;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this},equals:function(e){for(var t=0;9>t;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e){for(var t=this.coefficients,r=0;9>r;r++)t[r].fromArray(e,3*r);return this},toArray:function(){for(var e=[],t=this.coefficients,r=0;9>r;r++)t[r].toArray(e,3*r);return e}}),Object.assign(Ii,{getBasisAt:function(e,t){var r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}}),Oi.prototype=Object.assign(Object.create(ui.prototype),{constructor:Oi,isLightProbe:!0,copy:function(e){return ui.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return ui.prototype.toJSON.call(this,e)}}),Pi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Pi,isHemisphereLightProbe:!0,copy:function(e){return Oi.prototype.copy.call(this,e),this},toJSON:function(e){return Oi.prototype.toJSON.call(this,e)}}),Fi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Fi,isAmbientLightProbe:!0,copy:function(e){return Oi.prototype.copy.call(this,e),this},toJSON:function(e){return Oi.prototype.toJSON.call(this,e)}}),Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new q,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new q,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}.prototype,{update:function(){var e,t,r,n,i,a,o,s,c=new p,u=new p;return function(l){if(e!==this||t!==l.focus||r!==l.fov||n!==l.aspect*this.aspect||i!==l.near||a!==l.far||o!==l.zoom||s!==this.eyeSep){e=this,t=l.focus,r=l.fov,n=l.aspect*this.aspect,i=l.near,a=l.far,o=l.zoom;var h,p,d=l.projectionMatrix.clone(),f=(s=this.eyeSep/2)*i/t,m=i*ya(lc.DEG2RAD*r*.5)/o;u.elements[12]=-s,c.elements[12]=s,h=-m*n+f,p=m*n+f,d.elements[0]=2*i/(p-h),d.elements[8]=(p+h)/(p-h),this.cameraL.projectionMatrix.copy(d),h=-m*n-f,p=m*n-f,d.elements[0]=2*i/(p-h),d.elements[8]=(p+h)/(p-h),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(c)}}()}),Object.assign(ki.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Di.prototype=Object.assign(Object.create(m.prototype),{constructor:Di,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new o,t=new a,r=new o,n=new o,i=new ki;return function(a){m.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,s=this.up;if(this.timeDelta=i.getDelta(),this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),o.positionX){var c=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(e.x,c),o.positionY.linearRampToValueAtTime(e.y,c),o.positionZ.linearRampToValueAtTime(e.z,c),o.forwardX.linearRampToValueAtTime(n.x,c),o.forwardY.linearRampToValueAtTime(n.y,c),o.forwardZ.linearRampToValueAtTime(n.z,c),o.upX.linearRampToValueAtTime(s.x,c),o.upY.linearRampToValueAtTime(s.y,c),o.upZ.linearRampToValueAtTime(s.z,c)}else o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z,s.x,s.y,s.z)}}()}),Ui.prototype=Object.assign(Object.create(m.prototype),{constructor:Ui,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Bi.prototype=Object.assign(Object.create(Ui.prototype),{constructor:Bi,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(){var e=new o,t=new a,r=new o,n=new o;return function(i){if(m.prototype.updateMatrixWorld.call(this,i),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(e,t,r),n.set(0,0,1).applyQuaternion(t);var a=this.panner;if(a.positionX){var o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(e.x,o),a.positionY.linearRampToValueAtTime(e.y,o),a.positionZ.linearRampToValueAtTime(e.z,o),a.orientationX.linearRampToValueAtTime(n.x,o),a.orientationY.linearRampToValueAtTime(n.y,o),a.orientationZ.linearRampToValueAtTime(n.z,o)}else a.setPosition(e.x,e.y,e.z),a.setOrientation(n.x,n.y,n.z)}}}()}),Object.assign(zi.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(Gi.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)r[i+o]=r[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,a=this.binding;this.cumulativeWeight=0,1>i&&this._mixBufferRegion(r,n,3*t,1-i,t);for(var o=t;o!==t+t;++o)if(r[o]!==r[o+t]){a.setValue(r,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,r=this.valueSize,n=3*r;e.getValue(t,n);for(var i=r;i!==n;++i)t[i]=t[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(.5<=n)for(var a=0;a!==i;++a)e[t+a]=e[r+a]},_slerp:function(e,t,r,n){a.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var a,o=0;o!==i;++o)e[a=t+o]=e[a]*(1-n)+e[r+o]*n}});var pu,du,fu,mu,gu="\\[\\]\\.:\\/";Object.assign(ji.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(Vi,{Composite:ji,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new Vi.Composite(e,t,r):new Vi(e,t,r)},sanitizeNodeName:function(){var e=/[\[\]\.:\/]/g;return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^"+gu+"]",t="[^"+gu.replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC",e),n=/(WCOD+)?/.source.replace("WCOD",t),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),a=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),o=new RegExp("^"+r+n+i+a+"$"),s=["material","materials","bones"];return function(e){var t=o.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==s.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){var n=function(e){for(var r,i=0;i<e.length;i++){if((r=e[i]).name===t||r.uuid===t)return r;var a=n(r.children);if(a)return a}return null},i=n(e.children);if(i)return i}return null}}),Object.assign(Vi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=Vi.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var a=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[n];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0===e.needsUpdate?void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate):c=this.Versioning.NeedsUpdate;var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===i){i=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Vi.prototype,{_getValue_unbound:Vi.prototype.getValue,_setValue_unbound:Vi.prototype.setValue}),Object.assign(function(){this.uuid=lc.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,u=0,l=arguments.length;u!==l;++u){var h=arguments[u],p=h.uuid,d=n[p];if(void 0===d){d=t++,n[p]=d,e.push(h);for(var f=0,m=s;f!==m;++f)o[f].push(new Vi(h,i[f],a[f]))}else if(d<r){c=e[d];var g=--r,v=e[g];n[v.uuid]=d,e[d]=v,n[p]=g,e[g]=h;for(f=0,m=s;f!==m;++f){var y=o[f],b=y[g],x=y[d];y[d]=b,void 0===x&&(x=new Vi(h,i[f],a[f])),y[g]=x}}else e[d]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],c=s.uuid,u=r[c];if(void 0!==u&&u>=t){var l=t++,h=e[l];r[h.uuid]=u,e[u]=h,r[c]=l,e[l]=s;for(var p=0;p!==i;++p){var d=n[p],f=d[l],m=d[u];d[u]=f,d[l]=m}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],u=c.uuid,l=n[u];if(void 0!==l)if(delete n[u],l<r){var h=--r,p=e[h],d=e[y=--t];n[p.uuid]=l,e[l]=p,n[d.uuid]=h,e[h]=d,e.pop();for(var f=0,m=a;f!==m;++f){var g=(b=i[f])[h],v=b[y];b[l]=g,b[h]=v,b.pop()}}else{var y;n[(d=e[y=--t]).uuid]=l,e[l]=d,e.pop();var b;for(f=0,m=a;f!==m;++f)(b=i[f])[l]=b[y],b.pop()}}this.nCachedObjects_=r},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=Array(c);n=i.length,r[e]=n,a.push(e),o.push(t),i.push(l);for(var h,p=u,d=s.length;p!==d;++p)h=s[p],l[p]=new Vi(h,e,t);return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=r,a[r]=s,a.pop(),i[r]=i[o],i.pop(),n[r]=n[o],n.pop()}}}),Object.assign(Hi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){var n=this._clip.duration,i=e._clip.duration;e.warp(1,i/n,t),this.warp(n/i,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=i,s[1]=i+r,c[0]=e/o,c[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*r;if(0>a||0===r)return;this._startTime=null,t=r*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(0<s)for(var c=this._interpolants,u=this._propertyBindings,l=0,h=c.length;l!==h;++l)c[l].evaluate(o),u[l].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r)t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,r=this._clip.duration,n=this.loop,i=this._loopCount,a=2202===n;if(0===e)return-1===i?t:a&&1==(1&i)?r-t:t;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=r)t=r;else{if(!(0>t)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}}else{if(-1===i&&(0<=e?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=r||0>t){var o=Fa(t/r);t-=r*o,i+=Ea(o);var s=this.repetitions-i;if(0>=s)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?r:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(1==s){var c=0>e;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=t;if(a&&1==(1&i))return r-t}return t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=Xs,n.endingEnd=Xs):(n.endingStart=e?this.zeroSlopeAtStart?Xs:Js:2402,n.endingEnd=t?this.zeroSlopeAtEnd?Xs:Js:2402)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=r,this}}),Wi.prototype=Object.assign(Object.create(n.prototype),{constructor:Wi,_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==i;++l){var h=n[l],p=h.name,d=u[p];if(void 0!==d)a[l]=d;else{if(void 0!==(d=a[l])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var f=t&&t._propertyBindings[l].binding.parsedPath;++(d=new Gi(Vi.create(r,p,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,p),a[l]=d}o[l].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}for(var i,a=e._propertyBindings,o=0,s=a.length;o!==s;++o)0==(i=a[o]).useCount++&&(this._lendBinding(i),i.saveOriginalState());this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t,r=e._propertyBindings,n=0,i=r.length;n!==i;++n)0==--(t=r[n]).useCount&&(t.restoreOriginalState(),this._takeBackBinding(t));this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,c=s[s.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t,r=e._propertyBindings,n=0,i=r.length;n!==i;++n)0==--(t=r[n]).referenceCount&&this._removeInactiveBinding(t)},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],a=this._bindings;void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,o=a[n],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[n]},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new An(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?Fn.findByName(r,e):e,a=null===i?e:i.uuid,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[n];if(void 0!==c)return c;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new Hi(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,a,n),u},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?Fn.findByName(r,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0===o?null:o.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Pa(e),a=this._accuIndex^=1,o=0;o!==r;++o)t[o]._update(n,e,i,a);var s=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var a,o=i.knownActions,s=0,c=o.length;s!==c;++s){a=o[s],this._deactivateAction(a);var u=a._cacheIndex,l=t[t.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(a)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Ji.prototype.clone=function(){return new Ji(void 0===this.value.clone?this.value:this.value.clone())},Xi.prototype=Object.assign(Object.create(Bt.prototype),{constructor:Xi,isInstancedInterleavedBuffer:!0,copy:function(e){return Bt.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(function(e,t,r,n){this.ray=new b(e,t),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this._camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this._camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){var n=r||[];return qi(e,this,n,t),n.sort(Yi),n},intersectObjects:function(e,t,r){var n=r||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,a=e.length;i<a;i++)qi(e[i],this,n,t);return n.sort(Yi),n}}),Object.assign(function(e,t,r){return this.radius=void 0===e?1:e,this.phi=void 0===t?0:t,this.theta=void 0===r?0:r,this}.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Ca(1e-6,Ia(Oa-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Aa(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Ta(e,r),this.phi=xa(lc.clamp(t/this.radius,-1,1))),this}}),Object.assign(function(e,t,r){return this.radius=void 0===e?1:e,this.theta=void 0===t?0:t,this.y=void 0===r?0:r,this}.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Aa(e*e+r*r),this.theta=Ta(e,r),this.y=t,this}}),Object.assign(Ki.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new i;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new i),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new i),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new i),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new i),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new i;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Zi.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new o),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new o),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new o),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){null==pu&&(pu=new o,du=new o),pu.subVectors(e,this.start),du.subVectors(this.end,this.start);var r=du.dot(du),n=du.dot(pu)/r;return t&&(n=lc.clamp(n,0,1)),n},closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new o),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Qi.prototype=Object.create(m.prototype),Qi.prototype.constructor=Qi,Qi.prototype.isImmediateRenderObject=!0,$i.prototype=Object.create(qt.prototype),$i.prototype.constructor=$i,$i.prototype.update=function(){var e=new o,t=new o,r=new s;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s,c=o.vertices,u=o.faces,l=0,h=0,p=u.length;h<p;h++)for(var d=0,f=(s=u[h]).vertexNormals.length;d<f;d++){var m=c[s[n[d]]],g=s.vertexNormals[d];e.copy(m).applyMatrix4(i),t.copy(g).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),a.setXYZ(l,e.x,e.y,e.z),++l,a.setXYZ(l,t.x,t.y,t.z),++l}else if(o&&o.isBufferGeometry){var v=o.attributes.position,y=o.attributes.normal;for(l=0,d=0,f=v.count;d<f;d++)e.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(i),t.set(y.getX(d),y.getY(d),y.getZ(d)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),a.setXYZ(l,e.x,e.y,e.z),++l,a.setXYZ(l,t.x,t.y,t.z),++l}a.needsUpdate=!0}}(),ea.prototype=Object.create(m.prototype),ea.prototype.constructor=ea,ea.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ea.prototype.update=function(){var e=new o;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,r=t*ya(this.light.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0===this.color?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),ta.prototype=Object.create(qt.prototype),ta.prototype.constructor=ta,ta.prototype.updateMatrixWorld=function(){var e=new o,t=new p,r=new p;return function(n){var i=this.bones,a=this.geometry,o=a.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s,c=0,u=0;c<i.length;c++)(s=i[c]).parent&&s.parent.isBone&&(t.multiplyMatrices(r,s.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(u,e.x,e.y,e.z),t.multiplyMatrices(r,s.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(u+1,e.x,e.y,e.z),u+=2);a.getAttribute("position").needsUpdate=!0,m.prototype.updateMatrixWorld.call(this,n)}}(),ra.prototype=Object.create(G.prototype),ra.prototype.constructor=ra,ra.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ra.prototype.update=function(){void 0===this.color?this.material.color.copy(this.light.color):this.material.color.set(this.color)},na.prototype=Object.create(Yt.prototype),na.prototype.constructor=na,na.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Ca(e.r,e.g,e.b);1<t&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},na.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},ia.prototype=Object.create(m.prototype),ia.prototype.constructor=ia,ia.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ia.prototype.update=function(){var e=new o,t=new w,r=new w;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");t.copy(this.light.color),r.copy(this.light.groundColor);for(var a,o=0,s=i.count;o<s;o++)a=o<s/2?t:r,i.setXYZ(o,a.r,a.g,a.b);i.needsUpdate=!0}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),aa.prototype=Object.create(G.prototype),aa.prototype.constructor=aa,aa.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},aa.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},oa.prototype=Object.assign(Object.create(qt.prototype),{constructor:oa,copy:function(e){return qt.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),sa.prototype=Object.create(qt.prototype),sa.prototype.constructor=sa,ca.prototype=Object.create(Yt.prototype),ca.prototype.constructor=ca,ca.prototype.update=function(){function e(e,n,a,o){var s=(n-e)/a;for(f.setXYZ(h,0,0,0),p++,t=e;t<n;t+=s)r=h+p,f.setXYZ(r,wa(t)*i,0,_a(t)*i),f.setXYZ(r+1,wa(Ia(t+s,n))*i,0,_a(Ia(t+s,n))*i),f.setXYZ(r+2,0,0,0),p+=3;d.addGroup(h,p,o),h+=p,p=0}var t,r,n=this.audio,i=this.range,a=this.divisionsInnerAngle,o=this.divisionsOuterAngle,s=lc.degToRad(n.panner.coneInnerAngle),c=lc.degToRad(n.panner.coneOuterAngle),u=s/2,l=c/2,h=0,p=0,d=this.geometry,f=d.attributes.position;d.clearGroups(),e(-l,-u,o,0),e(-u,u,a,1),e(u,l,o,0),f.needsUpdate=!0,s===c&&(this.material[0].visible=!1)},ca.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},ua.prototype=Object.create(qt.prototype),ua.prototype.constructor=ua,ua.prototype.update=function(){var e=new o,t=new o,r=new s;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,u=0,l=s.length;u<l;u++){var h=s[u],p=h.normal;e.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(n),t.copy(p).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),i.setXYZ(c,e.x,e.y,e.z),++c,i.setXYZ(c,t.x,t.y,t.z),++c}i.needsUpdate=!0}}(),la.prototype=Object.create(m.prototype),la.prototype.constructor=la,la.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},la.prototype.update=function(){var e=new o,t=new o,r=new o;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e),this.lightPlane.lookAt(t),void 0===this.color?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=r.length()}}(),ha.prototype=Object.create(qt.prototype),ha.prototype.constructor=ha,ha.prototype.update=function(){function e(e,a,o,s){n.set(a,o,s).unproject(i);var c=r[e];if(void 0!==c)for(var u=t.getAttribute("position"),l=0,h=c.length;l<h;l++)u.setXYZ(c[l],n.x,n.y,n.z)}var t,r,n=new o,i=new Y;return function(){t=this.geometry,r=this.pointMap;i.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),e("c",0,0,-1),e("t",0,0,1),e("n1",-1,-1,-1),e("n2",1,-1,-1),e("n3",-1,1,-1),e("n4",1,1,-1),e("f1",-1,-1,1),e("f2",1,-1,1),e("f3",-1,1,1),e("f4",1,1,1),e("u1",.7,1.1,-1),e("u2",-.7,1.1,-1),e("u3",0,2,-1),e("cf1",-1,0,1),e("cf2",1,0,1),e("cf3",0,-1,1),e("cf4",0,1,1),e("cn1",-1,0,-1),e("cn2",1,0,-1),e("cn3",0,-1,-1),e("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),pa.prototype=Object.create(qt.prototype),pa.prototype.constructor=pa,pa.prototype.update=function(){var e=new v;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,n=e.max,i=this.geometry.attributes.position,a=i.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=r.x,a[4]=n.y,a[5]=n.z,a[6]=r.x,a[7]=r.y,a[8]=n.z,a[9]=n.x,a[10]=r.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=r.z,a[15]=r.x,a[16]=n.y,a[17]=r.z,a[18]=r.x,a[19]=r.y,a[20]=r.z,a[21]=n.x,a[22]=r.y,a[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),pa.prototype.setFromObject=function(e){return this.object=e,this.update(),this},pa.prototype.copy=function(e){return qt.prototype.copy.call(this,e),this.object=e.object,this},pa.prototype.clone=function(){return(new this.constructor).copy(this)},da.prototype=Object.create(qt.prototype),da.prototype.constructor=da,da.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),m.prototype.updateMatrixWorld.call(this,e))},fa.prototype=Object.create(Yt.prototype),fa.prototype.constructor=fa,fa.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;1e-8>Ea(t)&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=0>t?Ja:Wa,this.lookAt(this.plane.normal),m.prototype.updateMatrixWorld.call(this,e)},ma.prototype=Object.create(m.prototype),ma.prototype.constructor=ma,ma.prototype.setDirection=function(){var e,t=new o;return function(r){.99999<r.y?this.quaternion.set(0,0,0,1):-.99999>r.y?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=xa(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),ma.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Ca(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},ma.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},ma.prototype.copy=function(e){return m.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},ma.prototype.clone=function(){return(new this.constructor).copy(this)},ga.prototype=Object.create(qt.prototype),ga.prototype.constructor=ga,Wn.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Wn.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(oi.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t,r=new j,n=0,i=e.length;n<i;n++)t=e[n],r.vertices.push(new o(t.x,t.y,t.z||0));return r}}),Object.assign(si.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Object.create(qn.prototype),Object.create(qn.prototype),va.prototype=Object.create(qn.prototype),Object.assign(va.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),oa.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ta.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ri.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),au.extractUrlBase(e)}}),Object.assign(Ei.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Ki.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(v.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Zi.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(lc,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),lc.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),lc.ceilPowerOfTwo(e)}}),Object.assign(s.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(p.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return null==e&&(e=new o),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,n,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,r,i,a)}}),$.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},a.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(b.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(x.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(x,{barycoordFromPoint:function(e,t,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),x.getBarycoord(e,t,r,n,i)},normal:function(e,t,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),x.getNormal(e,t,r,n)}}),Object.assign(ci.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Wr(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new rn(this,e)}}),Object.assign(i.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(o.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(u.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(j.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(m.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(m.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Vt.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Wt.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Ht.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Wn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),q.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(ui.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(L.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(z.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(z.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Jr.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Ji.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(S.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new w}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(vn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(X.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(kt.prototype,{clearTarget:function(e,t,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,r,n)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(kt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}}}),Object.defineProperties(Mt.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Z.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(l.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Pt.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Ui.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Ci).load(e,function(e){t.setBuffer(e)}),this},zi.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},K.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},fc.crossOrigin=void 0,fc.loadTexture=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Hn;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,r,void 0,n);return t&&(a.mapping=t),a},fc.loadTextureCube=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Vn;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,r,void 0,n);return t&&(a.mapping=t),a},fc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},fc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},function(e,t,r){"use strict";function n(e,t,r){return new Promise(function(n,i){e.load(t,function(e){r?r(e,n):n(e)},function(e){console.log(e)},function(e){i(e)})})}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";var n=r(0),i=r(9);const a=function(e){this.logging={enabled:!0,debug:!1},this.callbacks={onParseProgress:null,onMeshAlter:null},this.materialHandler=e};a.prototype={constructor:a,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},_setCallbacks:function(e,t){null!=e&&(this.callbacks.onParseProgress=e),null!=t&&(this.callbacks.onMeshAlter=t)},buildMeshes:function(e){let t=e.params.meshName,r=new n.l;r.addAttribute("position",new n.k(new Float32Array(e.buffers.vertices),3)),null!==e.buffers.indices&&r.setIndex(new n.k(new Uint32Array(e.buffers.indices),1)),null!==e.buffers.colors&&r.addAttribute("color",new n.k(new Float32Array(e.buffers.colors),3)),null===e.buffers.normals?r.computeVertexNormals():r.addAttribute("normal",new n.k(new Float32Array(e.buffers.normals),3)),null!==e.buffers.uvs&&r.addAttribute("uv",new n.k(new Float32Array(e.buffers.uvs),2)),null!==e.buffers.skinIndex&&r.addAttribute("skinIndex",new n.k(new Uint16Array(e.buffers.skinIndex),4)),null!==e.buffers.skinWeight&&r.addAttribute("skinWeight",new n.k(new Float32Array(e.buffers.skinWeight),4));let i,a,o,s=e.materials.materialNames,c=e.materials.multiMaterial,u=[];for(o in s)a=s[o],i=this.materialHandler.getMaterial(a),c&&u.push(i);if(c){i=u;let t,n=e.materials.materialGroups;for(o in n)t=n[o],r.addGroup(t.start,t.count,t.index)}let l,h,p=[],d=this.callbacks.onMeshAlter,f=!0,m=null===e.geometryType?0:e.geometryType;if(d&&(h=d({detail:{meshName:t,bufferGeometry:r,material:i,geometryType:m}})),h)if(h.isDisregardMesh())f=!1;else if(h.providesAlteredMeshes()){for(let e in h.meshes)p.push(h.meshes[e]);f=!1}f&&(e.computeBoundingSphere&&r.computeBoundingSphere(),(l=0===m?new n.vb(r,i):1===m?new n.ib(r,i):new n.Sb(r,i)).name=t,p.push(l));let g=e.params.meshName;if(0<p.length){let r=[];for(let e in p)l=p[e],r[e]=l.name;g+=": Adding mesh(es) ("+r.length+": "+r+") from input mesh: "+t,g+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else g+=": Not adding mesh: "+t,g+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";let v=this.callbacks.onParseProgress;return v&&v("progress",g,e.progress.numericalValue),p}};const o=function(e,t){this.disregardMesh=!0===e,this.alteredMesh=!0===t,this.meshes=[]};o.prototype={constructor:o,addMesh:function(e){this.meshes.push(e),this.alteredMesh=!0},isDisregardMesh:function(){return this.disregardMesh},providesAlteredMeshes:function(){return this.alteredMesh}};const s=function(){this.logging={enabled:!0,debug:!1},this.callbacks={onLoadMaterials:null},this.materials={},this._createDefaultMaterials()};s.prototype={constructor:s,setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},_setCallbacks:function(e){null!=e&&(this.callbacks.onLoadMaterials=e)},_createDefaultMaterials:function(){let e=new n.Ab({color:14479871});e.name="defaultMaterial";let t=new n.Ab({color:14479871});t.name="defaultVertexColorMaterial",t.vertexColors=n.Mc;let r=new n.gb;r.name="defaultLineMaterial";let i=new n.Tb({size:.1});i.name="defaultPointMaterial";let a={};a[e.name]=e,a[t.name]=t,a[r.name]=r,a[i.name]=i,this.addMaterials(a)},addPayloadMaterials:function(e){let t,r,i=e.materials.materialCloneInstructions,a={};if(null!=i){let e=i.materialNameOrg;e=null!=e?e:"";let n=this.materials[e];if(n){t=n.clone(),r=i.materialName,t.name=r;let e=i.materialProperties;for(let r in e)t.hasOwnProperty(r)&&e.hasOwnProperty(r)&&(t[r]=e[r]);this.materials[r]=t,a[r]=t}else console.info('Requested material "'+e+'" is not available!')}let o=e.materials.serializedMaterials;if(null!=o&&0<Object.keys(o).length){let e,i=new n.rb;for(r in o)null!=(e=o[r])&&(t=i.parse(e),this.logging.enabled&&console.info('De-serialized material with name "'+r+'" will be added.'),this.materials[r]=t,a[r]=t)}return o=e.materials.runtimeMaterials,a=this.addMaterials(o,a)},addMaterials:function(e,t){if(null==t&&(t={}),null!=e&&0<Object.keys(e).length){let r;for(let n in e)r=e[n],this.materials[n]=r,t[n]=r,this.logging.enabled&&console.info('Material with name "'+n+'" was added.')}return t},getMaterials:function(){return this.materials},getMaterial:function(e){return this.materials[e]},getMaterialsJSON:function(){let e,t={};for(let r in this.materials)e=this.materials[r],t[r]=e.toJSON();return t}},r.d(t,"a",function(){return c});const c=function(e){this.manager=null!=e?e:n.D,this.logging={enabled:!0,debug:!1},this.modelName="",this.instanceNo=0,this.path=void 0,this.resourcePath=void 0,this.useIndices=!1,this.disregardNormals=!1,this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.baseObject3d=new n.R,this.callbacks={onParseProgress:void 0,genericErrorHandler:void 0},this.materialHandler=new s,this.meshReceiver=new a(this.materialHandler)};c.OBJLOADER2_VERSION="3.0.0-beta2",console.info("Using OBJLoader2 version: "+c.OBJLOADER2_VERSION),c.prototype={constructor:c,setLogging:function(e,t){return this.logging.enabled=!0===e,this.logging.debug=!0===t,this},setModelName:function(e){return this.modelName=e||this.modelName,this},setPath:function(e){return this.path=e||this.path,this},setResourcePath:function(e){this.resourcePath=e||this.resourcePath},setBaseObject3d:function(e){return this.baseObject3d=null==e?this.baseObject3d:e,this},addMaterials:function(e){this.materialHandler.addMaterials(e)},setUseIndices:function(e){return this.useIndices=!0===e,this},setDisregardNormals:function(e){return this.disregardNormals=!0===e,this},setMaterialPerSmoothingGroup:function(e){return this.materialPerSmoothingGroup=!0===e,this},setUseOAsMesh:function(e){return this.useOAsMesh=!0===e,this},setGenericErrorHandler:function(e){null!=e&&(this.callbacks.genericErrorHandler=e)},_setCallbacks:function(e,t,r){null!=e&&(this.callbacks.onParseProgress=e),this.meshReceiver._setCallbacks(e,t),this.materialHandler._setCallbacks(r)},_onProgress:function(e,t,r){let n=t||"",i={detail:{type:e,modelName:this.modelName,instanceNo:this.instanceNo,text:n,numericalValue:r}};this.callbacks.onParseProgress&&this.callbacks.onParseProgress(i),this.logging.enabled&&this.logging.debug&&console.log(n)},_onError:function(e){this.callbacks.genericErrorHandler&&this.callbacks.genericErrorHandler(e),this.logging.enabled&&this.logging.debug&&console.log(e)},load:function(e,t,r,i,a){let o=this;null==i&&(i=function(e){let t=e;e.currentTarget&&null!==e.currentTarget.statusText&&(t="Error occurred while downloading!\nurl: "+e.currentTarget.responseURL+"\nstatus: "+e.currentTarget.statusText),o._onError(t)}),e||i("An invalid url was provided. Unable to continue!");let s=new URL(e,window.location.href).href,c=s,u=s.split("/");if(2<u.length){c=u[u.length-1];let e=u.slice(0,u.length-1).join("/")+"/";null!=e&&(this.path=e)}if(null==r){let t=0,n=0;r=function(r){if(r.lengthComputable&&(n=r.loaded/r.total)>t){t=n;let r='Download of "'+e+'": '+(100*n).toFixed(2)+"%";o._onProgress("progressLoad",r,n)}}}this._setCallbacks(null,a,null);let l=new n.L(this.manager);l.setPath(this.path||this.resourcePath),l.setResponseType("arraybuffer"),l.load(c,function(e){t(o.parse(e))},r,i)},parse:function(e){if(null==e)throw"Provided content is not a valid ArrayBuffer or String. Unable to continue parsing";this.logging.enabled&&console.time("OBJLoader parse: "+this.modelName);let t=new i.a;t.setLogging(this.logging.enabled,this.logging.debug),t.setMaterialPerSmoothingGroup(this.materialPerSmoothingGroup),t.setUseOAsMesh(this.useOAsMesh),t.setUseIndices(this.useIndices),t.setDisregardNormals(this.disregardNormals),t.setMaterials(this.materialHandler.getMaterials());let r=this;return t.setCallbackOnAssetAvailable(function(e){r._onAssetAvailable(e)}),t.setCallbackOnProgress(function(e,t){r._onProgress("progressParse",e,t)}),t.setCallbackOnError(function(e){r._onError(e)}),e instanceof ArrayBuffer||e instanceof Uint8Array?(this.logging.enabled&&console.info("Parsing arrayBuffer..."),t.parse(e)):"string"==typeof e||e instanceof String?(this.logging.enabled&&console.info("Parsing text..."),t.parseText(e)):r._onError("Provided content was neither of type String nor Uint8Array! Aborting..."),this.logging.enabled&&console.timeEnd("OBJLoader parse: "+this.modelName),this.baseObject3d},_onAssetAvailable:function(e){if("assetAvailable"===e.cmd)if("mesh"===e.type){let t=this.meshReceiver.buildMeshes(e);for(let e of t)this.baseObject3d.add(e)}else"material"===e.type&&this.materialHandler.addPayloadMaterials(e)}}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),i=function(e){this.manager=void 0===e?n.D:e};i.prototype={constructor:i,load:function(e,t,r,i){var a=this,o=new n.xc,s=new n.L(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(e,function(e){o.image=a.parse(e),o.needsUpdate=!0,void 0!==t&&t(o)},r,i),o},parse:function(e){var t=48,r=4,n=0,i=1,a=2,o=3;19>e.length&&console.error("THREE.TGALoader: Not enough data to contain header.");var s=new Uint8Array(e),c=0,u={id_length:s[c++],colormap_type:s[c++],image_type:s[c++],colormap_index:s[c++]|s[c++]<<8,colormap_length:s[c++]|s[c++]<<8,colormap_size:s[c++],origin:[s[c++]|s[c++]<<8,s[c++]|s[c++]<<8],width:s[c++]|s[c++]<<8,height:s[c++]|s[c++]<<8,pixel_size:s[c++],flags:s[c++]};(function(e){switch(e.image_type){case 1:case 9:(256<e.colormap_length||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case 2:case 3:case 10:case 11:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case 0:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(0>=e.width||0>=e.height)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)})(u),u.id_length+c>e.length&&console.error("THREE.TGALoader: No data."),c+=u.id_length;var l=!1,h=!1,p=!1;switch(u.image_type){case 9:l=!0,h=!0;break;case 1:h=!0;break;case 10:l=!0;break;case 2:break;case 11:l=!0,p=!0;break;case 3:p=!0}var d="undefined"!=typeof OffscreenCanvas,f=d?new OffscreenCanvas(u.width,u.height):document.createElement("canvas");f.width=u.width,f.height=u.height;var m=f.getContext("2d"),g=m.createImageData(u.width,u.height),v=function(e,t,r,n,i){var a,o,s,c;if(o=r.pixel_size>>3,s=r.width*r.height*o,t&&(c=i.subarray(n,n+=r.colormap_length*(r.colormap_size>>3))),e){a=new Uint8Array(s);for(var u,l,h,p=0,d=new Uint8Array(o);p<s;)if(l=1+(127&(u=i[n++])),128&u){for(h=0;h<o;++h)d[h]=i[n++];for(h=0;h<l;++h)a.set(d,p+h*o);p+=o*l}else{for(l*=o,h=0;h<l;++h)a[p+h]=i[n++];p+=l}}else a=i.subarray(n,n+=t?r.width*r.height:s);return{pixel_data:a,palettes:c}}(l,h,u,c,s);!function(e,s,c,l,h){var d,f,m,g,v,y;switch((u.flags&t)>>r){default:case a:d=0,m=1,v=s,f=0,g=1,y=c;break;case n:d=0,m=1,v=s,f=c-1,g=-1,y=-1;break;case o:d=s-1,m=-1,v=-1,f=0,g=1,y=c;break;case i:d=s-1,m=-1,v=-1,f=c-1,g=-1,y=-1}if(p)switch(u.pixel_size){case 8:!function(e,t,r,n,i,a,o,s){var c,l,h,p=0,d=u.width;for(h=t;h!==n;h+=r)for(l=i;l!==o;l+=a,p++)c=s[p],e[4*(l+d*h)+0]=c,e[4*(l+d*h)+1]=c,e[4*(l+d*h)+2]=c,e[4*(l+d*h)+3]=255}(e,f,g,y,d,m,v,l);break;case 16:!function(e,t,r,n,i,a,o,s){var c,l,h=0,p=u.width;for(l=t;l!==n;l+=r)for(c=i;c!==o;c+=a,h+=2)e[4*(c+p*l)+0]=s[h+0],e[4*(c+p*l)+1]=s[h+0],e[4*(c+p*l)+2]=s[h+0],e[4*(c+p*l)+3]=s[h+1]}(e,f,g,y,d,m,v,l);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(u.pixel_size){case 8:!function(e,t,r,n,i,a,o,s,c){var l,h,p,d=c,f=0,m=u.width;for(p=t;p!==n;p+=r)for(h=i;h!==o;h+=a,f++)l=s[f],e[4*(h+m*p)+3]=255,e[4*(h+m*p)+2]=d[3*l+0],e[4*(h+m*p)+1]=d[3*l+1],e[4*(h+m*p)+0]=d[3*l+2]}(e,f,g,y,d,m,v,l,h);break;case 16:!function(e,t,r,n,i,a,o,s){var c,l,h,p=0,d=u.width;for(h=t;h!==n;h+=r)for(l=i;l!==o;l+=a,p+=2)c=s[p+0]+(s[p+1]<<8),e[4*(l+d*h)+0]=(31744&c)>>7,e[4*(l+d*h)+1]=(992&c)>>2,e[4*(l+d*h)+2]=(31&c)>>3,e[4*(l+d*h)+3]=32768&c?0:255}(e,f,g,y,d,m,v,l);break;case 24:!function(e,t,r,n,i,a,o,s){var c,l,h=0,p=u.width;for(l=t;l!==n;l+=r)for(c=i;c!==o;c+=a,h+=3)e[4*(c+p*l)+3]=255,e[4*(c+p*l)+2]=s[h+0],e[4*(c+p*l)+1]=s[h+1],e[4*(c+p*l)+0]=s[h+2]}(e,f,g,y,d,m,v,l);break;case 32:!function(e,t,r,n,i,a,o,s){var c,l,h=0,p=u.width;for(l=t;l!==n;l+=r)for(c=i;c!==o;c+=a,h+=4)e[4*(c+p*l)+2]=s[h+0],e[4*(c+p*l)+1]=s[h+1],e[4*(c+p*l)+0]=s[h+2],e[4*(c+p*l)+3]=s[h+3]}(e,f,g,y,d,m,v,l);break;default:console.error("THREE.TGALoader: Format not supported.")}}(g.data,u.width,u.height,v.pixel_data,v.palettes);return m.putImageData(g,0,0),d?f.transferToImageBitmap():f},setPath:function(e){return this.path=e,this}}},function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return n}),function(t,n){"object"==typeof exports&&"object"==typeof e?e.exports=n():"function"==typeof define&&r(31)?define("chevrotain",[],n):"object"==typeof exports?exports.chevrotain=n():t.chevrotain=n()}("undefined"==typeof self?void 0:self,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=18)}([function(e,t){function r(e){return e&&0===e.length}function n(e){return null==e?[]:Object.keys(e)}function i(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function a(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!m(e))throw Error("non exhaustive match");var i=n(e);for(r=0;r<i.length;r++){var a=i[r],o=e[a];t.call(null,o,a)}}}function o(e){return void 0===e}function s(e,t){var r=[];if(Array.isArray(e))for(var n,i=0;i<e.length;i++)n=e[i],t.call(null,n)&&r.push(n);return r}function c(e,t){return s(e,function(e){return!t(e)})}function u(e,t){return!!m(e)&&e.hasOwnProperty(t)}function l(e,t){return void 0!==d(e,function(e){return e===t})}function h(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function p(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function d(e,t){for(var r,n=0;n<e.length;n++)if(r=e[n],t.call(null,r))return r}function f(e,t,r){for(var a=Array.isArray(e),o=a?e:i(e),s=a?[]:n(e),c=r,u=0;u<o.length;u++)c=t.call(null,c,o[u],a?u:s[u]);return c}function m(e){return e instanceof Object}function g(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var i,a=0;a<t.length;a++)if(!o(i=t[a]))for(var s,c=n(i),l=0;l<c.length;l++)u(e,s=c[l])||(e[s]=i[s]);return e}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=r,t.keys=n,t.values=i,t.mapValues=function(e,t){for(var r,i=[],a=n(e),o=0;o<a.length;o++)r=a[o],i.push(t.call(null,e[r],r));return i},t.map=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r},t.flatten=function e(t){for(var r,n=[],i=0;i<t.length;i++)r=t[i],Array.isArray(r)?n=n.concat(e(r)):n.push(r);return n},t.first=function(e){return r(e)?void 0:e[0]},t.last=function(e){var t=e&&e.length;return t?e[t-1]:void 0},t.forEach=a,t.isString=function(e){return"string"==typeof e},t.isUndefined=o,t.isFunction=function(e){return e instanceof Function},t.drop=function(e,t){return void 0===t&&(t=1),e.slice(t,e.length)},t.dropRight=function(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)},t.filter=s,t.reject=c,t.pick=function(e,t){for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var a=r[i],o=e[a];t(o)&&(n[a]=o)}return n},t.has=u,t.contains=l,t.cloneArr=h,t.cloneObj=p,t.find=d,t.findAll=function(e,t){for(var r,n=[],i=0;i<e.length;i++)r=e[i],t.call(null,r)&&n.push(r);return n},t.reduce=f,t.compact=function(e){return c(e,function(e){return null==e})},t.uniq=function(e,t){void 0===t&&(t=function(e){return e});var r=[];return f(e,function(e,n){var i=t(n);return l(r,i)?e:(r.push(i),e.concat(n))},[])},t.partial=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null].concat(t);return Function.bind.apply(e,n)},t.isArray=function(e){return Array.isArray(e)},t.isRegExp=function(e){return e instanceof RegExp},t.isObject=m,t.every=function(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0},t.difference=function(e,t){return c(e,function(e){return l(t,e)})},t.some=function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1},t.indexOf=function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},t.sortBy=function(e,t){var r=h(e);return r.sort(function(e,r){return t(e)-t(r)}),r},t.zipObject=function(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r},t.assign=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var i=0;i<t.length;i++)for(var a,o=t[i],s=n(o),c=0;c<s.length;c++)e[a=s[c]]=o[a];return e},t.assignNoOverwrite=g,t.defaults=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g.apply(null,[{}].concat(e))},t.groupBy=function(e,t){var r={};return a(e,function(e){var n=t(e),i=r[n];i?i.push(e):r[n]=[e]}),r},t.merge=function(e,t){for(var r=p(e),i=n(t),a=0;a<i.length;a++){var o=i[a],s=t[o];r[o]=s}return r},t.NOOP=function(){},t.IDENTITY=function(e){return e},t.packArray=function(e){for(var t,r=[],n=0;n<e.length;n++)t=e[n],r.push(void 0===t?void 0:t);return r},t.PRINT_ERROR=function(e){console&&console.error&&console.error("Error: "+e)},t.PRINT_WARNING=function(e){console&&console.warn&&console.warn("Warning: "+e)},t.isES2015MapSupported=function(){return"function"==typeof Map},t.applyMixins=function(e,t){t.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if("constructor"!==n){var i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(e.prototype,n,i):e.prototype[n]=t.prototype[n]}})})},t.toFastProperties=function(e){function t(){}function r(){return typeof n.bar}t.prototype=e;var n=new t;return r(),r(),e}},function(e,t,r){function n(e){function t(e){return o.map(e,n)}if(e instanceof u)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof h)return{type:"Flat",definition:t(e.definition)};if(e instanceof p)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof d)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof f)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:n(new y({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof g)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:n(new y({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof m)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof v)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof y){var r={type:"Terminal",name:s.tokenName(e.terminalType),label:s.tokenLabel(e.terminalType),idx:e.idx},i=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=o.isRegExp(i)?i.source:i),r}if(e instanceof l)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=r(2),c=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),o.forEach(this.definition,function(t){t.accept(e)})},e}();t.AbstractProduction=c;var u=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0===this.referencedRule?[]:this.referencedRule.definition},set:function(){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(c);t.NonTerminal=u;var l=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.Rule=l;var h=function(e){function t(t){var r=e.call(this,t.definition)||this;return o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.Flat=h;var p=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.Option=p;var d=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.RepetitionMandatory=d;var f=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.RepetitionMandatoryWithSeparator=f;var m=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.Repetition=m;var g=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.RepetitionWithSeparator=g;var v=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,o.assign(r,o.pick(t,function(e){return void 0!==e})),r}return a(t,e),t}(c);t.Alternation=v;var y=function(){function e(e){this.idx=1,o.assign(this,o.pick(e,function(e){return void 0!==e}))}return e.prototype.accept=function(e){e.visit(this)},e}();t.Terminal=y,t.serializeGrammar=function(e){return o.map(e,n)},t.serializeProduction=n},function(e,t,r){function n(e){return o.isString(e.LABEL)&&""!==e.LABEL}function i(e){return o.isObject(e)&&e.hasOwnProperty("tokenName")&&o.isString(e.tokenName)?e.tokenName:s.functionName(e)}function a(e){return function(e){var t=e.name,r=e.pattern,n={};if(s.defineNameProp(n,t)||(n.tokenName=t),o.isUndefined(r)||(n.PATTERN=r),o.has(e,l))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return o.has(e,h)&&(n.CATEGORIES=e[h]),u.augmentTokenTypes([n]),o.has(e,p)&&(n.LABEL=e[p]),o.has(e,d)&&(n.GROUP=e[d]),o.has(e,m)&&(n.POP_MODE=e[m]),o.has(e,f)&&(n.PUSH_MODE=e[f]),o.has(e,g)&&(n.LONGER_ALT=e[g]),o.has(e,v)&&(n.LINE_BREAKS=e[v]),o.has(e,y)&&(n.START_CHARS_HINT=e[y]),n}(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=r(4),c=r(15),u=r(7);t.tokenLabel=function(e){return n(e)?e.LABEL:i(e)},t.hasTokenLabel=n,t.tokenName=i;var l="parent",h="categories",p="label",d="group",f="push_mode",m="pop_mode",g="longer_alt",v="line_breaks",y="start_chars_hint";t.createToken=a,t.EOF=a({name:"EOF",pattern:c.Lexer.NA}),u.augmentTokenTypes([t.EOF]),t.createTokenInstance=function(e,t,r,n,i,a,o,s){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:a,startColumn:o,endColumn:s,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}},t.tokenMatcher=function(e,t){return u.tokenStructuredMatcher(e,t)}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(4),o=r(0),s=r(26),c=r(2),u=r(23),l=r(16),h=r(10),p=r(24),d=r(25),f=r(31),m=r(32),g=r(34),v=r(35),y=r(36),b=r(37),x=r(38);t.END_OF_FILE=c.createTokenInstance(c.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),Object.freeze(t.END_OF_FILE),t.DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:h.defaultParserErrorProvider,serializedGrammar:null}),t.DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(t.ParserDefinitionErrorType||(t.ParserDefinitionErrorType={})),t.EMPTY_ALT=function(e){return void 0===e&&(e=void 0),function(){return e}};var w=function(){function e(e,r){void 0===r&&(r=t.DEFAULT_PARSER_CONFIG),this.ignoredIssues=t.DEFAULT_PARSER_CONFIG.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(r),this.initLexerAdapter(),this.initLooksAhead(r),this.initRecognizerEngine(e,r),this.initRecoverable(r),this.initTreeBuilder(r),this.initContentAssist(),this.ignoredIssues=o.has(r,"ignoredIssues")?r.ignoredIssues:t.DEFAULT_PARSER_CONFIG.ignoredIssues,o.toFastProperties(this)}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t,r=this;this.selfAnalysisDone=!0;var n=a.classNameFromInstance(this),i=this.gastProductionsCache;if(this.serializedGrammar){var c=u.deserializeGrammar(this.serializedGrammar,this.tokensMap);o.forEach(c,function(e){r.gastProductionsCache.put(e.name,e)})}var d=p.resolveGrammar({rules:i.values()});if(this.definitionErrors.push.apply(this.definitionErrors,d),o.isEmpty(d)){var f=p.validateGrammar({rules:i.values(),maxLookahead:this.maxLookahead,tokenTypes:o.values(this.tokensMap),ignoredIssues:this.ignoredIssues,errMsgProvider:h.defaultGrammarValidatorErrorProvider,grammarName:n});this.definitionErrors.push.apply(this.definitionErrors,f)}if(o.isEmpty(this.definitionErrors)){var m=s.computeAllProdsFollows(i.values());this.resyncFollows=m}var g=l.analyzeCst(i.values(),this.fullRuleNameToShort);if(this.allRuleNames=g.allRuleNames,!e.DEFER_DEFINITION_ERRORS_HANDLING&&!o.isEmpty(this.definitionErrors))throw t=o.map(this.definitionErrors,function(e){return e.message}),new Error("Parser Definition Errors detected:\n "+t.join("\n-------------------------------\n"))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();t.Parser=w,o.applyMixins(w,[d.Recoverable,f.LooksAhead,m.TreeBuilder,g.LexerAdapter,y.RecognizerEngine,v.RecognizerApi,b.ErrorHandler,x.ContentAssist]);var _=function(e){function r(r,n){void 0===n&&(n=t.DEFAULT_PARSER_CONFIG);var i=o.cloneObj(n);return i.outputCst=!0,e.call(this,r,i)||this}return i(r,e),r}(w);t.CstParser=_;var T=function(e){function r(r,n){void 0===n&&(n=t.DEFAULT_PARSER_CONFIG);var i=o.cloneObj(n);return i.outputCst=!1,e.call(this,r,i)||this}return i(r,e),r}(w);t.EmbeddedActionsParser=T},function(e,t,r){function n(e){return e.name||e.toString().match(a)[1]}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0);t.classNameFromInstance=function(e){return n(e.constructor)};var a=/^\s*function\s*(\S*)\s*\(/,o="name";t.functionName=n,t.defineNameProp=function(e,t){var r=Object.getOwnPropertyDescriptor(e,o);return(i.isUndefined(r)||r.configurable)&&(Object.defineProperty(e,o,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)};var s=function(){function e(){this._state={}}return e.prototype.keys=function(){return i.keys(this._state)},e.prototype.values=function(){return i.values(this._state)},e.prototype.put=function(e,t){this._state[e]=t},e.prototype.putAll=function(e){this._state=i.assign(this._state,e._state)},e.prototype.get=function(e){return this._state[e]},e.prototype.containsKey=function(e){return i.has(this._state,e)},e.prototype.clear=function(){this._state={}},e}();t.HashTable=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=function(){function e(){}return e.prototype.visit=function(e){if(e instanceof n.NonTerminal)return this.visitNonTerminal(e);if(e instanceof n.Flat)return this.visitFlat(e);if(e instanceof n.Option)return this.visitOption(e);if(e instanceof n.RepetitionMandatory)return this.visitRepetitionMandatory(e);if(e instanceof n.RepetitionMandatoryWithSeparator)return this.visitRepetitionMandatoryWithSeparator(e);if(e instanceof n.RepetitionWithSeparator)return this.visitRepetitionWithSeparator(e);if(e instanceof n.Repetition)return this.visitRepetition(e);if(e instanceof n.Alternation)return this.visitAlternation(e);if(e instanceof n.Terminal)return this.visitTerminal(e);if(e instanceof n.Rule)return this.visitRule(e);throw Error("non exhaustive match")},e.prototype.visitNonTerminal=function(){},e.prototype.visitFlat=function(){},e.prototype.visitOption=function(){},e.prototype.visitRepetition=function(){},e.prototype.visitRepetitionMandatory=function(){},e.prototype.visitRepetitionMandatoryWithSeparator=function(){},e.prototype.visitRepetitionWithSeparator=function(){},e.prototype.visitAlternation=function(){},e.prototype.visitTerminal=function(){},e.prototype.visitRule=function(){},e}();t.GAstVisitor=i},function(e,t,r){function n(e,t,r){this.name=c,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function i(e,t,r){this.name=u,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function a(e,t){this.name=h,this.message=e,this.token=t,this.resyncedTokens=[]}function o(e,t,r){this.name=l,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),c="MismatchedTokenException",u="NoViableAltException",l="EarlyExitException",h="NotAllInputParsedException",p=[c,u,l,h];Object.freeze(p),t.isRecognitionException=function(e){return s.contains(p,e.name)},t.MismatchedTokenException=n,n.prototype=Error.prototype,t.NoViableAltException=i,i.prototype=Error.prototype,t.NotAllInputParsedException=a,a.prototype=Error.prototype,t.EarlyExitException=o,o.prototype=Error.prototype},function(e,t,r){function n(e){for(var t=d.cloneArr(e),r=e,n=!0;n;){r=d.compact(d.flatten(d.map(r,function(e){return e.CATEGORIES})));var i=d.difference(r,t);t=t.concat(i),d.isEmpty(i)?n=!1:r=i}return t}function i(e){d.forEach(e,function(e){c(e)||(t.tokenIdxToClass.put(t.tokenShortNameIdx,e),e.tokenTypeIdx=t.tokenShortNameIdx++),u(e)&&!d.isArray(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),u(e)||(e.CATEGORIES=[]),l(e)||(e.categoryMatches=[]),h(e)||(e.categoryMatchesMap={}),p(e)||(e.tokenName=m.tokenName(e))})}function a(e){d.forEach(e,function(e){e.categoryMatches=[],d.forEach(e.categoryMatchesMap,function(r,n){e.categoryMatches.push(t.tokenIdxToClass.get(n).tokenTypeIdx)})})}function o(e){d.forEach(e,function(e){s([],e)})}function s(e,t){d.forEach(e,function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0}),d.forEach(t.CATEGORIES,function(r){var n=e.concat(t);d.contains(n,r)||s(n,r)})}function c(e){return d.has(e,"tokenTypeIdx")}function u(e){return d.has(e,"CATEGORIES")}function l(e){return d.has(e,"categoryMatches")}function h(e){return d.has(e,"categoryMatchesMap")}function p(e){return d.has(e,"tokenName")}Object.defineProperty(t,"__esModule",{value:!0});var d=r(0),f=r(4),m=r(2);t.tokenStructuredMatcher=function(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]},t.tokenStructuredMatcherNoCategories=function(e,t){return e.tokenTypeIdx===t.tokenTypeIdx},t.tokenShortNameIdx=1,t.tokenIdxToClass=new f.HashTable,t.augmentTokenTypes=function(e){var t=n(e);i(t),o(t),a(t),d.forEach(t,function(e){e.isParent=0<e.categoryMatches.length})},t.expandCategories=n,t.assignTokenDefaultProps=i,t.assignCategoriesTokensProp=a,t.assignCategoriesMapProp=o,t.singleAssignCategoriesToksMap=s,t.hasShortKeyProperty=c,t.hasCategoriesProperty=u,t.hasExtendingTokensTypesProperty=l,t.hasExtendingTokensTypesMapProperty=h,t.hasTokenNameProperty=p,t.isTokenType=function(e){return d.has(e,"tokenTypeIdx")}},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(1),s=r(5),c=r(2);t.isSequenceProd=function(e){return e instanceof o.Flat||e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionMandatory||e instanceof o.RepetitionMandatoryWithSeparator||e instanceof o.RepetitionWithSeparator||e instanceof o.Terminal||e instanceof o.Rule},t.isOptionalProd=function e(t,r){return void 0===r&&(r=[]),!!(t instanceof o.Option||t instanceof o.Repetition||t instanceof o.RepetitionWithSeparator)||(t instanceof o.Alternation?a.some(t.definition,function(t){return e(t,r)}):!(t instanceof o.NonTerminal&&a.contains(r,t))&&t instanceof o.AbstractProduction&&(t instanceof o.NonTerminal&&r.push(t),a.every(t.definition,function(t){return e(t,r)})))},t.isBranchingProd=function(e){return e instanceof o.Alternation},t.getProductionDslName=function(e){if(e instanceof o.NonTerminal)return"SUBRULE";if(e instanceof o.Option)return"OPTION";if(e instanceof o.Alternation)return"OR";if(e instanceof o.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof o.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof o.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof o.Repetition)return"MANY";if(e instanceof o.Terminal)return"CONSUME";throw Error("non exhaustive match")};var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return i(t,e),t.prototype.visitTerminal=function(e){var t=c.tokenName(e.terminalType)+this.separator+"Terminal";a.has(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";a.has(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(s.GAstVisitor);t.DslMethodsCollectorVisitor=u},function(e,t){function r(e,t,r){return r|t|e}Object.defineProperty(t,"__esModule",{value:!0}),t.BITS_FOR_METHOD_IDX=4,t.BITS_FOR_OCCURRENCE_IDX=4,t.BITS_FOR_RULE_IDX=24,t.BITS_FOR_ALT_IDX=8,t.OR_IDX=1<<t.BITS_FOR_METHOD_IDX,t.OPTION_IDX=2<<t.BITS_FOR_METHOD_IDX,t.MANY_IDX=3<<t.BITS_FOR_METHOD_IDX,t.AT_LEAST_ONE_IDX=4<<t.BITS_FOR_METHOD_IDX,t.MANY_SEP_IDX=5<<t.BITS_FOR_METHOD_IDX,t.AT_LEAST_ONE_SEP_IDX=6<<t.BITS_FOR_METHOD_IDX,t.getKeyForAutomaticLookahead=r;var n=32-t.BITS_FOR_ALT_IDX;t.getKeyForAltIndex=function(e,t,i,a){return r(e,t,i)|a+1<<n}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(0),a=r(0),o=r(1),s=r(8),c=r(11),u=r(17),l=r(3);t.defaultParserErrorProvider={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(n.hasTokenLabel(t)?"--\x3e "+n.tokenLabel(t)+" <--":"token of type --\x3e "+n.tokenName(t)+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,i=(e.previous,e.customUserDescription),o=(e.ruleName,"\nbut found: '"+a.first(r).image+"'");if(i)return"Expecting: "+i+o;var s=a.reduce(t,function(e,t){return e.concat(t)},[]),c=a.map(s,function(e){return"["+a.map(e,function(e){return n.tokenLabel(e)}).join(", ")+"]"});return"Expecting: one of these possible Token sequences:\n"+a.map(c,function(e,t){return"  "+(t+1)+". "+e}).join("\n")+o},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,i=e.customUserDescription,o=(e.ruleName,"\nbut found: '"+a.first(r).image+"'");return i?"Expecting: "+i+o:"Expecting: expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+a.map(t,function(e){return"["+a.map(e,function(e){return n.tokenLabel(e)}).join(",")+"]"}).join(" ,")+">"+o}},Object.freeze(t.defaultParserErrorProvider),t.defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},t.defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(e,t){var r,i=e.name,c=a.first(t),u=c.idx,l=s.getProductionDslName(c),h=(r=c)instanceof o.Terminal?n.tokenName(r.terminalType):r instanceof o.NonTerminal?r.nonTerminalName:"",p="->"+l+"<- with numerical suffix: ->"+u+"<-\n                  "+(h?"and argument: ->"+h+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+i+"<-.\n                  "+(0===u?"Also note that numerical suffix 0 means "+l+" without any suffix.":"")+"\n                  To fix this make sure each usage of "+l+" "+(h?"with the argument: ->"+h+"<-":"")+"\n                  in the rule ->"+i+"<- has a different occurrence index (0-5), as that combination acts as a unique\n                  position key in the grammar, which is needed by the parsing engine.\n                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(p=p.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+c.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+a.first(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=a.map(e.prefixPath,function(e){return n.tokenLabel(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nhttps://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=a.map(e.prefixPath,function(e){return n.tokenLabel(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,i="Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n",o=u.VERSION.replace(/\./g,"_");return i+"To Resolve this, try one of of the following: \n1. Refactor your grammar to be LL(K) for the current value of k (by default k="+l.DEFAULT_PARSER_CONFIG.maxLookahead+"})\n2. Increase the value of K for your grammar by providing a larger 'maxLookahead' value in the parser's config\n3. This issue can be ignored (if you know what you are doing...), see https://sap.github.io/chevrotain/documentation/"+o+"/interfaces/iparserconfig.html#ignoredissues for more details\n"},buildEmptyRepetitionError:function(e){var t=s.getProductionDslName(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+n.tokenName(e.tokenType)+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+i.map(e.leftRecursionPath,function(e){return e.name}).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof o.Rule?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},function(e,t,r){function n(e){return w.getProductionDslName(e)+"_#_"+e.idx+"_#_"+i(e)}function i(e){return e instanceof S.Terminal?_.tokenName(e.terminalType):e instanceof S.NonTerminal?e.nonTerminalName:""}function a(e,r){var n=[],i=e.name;return i.match(t.validTermsPattern)||n.push({message:r.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:t.validTermsPattern}),type:x.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:i}),n}function o(e,r,n){var i,a=[];return r.name.match(t.validNestedRuleName)||(i=n.buildInvalidNestedRuleNameError(e,r),a.push({message:i,type:x.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),a}function s(e,r){var n=[];return _.tokenName(e).match(t.validTermsPattern)||n.push({message:r.buildTokenNameError({tokenType:e,expectedPattern:t.validTermsPattern}),type:x.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),n}function c(e,t,r,n){var i=[];if(1<b.reduce(t,function(t,r){return r.name===e.name?t+1:t},0)){var a=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});i.push({message:a,type:x.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function u(e,t,r,n){void 0===n&&(n=[]);var i=[],a=l(t.definition);if(y.isEmpty(a))return[];var o=e.name;y.contains(a,e)&&i.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:x.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:o});var s=y.difference(a,n.concat([e])),c=y.map(s,function(t){var i=y.cloneArr(n);return i.push(t),u(e,t,r,i)});return i.concat(y.flatten(c))}function l(e){var t=[];if(y.isEmpty(e))return t;var r=y.first(e);if(r instanceof S.NonTerminal)t.push(r.referencedRule);else if(r instanceof S.Flat||r instanceof S.Option||r instanceof S.RepetitionMandatory||r instanceof S.RepetitionMandatoryWithSeparator||r instanceof S.RepetitionWithSeparator||r instanceof S.Repetition)t=t.concat(l(r.definition));else if(r instanceof S.Alternation)t=y.flatten(y.map(r.definition,function(e){return l(e.definition)}));else if(!(r instanceof S.Terminal))throw Error("non exhaustive match");var n=w.isOptionalProd(r),i=1<e.length;if(n&&i){var a=y.drop(e);return t.concat(l(a))}return t}function h(e,t){var r=new N;e.accept(r);var n=r.alternations;return y.reduce(n,function(r,n){var i=y.dropRight(n.definition),a=y.map(i,function(r,i){var a=A.nextPossibleTokensAfter([r],[],null,1);return y.isEmpty(a)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:i}),type:x.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:i+1}:null});return r.concat(y.compact(a))},[])}function p(e,t,r,n){var i=new N;e.accept(i);var a=i.alternations,o=r[e.name];return o&&(a=b.reject(a,function(e){return o[w.getProductionDslName(e)+(0===e.idx?"":e.idx)]})),y.reduce(a,function(r,i){var a=i.idx,o=T.getLookaheadPathsForOr(a,e,t),s=function(e,t,r,n){var i=[],a=b.reduce(e,function(t,r,n){return b.forEach(r,function(r){var a=[n];b.forEach(e,function(e,t){n!==t&&T.containsPath(e,r)&&a.push(t)}),1<a.length&&!T.containsPath(i,r)&&(i.push(r),t.push({alts:a,path:r}))}),t},[]);return y.map(a,function(e){var i=b.map(e.alts,function(e){return e+1});return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:x.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}})}(o,i,e,n),c=m(o,i,e,n);return r.concat(s,c)},[])}function d(e,t){var r=new N;e.accept(r);var n=r.alternations;return y.reduce(n,function(r,n){return 255<n.definition.length&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:x.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r},[])}function f(e,t,r){var n=[];return b.forEach(e,function(e){var i=new R;e.accept(i);var a=i.allProductions;b.forEach(a,function(i){var a=T.getProdType(i),o=i.idx,s=T.getLookaheadPathsForOptionalProd(o,e,a,t)[0];if(b.isEmpty(b.flatten(s))){var c=r.buildEmptyRepetitionError({topLevelRule:e,repetition:i});n.push({message:c,type:x.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}})}),n}function m(e,t,r,n){var i=[],a=b.reduce(e,function(e,t,r){var n=b.map(t,function(e){return{idx:r,path:e}});return e.concat(n)},[]);return b.forEach(a,function(e){var o=e.idx,s=e.path,c=b.findAll(a,function(e){return e.idx<o&&T.isStrictPrefixOfPath(e.path,s)}),u=b.map(c,function(e){var i=[e.idx+1,o+1],a=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:x.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:a,alternatives:i}});i=i.concat(u)}),i}var g,v=this&&this.__extends||(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var y=r(0),b=r(0),x=r(3),w=r(8),_=r(2),T=r(12),E=r(16),A=r(13),S=r(1),M=r(5);t.validateGrammar=function(e,t,r,l,m,g){var v=y.map(e,function(e){return function(e,t){var r=new L;e.accept(r);var a=r.allProductions,o=y.groupBy(a,n),s=y.pick(o,function(e){return 1<e.length});return y.map(y.values(s),function(r){var n=y.first(r),a=t.buildDuplicateFoundError(e,r),o=w.getProductionDslName(n),s={message:a,type:x.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:n.idx},c=i(n);return c&&(s.parameter=c),s})}(e,m)}),T=y.map(e,function(e){return u(e,e,m)}),A=[],S=[],M=[];b.every(T,b.isEmpty)&&(A=b.map(e,function(e){return h(e,m)}),S=b.map(e,function(e){return p(e,t,l,m)}),M=f(e,t,m));var N=function(e,t,r){var n=[],i=b.map(t,function(e){return _.tokenName(e)});return b.forEach(e,function(e){var t=e.name;if(b.contains(i,t)){var a=r.buildNamespaceConflictError(e);n.push({message:a,type:x.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}}),n}(e,r,m),R=y.map(r,function(e){return s(e,m)}),C=function(e,t){var r=[];return b.forEach(e,function(e){var n=new E.NamedDSLMethodsCollectorVisitor("");e.accept(n);var i=b.map(n.result,function(e){return e.orgProd});r.push(b.map(i,function(r){return o(e,r,t)}))}),b.flatten(r)}(e,m),I=function(e,t){var r=[];return b.forEach(e,function(e){var n=new E.NamedDSLMethodsCollectorVisitor("");e.accept(n);var i=b.groupBy(n.result,function(e){return e.name}),a=b.pick(i,function(e){return 1<e.length});b.forEach(b.values(a),function(n){var i=b.map(n,function(e){return e.orgProd}),a=t.buildDuplicateNestedRuleNameError(e,i);r.push({message:a,type:x.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:e.name})})}),r}(e,m),O=b.map(e,function(e){return d(e,m)}),P=b.map(e,function(e){return a(e,m)}),F=b.map(e,function(t){return c(t,e,g,m)});return y.flatten(v.concat(R,C,I,M,T,A,S,N,O,P,F))},t.identifyProductionForDuplicates=n;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return v(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(M.GAstVisitor);t.OccurrenceValidationCollector=L,t.validTermsPattern=/^[a-zA-Z_]\w*$/,t.validNestedRuleName=new RegExp(t.validTermsPattern.source.replace("^","^\\$")),t.validateRuleName=a,t.validateNestedRuleName=o,t.validateTokenName=s,t.validateRuleDoesNotAlreadyExist=c,t.validateRuleIsOverridden=function(e,t,r){var n,i=[];return y.contains(t,e)||(n="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",i.push({message:n,type:x.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),i},t.validateNoLeftRecursion=u,t.getFirstNoneTerminal=l;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return v(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(M.GAstVisitor);t.validateEmptyOrAlternative=h,t.validateAmbiguousAlternationAlternatives=p;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return v(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(M.GAstVisitor);t.RepetionCollector=R,t.validateTooManyAlts=d,t.validateSomeNonEmptyLookaheadPath=f,t.checkPrefixAlternativesAmbiguities=m},function(e,t,r){function n(e,t){function r(e,t){return h.reduce(e,function(e,r,n){if(n!==t){var i=h.map(r,function(e){return e.partialPath});return e.concat(i)}return e},[])}function n(e,t){return void 0===h.find(e,function(e){return h.every(t,function(t,r){return(n=t)===(i=e[r])||n&&i&&(n.categoryMatchesMap[i.tokenTypeIdx]||i.categoryMatchesMap[n.tokenTypeIdx]);var n,i})})}function i(e){for(var t=[],r=0;r<e;r++)t.push([]);return t}for(var a,s=h.map(e,function(e){return p.possiblePathsFrom([e],1)}),c=i(s.length),u=s,l=1;l<=t;l++){u=i((a=u).length);for(var d=0;d<a.length;d++)for(var f=a[d],m=r(a,d),g=0;g<f.length;g++){var v=f[g].partialPath,y=f[g].suffixDef;if(n(m,v)||h.isEmpty(y)||v.length===t){var b=c[d];o(b,v)||b.push(v)}else{var x=p.possiblePathsFrom(y,l+1,v);u[d]=u[d].concat(x)}}}return c}function i(e,t,r){var i=new y(e,l.ALTERNATION);return t.accept(i),n(i.result,r)}function a(e,t,r,i){var a=new y(e,r);t.accept(a);var o=a.result,s=new v(t,e,r).startWalking();return n([new m.Flat({definition:o}),new m.Flat({definition:s})],i)}function o(e,t){return void 0!==h.find(e,function(e){return t.length===e.length&&h.every(t,function(t,r){return t===e[r]||e[r].categoryMatchesMap[t.tokenTypeIdx]})})}function s(e){return h.every(e,function(e){return h.every(e,function(e){return h.every(e,function(e){return h.isEmpty(e.categoryMatches)})})})}var c,u=this&&this.__extends||(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var l,h=r(0),p=r(13),d=r(14),f=r(7),m=r(1),g=r(5);!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(l=t.PROD_TYPE||(t.PROD_TYPE={})),t.getProdType=function(e){if(e instanceof m.Option)return l.OPTION;if(e instanceof m.Repetition)return l.REPETITION;if(e instanceof m.RepetitionMandatory)return l.REPETITION_MANDATORY;if(e instanceof m.RepetitionMandatoryWithSeparator)return l.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof m.RepetitionWithSeparator)return l.REPETITION_WITH_SEPARATOR;if(e instanceof m.Alternation)return l.ALTERNATION;throw Error("non exhaustive match")},t.buildLookaheadFuncForOr=function(e,t,r,n,a,o){var c=i(e,t,r);return o(c,n,s(c)?f.tokenStructuredMatcherNoCategories:f.tokenStructuredMatcher,a)},t.buildLookaheadFuncForOptionalProd=function(e,t,r,n,i,o){var c=a(e,t,i,r),u=s(c)?f.tokenStructuredMatcherNoCategories:f.tokenStructuredMatcher;return o(c[0],u,n)},t.buildAlternativesLookAheadFunc=function(e,t,r,n){var i=e.length,a=h.every(e,function(e){return h.every(e,function(e){return 1===e.length})});if(t)return function(t){for(var n=h.map(t,function(e){return e.GATE}),a=0;a<i;a++){var o=e[a],s=o.length,c=n[a];if(void 0===c||!1!==c.call(this))e:for(var u=0;u<s;u++){for(var l,p=o[u],d=p.length,f=0;f<d;f++)if(l=this.LA(f+1),!1===r(l,p[f]))continue e;return a}}};if(a&&!n){var o=h.map(e,function(e){return h.flatten(e)}),s=h.reduce(o,function(e,t,r){return h.forEach(t,function(t){h.has(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),h.forEach(t.categoryMatches,function(t){h.has(e,t)||(e[t]=r)})}),e},[]);return function(){var e=this.LA(1);return s[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var n=e[t],a=n.length;e:for(var o=0;o<a;o++){for(var s,c=n[o],u=c.length,l=0;l<u;l++)if(s=this.LA(l+1),!1===r(s,c[l]))continue e;return t}}}},t.buildSingleAlternativeLookaheadFunction=function(e,t,r){var n=h.every(e,function(e){return 1===e.length}),i=e.length;if(n&&!r){var a=h.flatten(e);if(1===a.length&&h.isEmpty(a[0].categoryMatches)){var o=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}var s=h.reduce(a,function(e,t){return e[t.tokenTypeIdx]=!0,h.forEach(t.categoryMatches,function(t){e[t]=!0}),e},[]);return function(){var e=this.LA(1);return!0===s[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<i;r++){for(var n,a=e[r],o=a.length,s=0;s<o;s++)if(n=this.LA(s+1),!1===t(n,a[s]))continue e;return!0}return!1}};var v=function(e){function t(t,r,n){var i=e.call(this)||this;return i.topProd=t,i.targetOccurrence=r,i.targetProdType=n,i}return u(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,l.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,l.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,l.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,l.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,l.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(d.RestWalker),y=function(e){function t(t,r){var n=e.call(this)||this;return n.targetOccurrence=t,n.targetProdType=r,n.result=[],n}return u(t,e),t.prototype.checkIsTarget=function(e,t){e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,l.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,l.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,l.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,l.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,l.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,l.ALTERNATION)},t}(g.GAstVisitor);t.lookAheadSequenceFromAlternatives=n,t.getLookaheadPathsForOr=i,t.getLookaheadPathsForOptionalProd=a,t.containsPath=o,t.isStrictPrefixOfPath=function(e,t){return e.length<t.length&&h.every(e,function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})},t.areTokenCategoriesNotUsed=s},function(e,t,r){function n(e,t,r,n){var i=s.cloneArr(r);i.push(e.name);var a=s.cloneArr(n);return a.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:a}}var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),s=r(0),c=r(2),u=r(21),l=r(1),h=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return a(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=s.cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=s.cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){s.isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(o.RestWalker);t.AbstractNextPossibleTokensWalker=h;var p=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=c.tokenName(n.path.lastTok),n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return a(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&c.tokenName(e.terminalType)===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),i=new l.Flat({definition:n});this.possibleTokTypes=u.first(i),this.found=!0}},t}(h);t.NextAfterTokenWalker=p;var d=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return a(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(o.RestWalker);t.AbstractNextTerminalAfterProductionWalker=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var i=s.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof l.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(d);t.NextTerminalAfterManyWalker=f;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var i=s.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof l.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(d);t.NextTerminalAfterManySepWalker=m;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var i=s.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof l.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(d);t.NextTerminalAfterAtLeastOneWalker=g;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var i=s.first(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof l.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(d);t.NextTerminalAfterAtLeastOneSepWalker=v,t.possiblePathsFrom=function e(t,r,n){function i(i){var c=e(i.concat(s.drop(t,o+1)),r,n);return a.concat(c)}void 0===n&&(n=[]),n=s.cloneArr(n);for(var a=[],o=0;n.length<r&&o<t.length;){var c=t[o];if(c instanceof l.Flat)return i(c.definition);if(c instanceof l.NonTerminal)return i(c.definition);if(c instanceof l.Option)a=i(c.definition);else{if(c instanceof l.RepetitionMandatory)return i(u=c.definition.concat([new l.Repetition({definition:c.definition})]));if(c instanceof l.RepetitionMandatoryWithSeparator)return i(u=[new l.Flat({definition:c.definition}),new l.Repetition({definition:[new l.Terminal({terminalType:c.separator})].concat(c.definition)})]);if(c instanceof l.RepetitionWithSeparator){var u=c.definition.concat([new l.Repetition({definition:[new l.Terminal({terminalType:c.separator})].concat(c.definition)})]);a=i(u)}else if(c instanceof l.Repetition)u=c.definition.concat([new l.Repetition({definition:c.definition})]),a=i(u);else{if(c instanceof l.Alternation)return s.forEach(c.definition,function(e){a=i(e.definition)}),a;if(!(c instanceof l.Terminal))throw Error("non exhaustive match");n.push(c.terminalType)}}o++}return a.push({partialPath:n,suffixDef:s.drop(t,o)}),a},t.nextPossibleTokensAfter=function(e,t,r,i){var a=["EXIT_NONE_TERMINAL"],o=!1,c=t.length,u=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!s.isEmpty(h);){var p=h.pop();if("EXIT_ALTERNATIVE"!==p){var d=p.def,f=p.idx,m=p.ruleStack,g=p.occurrenceStack;if(!s.isEmpty(d)){var v=d[0];if("EXIT_NONE_TERMINAL"===v){var y={idx:f,def:s.drop(d),ruleStack:s.dropRight(m),occurrenceStack:s.dropRight(g)};h.push(y)}else if(v instanceof l.Terminal)if(f<c-1){var b=f+1;r(t[b],v.terminalType)&&(y={idx:b,def:s.drop(d),ruleStack:m,occurrenceStack:g},h.push(y))}else{if(f!==c-1)throw Error("non exhaustive match");u.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:m,occurrenceStack:g}),o=!0}else if(v instanceof l.NonTerminal){var x=s.cloneArr(m);x.push(v.nonTerminalName);var w=s.cloneArr(g);w.push(v.idx),y={idx:f,def:v.definition.concat(a,s.drop(d)),ruleStack:x,occurrenceStack:w},h.push(y)}else if(v instanceof l.Option){var _={idx:f,def:s.drop(d),ruleStack:m,occurrenceStack:g};h.push(_),h.push("EXIT_ALTERNATIVE");var T={idx:f,def:v.definition.concat(s.drop(d)),ruleStack:m,occurrenceStack:g};h.push(T)}else if(v instanceof l.RepetitionMandatory){var E=new l.Repetition({definition:v.definition,idx:v.idx});y={idx:f,def:v.definition.concat([E],s.drop(d)),ruleStack:m,occurrenceStack:g},h.push(y)}else if(v instanceof l.RepetitionMandatoryWithSeparator){var A=new l.Terminal({terminalType:v.separator});E=new l.Repetition({definition:[A].concat(v.definition),idx:v.idx}),y={idx:f,def:v.definition.concat([E],s.drop(d)),ruleStack:m,occurrenceStack:g},h.push(y)}else if(v instanceof l.RepetitionWithSeparator){_={idx:f,def:s.drop(d),ruleStack:m,occurrenceStack:g},h.push(_),h.push("EXIT_ALTERNATIVE"),A=new l.Terminal({terminalType:v.separator});var S=new l.Repetition({definition:[A].concat(v.definition),idx:v.idx});T={idx:f,def:v.definition.concat([S],s.drop(d)),ruleStack:m,occurrenceStack:g},h.push(T)}else if(v instanceof l.Repetition)_={idx:f,def:s.drop(d),ruleStack:m,occurrenceStack:g},h.push(_),h.push("EXIT_ALTERNATIVE"),S=new l.Repetition({definition:v.definition,idx:v.idx}),T={idx:f,def:v.definition.concat([S],s.drop(d)),ruleStack:m,occurrenceStack:g},h.push(T);else if(v instanceof l.Alternation)for(var M,L=v.definition.length-1;0<=L;L--)M={idx:f,def:v.definition[L].definition.concat(s.drop(d)),ruleStack:m,occurrenceStack:g},h.push(M),h.push("EXIT_ALTERNATIVE");else if(v instanceof l.Flat)h.push({idx:f,def:v.definition.concat(s.drop(d)),ruleStack:m,occurrenceStack:g});else{if(!(v instanceof l.Rule))throw Error("non exhaustive match");h.push(n(v,f,m,g))}}}else o&&s.last(h).idx<=c-i-1&&h.pop()}return u}},function(e,t,r){function n(e,t,r){return[new a.Option({definition:[new a.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(1),o=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),i.forEach(e.definition,function(n,o){var s=i.drop(e.definition,o+1);if(n instanceof a.NonTerminal)r.walkProdRef(n,s,t);else if(n instanceof a.Terminal)r.walkTerminal(n,s,t);else if(n instanceof a.Flat)r.walkFlat(n,s,t);else if(n instanceof a.Option)r.walkOption(n,s,t);else if(n instanceof a.RepetitionMandatory)r.walkAtLeastOne(n,s,t);else if(n instanceof a.RepetitionMandatoryWithSeparator)r.walkAtLeastOneSep(n,s,t);else if(n instanceof a.RepetitionWithSeparator)r.walkManySep(n,s,t);else if(n instanceof a.Repetition)r.walkMany(n,s,t);else{if(!(n instanceof a.Alternation))throw Error("non exhaustive match");r.walkOr(n,s,t)}})},e.prototype.walkTerminal=function(){},e.prototype.walkProdRef=function(){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new a.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var i=n(e,t,r);this.walk(e,i)},e.prototype.walkMany=function(e,t,r){var n=[new a.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var i=n(e,t,r);this.walk(e,i)},e.prototype.walkOr=function(e,t,r){var n=this,o=t.concat(r);i.forEach(e.definition,function(e){var t=new a.Flat({definition:[e]});n.walk(t,o)})},e}();t.RestWalker=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(27),i=r(0),a=r(7),o=r(20);!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(t.LexerDefinitionErrorType||(t.LexerDefinitionErrorType={}));var s={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:o.defaultLexerErrorProvider};Object.freeze(s);var c=function(){function e(e,t){var r=this;if(void 0===t&&(t=s),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");if(this.config=i.merge(s,t),this.config.lineTerminatorsPattern===s.lineTerminatorsPattern)this.config.lineTerminatorsPattern=n.LineTerminatorOptimizedTester;else if(this.config.lineTerminatorCharacters===s.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking);var o,c=!0;i.isArray(e)?((o={modes:{}}).modes[n.DEFAULT_MODE]=i.cloneArr(e),o[n.DEFAULT_MODE]=n.DEFAULT_MODE):(c=!1,o=i.cloneObj(e)),this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(n.performRuntimeChecks(o,this.trackStartLines,this.config.lineTerminatorCharacters)),this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(n.performWarningRuntimeChecks(o,this.trackStartLines,this.config.lineTerminatorCharacters)),o.modes=o.modes?o.modes:{},i.forEach(o.modes,function(e,t){o.modes[t]=i.reject(e,function(e){return i.isUndefined(e)})});var u=i.keys(o.modes);if(i.forEach(o.modes,function(e,o){if(r.modes.push(o),r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(n.validatePatterns(e,u)),i.isEmpty(r.lexerDefinitionErrors)){a.augmentTokenTypes(e);var s=n.analyzeTokenTypes(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode});r.patternIdxToConfig[o]=s.patternIdxToConfig,r.charCodeToPatternIdxToConfig[o]=s.charCodeToPatternIdxToConfig,r.emptyGroups=i.merge(r.emptyGroups,s.emptyGroups),r.hasCustom=s.hasCustom||r.hasCustom,r.canModeBeOptimized[o]=s.canBeOptimized}}),this.defaultMode=o.defaultMode,!i.isEmpty(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){var l=i.map(this.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+l)}if(i.forEach(this.lexerDefinitionWarning,function(e){i.PRINT_WARNING(e.message)}),n.SUPPORT_STICKY?(this.chopInput=i.IDENTITY,this.match=this.matchWithTest):(this.updateLastIndex=i.NOOP,this.match=this.matchWithExec),c&&(this.handleModes=i.NOOP),!1===this.trackStartLines&&(this.computeNewColumn=i.IDENTITY),!1===this.trackEndLines&&(this.updateTokenEndLineColumnLocation=i.NOOP),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else{if(!/onlyOffset/i.test(this.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+this.config.positionTracking+'"');this.createTokenInstance=this.createOffsetOnlyToken}this.addToken=this.hasCustom?this.addTokenUsingPush:this.addTokenUsingMemberAccess;var h=i.reduce(this.canModeBeOptimized,function(e,t,r){return!1===t&&e.push(r),e},[]);if(t.ensureOptimizations&&!i.isEmpty(h))throw Error("Lexer Modes: < "+h.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!i.isEmpty(this.lexerDefinitionErrors)){var r=i.map(this.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){function r(e){O.push(e),I=this.charCodeToPatternIdxToConfig[e],C=this.patternIdxToConfig[e],R=C.length,R=C.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;k=I&&t?function(e){var t=I[e];return void 0===t?P:t}:function(){return C}}var a,o,s,c,u,l,h,p,d,f,m,g,v=this,y=e,b=y.length,x=0,w=0,_=this.hasCustom?0:Math.floor(e.length/10),T=Array(_),E=[],A=this.trackStartLines?1:void 0,S=this.trackStartLines?1:void 0,M=n.cloneEmptyGroups(this.emptyGroups),L=this.trackStartLines,N=this.config.lineTerminatorsPattern,R=0,C=[],I=[],O=[],P=[];Object.freeze(P);var F,k,D=function(e){if(1===O.length&&void 0===e.tokenType.PUSH_MODE){var t=v.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);E.push({offset:e.startOffset,line:void 0===e.startLine?void 0:e.startLine,column:void 0===e.startColumn?void 0:e.startColumn,length:e.image.length,message:t})}else{O.pop();var r=i.last(O);C=v.patternIdxToConfig[r],I=v.charCodeToPatternIdxToConfig[r],R=C.length;var n=v.canModeBeOptimized[r]&&!1===v.config.safeMode;k=I&&n?function(e){var t=I[e];return void 0===t?P:t}:function(){return C}}};for(r.call(this,t);x<b;){u=null;var U=y.charCodeAt(x),B=k(U),z=B.length;for(a=0;a<z;a++){var G=(F=B[a]).pattern;if(!1===(Z=F.short)?!0===F.isCustom?u=null===(g=G.exec(y,x,T,M))?g:g[0]:(this.updateLastIndex(G,x),u=this.match(G,e,x)):U===Z&&(u=G),null!==u){if(void 0!==(c=F.longerAlt)){var j=C[c],V=j.pattern;!0===j.isCustom?s=null===(g=V.exec(y,x,T,M))?g:g[0]:(this.updateLastIndex(V,x),s=this.match(V,e,x)),s&&s.length>u.length&&(u=s,F=j)}break}}if(null!==u){if(l=u.length,void 0!==(h=F.group)&&(p=F.tokenTypeIdx,d=this.createTokenInstance(u,x,p,F.tokenType,A,S,l),!1===h?w=this.addToken(T,w,d):M[h].push(d)),e=this.chopInput(e,l),x+=l,S=this.computeNewColumn(S,l),!0===L&&!0===F.canLineTerminator){var H=0,W=void 0,J=void 0;N.lastIndex=0;do{!0===(W=N.test(u))&&(J=N.lastIndex-1,H++)}while(W);0!=H&&(A+=H,S=l-J,this.updateTokenEndLineColumnLocation(d,h,J,H,A,S,l))}this.handleModes(F,D,r,d)}else{for(var X=x,Y=A,q=S,K=!1;!K&&x<b;)for(y.charCodeAt(x),e=this.chopInput(e,1),x++,o=0;o<R;o++){var Z,Q=C[o];if(G=Q.pattern,!1===(Z=Q.short)?!0===Q.isCustom?K=null!==G.exec(y,x,T,M):(this.updateLastIndex(G,x),K=null!==G.exec(e)):y.charCodeAt(x)===Z&&(K=!0),1==K)break}f=x-X,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,X,f,Y,q),E.push({offset:X,line:Y,column:q,length:f,message:m})}}return this.hasCustom||(T.length=w),{tokens:T,groups:M,errors:E}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var i=e.push;t(n),void 0!==i&&r.call(this,i)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,i,a,o){var s,c;void 0!==t&&(c=(s=r===o-1)?-1:0,1===n&&!0===s||(e.endLine=i+c,e.endColumn=a-1-c))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,i,a){return{image:e,startOffset:t,startLine:i,startColumn:a,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,i,a,o){return{image:e,startOffset:t,endOffset:t+o-1,startLine:i,endLine:i,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.match=function(){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null===r?r:r[0]},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();t.Lexer=c},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=r(4),s=r(9),c=r(1),u=r(5);t.addTerminalToCst=function(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)},t.addNoneTerminalToCst=function(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)};var l=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return i(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!a.isUndefined(e.name)){var n;if(e instanceof c.Option||e instanceof c.Repetition||e instanceof c.RepetitionMandatory||e instanceof c.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof c.RepetitionMandatoryWithSeparator||e instanceof c.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var i=[n],o=s.getKeyForAutomaticLookahead(this.ruleIdx,r,e.idx);this.result.push({def:i,key:o,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,c.Option,s.OPTION_IDX)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,c.Repetition,s.MANY_IDX)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,c.RepetitionMandatory,s.AT_LEAST_ONE_IDX)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,c.RepetitionMandatoryWithSeparator,s.AT_LEAST_ONE_SEP_IDX)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,c.RepetitionWithSeparator,s.MANY_SEP_IDX)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,c.Alternation,s.OR_IDX);var r=1<e.definition.length;a.forEach(e.definition,function(n,i){if(!a.isUndefined(n.name)){var o=n.definition;o=r?[new c.Option({definition:n.definition})]:n.definition;var u=s.getKeyForAltIndex(t.ruleIdx,s.OR_IDX,e.idx,i);t.result.push({def:o,key:u,name:n.name,orgProd:n})}})},t}(u.GAstVisitor);t.NamedDSLMethodsCollectorVisitor=l,t.analyzeCst=function(e,t){var r={dictDef:new o.HashTable,allRuleNames:[]};return a.forEach(e,function(e){var n=t.get(e.name);r.allRuleNames.push(e.name);var i=new l(n);e.accept(i),a.forEach(i.result,function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)})}),r}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="4.6.0"},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(15),a=r(2),o=r(6),s=r(17),c=r(10),u=r(39),l=r(5),h=r(1),p=r(24),d=r(40),f=r(20),m={};m.VERSION=s.VERSION,m.Parser=n.Parser,m.CstParser=n.CstParser,m.EmbeddedActionsParser=n.EmbeddedActionsParser,m.ParserDefinitionErrorType=n.ParserDefinitionErrorType,m.Lexer=i.Lexer,m.LexerDefinitionErrorType=i.LexerDefinitionErrorType,m.EOF=a.EOF,m.tokenName=a.tokenName,m.tokenLabel=a.tokenLabel,m.tokenMatcher=a.tokenMatcher,m.createToken=a.createToken,m.createTokenInstance=a.createTokenInstance,m.EMPTY_ALT=n.EMPTY_ALT,m.defaultParserErrorProvider=c.defaultParserErrorProvider,m.isRecognitionException=o.isRecognitionException,m.EarlyExitException=o.EarlyExitException,m.MismatchedTokenException=o.MismatchedTokenException,m.NotAllInputParsedException=o.NotAllInputParsedException,m.NoViableAltException=o.NoViableAltException,m.defaultLexerErrorProvider=f.defaultLexerErrorProvider,m.Flat=h.Flat,m.Repetition=h.Repetition,m.RepetitionWithSeparator=h.RepetitionWithSeparator,m.RepetitionMandatory=h.RepetitionMandatory,m.RepetitionMandatoryWithSeparator=h.RepetitionMandatoryWithSeparator,m.Option=h.Option,m.Alternation=h.Alternation,m.NonTerminal=h.NonTerminal,m.Terminal=h.Terminal,m.Rule=h.Rule,m.GAstVisitor=l.GAstVisitor,m.serializeGrammar=h.serializeGrammar,m.serializeProduction=h.serializeProduction,m.resolveGrammar=p.resolveGrammar,m.defaultGrammarResolverErrorProvider=c.defaultGrammarResolverErrorProvider,m.validateGrammar=p.validateGrammar,m.defaultGrammarValidatorErrorProvider=c.defaultGrammarValidatorErrorProvider,m.assignOccurrenceIndices=p.assignOccurrenceIndices,m.clearCache=function(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")},m.createSyntaxDiagramsCode=u.createSyntaxDiagramsCode,m.generateParserFactory=d.generateParserFactory,m.generateParserModule=d.generateParserModule,e.exports=m},function(e,t){var r,n;"undefined"!=typeof self&&self,void 0===(n="function"==typeof(r=function(){function e(){}function t(e){return e.charCodeAt(0)}function r(e,t){void 0===e.length?t.push(e):e.forEach(function(e){t.push(e)})}function n(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function i(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}function a(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":n(r,"global");break;case"i":n(r,"ignoreCase");break;case"m":n(r,"multiLine");break;case"u":n(r,"unicode");break;case"y":n(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}i(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":this.isDigit()?t={atLeast:r,atMost:this.integerIncludingZero()}:t={atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;i(t)}if(!0!==e||void 0!==t)return i(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),i(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[t("\n"),t("\r"),t("\u2028"),t("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=l;break;case"D":e=l,t=!0;break;case"s":e=p;break;case"S":e=p,t=!0;break;case"w":e=h;break;case"W":e=h,t=!0}return i(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=t("\f");break;case"n":e=t("\n");break;case"r":e=t("\r");break;case"t":e=t("\t");break;case"v":e=t("\v")}return i(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:t("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:t(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:t(this.popChar())}}},e.prototype.characterClass=function(){var e=[],n=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),n=!0);this.isClassAtom();){var i=this.classAtom();if("Character"===i.type&&this.isRangeDash()){this.consumeChar("-");var a=this.classAtom();if("Character"===a.type){if(a.value<i.value)throw Error("Range out of order in character class");e.push({from:i.value,to:a.value})}else r(i.value,e),e.push(t("-")),r(a.value,e)}else r(i.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:t("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===u.test(e))throw Error("Expecting a positive integer");for(;c.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===c.test(e))throw Error("Expecting an integer");for(;c.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:t(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return c.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t,r="",n=0;n<e;n++){if(t=this.popChar(),!1===s.test(t))throw Error("Expecting a HexDecimal digits");r+=t}return{type:"Character",value:parseInt(r,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var o,s=/[0-9a-fA-F]/,c=/[0-9]/,u=/[1-9]/,l=[];for(o=t("0");o<=t("9");o++)l.push(o);var h=[t("_")].concat(l);for(o=t("a");o<=t("z");o++)h.push(o);for(o=t("A");o<=t("Z");o++)h.push(o);var p=[t(" "),t("\f"),t("\n"),t("\r"),t("\t"),t("\v"),t("\t"),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t(" "),t("\u2028"),t("\u2029"),t(" "),t(" "),t("　"),t("\ufeff")];return a.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0===r.type?Array.isArray(r)&&r.forEach(function(e){this.visit(e)},this):this.visit(r))}},a.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},a.prototype.visitPattern=function(){},a.prototype.visitFlags=function(){},a.prototype.visitDisjunction=function(){},a.prototype.visitAlternative=function(){},a.prototype.visitStartAnchor=function(){},a.prototype.visitEndAnchor=function(){},a.prototype.visitWordBoundary=function(){},a.prototype.visitNonWordBoundary=function(){},a.prototype.visitLookahead=function(){},a.prototype.visitNegativeLookahead=function(){},a.prototype.visitCharacter=function(){},a.prototype.visitSet=function(){},a.prototype.visitGroup=function(){},a.prototype.visitGroupBackReference=function(){},a.prototype.visitQuantifier=function(){},{RegExpParser:e,BaseRegExpVisitor:a,VERSION:"0.4.0"}})?r.apply(t,[]):r)||(e.exports=n)},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},function(e,t,r){function n(e){if(e instanceof c.NonTerminal)return n(e.referencedRule);if(e instanceof c.Terminal)return o(e);if(u.isSequenceProd(e))return i(e);if(u.isBranchingProd(e))return a(e);throw Error("non exhaustive match")}function i(e){for(var t,r=[],i=e.definition,a=0,o=i.length>a,c=!0;o&&c;)t=i[a],c=u.isOptionalProd(t),r=r.concat(n(t)),a+=1,o=i.length>a;return s.uniq(r)}function a(e){var t=s.map(e.definition,function(e){return n(e)});return s.uniq(s.flatten(t))}function o(e){return[e.terminalType]}Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),c=r(1),u=r(8);t.first=n,t.firstForSequence=i,t.firstForBranching=a,t.firstForTerminal=o},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IN="_~IN~_"},function(e,t,r){function n(e,r,n){switch(e.type){case M.AT_LEAST_ONE:return function(e,t,r){return i(q,new R.RepetitionMandatory({definition:[]}),e,t,r)}(e,r,n);case M.AT_LEAST_ONE_SEP:return function(e,t,r){return a(e,t,R.RepetitionMandatoryWithSeparator,J,r)}(e,r,n);case M.MANY_SEP:return function(e,t,r){return a(e,t,R.RepetitionWithSeparator,H,r)}(e,r,n);case M.MANY:return function(e,t,r){return i(G,new R.Repetition({definition:[]}),e,t,r)}(e,r,n);case M.OPTION:return function(e,t,r){return i(U,new R.Option({definition:[]}),e,t,r)}(e,r,n);case M.OR:return function(e,t,r){return i(Q,new R.Alternation({definition:[]}),e,t,r)}(e,r,n);case M.FLAT:return function(e,t,r){var n=new R.Flat({definition:[]}),i=ee.exec(e.text)[1];return N.isUndefined(i)||(n.name=i),o(n,e.range,t,r)}(e,r,n);case M.REF:return function(e){var t=F.exec(e.text),r=void 0===t[1]?0:parseInt(t[1],10),n=t[2];return new R.NonTerminal({nonTerminalName:n,idx:r})}(e);case M.TERMINAL:return function(e,r){var n=O.exec(e.text),i=void 0===n[1]?0:parseInt(n[1],10),a=n[2],o=t.terminalNameToConstructor[a];if(!o)throw Error("Terminal Token name: <"+a+"> not found in rule: <"+r+">  \n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#TERMINAL_NAME_NOT_FOUND\n\tFor Further details.");return new R.Terminal({terminalType:o,idx:i})}(e,n);default:throw Error("non exhaustive match")}}function i(e,t,r,n,i){var a=e.exec(r.text),s=void 0===a[1];t.idx=s?0:parseInt(a[1],10);var c=a[2];return N.isUndefined(c)||(t.name=c),o(t,r.range,n,i)}function a(e,r,n,i,a){var s=i.exec(e.text),c=void 0===s[1]?0:parseInt(s[1],10),u=s[3],l=t.terminalNameToConstructor[u];if(!l)throw Error("Separator Terminal Token name: "+u+" not found");var h=new n({definition:[],separator:l,idx:c}),p=s[2];return N.isUndefined(p)||(h.name=p),o(h,e.range,r,a)}function o(e,t,r,i){var a=s(t,r),o=N.sortBy(a,function(e){return e.range.start}),c=[];return N.forEach(o,function(e){c.push(n(e,r,i))}),e.definition=c,e}function s(e,t){return N.filter(t,function(r){var n=e.strictlyContainsRange(r.range),i=N.every(t,function(t){var n=t.range.strictlyContainsRange(r.range),i=t.range.isStrictlyContainedInRange(e);return!(n&&i)});return n&&i})}function c(e){return e.replace(re,"").replace(ne,"")}function u(e,t){return void 0===t?"":e}function l(e){return e.replace(ie,u).replace(ae,u)}function h(e){var t=p(e),r=d(e),n=f(e),i=m(e),a=g(e),o=v(e),s=y(e),c=b(e);return[].concat(t,r,n,i,a,o,s,c)}function p(e){return w(e,M.TERMINAL,P)}function d(e){return w(e,M.REF,k)}function f(e){return _(e,M.AT_LEAST_ONE,K)}function m(e){return _(e,M.AT_LEAST_ONE_SEP,X)}function g(e){return _(e,M.MANY,j)}function v(e){return _(e,M.MANY_SEP,W)}function y(e){return _(e,M.OPTION,B)}function b(e){var t=_(e,M.OR,$),r=x(t);return t.concat(r)}function x(e){var t=[];return N.forEach(e,function(e){var r=T(e.text,M.FLAT,te,oe),n=e.range.start;N.forEach(r,function(e){e.range.start+=n,e.range.end+=n}),t=t.concat(r)}),N.uniq(t,function(e){return e.type+"~"+e.range.start+"~"+e.range.end+"~"+e.text})}function w(e,t,r){for(var n,i=[];n=r.exec(e);){var a=n.index,o=r.lastIndex,s=new L.Range(a,o),c=n[0];i.push({range:s,text:c,type:t})}return i}function _(e,t,r){return T(e,t,r,se)}function T(e,t,r,n){for(var i,a=[];i=r.exec(e);){var o=i.index,s=n(o+i[0].length,e),c=new L.Range(o,s),u=e.substr(o,s-o+1);a.push({range:c,text:u,type:t})}return a}function E(e,t,r,n){for(var i=[1],a=-1;!N.isEmpty(i)&&a+r<n.length;){a++;var o=n.charAt(r+a);o===e?i.push(1):o===t&&i.pop()}if(N.isEmpty(i))return a+r;throw new Error("INVALID INPUT TEXT, UNTERMINATED PARENTHESIS")}function A(e,t){return N.map(e,function(e){return S(e,t)})}function S(e,t){switch(e.type){case"NonTerminal":return new R.NonTerminal({nonTerminalName:e.name,idx:e.idx});case"Flat":return new R.Flat({name:e.name,definition:A(e.definition,t)});case"Option":return new R.Option({name:e.name,idx:e.idx,definition:A(e.definition,t)});case"RepetitionMandatory":return new R.RepetitionMandatory({name:e.name,idx:e.idx,definition:A(e.definition,t)});case"RepetitionMandatoryWithSeparator":return new R.RepetitionMandatoryWithSeparator({name:e.name,idx:e.idx,separator:t[e.separator.name],definition:A(e.definition,t)});case"RepetitionWithSeparator":return new R.RepetitionWithSeparator({name:e.name,idx:e.idx,separator:t[e.separator.name],definition:A(e.definition,t)});case"Repetition":return new R.Repetition({name:e.name,idx:e.idx,definition:A(e.definition,t)});case"Alternation":return new R.Alternation({name:e.name,idx:e.idx,definition:A(e.definition,t)});case"Terminal":return new R.Terminal({terminalType:t[e.name],idx:e.idx});case"Rule":return new R.Rule({name:e.name,orgText:e.orgText,definition:A(e.definition,t)})}}Object.defineProperty(t,"__esModule",{value:!0});var M,L=r(29),N=r(0),R=r(1);!function(e){e[e.OPTION=0]="OPTION",e[e.OR=1]="OR",e[e.MANY=2]="MANY",e[e.MANY_SEP=3]="MANY_SEP",e[e.AT_LEAST_ONE=4]="AT_LEAST_ONE",e[e.AT_LEAST_ONE_SEP=5]="AT_LEAST_ONE_SEP",e[e.REF=6]="REF",e[e.TERMINAL=7]="TERMINAL",e[e.FLAT=8]="FLAT"}(M=t.ProdType||(t.ProdType={}));var C=/(?:\s*{\s*NAME\s*:\s*["'`]([\w$]*)["'`])?/,I=new RegExp(C.source.replace("{","").replace(")?","\\s*,)?")),O=/\.\s*CONSUME(\d+)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,P=new RegExp(O.source,"g"),F=/\.\s*SUBRULE(\d+)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,k=new RegExp(F.source,"g"),D=/\.\s*OPTION(\d+)?\s*\(/,U=new RegExp(D.source+C.source),B=new RegExp(D.source,"g"),z=/\.\s*MANY(\d+)?\s*\(/,G=new RegExp(z.source+C.source),j=new RegExp(z.source,"g"),V=/\s*SEP\s*:\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,H=new RegExp(/\.\s*MANY_SEP(\d+)?\s*\(\s*{/.source+I.source+V.source),W=new RegExp(H.source,"g"),J=new RegExp(/\.\s*AT_LEAST_ONE_SEP(\d+)?\s*\(\s*{/.source+I.source+V.source),X=new RegExp(J.source,"g"),Y=/\.\s*AT_LEAST_ONE(\d+)?\s*\(/,q=new RegExp(Y.source+C.source),K=new RegExp(Y.source,"g"),Z=/\.\s*OR(\d+)?\s*\(/,Q=new RegExp(Z.source+C.source),$=new RegExp(Z.source,"g"),ee=new RegExp(I.source+/\s*(ALT)\s*:/.source),te=new RegExp(ee.source,"g");t.terminalNameToConstructor={},t.buildTopProduction=function(e,r,n){t.terminalNameToConstructor=n;var i=h(l(c("  "+e)));return function(e,t,r,n){return o(new R.Rule({name:e,definition:[],orgText:n}),t,r,e)}(r,new L.Range(0,e.length+2),i,e)},t.buildProdGast=n,t.getDirectlyContainedRanges=s;var re=/\/\/.*/g,ne=/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,ie=/(NAME\s*:\s*)?"([^\\"]|\\([bfnrtv"\\\/]|u[0-9a-fA-F]{4}))*"/g,ae=/(NAME\s*:\s*)?'([^\\']|\\([bfnrtv'\\\/]|u[0-9a-fA-F]{4}))*'/g;t.removeComments=c,t.removeStringLiterals=l,t.createRanges=h,t.createTerminalRanges=p,t.createRefsRanges=d,t.createAtLeastOneRanges=f,t.createAtLeastOneSepRanges=m,t.createManyRanges=g,t.createManySepRanges=v,t.createOptionRanges=y,t.createOrRanges=b;var oe=N.partial(E,"{","}"),se=N.partial(E,"(",")");t.createOrPartRanges=x,t.findClosingOffset=E,t.deserializeGrammar=A,t.deserializeProduction=S},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),a=r(30),o=r(11),s=r(10),c=r(8);t.resolveGrammar=function(e){e=n.defaults(e,{errMsgProvider:s.defaultGrammarResolverErrorProvider});var t=new i.HashTable;return n.forEach(e.rules,function(e){t.put(e.name,e)}),a.resolveGrammar(t,e.errMsgProvider)},t.validateGrammar=function(e){return e=n.defaults(e,{errMsgProvider:s.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),o.validateGrammar(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)},t.assignOccurrenceIndices=function(e){n.forEach(e.rules,function(e){var t=new c.DslMethodsCollectorVisitor;e.accept(t),n.forEach(t.dslMethods,function(e){n.forEach(e,function(e,t){e.idx=t+1})})})}},function(e,t,r){function n(e){this.name=t.IN_RULE_RECOVERY_EXCEPTION,this.message=e}function i(e,t,r,n,i,o){var s=this.getKeyForAutomaticLookahead(n,i),c=this.firstAfterRepMap.get(s);if(void 0===c){var u=this.getCurrRuleFullName();c=new o(this.getGAstProductions().get(u),i).startWalking(),this.firstAfterRepMap.put(s,c)}var l=c.token,h=c.occurrence,p=c.isEndOfRule;1===this.RULE_STACK.length&&p&&void 0===l&&(l=a.EOF,h=1),this.shouldInRepetitionRecoveryBeTried(l,h)&&this.tryInRepetitionRecovery(e,t,r,l)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=r(0),s=r(6),c=r(22),u=r(4),l=r(3);t.EOF_FOLLOW_KEY={},t.IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException",t.InRuleRecoveryException=n,n.prototype=Error.prototype;var h=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap=new u.HashTable,this.resyncFollows=new u.HashTable,this.recoveryEnabled=o.has(e,"recoveryEnabled")?e.recoveryEnabled:l.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=i)},e.prototype.getTokenToInsert=function(e){var t=a.createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var i=this,a=this.findReSyncTokenType(),c=this.exportLexerState(),u=[],l=!1,h=this.LA(1),p=this.LA(1),d=function(){var e=i.LA(0),t=i.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:h,previous:e,ruleName:i.getCurrRuleFullName()}),r=new s.MismatchedTokenException(t,h,i.LA(0));r.resyncedTokens=o.dropRight(u),i.SAVE_ERROR(r)};!l;){if(this.tokenMatcher(p,n))return void d();if(r.call(this))return d(),void e.apply(this,t);this.tokenMatcher(p,a)?l=!0:(p=this.SKIP_TOKEN(),this.addToResyncTokens(p,u))}this.importLexerState(c)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t){return void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new n("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(o.isEmpty(t))return!1;var n=this.LA(1);return void 0!==o.find(t,function(e){return r.tokenMatcher(n,e)})},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return o.contains(r,e)},e.prototype.findReSyncTokenType=function(){for(var e,t=this.flattenFollowSet(),r=this.LA(1),n=2;;){if(e=r.tokenType,o.contains(t,e))return e;r=this.LA(n),n++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return t.EOF_FOLLOW_KEY;var e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,r=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return o.isEmpty(this.LAST_EXPLICIT_RULE_STACK)||(r=o.map(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.RULE_STACK[t]}),n=o.map(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.RULE_OCCURRENCE_STACK[t]})),o.map(r,function(i,a){return 0===a?t.EOF_FOLLOW_KEY:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[a],inRule:e.shortRuleNameToFullName(r[a-1])}})},e.prototype.flattenFollowSet=function(){var e=this,t=o.map(this.buildFullFollowKeyStack(),function(t){return e.getFollowSetFromFollowKey(t)});return o.flatten(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===t.EOF_FOLLOW_KEY)return[a.EOF];var r=e.ruleName+e.idxInCallingRule+c.IN+e.inRule;return this.resyncFollows.get(r)},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,a.EOF)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return o.dropRight(t)},e.prototype.attemptInRepetitionRecovery=function(){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:o.cloneArr(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return o.isEmpty(this.LAST_EXPLICIT_RULE_STACK)?o.map(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):o.map(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},e}();t.Recoverable=h,t.attemptInRepetitionRecovery=i},function(e,t,r){function n(e,t){return e.name+t+l.IN}var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),s=r(4),c=r(21),u=r(0),l=r(22),h=r(2),p=r(1),d=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows=new s.HashTable,r}return a(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(){},t.prototype.walkProdRef=function(e,t,r){var i=n(e.referencedRule,e.idx)+this.topProd.name,a=t.concat(r),o=new p.Flat({definition:a}),s=c.first(o);this.follows.put(i,s)},t}(o.RestWalker);t.ResyncFollowsWalker=d,t.computeAllProdsFollows=function(e){var t=new s.HashTable;return u.forEach(e,function(e){var r=new d(e).startWalking();t.putAll(r)}),t},t.buildBetweenProdsFollowPrefix=n,t.buildInProdFollowPrefix=function(e){return h.tokenName(e.terminalType)+e.idx+l.IN}},function(e,t,r){function n(e){var t=A.filter(e,function(e){return!A.has(e,L)});return{errors:A.map(t,function(e){return{message:"Token Type: ->"+T.tokenName(e)+"<- missing static 'PATTERN' property",type:E.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}}),valid:A.difference(e,t)}}function i(e){var t=A.filter(e,function(e){var t=e[L];return!(A.isRegExp(t)||A.isFunction(t)||A.has(t,"exec")||A.isString(t))});return{errors:A.map(t,function(e){return{message:"Token Type: ->"+T.tokenName(e)+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:E.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}}),valid:A.difference(e,t)}}function a(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return w(t,e),t.prototype.visitEndAnchor=function(){this.found=!0},t}(_.BaseRegExpVisitor),r=A.filter(e,function(e){var r=e[L];try{var n=M.pattern(r.toString()),i=new t;return i.visit(n),i.found}catch(e){return N.test(r.source)}});return A.map(r,function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+T.tokenName(e)+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:E.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}})}function o(e){var t=A.filter(e,function(e){return e[L].test("")});return A.map(t,function(e){return{message:"Token Type: ->"+T.tokenName(e)+"<- static 'PATTERN' must not match an empty string",type:E.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}})}function s(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return w(t,e),t.prototype.visitStartAnchor=function(){this.found=!0},t}(_.BaseRegExpVisitor),r=A.filter(e,function(e){var r=e[L];try{var n=M.pattern(r.toString()),i=new t;return i.visit(n),i.found}catch(e){return R.test(r.source)}});return A.map(r,function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+T.tokenName(e)+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:E.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}})}function c(e){var t=A.filter(e,function(e){var t=e[L];return t instanceof RegExp&&(t.multiline||t.global)});return A.map(t,function(e){return{message:"Token Type: ->"+T.tokenName(e)+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:E.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}})}function u(e){var t=[],r=A.map(e,function(r){return A.reduce(e,function(e,n){return r.PATTERN.source!==n.PATTERN.source||A.contains(t,n)||n.PATTERN===E.Lexer.NA?e:(t.push(n),e.push(n),e)},[])});r=A.compact(r);var n=A.filter(r,function(e){return 1<e.length});return A.map(n,function(e){var t=A.map(e,function(e){return T.tokenName(e)});return{message:"The same RegExp pattern ->"+A.first(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:E.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}})}function l(e){var t=A.filter(e,function(e){if(!A.has(e,"GROUP"))return!1;var t=e.GROUP;return t!==E.Lexer.SKIPPED&&t!==E.Lexer.NA&&!A.isString(t)});return A.map(t,function(e){return{message:"Token Type: ->"+T.tokenName(e)+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:E.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}})}function h(e,t){var r=A.filter(e,function(e){return void 0!==e.PUSH_MODE&&!A.contains(t,e.PUSH_MODE)});return A.map(r,function(e){return{message:"Token Type: ->"+T.tokenName(e)+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:E.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}})}function p(e){var t=[],r=A.reduce(e,function(e,t,r){var n,i=t.PATTERN;return i===E.Lexer.NA?e:(A.isString(i)?e.push({str:i,idx:r,tokenType:t}):A.isRegExp(i)&&(n=i,void 0===A.find([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(e){return-1!==n.source.indexOf(e)}))&&e.push({str:i.source,idx:r,tokenType:t}),e)},[]);return A.forEach(e,function(e,n){A.forEach(r,function(r){var i=r.str,a=r.idx,o=r.tokenType;if(n<a&&function(e,t){if(A.isRegExp(t)){var r=t.exec(e);return null!==r&&0===r.index}if(A.isFunction(t))return t(e,0,[],{});if(A.has(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var s="Token: ->"+T.tokenName(o)+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+T.tokenName(e)+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:s,type:E.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[e,o]})}})}),t}function d(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function f(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function m(e){var t=e.PATTERN;if(A.isRegExp(t))return!1;if(A.isFunction(t))return!0;if(A.has(t,"exec"))return!0;if(A.isString(t))return!1;throw Error("non exhaustive match")}function g(e){return A.isString(e)&&1===e.length&&e.charCodeAt(0)}function v(e,t){if(A.has(e,"LINE_BREAKS"))return!1;if(A.isRegExp(e.PATTERN)){try{S.canMatchCharCode(t,e.PATTERN)}catch(e){return{issue:E.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(A.isString(e.PATTERN))return!1;if(m(e))return{issue:E.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function y(e,t){if(t.issue===E.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===E.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function b(e){return A.map(e,function(e){return A.isString(e)&&0<e.length?e.charCodeAt(0):e})}var x,w=this&&this.__extends||(x=function(e,t){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}x(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var _=r(19),T=r(2),E=r(15),A=r(0),S=r(28),M=new _.RegExpParser,L="PATTERN";t.DEFAULT_MODE="defaultMode",t.MODES="modes",t.SUPPORT_STICKY="boolean"==typeof/(?:)/.sticky,t.disableSticky=function(){t.SUPPORT_STICKY=!1},t.enableSticky=function(){t.SUPPORT_STICKY=!0},t.analyzeTokenTypes=function(e,r){function n(e,t,r){void 0===e[t]&&(e[t]=[]),e[t].push(r)}r=A.defaults(r,{useSticky:t.SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"]});var i=A.reject(e,function(e){return e[L]===E.Lexer.NA}),a=!1,o=A.map(i,function(e){var t=e[L];if(A.isRegExp(t)){var n=t.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||A.contains(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?r.useSticky?f(t):d(t):n[1]}if(A.isFunction(t))return a=!0,{exec:t};if(A.has(t,"exec"))return a=!0,t;if("string"==typeof t){if(1===t.length)return t;var i=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),o=new RegExp(i);return r.useSticky?f(o):d(o)}throw Error("non exhaustive match")}),s=A.map(i,function(e){return e.tokenTypeIdx}),c=A.map(i,function(e){var t=e.GROUP;if(t!==E.Lexer.SKIPPED){if(A.isString(t))return t;if(A.isUndefined(t))return!1;throw Error("non exhaustive match")}}),u=A.map(i,function(e){var t=e.LONGER_ALT;if(t)return A.indexOf(i,t)}),l=A.map(i,function(e){return e.PUSH_MODE}),h=A.map(i,function(e){return A.has(e,"POP_MODE")}),p=b(r.lineTerminatorCharacters),y=A.map(i,function(){return!1});"onlyOffset"!==r.positionTracking&&(y=A.map(i,function(e){return A.has(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===v(e,p)?S.canMatchCharCode(p,e.PATTERN):void 0}));var x=A.map(i,m),w=A.map(o,g),_=A.reduce(i,function(e,t){var r=t.GROUP;return A.isString(r)&&r!==E.Lexer.SKIPPED&&(e[r]=[]),e},{}),M=A.map(o,function(e,t){return{pattern:o[t],longerAlt:u[t],canLineTerminator:y[t],isCustom:x[t],short:w[t],group:c[t],push:l[t],pop:h[t],tokenTypeIdx:s[t],tokenType:i[t]}}),N=!0,R=[];return r.safeMode||(R=A.reduce(i,function(e,t,i){if("string"==typeof t.PATTERN){var a=t.PATTERN.charCodeAt(0);n(e,a,M[i])}else if(A.isArray(t.START_CHARS_HINT))A.forEach(t.START_CHARS_HINT,function(t){var r="string"==typeof t?t.charCodeAt(0):t;n(e,r,M[i])});else if(A.isRegExp(t.PATTERN))if(t.PATTERN.unicode)N=!1,r.ensureOptimizations&&A.PRINT_ERROR(S.failedOptimizationPrefixMsg+"\tUnable to analyze < "+t.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var o=S.getStartCodes(t.PATTERN,r.ensureOptimizations);A.isEmpty(o)&&(N=!1),A.forEach(o,function(t){n(e,t,M[i])})}else r.ensureOptimizations&&A.PRINT_ERROR(S.failedOptimizationPrefixMsg+"\tTokenType: <"+T.tokenName(t)+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),N=!1;return e},[])),N&&65536>R.length&&(R=A.packArray(R)),{emptyGroups:_,patternIdxToConfig:M,charCodeToPatternIdxToConfig:R,hasCustom:a,canBeOptimized:N}},t.validatePatterns=function(e,t){var r=[],d=n(e);r=r.concat(d.errors);var f=i(d.valid),m=f.valid;return(r=(r=(r=(r=r.concat(f.errors)).concat(function(e){var t=[],r=A.filter(e,function(e){return A.isRegExp(e[L])});return(t=(t=(t=(t=t.concat(a(r))).concat(s(r))).concat(c(r))).concat(u(r))).concat(o(r))}(m))).concat(l(m))).concat(h(m,t))).concat(p(m))},t.findMissingPatterns=n,t.findInvalidPatterns=i;var N=/[^\\][\$]/;t.findEndOfInputAnchor=a,t.findEmptyMatchRegExps=o;var R=/[^\\[][\^]|^\^/;t.findStartOfInputAnchor=s,t.findUnsupportedFlags=c,t.findDuplicatePatterns=u,t.findInvalidGroupType=l,t.findModesThatDoNotExist=h,t.findUnreachablePatterns=p,t.addStartOfInput=d,t.addStickyFlag=f,t.performRuntimeChecks=function(e){var r=[];return A.has(e,t.DEFAULT_MODE)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+t.DEFAULT_MODE+"> property in its definition\n",type:E.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),A.has(e,t.MODES)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+t.MODES+"> property in its definition\n",type:E.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),A.has(e,t.MODES)&&A.has(e,t.DEFAULT_MODE)&&!A.has(e.modes,e.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+t.DEFAULT_MODE+": <"+e.defaultMode+">which does not exist\n",type:E.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),A.has(e,t.MODES)&&A.forEach(e.modes,function(e,t){A.forEach(e,function(e,n){A.isUndefined(e)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+n+">\n",type:E.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r},t.performWarningRuntimeChecks=function(e,t,r){var n=[],i=!1,a=A.compact(A.flatten(A.mapValues(e.modes,function(e){return e}))),o=A.reject(a,function(e){return e[L]===E.Lexer.NA}),s=b(r);return t&&A.forEach(o,function(e){var t=v(e,s);if(!1!==t){var r={message:y(e,t),type:t.issue,tokenType:e};n.push(r)}else A.has(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):S.canMatchCharCode(s,e.PATTERN)&&(i=!0)}),t&&!i&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:E.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n},t.cloneEmptyGroups=function(e){var t={},r=A.keys(e);return A.forEach(r,function(r){var n=e[r];if(!A.isArray(n))throw Error("non exhaustive match");t[r]=[]}),t},t.isCustomPattern=m,t.isShortPattern=g,t.LineTerminatorOptimizedTester={test:function(e){for(var t,r=e.length,n=this.lastIndex;n<r;n++){if(10===(t=e.charCodeAt(n)))return this.lastIndex=n+1,!0;if(13===t)return this.lastIndex=10===e.charCodeAt(n+1)?n+2:n+1,!0}return!1},lastIndex:0},t.buildLineBreakIssueMessage=y},function(e,t,r){function n(e){switch(e.type){case"Disjunction":return l.flatten(l.map(e.value,n));case"Alternative":for(var t,r=[],i=e.value,a=0;a<i.length;a++)if(t=i[a],!l.contains(["GroupBackReference","Lookahead","NegativeLookahead","StartAnchor","EndAnchor","WordBoundary","NonWordBoundary"],t.type)){var s=t;switch(s.type){case"Character":r.push(s.value);break;case"Set":if(!0===s.complement)throw Error(p);l.forEach(s.value,function(e){if("number"==typeof e)r.push(e);else for(var t=e,n=t.from;n<=t.to;n++)r.push(n)});break;case"Group":var c=n(s.value);l.forEach(c,function(e){return r.push(e)});break;default:throw Error("Non Exhaustive Match")}var u=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===o(s)||"Group"!==s.type&&0==u)break}return r;default:throw Error("non exhaustive match!")}}function i(e){var t=[];return l.forEach(e,function(e){t.push(e);var r=String.fromCharCode(e);r.toUpperCase()===r?r.toLowerCase()!==r&&t.push(r.toLowerCase().charCodeAt(0)):t.push(r.toUpperCase().charCodeAt(0))}),t}function a(e,t){return l.find(e.value,function(e){if("number"==typeof e)return l.contains(t,e);var r=e;return void 0!==l.find(t,function(e){return r.from<=e&&e<=r.to})})}function o(e){return e.quantifier&&0===e.quantifier.atLeast||!!e.value&&(l.isArray(e.value)?l.every(e.value,o):o(e.value))}var s,c=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var u=r(19),l=r(0),h=new u.RegExpParser,p="Complement Sets are not supported for first char optimization";t.failedOptimizationPrefixMsg='Unable to use "first char" lexer optimizations:\n',t.getStartCodes=function(e,r){void 0===r&&(r=!1);try{var a=h.pattern(e.toString()),o=n(a.value);return a.flags.ignoreCase&&(o=i(o)),o}catch(n){if(n.message===p)r&&l.PRINT_WARNING(t.failedOptimizationPrefixMsg+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var s="";r&&(s="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),l.PRINT_ERROR(t.failedOptimizationPrefixMsg+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+u.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+s)}}return[]},t.firstChar=n,t.applyIgnoreCase=i;var d=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return c(t,e),t.prototype.visitChildren=function(t){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)},t.prototype.visitCharacter=function(e){l.contains(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===a(e,this.targetCharCodes)&&(this.found=!0):void 0!==a(e,this.targetCharCodes)&&(this.found=!0)},t}(u.BaseRegExpVisitor);t.canMatchCharCode=function(e,t){if(t instanceof RegExp){var r=h.pattern(t.toString()),n=new d(e);return n.visit(r),n.found}return void 0!==l.find(t,function(t){return l.contains(e,t.charCodeAt(0))})}},function(e,t){function r(e,t){return!(0>e||t<e)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){if(this.start=e,this.end=t,!r(e,t))throw new Error("INVALID RANGE")}return e.prototype.contains=function(e){return this.start<=e&&this.end>=e},e.prototype.containsRange=function(e){return this.start<=e.start&&this.end>=e.end},e.prototype.isContainedInRange=function(e){return e.containsRange(this)},e.prototype.strictlyContainsRange=function(e){return this.start<e.start&&this.end>e.end},e.prototype.isStrictlyContainedInRange=function(e){return e.strictlyContainsRange(this)},e}();t.Range=n,t.isValidRange=r},function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(3),o=r(0),s=r(5);t.resolveGrammar=function(e,t){var r=new c(e,t);return r.resolveRefs(),r.errors};var c=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return i(t,e),t.prototype.resolveRefs=function(){var e=this;o.forEach(this.nameToTopRule.values(),function(t){e.currTopLevel=t,t.accept(e)})},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule.get(e.nonTerminalName);if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:a.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(s.GAstVisitor);t.GastRefResolverVisitor=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),i=r(0),a=r(3),o=r(9),s=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=i.has(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:a.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=i.has(e,"maxLookahead")?e.maxLookahead:a.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=i.isES2015MapSupported()?new Map:[],i.isES2015MapSupported()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return n.buildSingleAlternativeLookaheadFunction(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return n.buildAlternativesLookAheadFunc(e,t,r,i)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return o.getKeyForAutomaticLookahead(r,e,t)},e.prototype.getLookaheadFuncForOr=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OR_IDX,e),a=this.getLaFuncFromCache(r);if(void 0===a){var s=this.getCurrRuleFullName(),c=this.getGAstProductions().get(s),u=i.some(t,function(e){return i.isFunction(e.GATE)});return a=n.buildLookaheadFuncForOr(e,c,this.maxLookahead,u,this.dynamicTokensEnabled,this.lookAheadBuilderForAlternatives),this.setLaFuncCache(r,a),a}return a},e.prototype.getLookaheadFuncForOption=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.OPTION)},e.prototype.getLookaheadFuncForMany=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION)},e.prototype.getLookaheadFuncForManySep=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION_WITH_SEPARATOR)},e.prototype.getLookaheadFuncForAtLeastOne=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION_MANDATORY)},e.prototype.getLookaheadFuncForAtLeastOneSep=function(e,t){return this.getLookaheadFuncFor(e,t,this.maxLookahead,n.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.getLookaheadFuncFor=function(e,t,r,i){var a=this.getLaFuncFromCache(e);if(void 0===a){var o=this.getCurrRuleFullName(),s=this.getGAstProductions().get(o);return a=n.buildLookaheadFuncForOptionalProd(t,s,r,this.dynamicTokensEnabled,i,this.lookAheadBuilderForOptional),this.setLaFuncCache(e,a),a}return a},e.prototype.getLaFuncFromCache=function(){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();t.LooksAhead=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),i=r(0),a=r(33),o=r(9),s=r(3),c=function(){function e(){}return e.prototype.initTreeBuilder=function(e){this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=i.has(e,"outputCst")?e.outputCst:s.DEFAULT_PARSER_CONFIG.outputCst,this.outputCst||(this.cstInvocationStateUpdate=i.NOOP,this.cstFinallyStateUpdate=i.NOOP,this.cstPostTerminal=i.NOOP,this.cstPostNonTerminal=i.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst)},e.prototype.cstNestedInvocationStateUpdate=function(e){this.CST_STACK.push({name:e,fullName:this.shortRuleNameToFull.get(this.getLastExplicitRuleShortName())+e,children:{}})},e.prototype.cstInvocationStateUpdate=function(e){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1),this.CST_STACK.push({name:e,children:{}})},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];n.addTerminalToCst(r,t,e)},e.prototype.cstPostNonTerminal=function(e,t){n.addNoneTerminalToCst(this.CST_STACK[this.CST_STACK.length-1],t,e)},e.prototype.getBaseCstVisitorConstructor=function(){if(i.isUndefined(this.baseCstVisitorConstructor)){var e=a.createBaseSemanticVisitorConstructor(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(i.isUndefined(this.baseCstVisitorWithDefaultsConstructor)){var e=a.createBaseVisitorConstructorWithDefaults(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0===e.NAME?void 0:(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r)},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var i,a=this.getLastExplicitRuleShortName(),s=o.getKeyForAltIndex(a,r,t,n);return void 0===e.NAME?void 0:(i=e.NAME,this.nestedRuleInvocationStateUpdate(i,s),{shortName:s,nestedName:i})},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var a=r[r.length-1];n.addNoneTerminalToCst(a,t,i)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}();t.TreeBuilder=c},function(e,t,r){function n(e,t){for(var r=c.keys(e),n=r.length,i=0;i<n;i++)for(var a,o=e[r[i]],s=o.length,u=0;u<s;u++)void 0===(a=o[u]).tokenTypeIdx&&(void 0===a.fullName?this[a.name](a.children,t):this[a.fullName](a.children,t))}function i(e,t){var r=a(e,t),n=o(e,t);return r.concat(n)}function a(e,t){var r=c.map(t,function(t){if(!c.isFunction(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+u.functionName(e.constructor)+" CST Visitor.",type:s.MISSING_METHOD,methodName:t}});return c.compact(r)}function o(e,t){var r=[];for(var n in e)l.validTermsPattern.test(n)&&c.isFunction(e[n])&&!c.contains(h,n)&&!c.contains(t,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+u.functionName(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+l.validTermsPattern.source+"/.",type:s.REDUNDANT_METHOD,methodName:n});return r}Object.defineProperty(t,"__esModule",{value:!0});var s,c=r(0),u=r(4),l=r(11);t.defaultVisit=n,t.createBaseSemanticVisitorConstructor=function(e,t){var r=function(){};return u.defineNameProp(r,e+"BaseSemantics"),(r.prototype={visit:function(e,t){if(c.isArray(e)&&(e=e[0]),!c.isUndefined(e))return void 0===e.fullName?this[e.name](e.children,t):this[e.fullName](e.children,t)},validateVisitor:function(){var e=i(this,t);if(!c.isEmpty(e)){var r=c.map(e,function(e){return e.msg});throw Error("Errors Detected in CST Visitor <"+u.functionName(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=r,r._RULE_NAMES=t,r},t.createBaseVisitorConstructorWithDefaults=function(e,t,r){var i=function(){};u.defineNameProp(i,e+"BaseSemanticsWithDefaults");var a=Object.create(r.prototype);return c.forEach(t,function(e){a[e]=n}),(i.prototype=a).constructor=i,i},function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(s=t.CstVisitorDefinitionError||(t.CstVisitorDefinitionError={})),t.validateVisitor=i,t.validateMissingCstMethods=a;var h=["constructor","visit","validateVisitor"];t.validateRedundantMethods=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},e.prototype.LA=function(e){return 0>this.currIdx+e||this.tokVectorLength<=this.currIdx+e?n.END_OF_FILE:this.tokVector[this.currIdx+e]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}();t.LexerAdapter=i},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),a=r(3),o=r(10),s=r(23),c=r(11),u=r(1),l=function(){function e(){}return e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=a.DEFAULT_RULE_CONFIG),n.contains(this.definedRulesNames,e)){var i={message:o.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(i)}if(this.definedRulesNames.push(e),!this.gastProductionsCache.containsKey(e)&&!this.serializedGrammar){var c=s.buildTopProduction(t.toString(),e,this.tokensMap);this.gastProductionsCache.put(e,c)}var u=this.defineRule(e,t,r);return this[e]=u,u},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=a.DEFAULT_RULE_CONFIG);var n=[];if(n=n.concat(c.validateRuleIsOverridden(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n),!this.serializedGrammar){var i=s.buildTopProduction(t.toString(),e,this.tokensMap);this.gastProductionsCache.put(e,i)}var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(r){if(i.isRecognitionException(r))return!1;throw r}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return u.serializeGrammar(this.gastProductionsCache.values())},e}();t.RecognizerApi=l},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(9),a=r(6),o=r(12),s=r(13),c=r(3),u=r(25),l=r(2),h=r(7),p=r(4),d=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=p.classNameFromInstance(this),this.shortRuleNameToFull=new p.HashTable,this.fullRuleNameToShort=new p.HashTable,this.ruleShortNameIdx=256,this.tokenMatcher=h.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache=new p.HashTable,this.serializedGrammar=n.has(t,"serializedGrammar")?t.serializedGrammar:c.DEFAULT_PARSER_CONFIG.serializedGrammar,n.isArray(e)){if(n.isEmpty(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(n.isArray(e))this.tokensMap=n.reduce(e,function(e,t){return e[l.tokenName(t)]=t,e},{});else if(n.has(e,"modes")&&n.every(n.flatten(n.values(e.modes)),h.isTokenType)){var r=n.flatten(n.values(e.modes)),i=n.uniq(r);this.tokensMap=n.reduce(i,function(e,t){return e[l.tokenName(t)]=t,e},{})}else{if(!n.isObject(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=n.cloneObj(e)}this.tokensMap.EOF=l.EOF;var a=n.every(n.values(e),function(e){return n.isEmpty(e.categoryMatches)});this.tokenMatcher=a?h.tokenStructuredMatcherNoCategories:h.tokenStructuredMatcher,h.augmentTokenTypes(n.values(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var o,s=n.has(r,"resyncEnabled")?r.resyncEnabled:c.DEFAULT_RULE_CONFIG.resyncEnabled,u=n.has(r,"recoveryValueFunc")?r.recoveryValueFunc:c.DEFAULT_RULE_CONFIG.recoveryValueFunc,l=this.ruleShortNameIdx<<i.BITS_FOR_METHOD_IDX+i.BITS_FOR_OCCURRENCE_IDX;return this.ruleShortNameIdx++,this.shortRuleNameToFull.put(l,e),this.fullRuleNameToShort.put(e,l),(o=function(r,n){return void 0===r&&(r=0),this.ruleInvocationStateUpdate(l,e,r),function(e){try{return!0===this.outputCst?(t.apply(this,e),this.CST_STACK[this.CST_STACK.length-1]):t.apply(this,e)}catch(e){var r=1===this.RULE_STACK.length,n=s&&!this.isBackTracking()&&this.recoveryEnabled;if(a.isRecognitionException(e)){if(n){var i,o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))return e.resyncedTokens=this.reSyncTo(o),this.outputCst?((i=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i):u();throw this.outputCst&&((i=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,e.partialCstResult=i),e}if(r)return this.moveToTerminatedState(),u();throw e}throw e}finally{this.ruleFinallyStateUpdate()}}.call(this,n)}).ruleName=e,o},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,i,a=this,o=this.getLookaheadFuncForOption(r,t);if(void 0===e.DEF)n=e;else if(n=e.DEF,void 0!==(i=e.GATE)){var s=o;o=function(){return i.call(a)&&s.call(a)}}return!0===o.call(this)?n.call(this):void 0},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,c=this,u=this.getLookaheadFuncForAtLeastOne(r,e);if(void 0===t.DEF)n=t;else if(n=t.DEF,void 0!==(a=t.GATE)){var l=u;u=function(){return a.call(c)&&l.call(c)}}if(!0!==u.call(this))throw this.raiseEarlyExitException(e,o.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var h=this.doSingleRepetition(n);!0===u.call(this)&&!0===h;)h=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],u,i.AT_LEAST_ONE_IDX,e,s.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,c=t.SEP;if(!0!==this.getLookaheadFuncForAtLeastOneSep(r,e).call(this))throw this.raiseEarlyExitException(e,o.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);a.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),c)};!0===this.tokenMatcher(this.LA(1),c);)this.CONSUME(c),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,c,u,a,s.NextTerminalAfterAtLeastOneSepWalker],u,i.AT_LEAST_ONE_SEP_IDX,e,s.NextTerminalAfterAtLeastOneSepWalker)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,a,o=this,c=this.getLookaheadFuncForMany(r,e);if(void 0===t.DEF)n=t;else if(n=t.DEF,void 0!==(a=t.GATE)){var u=c;c=function(){return a.call(o)&&u.call(o)}}for(var l=!0;!0===c.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],c,i.MANY_IDX,e,s.NextTerminalAfterManyWalker)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,o=t.SEP;if(!0===this.getLookaheadFuncForManySep(r,e).call(this)){a.call(this);for(var c=function(){return n.tokenMatcher(n.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,c,a,s.NextTerminalAfterManySepWalker],c,i.MANY_SEP_IDX,e,s.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,a){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,a],r,i.AT_LEAST_ONE_SEP_IDX,e,a)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=n.isArray(e)?e:e.DEF,i=this.getLookaheadFuncForOr(t,r).call(this,r);return void 0===i?void this.raiseNoAltException(t,e.ERR_MSG):r[i].ALT.call(this)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OR_IDX,t),a=this.nestedRuleBeforeClause(e,r);try{var o=n.isArray(e)?e:e.DEF,s=this.getLookaheadFuncForOr(t,o).call(this,o);if(void 0!==s){var c=o[s],u=this.nestedAltBeforeClause(c,t,i.OR_IDX,s);try{return c.ALT.call(this)}finally{void 0!==u&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==a&&this.nestedRuleFinallyClause(r,a)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new a.NotAllInputParsedException(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var i=void 0===r?void 0:r.ARGS;return n=e.call(this,t,i),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){throw a.isRecognitionException(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),delete t.partialCstResult),t}},e.prototype.consumeInternal=function(e,t,r){var n;try{var i=this.LA(1);if(!0!==this.tokenMatcher(i,e)){var o,s=this.LA(0);throw o=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:i,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new a.MismatchedTokenException(o,i,s))}this.consumeToken(),n=i}catch(r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var c=this.getFollowsForInRuleRecovery(e,t);try{n=this.tryInRuleRecovery(e,c)}catch(i){throw i.name===u.IN_RULE_RECOVERY_EXCEPTION?r:i}}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.tokenName,n),n},e.prototype.saveRecogState=function(){var e=this.errors,t=n.cloneArr(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return!n.isEmpty(this.isBackTrackingStack)},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull.get(e)},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull.get(e)},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),l.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}();t.RecognizerEngine=d},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(0),a=r(12),o=r(3),s=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=i.defaults(e.errorMessageProvider,o.DEFAULT_PARSER_CONFIG.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(n.isRecognitionException(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:i.cloneArr(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return i.cloneArr(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),o=this.getGAstProductions().get(i),s=a.getLookaheadPathsForOptionalProd(e,o,t,this.maxLookahead)[0],c=[],u=1;u<this.maxLookahead;u++)c.push(this.LA(u));var l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:s,actual:c,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new n.EarlyExitException(l,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions().get(r),o=a.getLookaheadPathsForOr(e,i,this.maxLookahead),s=[],c=1;c<=this.maxLookahead;c++)s.push(this.LA(c));var u=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:s,previous:u,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n.NoViableAltException(l,this.LA(1),u))},e}();t.ErrorHandler=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(13),i=r(0),a=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache.get(e);if(i.isUndefined(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return n.nextPossibleTokensAfter([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=i.first(e.ruleStack),r=this.getGAstProductions().get(t);return new n.NextAfterTokenWalker(r,e).startWalking()},e}();t.ContentAssist=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(17);t.createSyntaxDiagramsCode=function(e,t){var r=void 0===t?{}:t,i=r.resourceBase,a=void 0===i?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":i,o=r.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===o?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":o)+"'>\n\n<script src='"+a+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+a+"src/diagrams_builder.js'><\/script>\n<script src='"+a+"src/diagrams_behavior.js'><\/script>\n<script src='"+a+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(41);t.generateParserFactory=function(e){var t=n.genWrapperFunction({name:e.name,rules:e.rules}),i=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return i(e.tokenVocabulary,t,r(18))}},t.generateParserModule=function(e){return n.genUmdModule({name:e.name,rules:e.rules})}},function(e,t,r){function n(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+i(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function i(e){return f.map(e,function(e){return a(e,1)}).join("\n")}function a(e,t){var r=d(t,'$.RULE("'+e.name+'", function() {')+v;return(r+=p(e.definition,t+1))+(d(t+1,"})")+v)}function o(e,t){var r=m.tokenName(e.terminalType);return d(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+v)}function s(e,t){return d(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+v)}function c(e,t){var r=d(t,"$.OR"+e.idx+"([")+v;return(r+=f.map(e.definition,function(e){return u(e,t+1)}).join(","+v))+(v+d(t,"])"+v))}function u(e,t){var r=d(t,"{")+v;return e.name&&(r+=d(t+1,'NAME: "'+e.name+'",')+v),r+=d(t+1,"ALT: function() {")+v,r+=p(e.definition,t+1),(r+=d(t+1,"}")+v)+d(t,"}")}function l(e,t,r){var n=d(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{"+v,t.name&&(n+=d(r+1,'NAME: "'+t.name+'"')+","+v),t.separator&&(n+=d(r+1,"SEP: this.tokensMap."+m.tokenName(t.separator))+","+v),n+="DEF: "+h(t.definition,r+2)+v,n+=d(r,"}")+v):n+=h(t.definition,r+1),n+(d(r,")")+v)}function h(e,t){var r="function() {"+v;return(r+=p(e,t))+(d(t,"}")+v)}function p(e,t){var r="";return f.forEach(e,function(e){r+=function(e,t){if(e instanceof g.NonTerminal)return s(e,t);if(e instanceof g.Option)return l("OPTION",e,t);if(e instanceof g.RepetitionMandatory)return l("AT_LEAST_ONE",e,t);if(e instanceof g.RepetitionMandatoryWithSeparator)return l("AT_LEAST_ONE_SEP",e,t);if(e instanceof g.RepetitionWithSeparator)return l("MANY_SEP",e,t);if(e instanceof g.Repetition)return l("MANY",e,t);if(e instanceof g.Alternation)return c(e,t);if(e instanceof g.Terminal)return o(e,t);if(e instanceof g.Flat)return p(e.definition,t);throw Error("non exhaustive match")}(e,t+1)}),r}function d(e,t){return Array(4*e+1).join(" ")+t}Object.defineProperty(t,"__esModule",{value:!0});var f=r(0),m=r(2),g=r(1),v="\n";t.genUmdModule=function(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+n(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"},t.genWrapperFunction=function(e){return"    \n"+n(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"},t.genClass=n,t.genAllRules=i,t.genRule=a,t.genTerminal=o,t.genNonTerminal=s,t.genAlternation=c,t.genSingleAlt=u}])});var n=window.chevrotain}).call(this,r(30)(e))},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(0),i=r(3),a=function(e){this.manager=void 0===e?n.D:e};a.prototype={constructor:a,crossOrigin:"anonymous",load:function(e,t,r,i){var a=this,o=void 0===a.path?n.ob.extractUrlBase(e):a.path,s=new n.L(a.manager);s.setPath(a.path),s.load(e,function(e){t(a.parse(e,o))},r,i)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r,n=[],i=e.childNodes,a=0,o=i.length;a<o;a++)(r=i[a]).nodeName===t&&n.push(r);return n}function a(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=Array(t.length),n=0,i=t.length;n<i;n++)r[n]=t[n];return r}function o(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseFloat(t[n]);return r}function s(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=Array(t.length),n=0,i=t.length;n<i;n++)r[n]=parseInt(t[n]);return r}function c(e){return e.substring(1)}function u(e){return 0===Object.keys(e).length}function l(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function h(e){return void 0===e?"Y_UP":e.textContent}function p(e,t,n,i){var a=r(e,t)[0];if(void 0!==a)for(var o=r(a,n),s=0;s<o.length;s++)i(o[s])}function d(e,t){for(var r in e){e[r].build=t(e[r])}}function f(e,t){return void 0===e.build?(e.build=t(e),e.build):e.build}function m(e){for(var t,r={inputs:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"input":var a=c(t.getAttribute("source")),o=t.getAttribute("semantic");r.inputs[o]=a}return r}function g(e){var t={},r=e.getAttribute("target").split("/"),n=r.shift(),i=r.shift(),a=-1!==i.indexOf("("),o=-1!==i.indexOf(".");if(o)r=i.split("."),i=r.shift(),t.member=r.shift();else if(a){var s=i.split("(");i=s.shift();for(var u=0;u<s.length;u++)s[u]=parseInt(s[u].replace(/\)/,""));t.indices=s}return t.id=n,t.sid=i,t.arraySyntax=a,t.memberSyntax=o,t.sampler=c(e.getAttribute("source")),t}function v(e){var t=[],r=e.channels,n=e.samplers,i=e.sources;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a],s=n[o.sampler],c=s.inputs.INPUT,u=s.inputs.OUTPUT;x(b(o,i[c],i[u]),t)}return t}function y(e){return f(rt.animations[e],v)}function b(e,t,r){var n,i,a,o,s,c,u=rt.nodes[e.id],l=Pe(u.id),h=u.transforms[e.sid],p=u.matrix.clone().transpose(),d={};switch(h){case"matrix":for(a=0,o=t.array.length;a<o;a++)if(n=t.array[a],i=a*r.stride,void 0===d[n]&&(d[n]={}),!0===e.arraySyntax){var f=r.array[i],m=e.indices[0]+4*e.indices[1];d[n][m]=f}else for(s=0,c=r.stride;s<c;s++)d[n][s]=r.array[i+s];break;case"translate":case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',h);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var g=function(e,t){var r=[];for(var n in e)r.push({time:parseFloat(n),value:e[n]});r.sort(function(e,t){return e.time-t.time});for(var i=0;16>i;i++)w(r,i,t.elements[i]);return r}(d,p);return{name:l.uuid,keyframes:g}}function x(e,t){for(var r=e.keyframes,i=e.name,a=[],o=[],s=[],c=[],u=0,l=r.length;u<l;u++){var h=r[u],p=h.time,d=h.value;Ge.fromArray(d).transpose(),Ge.decompose(Ue,ze,Be),a.push(p),o.push(Ue.x,Ue.y,Ue.z),s.push(ze.x,ze.y,ze.z,ze.w),c.push(Be.x,Be.y,Be.z)}return 0<o.length&&t.push(new n.Lc(i+".position",a,o)),0<s.length&&t.push(new n.Wb(i+".quaternion",a,s)),0<c.length&&t.push(new n.Lc(i+".scale",a,c)),t}function w(e,t,r){var n,i,a,o=!0;for(i=0,a=e.length;i<a;i++)void 0===(n=e[i]).value[t]?n.value[t]=null:o=!1;if(1==o)for(i=0,a=e.length;i<a;i++)(n=e[i]).value[t]=r;else!function(e,t){for(var r,n,i,a=0,o=e.length;a<o;a++)if(null===(i=e[a]).value[t]){if(r=_(e,a,t),n=T(e,a,t),null===r){i.value[t]=n.value[t];continue}if(null===n){i.value[t]=r.value[t];continue}E(i,r,n,t)}}(e,t)}function _(e,t,r){for(;0<=t;){var n=e[t];if(null!==n.value[r])return n;t--}return null}function T(e,t,r){for(;t<e.length;){var n=e[t];if(null!==n.value[r])return n;t++}return null}function E(e,t,r,n){return 0==r.time-t.time?void(e.value[n]=t.value[n]):void(e.value[n]=(e.time-t.time)*(r.value[n]-t.value[n])/(r.time-t.time)+t.value[n])}function A(e){for(var t,r=[],i=e.name,a=e.end-e.start||-1,o=e.animations,s=0,c=o.length;s<c;s++)for(var u=0,l=(t=y(o[s])).length;u<l;u++)r.push(t[u]);return new n.d(i,a,r)}function S(e){return f(rt.clips[e],A)}function M(e){for(var t,r={sources:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"bind_shape_matrix":r.bindShapeMatrix=o(t.textContent);break;case"source":var a=t.getAttribute("id");r.sources[a]=ie(t);break;case"joints":r.joints=L(t);break;case"vertex_weights":r.vertexWeights=N(t)}return r}function L(e){for(var t,r={inputs:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"input":var a=t.getAttribute("semantic"),o=c(t.getAttribute("source"));r.inputs[a]=o}return r}function N(e){for(var t,r={inputs:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"input":var a=t.getAttribute("semantic"),o=c(t.getAttribute("source")),u=parseInt(t.getAttribute("offset"));r.inputs[a]={id:o,offset:u};break;case"vcount":r.vcount=s(t.textContent);break;case"v":r.v=s(t.textContent)}return r}function R(e){var t={id:e.id},r=rt.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){function t(e,t){return t.weight-e.weight}var r,i,a,o={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},s=e.sources,c=e.vertexWeights,u=c.vcount,l=c.v,h=c.inputs.JOINT.offset,p=c.inputs.WEIGHT.offset,d=e.sources[e.joints.inputs.JOINT],f=e.sources[e.joints.inputs.INV_BIND_MATRIX],m=s[c.inputs.WEIGHT.id].array,g=0;for(r=0,a=u.length;r<a;r++){var v=u[r],y=[];for(i=0;i<v;i++){var b=l[g+h],x=l[g+p],w=m[x];y.push({index:b,weight:w}),g+=2}for(y.sort(t),i=0;i<4;i++){var _=y[i];void 0===_?(o.indices.array.push(0),o.weights.array.push(0)):(o.indices.array.push(_.index),o.weights.array.push(_.weight))}}for(o.bindMatrix=e.bindShapeMatrix?(new n.ub).fromArray(e.bindShapeMatrix).transpose():(new n.ub).identity(),r=0,a=d.array.length;r<a;r++){var T=d.array[r],E=(new n.ub).fromArray(f.array,r*f.stride).transpose();o.joints.push({name:T,boneInverse:E})}return o}(e.skin),r.sources.skinIndices=t.skin.indices,r.sources.skinWeights=t.skin.weights),t}function C(e){return f(rt.controllers[e],R)}function I(e){return void 0===e.build?e.init_from:e.build}function O(e){var t=rt.images[e];return void 0===t?(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null):f(t,I)}function P(e){for(var t,r={surfaces:{},samplers:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"newparam":F(t,r);break;case"technique":r.technique=U(t);break;case"extra":r.extra=H(t)}return r}function F(e,t){for(var r,n=e.getAttribute("sid"),i=0,a=e.childNodes.length;i<a;i++)if(1===(r=e.childNodes[i]).nodeType)switch(r.nodeName){case"surface":t.surfaces[n]=k(r);break;case"sampler2D":t.samplers[n]=D(r)}}function k(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"init_from":r.init_from=t.textContent}return r}function D(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"source":r.source=t.textContent}return r}function U(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"constant":case"lambert":case"blinn":case"phong":r.type=t.nodeName,r.parameters=B(t)}return r}function B(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":r[t.nodeName]=z(t);break;case"transparent":r[t.nodeName]={opaque:t.getAttribute("opaque"),data:z(t)}}return r}function z(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"color":r[t.nodeName]=o(t.textContent);break;case"float":r[t.nodeName]=parseFloat(t.textContent);break;case"texture":r[t.nodeName]={id:t.getAttribute("texture"),extra:G(t)}}return r}function G(e){for(var t,r={technique:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"extra":j(t,r)}return r}function j(e,t){for(var r,n=0,i=e.childNodes.length;n<i;n++)if(1===(r=e.childNodes[n]).nodeType)switch(r.nodeName){case"technique":V(r,t)}}function V(e,t){for(var r,n=0,i=e.childNodes.length;n<i;n++)if(1===(r=e.childNodes[n]).nodeType)switch(r.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[r.nodeName]=parseFloat(r.textContent);break;case"wrapU":case"wrapV":t.technique[r.nodeName]="TRUE"===r.textContent.toUpperCase()?1:"FALSE"===r.textContent.toUpperCase()?0:parseInt(r.textContent)}}function H(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"technique":r.technique=W(t)}return r}function W(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"double_sided":r[t.nodeName]=parseInt(t.textContent)}return r}function J(e){return e}function X(e){function t(e){var t=i.profile.samplers[e.id],r=null;void 0!==t?r=O(i.profile.surfaces[t.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),r=O(e.id));if(null!==r){var a=function(e){var t=e.slice(2+(e.lastIndexOf(".")-1>>>0));return"tga"===(t=t.toLowerCase())?Ke:Qe}(r);if(void 0!==a){var o=a.load(r),s=e.extra;if(void 0!==s&&void 0!==s.technique&&!1===u(s.technique)){var c=s.technique;o.wrapS=c.wrapU?n.mc:n.n,o.wrapT=c.wrapV?n.mc:n.n,o.offset.set(c.offsetU||0,c.offsetV||0),o.repeat.set(c.repeatU||1,c.repeatV||1)}else o.wrapS=n.mc,o.wrapT=n.mc;return o}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",r),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}var r,i=function(e){return f(rt.effects[e],J)}(e.url),a=i.profile.technique,o=i.profile.extra;switch(a.type){case"phong":case"blinn":r=new n.yb;break;case"lambert":r=new n.xb;break;default:r=new n.wb}r.name=e.name||"";var s=a.parameters;for(var c in s){var l=s[c];"diffuse"==c?(l.color&&r.color.fromArray(l.color),l.texture&&(r.map=t(l.texture))):"specular"==c?(l.color&&r.specular&&r.specular.fromArray(l.color),l.texture&&(r.specularMap=t(l.texture))):"bump"==c?l.texture&&(r.normalMap=t(l.texture)):"ambient"==c?l.texture&&(r.lightMap=t(l.texture)):"shininess"==c?l.float&&r.shininess&&(r.shininess=l.float):"emission"==c&&(l.color&&r.emissive&&r.emissive.fromArray(l.color),l.texture&&(r.emissiveMap=t(l.texture)))}var h=s.transparent,p=s.transparency;if(void 0===p&&h&&(p={float:1}),void 0===h&&p&&(h={opaque:"A_ONE",data:{color:[1,1,1,1]}}),h&&p)if(h.data.texture)r.transparent=!0;else{var d=h.data.color;switch(h.opaque){case"A_ONE":r.opacity=d[3]*p.float;break;case"RGB_ZERO":r.opacity=1-d[0]*p.float;break;case"A_ZERO":r.opacity=1-d[3]*p.float;break;case"RGB_ONE":r.opacity=d[0]*p.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',h.opaque)}1>r.opacity&&(r.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(r.side=n.F),r}function Y(e){return f(rt.materials[e],X)}function q(e){for(var t,r=0;r<e.childNodes.length;r++)switch(t=e.childNodes[r],t.nodeName){case"technique_common":return K(t)}return{}}function K(e){for(var t,r={},n=0;n<e.childNodes.length;n++)switch(t=e.childNodes[n],t.nodeName){case"perspective":case"orthographic":r.technique=t.nodeName,r.parameters=Z(t)}return r}function Z(e){for(var t,r={},n=0;n<e.childNodes.length;n++)switch(t=e.childNodes[n],t.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":r[t.nodeName]=parseFloat(t.textContent)}return r}function Q(e){var t;switch(e.optics.technique){case"perspective":t=new n.Pb(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag,i=e.optics.parameters.xmag,a=e.optics.parameters.aspect_ratio;i=void 0===i?r*a:i,r=void 0===r?i/a:r,i*=.5,r*=.5,t=new n.Nb(-i,i,r,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new n.Pb}return t.name=e.name||"",t}function $(e){var t=rt.cameras[e];return void 0===t?(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null):f(t,Q)}function ee(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"directional":case"point":case"spot":case"ambient":r.technique=t.nodeName,r.parameters=te(t)}return r}function te(e){for(var t,r={},i=0,a=e.childNodes.length;i<a;i++)if(1===(t=e.childNodes[i]).nodeType)switch(t.nodeName){case"color":var s=o(t.textContent);r.color=(new n.o).fromArray(s);break;case"falloff_angle":r.falloffAngle=parseFloat(t.textContent);break;case"quadratic_attenuation":var c=parseFloat(t.textContent);r.distance=c?Math.sqrt(1/c):0}return r}function re(e){var t;switch(e.technique){case"directional":t=new n.E;break;case"point":t=new n.Rb;break;case"spot":t=new n.vc;break;case"ambient":t=new n.c}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function ne(e){var t=rt.lights[e];return void 0===t?(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null):f(t,re)}function ie(e){for(var t,n={array:[],stride:3},i=0;i<e.childNodes.length;i++)if(1===(t=e.childNodes[i]).nodeType)switch(t.nodeName){case"float_array":n.array=o(t.textContent);break;case"Name_array":n.array=a(t.textContent);break;case"technique_common":var s=r(t,"accessor")[0];void 0!==s&&(n.stride=parseInt(s.getAttribute("stride")))}return n}function ae(e){for(var t,r={},n=0;n<e.childNodes.length;n++)1===(t=e.childNodes[n]).nodeType&&(r[t.getAttribute("semantic")]=c(t.getAttribute("source")));return r}function oe(e){for(var t,r={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"input":var a=c(t.getAttribute("source")),o=t.getAttribute("semantic"),u=parseInt(t.getAttribute("offset")),l=parseInt(t.getAttribute("set")),h=0<l?o+l:o;r.inputs[h]={id:a,offset:u},r.stride=Math.max(r.stride,u+1),"TEXCOORD"===o&&(r.hasUV=!0);break;case"vcount":r.vcount=s(t.textContent);break;case"p":r.p=s(t.textContent)}return r}function se(e){for(var t=0,r=0,n=e.length;r<n;r++)!0===e[r].hasUV&&t++;0<t&&t<e.length&&(e.uvsNeedsFix=!0)}function ce(e){var t={},r=e.sources,n=e.vertices,i=e.primitives;if(0===i.length)return{};var a=function(e){for(var t,r={},n=0;n<e.length;n++)void 0===r[(t=e[n]).type]&&(r[t.type]=[]),r[t.type].push(t);return r}(i);for(var o in a){var s=a[o];se(s),t[o]=ue(s,r,n)}return t}function ue(e,t,r){for(var i={},a={array:[],stride:0},o={array:[],stride:0},s={array:[],stride:0},c={array:[],stride:0},u={array:[],stride:0},l={array:[],stride:4},h={array:[],stride:4},p=new n.l,d=[],f=0,m=0;m<e.length;m++){var g=e[m],v=g.inputs,y=0;switch(g.type){case"lines":case"linestrips":y=2*g.count;break;case"triangles":y=3*g.count;break;case"polylist":for(var b,x=0;x<g.count;x++)switch(b=g.vcount[x],b){case 3:y+=3;break;case 4:y+=6;break;default:y+=3*(b-2)}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",g.type)}for(var w in p.addGroup(f,y,m),f+=y,g.material&&d.push(g.material),v){var _=v[w];switch(w){case"VERTEX":for(var T in r){var E=r[T];switch(T){case"POSITION":var A=a.array.length;if(le(g,t[E],_.offset,a.array),a.stride=t[E].stride,t.skinWeights&&t.skinIndices&&(le(g,t.skinIndices,_.offset,l.array),le(g,t.skinWeights,_.offset,h.array)),!1===g.hasUV&&!0===e.uvsNeedsFix){y=(a.array.length-A)/a.stride;for(var S=0;S<y;S++)s.array.push(0,0)}break;case"NORMAL":le(g,t[E],_.offset,o.array),o.stride=t[E].stride;break;case"COLOR":le(g,t[E],_.offset,u.array),u.stride=t[E].stride;break;case"TEXCOORD":le(g,t[E],_.offset,s.array),s.stride=t[E].stride;break;case"TEXCOORD1":le(g,t[E],_.offset,c.array),s.stride=t[E].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',T)}}break;case"NORMAL":le(g,t[_.id],_.offset,o.array),o.stride=t[_.id].stride;break;case"COLOR":le(g,t[_.id],_.offset,u.array),u.stride=t[_.id].stride;break;case"TEXCOORD":le(g,t[_.id],_.offset,s.array),s.stride=t[_.id].stride;break;case"TEXCOORD1":le(g,t[_.id],_.offset,c.array),c.stride=t[_.id].stride}}}return 0<a.array.length&&p.addAttribute("position",new n.M(a.array,a.stride)),0<o.array.length&&p.addAttribute("normal",new n.M(o.array,o.stride)),0<u.array.length&&p.addAttribute("color",new n.M(u.array,u.stride)),0<s.array.length&&p.addAttribute("uv",new n.M(s.array,s.stride)),0<c.array.length&&p.addAttribute("uv2",new n.M(c.array,c.stride)),0<l.array.length&&p.addAttribute("skinIndex",new n.M(l.array,l.stride)),0<h.array.length&&p.addAttribute("skinWeight",new n.M(h.array,h.stride)),i.data=p,i.type=e[0].type,i.materialKeys=d,i}function le(e,t,r,n){function i(e){for(var t=a[e+r]*u,i=t+u;t<i;t++)n.push(c[t])}var a=e.p,o=e.stride,s=e.vcount,c=t.array,u=t.stride;if(void 0!==e.vcount)for(var l,h=0,p=0,d=s.length;p<d;p++){if(4===(l=s[p])){var f=h+1*o,m=h+2*o,g=h+3*o;i(h+0*o),i(f),i(g),i(f),i(m),i(g)}else if(3===l){f=h+1*o,m=h+2*o;i(h+0*o),i(f),i(m)}else if(4<l)for(var v=1,y=l-2;v<=y;v++){f=h+o*v,m=h+o*(v+1);i(h+0*o),i(f),i(m)}h+=o*l}else for(p=0,d=a.length;p<d;p+=o)i(p)}function he(e){return f(rt.geometries[e],ce)}function pe(e){return void 0===e.build?e:e.build}function de(e){return f(rt.kinematicsModels[e],pe)}function fe(e,t){for(var r,n=0;n<e.childNodes.length;n++)if(1===(r=e.childNodes[n]).nodeType)switch(r.nodeName){case"joint":t.joints[r.getAttribute("sid")]=me(r);break;case"link":t.links.push(ve(r))}}function me(e){for(var t,r,n=0;n<e.childNodes.length;n++)if(1===(r=e.childNodes[n]).nodeType)switch(r.nodeName){case"prismatic":case"revolute":t=ge(r)}return t}function ge(e,t){t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new n.Jc,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var r,i=0;i<e.childNodes.length;i++)if(1===(r=e.childNodes[i]).nodeType)switch(r.nodeName){case"axis":var a=o(r.textContent);t.axis.fromArray(a);break;case"limits":var s=r.getElementsByTagName("max")[0],c=r.getElementsByTagName("min")[0];t.limits.max=parseFloat(s.textContent),t.limits.min=parseFloat(c.textContent)}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function ve(e){for(var t,r={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},n=0;n<e.childNodes.length;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"attachment_full":r.attachments.push(ye(t));break;case"matrix":case"translate":case"rotate":r.transforms.push(be(t))}return r}function ye(e){for(var t,r={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},n=0;n<e.childNodes.length;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"link":r.links.push(ve(t));break;case"matrix":case"translate":case"rotate":r.transforms.push(be(t))}return r}function be(e){var t={type:e.nodeName},r=o(e.textContent);switch(t.type){case"matrix":t.obj=new n.ub,t.obj.fromArray(r).transpose();break;case"translate":t.obj=new n.Jc,t.obj.fromArray(r);break;case"rotate":t.obj=new n.Jc,t.obj.fromArray(r),t.angle=n.sb.degToRad(r[3])}return t}function xe(e,t){for(var r,n=0;n<e.childNodes.length;n++)if(1===(r=e.childNodes[n]).nodeType)switch(r.nodeName){case"technique_common":we(r,t)}}function we(e,t){for(var r,n=0;n<e.childNodes.length;n++)if(1===(r=e.childNodes[n]).nodeType)switch(r.nodeName){case"inertia":t.inertia=o(r.textContent);break;case"mass":t.mass=o(r.textContent)[0]}}function _e(e){for(var t,r={target:e.getAttribute("target").split("/").pop()},n=0;n<e.childNodes.length;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"axis":var i=t.getElementsByTagName("param")[0];r.axis=i.textContent;var a=r.axis.split("inst_").pop().split("axis")[0];r.jointIndex=a.substr(0,a.length-1)}return r}function Te(e){return void 0===e.build?e:e.build}function Ee(e){return f(rt.kinematicsScenes[e],Te)}function Ae(e){for(var t,r=[],i=We.querySelector('[id="'+e.id+'"]'),a=0;a<i.childNodes.length;a++)if(1===(t=i.childNodes[a]).nodeType)switch(t.nodeName){case"matrix":var s=o(t.textContent),c=(new n.ub).fromArray(s).transpose();r.push({sid:t.getAttribute("sid"),type:t.nodeName,obj:c});break;case"translate":case"scale":s=o(t.textContent);var u=(new n.Jc).fromArray(s);r.push({sid:t.getAttribute("sid"),type:t.nodeName,obj:u});break;case"rotate":s=o(t.textContent),u=(new n.Jc).fromArray(s);var l=n.sb.degToRad(s[3]);r.push({sid:t.getAttribute("sid"),type:t.nodeName,obj:u,angle:l})}return r}function Se(e){for(var t,r={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new n.ub,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},i=0;i<e.childNodes.length;i++)if(1===(t=e.childNodes[i]).nodeType)switch(t.nodeName){case"node":r.nodes.push(t.getAttribute("id")),Se(t);break;case"instance_camera":r.instanceCameras.push(c(t.getAttribute("url")));break;case"instance_controller":r.instanceControllers.push(Me(t));break;case"instance_light":r.instanceLights.push(c(t.getAttribute("url")));break;case"instance_geometry":r.instanceGeometries.push(Me(t));break;case"instance_node":r.instanceNodes.push(c(t.getAttribute("url")));break;case"matrix":var a=o(t.textContent);r.matrix.multiply(Ge.fromArray(a).transpose()),r.transforms[t.getAttribute("sid")]=t.nodeName;break;case"translate":a=o(t.textContent);je.fromArray(a),r.matrix.multiply(Ge.makeTranslation(je.x,je.y,je.z)),r.transforms[t.getAttribute("sid")]=t.nodeName;break;case"rotate":a=o(t.textContent);var s=n.sb.degToRad(a[3]);r.matrix.multiply(Ge.makeRotationAxis(je.fromArray(a),s)),r.transforms[t.getAttribute("sid")]=t.nodeName;break;case"scale":a=o(t.textContent);r.matrix.scale(je.fromArray(a)),r.transforms[t.getAttribute("sid")]=t.nodeName;break;case"extra":break;default:console.log(t)}return Oe(r.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",r.id):rt.nodes[r.id]=r,r}function Me(e){for(var t,r={id:c(e.getAttribute("url")),materials:{},skeletons:[]},n=0;n<e.childNodes.length;n++)switch(t=e.childNodes[n],t.nodeName){case"bind_material":for(var i=t.getElementsByTagName("instance_material"),a=0;a<i.length;a++){var o=i[a],s=o.getAttribute("symbol"),u=o.getAttribute("target");r.materials[s]=c(u)}break;case"skeleton":r.skeletons.push(c(t.textContent))}return r}function Le(e,t){var r,i,a=[],o=[];for(r=0;r<e.length;r++){var s=e[r];if(Oe(s))Ne(Pe(s),t,a);else if(ke(s)){for(var c,u=rt.visualScenes[s].children,l=0;l<u.length;l++)if("JOINT"===(c=u[l]).type){Ne(Pe(c.id),t,a)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",s)}for(r=0;r<t.length;r++)for(l=0;l<a.length;l++)if((i=a[l]).bone.name===t[r].name){o[r]=i,i.processed=!0;break}for(r=0;r<a.length;r++)!1===(i=a[r]).processed&&(o.push(i),i.processed=!0);var h=[],p=[];for(r=0;r<o.length;r++)i=o[r],h.push(i.bone),p.push(i.boneInverse);return new n.rc(h,p)}function Ne(e,t,r){e.traverse(function(e){if(!0===e.isBone){for(var i,a,o=0;o<t.length;o++)if((a=t[o]).name===e.name){i=a.boneInverse;break}void 0===i&&(i=new n.ub),r.push({bone:e,boneInverse:i,processed:!1})}})}function Re(e){for(var t=[],r=e.matrix,i=e.nodes,a=e.type,o=e.instanceCameras,s=e.instanceControllers,c=e.instanceLights,u=e.instanceGeometries,l=e.instanceNodes,h=0,p=i.length;h<p;h++)t.push(Pe(i[h]));var d;for(h=0,p=o.length;h<p;h++)null!==(d=$(o[h]))&&t.push(d.clone());for(h=0,p=s.length;h<p;h++)for(var f=C((x=s[h]).id),m=Ie(he(f.id),x.materials),g=Le(x.skeletons,f.skin.joints),v=0,y=m.length;v<y;v++)(w=m[v]).isSkinnedMesh&&(w.bind(g,f.skin.bindMatrix),w.normalizeSkinWeights()),t.push(w);var b;for(h=0,p=c.length;h<p;h++)null!==(b=ne(c[h]))&&t.push(b.clone());for(h=0,p=u.length;h<p;h++){var x;for(v=0,y=(m=Ie(he((x=u[h]).id),x.materials)).length;v<y;v++)t.push(m[v])}for(h=0,p=l.length;h<p;h++)t.push(Pe(l[h]).clone());var w;if(0===i.length&&1===t.length)w=t[0];else{w="JOINT"===a?new n.i:new n.R;for(h=0;h<t.length;h++)w.add(t[h])}return""===w.name&&(w.name="JOINT"===a?e.sid:e.name),w.matrix.copy(r),w.matrix.decompose(w.position,w.quaternion,w.scale),w}function Ce(e,t){for(var r,n=[],i=0,a=e.length;i<a;i++)void 0===(r=t[e[i]])?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[i]),n.push(Ve)):n.push(Y(r));return n}function Ie(e,t){var r=[];for(var i in e){var a=e[i],o=Ce(a.materialKeys,t);0===o.length&&("lines"==i||"linestrips"==i?o.push(new n.gb):o.push(new n.yb));var s=void 0!==a.data.attributes.skinIndex;if(s)for(var c=0,u=o.length;c<u;c++)o[c].skinning=!0;var l,h=1===o.length?o[0]:o;"lines"==i?l=new n.ib(a.data,h):"linestrips"==i?l=new n.fb(a.data,h):("triangles"==i||"polylist"==i)&&(l=s?new n.sc(a.data,h):new n.vb(a.data,h)),r.push(l)}return r}function Oe(e){return void 0!==rt.nodes[e]}function Pe(e){return f(rt.nodes[e],Re)}function Fe(e){var t=new n.R;t.name=e.name;for(var r,i=e.children,a=0;a<i.length;a++)r=i[a],t.add(Pe(r.id));return t}function ke(e){return void 0!==rt.visualScenes[e]}function De(e){return f(rt.visualScenes[e],Fe)}var Ue=new n.Jc,Be=new n.Jc,ze=new n.Vb,Ge=new n.ub,je=new n.Jc,Ve=new n.wb({color:16711935});if(0===e.length)return{scene:new n.nc};var He=(new DOMParser).parseFromString(e,"application/xml"),We=r(He,"COLLADA")[0],Je=He.getElementsByTagName("parsererror")[0];if(void 0!==Je){var Xe,Ye=r(Je,"div")[0];return Xe=Ye?Ye.textContent:function(e){for(var t,r="",n=[e];n.length;)(t=n.shift()).nodeType===Node.TEXT_NODE?r+=t.textContent:(r+="\n",n.push.apply(n,t.childNodes));return r.trim()}(Je),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",Xe),null}var qe=We.getAttribute("version");console.log("THREE.ColladaLoader: File version",qe);var Ke,Ze=function(e){return{unit:l(r(e,"unit")[0]),upAxis:h(r(e,"up_axis")[0])}}(r(We,"asset")[0]),Qe=new n.yc(this.manager);Qe.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),i.a&&(Ke=new i.a(this.manager)).setPath(this.resourcePath||t);var $e=[],et={},tt=0,rt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};p(We,"library_animations","animation",function(e){for(var t,r={sources:{},samplers:{},channels:{}},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType){var a;switch(t.nodeName){case"source":a=t.getAttribute("id"),r.sources[a]=ie(t);break;case"sampler":a=t.getAttribute("id"),r.samplers[a]=m(t);break;case"channel":a=t.getAttribute("target"),r.channels[a]=g(t);break;default:console.log(t)}}rt.animations[e.getAttribute("id")]=r}),p(We,"library_animation_clips","animation_clip",function(e){for(var t,r={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"instance_animation":r.animations.push(c(t.getAttribute("url")))}rt.clips[e.getAttribute("id")]=r}),p(We,"library_controllers","controller",function(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"skin":r.id=c(t.getAttribute("source")),r.skin=M(t);break;case"morph":r.id=c(t.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}rt.controllers[e.getAttribute("id")]=r}),p(We,"library_images","image",function(e){var t={init_from:r(e,"init_from")[0].textContent};rt.images[e.getAttribute("id")]=t}),p(We,"library_effects","effect",function(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"profile_COMMON":r.profile=P(t)}rt.effects[e.getAttribute("id")]=r}),p(We,"library_materials","material",function(e){for(var t,r={name:e.getAttribute("name")},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"instance_effect":r.url=c(t.getAttribute("url"))}rt.materials[e.getAttribute("id")]=r}),p(We,"library_cameras","camera",function(e){for(var t,r={name:e.getAttribute("name")},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"optics":r.optics=q(t)}rt.cameras[e.getAttribute("id")]=r}),p(We,"library_lights","light",function(e){for(var t,r={},n=0,i=e.childNodes.length;n<i;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"technique_common":r=ee(t)}rt.lights[e.getAttribute("id")]=r}),p(We,"library_geometries","geometry",function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},n=r(e,"mesh")[0];if(void 0!==n){for(var i,a=0;a<n.childNodes.length;a++)if(1===(i=n.childNodes[a]).nodeType){var o=i.getAttribute("id");switch(i.nodeName){case"source":t.sources[o]=ie(i);break;case"vertices":t.vertices=ae(i);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",i.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(oe(i));break;default:console.log(i)}}rt.geometries[e.getAttribute("id")]=t}}),p(We,"library_nodes","node",Se),p(We,"library_visual_scenes","visual_scene",function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t,r=e.getElementsByTagName("node"),n=0;n<r.length;n++)!1===(t=r[n]).hasAttribute("id")&&t.setAttribute("id","three_default_"+tt++)}(e);for(var n=r(e,"node"),i=0;i<n.length;i++)t.children.push(Se(n[i]));rt.visualScenes[e.getAttribute("id")]=t}),p(We,"library_kinematics_models","kinematics_model",function(e){for(var t,r={name:e.getAttribute("name")||"",joints:{},links:[]},n=0;n<e.childNodes.length;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"technique_common":fe(t,r)}rt.kinematicsModels[e.getAttribute("id")]=r}),p(We,"library_physics_models","physics_model",function(e){for(var t,r={name:e.getAttribute("name")||"",rigidBodies:{}},n=0;n<e.childNodes.length;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"rigid_body":r.rigidBodies[t.getAttribute("name")]={},xe(t,r.rigidBodies[t.getAttribute("name")])}rt.physicsModels[e.getAttribute("id")]=r}),p(We,"scene","instance_kinematics_scene",function(e){for(var t,r={bindJointAxis:[]},n=0;n<e.childNodes.length;n++)if(1===(t=e.childNodes[n]).nodeType)switch(t.nodeName){case"bind_joint_axis":r.bindJointAxis.push(_e(t))}rt.kinematicsScenes[c(e.getAttribute("url"))]=r}),d(rt.animations,v),d(rt.clips,A),d(rt.controllers,R),d(rt.images,I),d(rt.effects,J),d(rt.materials,X),d(rt.cameras,Q),d(rt.lights,re),d(rt.geometries,ce),d(rt.visualScenes,Fe),function(){var e=rt.clips;if(!0!==u(e))for(var t in e)$e.push(S(t));else if(!1===u(rt.animations)){var r=[];for(var t in rt.animations)for(var i=y(t),a=0,o=i.length;a<o;a++)r.push(i[a]);$e.push(new n.d("default",-1,r))}}(),function(){function e(e,t){var r=t.getAttribute("name"),n=a.joints[e];s.traverse(function(i){i.name===r&&(u[e]={object:i,transforms:Ae(t),joint:n,position:n.zeroPosition})})}var t=Object.keys(rt.kinematicsModels)[0],r=Object.keys(rt.kinematicsScenes)[0],i=Object.keys(rt.visualScenes)[0];if(void 0!==t&&void 0!==r){for(var a=de(t),o=Ee(r),s=De(i),c=o.bindJointAxis,u={},l=0,h=c.length;l<h;l++){var p=c[l],d=We.querySelector('[sid="'+p.target+'"]');if(d){var f=d.parentElement;e(p.jointIndex,f)}}var m=new n.ub;et={joints:a&&a.joints,getJointValue:function(e){var t=u[e];return t?t.position:void console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=u[e];if(r){var i=r.joint;if(t>i.limits.max||t<i.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+i.limits.min+", max: "+i.limits.max+").");else if(i.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var a=r.object,o=i.axis,s=r.transforms;Ge.identity();for(var c,l=0;l<s.length;l++)if((c=s[l]).sid&&-1!==c.sid.indexOf(e))switch(i.type){case"revolute":Ge.multiply(m.makeRotationAxis(o,n.sb.degToRad(t)));break;case"prismatic":Ge.multiply(m.makeTranslation(o.x*t,o.y*t,o.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+i.type)}else switch(c.type){case"matrix":Ge.multiply(c.obj);break;case"translate":Ge.multiply(m.makeTranslation(c.obj.x,c.obj.y,c.obj.z));break;case"scale":Ge.scale(c.obj);break;case"rotate":Ge.multiply(m.makeRotationAxis(c.obj,c.angle))}a.matrix.copy(Ge),a.matrix.decompose(a.position,a.quaternion,a.scale),u[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}}();var nt=function(e){return De(c(r(e,"instance_visual_scene")[0].getAttribute("url")))}(r(We,"scene")[0]);return"Z_UP"===Ze.upAxis&&nt.quaternion.setFromEuler(new n.J(-Math.PI/2,0,0)),nt.scale.multiplyScalar(Ze.unit),{animations:$e,kinematics:et,library:rt,scene:nt}}}},function(e,t,r){"use strict";function n(e,t){var r,n=e.split("."),i=h;!(n[0]in i)&&i.execScript&&i.execScript("var "+n[0]);for(;n.length&&(r=n.shift());)n.length||t===u?i=i[r]?i[r]:i[r]={}:i[r]=t}function i(e){var t,r,n,i,a,o,s,c,u,l,h=e.length,d=0,f=Number.POSITIVE_INFINITY;for(c=0;c<h;++c)e[c]>d&&(d=e[c]),e[c]<f&&(f=e[c]);for(t=1<<d,r=new(p?Uint32Array:Array)(t),n=1,i=0,a=2;n<=d;){for(c=0;c<h;++c)if(e[c]===n){for(o=0,s=i,u=0;u<n;++u)o=o<<1|1&s,s>>=1;for(l=n<<16|c,u=o;u<t;u+=a)r[u]=l;++i}++n,i<<=1,a<<=1}return[r,d,f]}function a(e,t){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=p?new Uint8Array(e):e,this.m=!1,this.i=f,this.r=!1,(t||!(t={}))&&(t.index&&(this.a=t.index),t.bufferSize&&(this.h=t.bufferSize),t.bufferType&&(this.i=t.bufferType),t.resize&&(this.r=t.resize)),this.i){case d:this.b=32768,this.c=new(p?Uint8Array:Array)(32768+this.h+258);break;case f:this.b=0,this.c=new(p?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}function o(e,t){for(var r,n=e.f,i=e.d,a=e.input,o=e.a,s=a.length;i<t;){if(o>=s)throw Error("input buffer is broken");n|=a[o++]<<i,i+=8}return r=n&(1<<t)-1,e.f=n>>>t,e.d=i-t,e.a=o,r}function s(e,t){for(var r,n,i=e.f,a=e.d,o=e.input,s=e.a,c=o.length,u=t[0],l=t[1];a<l&&!(s>=c);)i|=o[s++]<<a,a+=8;if((n=(r=u[i&(1<<l)-1])>>>16)>a)throw Error("invalid code length: "+n);return e.f=i>>n,e.d=a-n,e.a=s,65535&r}function c(e,t){var r,n;switch(this.input=e,this.a=0,(t||!(t={}))&&(t.index&&(this.a=t.index),t.verify&&(this.A=t.verify)),r=e[this.a++],n=e[this.a++],15&r){case P:this.method=P;break;default:throw Error("unsupported compression method")}if(0!=((r<<8)+n)%31)throw Error("invalid fcheck flag:"+((r<<8)+n)%31);if(32&n)throw Error("fdict flag is not supported");this.q=new a(e,{index:this.a,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})}r.d(t,"a",function(){return z});/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */var u,l={},h=l,p="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView,d=0,f=1,m={t:d,s:f};a.prototype.k=function(){for(;!this.m;){var e=o(this,3);switch(1&e&&(this.m=!0),e>>>=1){case 0:var t=this.input,r=this.a,n=this.c,a=this.b,c=t.length,l=u,h=n.length,m=u;if(this.d=this.f=0,r+1>=c)throw Error("invalid uncompressed block header: LEN");if(l=t[r++]|t[r++]<<8,r+1>=c)throw Error("invalid uncompressed block header: NLEN");if(l===~(t[r++]|t[r++]<<8))throw Error("invalid uncompressed block header: length verify");if(r+l>t.length)throw Error("input buffer is broken");switch(this.i){case d:for(;a+l>n.length;){if(l-=m=h-a,p)n.set(t.subarray(r,r+m),a),a+=m,r+=m;else for(;m--;)n[a++]=t[r++];this.b=a,n=this.e(),a=this.b}break;case f:for(;a+l>n.length;)n=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(p)n.set(t.subarray(r,r+l),a),a+=l,r+=l;else for(;l--;)n[a++]=t[r++];this.a=r,this.b=a,this.c=n;break;case 1:this.j(C,O);break;case 2:var g,v,y,x,w=o(this,5)+257,_=o(this,5)+1,T=o(this,4)+4,E=new(p?Uint8Array:Array)(b.length),A=u,S=u,M=u,L=u,N=u;for(N=0;N<T;++N)E[b[N]]=o(this,3);if(!p)for(N=T,T=E.length;N<T;++N)E[b[N]]=0;for(g=i(E),A=new(p?Uint8Array:Array)(w+_),N=0,x=w+_;N<x;)switch(S=s(this,g),S){case 16:for(L=3+o(this,2);L--;)A[N++]=M;break;case 17:for(L=3+o(this,3);L--;)A[N++]=0;M=0;break;case 18:for(L=11+o(this,7);L--;)A[N++]=0;M=0;break;default:M=A[N++]=S}v=i(p?A.subarray(0,w):A.slice(0,w)),y=i(p?A.subarray(w):A.slice(w)),this.j(v,y);break;default:throw Error("unknown BTYPE: "+e)}}return this.n()};var g,v,y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],b=p?new Uint16Array(y):y,x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],w=p?new Uint16Array(x):x,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],T=p?new Uint8Array(_):_,E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],A=p?new Uint16Array(E):E,S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=p?new Uint8Array(S):S,L=new(p?Uint8Array:Array)(288);for(g=0,v=L.length;g<v;++g)L[g]=143>=g?8:255>=g?9:279>=g?7:8;var N,R,C=i(L),I=new(p?Uint8Array:Array)(30);for(N=0,R=I.length;N<R;++N)I[N]=5;var O=i(I);a.prototype.j=function(e,t){var r=this.c,n=this.b;this.o=e;for(var i,a,c,u,l=r.length-258;256!==(i=s(this,e));)if(256>i)n>=l&&(this.b=n,r=this.e(),n=this.b),r[n++]=i;else for(u=w[a=i-257],0<T[a]&&(u+=o(this,T[a])),i=s(this,t),c=A[i],0<M[i]&&(c+=o(this,M[i])),n>=l&&(this.b=n,r=this.e(),n=this.b);u--;)r[n]=r[n++-c];for(;8<=this.d;)this.d-=8,this.a--;this.b=n},a.prototype.w=function(e,t){var r=this.c,n=this.b;this.o=e;for(var i,a,c,u,l=r.length;256!==(i=s(this,e));)if(256>i)n>=l&&(l=(r=this.e()).length),r[n++]=i;else for(u=w[a=i-257],0<T[a]&&(u+=o(this,T[a])),i=s(this,t),c=A[i],0<M[i]&&(c+=o(this,M[i])),n+u>l&&(l=(r=this.e()).length);u--;)r[n]=r[n++-c];for(;8<=this.d;)this.d-=8,this.a--;this.b=n},a.prototype.e=function(){var e,t,r=new(p?Uint8Array:Array)(this.b-32768),n=this.b-32768,i=this.c;if(p)r.set(i.subarray(32768,r.length));else for(e=0,t=r.length;e<t;++e)r[e]=i[e+32768];if(this.g.push(r),this.l+=r.length,p)i.set(i.subarray(n,n+32768));else for(e=0;32768>e;++e)i[e]=i[n+e];return this.b=32768,i},a.prototype.z=function(e){var t,r,n,i=0|this.input.length/this.a+1,a=this.input,o=this.c;return e&&("number"==typeof e.p&&(i=e.p),"number"==typeof e.u&&(i+=e.u)),2>i?r=(n=0|(a.length-this.a)/this.o[2]/2*258)<o.length?o.length+n:o.length<<1:r=o.length*i,p?(t=new Uint8Array(r)).set(o):t=o,this.c=t},a.prototype.n=function(){var e,t,r,n,i,a=0,o=this.c,s=this.g,c=new(p?Uint8Array:Array)(this.l+(this.b-32768));if(0===s.length)return p?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(t=0,r=s.length;t<r;++t)for(n=0,i=(e=s[t]).length;n<i;++n)c[a++]=e[n];for(t=32768,r=this.b;t<r;++t)c[a++]=o[t];return this.g=[],this.buffer=c},a.prototype.v=function(){var e,t=this.b;return p?this.r?(e=new Uint8Array(t)).set(this.c.subarray(0,t)):e=this.c.subarray(0,t):(this.c.length>t&&(this.c.length=t),e=this.c),this.buffer=e},c.prototype.k=function(){var e,t,r=this.input;if(e=this.q.k(),this.a=this.q.a,this.A){t=(r[this.a++]<<24|r[this.a++]<<16|r[this.a++]<<8|r[this.a++])>>>0;var n=e;if("string"==typeof n){var i,a,o=n.split("");for(i=0,a=o.length;i<a;i++)o[i]=(255&o[i].charCodeAt(0))>>>0;n=o}for(var s,c=1,u=0,l=n.length,h=0;0<l;){l-=s=1024<l?1024:l;do{u+=c+=n[h++]}while(--s);c%=65521,u%=65521}if(t!==(u<<16|c)>>>0)throw Error("invalid adler-32 checksum")}return e};var P=8;n("Zlib.Inflate",c),n("Zlib.Inflate.prototype.decompress",c.prototype.k);var F,k,D,U,B={ADAPTIVE:m.s,BLOCK:m.t};if(Object.keys)F=Object.keys(B);else for(k in F=[],D=0,B)F[D++]=k;for(D=0,U=F.length;D<U;++D)n("Zlib.Inflate.BufferType."+(k=F[D]),B[k]);var z=l.Zlib},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),i=function(){function e(e){this.manager=void 0===e?n.D:e,this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}function r(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=x.MSFT_TEXTURE_DDS,this.ddsLoader=e}function i(e){this.name=x.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[x.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function a(){this.name=x.KHR_MATERIALS_UNLIT}function o(e){this.name=x.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,_);if(this.header={magic:n.ob.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==w)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var r,i=new DataView(e,_),a=0;a<i.byteLength;){r=i.getUint32(a,!0),a+=4;var o=i.getUint32(a,!0);if(a+=4,o===T.JSON){var s=new Uint8Array(e,_+a,r);this.content=n.ob.decodeText(s)}else if(o===T.BIN){var c=_+a;this.body=e.slice(c,c+r)}a+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function s(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=x.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function c(){this.name=x.KHR_TEXTURE_TRANSFORM}function u(){return{name:x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return n.pc},extendParams:function(e,t,r){var i=t.extensions[this.name],a=n.oc.standard,o=n.Gc.clone(a.uniforms),s=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n\tuniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\ttexelSpecular = sRGBToLinear( texelSpecular );\n\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tspecularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );\n\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tglossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );\nmaterial.specularColor = specularFactor.rgb;");delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new n.o).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=a.vertexShader,e.fragmentShader=s,e.uniforms=o,e.defines={STANDARD:""},e.color=new n.o(1,1,1),e.opacity=1;var c=[];if(Array.isArray(i.diffuseFactor)){var u=i.diffuseFactor;e.color.fromArray(u),e.opacity=u[3]}if(void 0!==i.diffuseTexture&&c.push(r.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new n.o(0,0,0),e.glossiness=void 0===i.glossinessFactor?1:i.glossinessFactor,e.specular=new n.o(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var l=i.specularGlossinessTexture;c.push(r.assignTexture(e,"glossinessMap",l)),c.push(r.assignTexture(e,"specularMap",l))}return Promise.all(c)},createMaterial:function(e){var t=new n.pc({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r,n=this.specularGlossinessParams,i=0,a=n.length;i<a;i++)r=e[n[i]],t[n[i]]=r&&r.isColor?r.clone():r;return t},refreshUniforms:function(e,t,r,n,i){if(!0===i.isGLTFSpecularGlossinessMaterial){var a,o=i.uniforms,s=i.defines;o.opacity.value=i.opacity,o.diffuse.value.copy(i.color),o.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),o.map.value=i.map,o.specularMap.value=i.specularMap,o.alphaMap.value=i.alphaMap,o.lightMap.value=i.lightMap,o.lightMapIntensity.value=i.lightMapIntensity,o.aoMap.value=i.aoMap,o.aoMapIntensity.value=i.aoMapIntensity,i.map?a=i.map:i.specularMap?a=i.specularMap:i.displacementMap?a=i.displacementMap:i.normalMap?a=i.normalMap:i.bumpMap?a=i.bumpMap:i.glossinessMap?a=i.glossinessMap:i.alphaMap?a=i.alphaMap:i.emissiveMap&&(a=i.emissiveMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),o.uvTransform.value.copy(a.matrix)),i.envMap&&(o.envMap.value=i.envMap,o.envMapIntensity.value=i.envMapIntensity,o.flipEnvMap.value=i.envMap.isCubeTexture?-1:1,o.reflectivity.value=i.reflectivity,o.refractionRatio.value=i.refractionRatio,o.maxMipLevel.value=e.properties.get(i.envMap).__maxMipLevel),o.specular.value.copy(i.specular),o.glossiness.value=i.glossiness,o.glossinessMap.value=i.glossinessMap,o.emissiveMap.value=i.emissiveMap,o.bumpMap.value=i.bumpMap,o.normalMap.value=i.normalMap,o.displacementMap.value=i.displacementMap,o.displacementScale.value=i.displacementScale,o.displacementBias.value=i.displacementBias,null!==o.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}function l(e,t,r,i){n.bb.call(this,e,t,r,i)}function h(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function p(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function d(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function f(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function m(e){var t=e.extensions&&e.extensions[x.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+g(t.attributes):e.indices+":"+g(e.attributes)+":"+e.mode}function g(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function v(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,i=e.array.slice(0,t*r),a=0,o=0;a<t;++a)i[o++]=e.getX(a),2<=r&&(i[o++]=e.getY(a)),3<=r&&(i[o++]=e.getZ(a)),4<=r&&(i[o++]=e.getW(a));return new n.k(i,r,e.normalized)}return e.clone()}function y(e,r,i){this.json=e||{},this.extensions=r||{},this.options=i||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new n.yc(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new n.L(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function b(e,t,r){function n(t,n){return r.getDependency("accessor",t).then(function(t){e.addAttribute(n,t)})}var i=t.attributes,a=[];for(var o in i){var s=k[o]||o.toLowerCase();s in e.attributes||a.push(n(i[o],s))}if(void 0!==t.indices&&!e.index){var c=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});a.push(c)}return d(e,t),Promise.all(a).then(function(){return void 0===t.targets?e:function(e,t,r){for(var n=!1,i=!1,a=0,o=t.length;a<o&&(void 0!==(s=t[a]).POSITION&&(n=!0),void 0!==s.NORMAL&&(i=!0),!n||!i);a++);if(!n&&!i)return Promise.resolve(e);var s,c=[],u=[];for(a=0,o=t.length;a<o;a++){if(s=t[a],n){var l=void 0===s.POSITION?e.attributes.position:r.getDependency("accessor",s.POSITION);c.push(l)}if(i){l=void 0===s.NORMAL?e.attributes.normal:r.getDependency("accessor",s.NORMAL);u.push(l)}}return Promise.all([Promise.all(c),Promise.all(u)]).then(function(r){for(var a=r[0],o=r[1],s=0,c=a.length;s<c;s++)e.attributes.position!==a[s]&&(a[s]=v(a[s]));for(s=0,c=o.length;s<c;s++)e.attributes.normal!==o[s]&&(o[s]=v(o[s]));for(s=0,c=t.length;s<c;s++){var u=t[s],l="morphTarget"+s;if(n&&void 0!==u.POSITION){var h=a[s];h.name=l;for(var p=e.attributes.position,d=0,f=h.count;d<f;d++)h.setXYZ(d,h.getX(d)+p.getX(d),h.getY(d)+p.getY(d),h.getZ(d)+p.getZ(d))}if(i&&void 0!==u.NORMAL){var m=o[s];m.name=l;var g=e.attributes.normal;for(d=0,f=m.count;d<f;d++)m.setXYZ(d,m.getX(d)+g.getX(d),m.getY(d)+g.getY(d),m.getZ(d)+g.getZ(d))}}return n&&(e.morphAttributes.position=a),i&&(e.morphAttributes.normal=o),e})}(e,t.targets,r)})}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,i){var a,o=this;a=void 0===this.resourcePath?void 0===this.path?n.ob.extractUrlBase(e):this.path:this.resourcePath,o.manager.itemStart(e);var s=function(t){i?i(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},c=new n.L(o.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&c.setWithCredentials(!0),c.load(e,function(r){try{o.parse(r,a,function(r){t(r),o.manager.itemEnd(e)},s)}catch(e){s(e)}},r,s)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,l,h){var p,d={};if("string"==typeof e)p=e;else if(n.ob.decodeText(new Uint8Array(e,0,4))===w){try{d[x.KHR_BINARY_GLTF]=new o(e)}catch(e){return void(h&&h(e))}p=d[x.KHR_BINARY_GLTF].content}else p=n.ob.decodeText(new Uint8Array(e));var f=JSON.parse(p);if(void 0===f.asset||2>f.asset.version[0])h&&h(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(f.extensionsUsed)for(var m=0;m<f.extensionsUsed.length;++m){var g=f.extensionsUsed[m],v=f.extensionsRequired||[];g===x.KHR_LIGHTS_PUNCTUAL?d[g]=new i(f):g===x.KHR_MATERIALS_UNLIT?d[g]=new a:g===x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS?d[g]=new u:g===x.KHR_DRACO_MESH_COMPRESSION?d[g]=new s(f,this.dracoLoader):g===x.MSFT_TEXTURE_DDS?d[x.MSFT_TEXTURE_DDS]=new r(this.ddsLoader):g===x.KHR_TEXTURE_TRANSFORM?d[x.KHR_TEXTURE_TRANSFORM]=new c:0<=v.indexOf(g)&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}new y(f,d,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(l,h)}}};var x={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};i.prototype.loadLight=function(e){var t,r=this.lightDefs[e],i=new n.o(16777215);void 0!==r.color&&i.fromArray(r.color);var a=void 0===r.range?0:r.range;switch(r.type){case"directional":(t=new n.E(i)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new n.Rb(i)).distance=a;break;case"spot":(t=new n.vc(i)).distance=a,r.spot=r.spot||{},r.spot.innerConeAngle=void 0===r.spot.innerConeAngle?0:r.spot.innerConeAngle,r.spot.outerConeAngle=void 0===r.spot.outerConeAngle?Math.PI/4:r.spot.outerConeAngle,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},a.prototype.getMaterialType=function(){return n.wb},a.prototype.extendParams=function(e,t,r){var i=[];e.color=new n.o(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&i.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(i)};var w="glTF",_=12,T={JSON:1313821514,BIN:5130562};s.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},c={};for(var u in a){var l=k[u]||u.toLowerCase();o[l]=a[u]}for(u in e.attributes){l=k[u]||u.toLowerCase();if(void 0!==a[u]){var h=r.accessors[e.attributes[u]],p=I[h.componentType];c[l]=p,s[l]=!0===h.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],i=s[r];void 0!==i&&(n.normalized=i)}t(e)},o,c)})})},c.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},l.prototype=Object.create(n.bb.prototype),l.prototype.constructor=l,l.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=0;i!==n;i++)t[i]=r[e*n*3+n+i];return t},l.prototype.beforeStart_=l.prototype.copySampleValue_,l.prototype.afterEnd_=l.prototype.copySampleValue_,l.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=3*o,c=n-t,u=(r-t)/c,l=u*u,h=l*u,p=e*s,d=p-s,f=-2*h+3*l,m=h-l,g=0;g!==o;g++){var v=a[d+g+o],y=a[d+g+2*o]*c,b=a[p+g+o],x=a[p+g]*c;i[g]=(1-f)*v+(m-l+u)*y+f*b+m*x}return i};var E,A=0,S=1,M=2,L=3,N=4,R=5,C=6,I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},O={9728:n.Eb,9729:n.kb,9984:n.Gb,9985:n.mb,9986:n.Fb,9987:n.lb},P={33071:n.n,33648:n.Cb,10497:n.mc},F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},D={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},U={CUBICSPLINE:void 0,LINEAR:n.db,STEP:n.cb},B="OPAQUE",z="MASK",G="BLEND",j={"image/png":n.Xb,"image/jpeg":n.fc};return y.prototype.parse=function(e,t){var r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};p(i,a,n),d(a,n),e(a)}).catch(t)},y.prototype.markDefs=function(){for(var e,t=this.json.nodes||[],r=this.json.skins||[],n=this.json.meshes||[],i={},a={},o=0,s=r.length;o<s;o++)for(var c=0,u=(e=r[o].joints).length;c<u;c++)t[e[c]].isBone=!0;for(var l,h=0,p=t.length;h<p;h++)void 0!==(l=t[h]).mesh&&(void 0===i[l.mesh]&&(i[l.mesh]=a[l.mesh]=0),i[l.mesh]++,void 0!==l.skin&&(n[l.mesh].isSkinnedMesh=!0));this.json.meshReferences=i,this.json.meshUses=a},y.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this.loadMesh(t);break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this.loadBufferView(t);break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this.loadMaterial(t);break;case"texture":n=this.loadTexture(t);break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;case"light":n=this.extensions[x.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},y.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},y.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[x.KHR_BINARY_GLTF].body);var n=this.options;return new Promise(function(e,i){r.load(h(t.uri,n.path),e,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},y.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})},y.prototype.loadAccessor=function(e){var t=this,r=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var a=[];return void 0===i.bufferView?a.push(null):a.push(this.getDependency("bufferView",i.bufferView)),void 0!==i.sparse&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(e){var a,o,s=e[0],c=F[i.type],u=I[i.componentType],l=u.BYTES_PER_ELEMENT,h=i.byteOffset||0,p=void 0===i.bufferView?void 0:r.bufferViews[i.bufferView].byteStride,d=!0===i.normalized;if(p&&p!==l*c){var f=Math.floor(h/p),m="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+f+":"+i.count,g=t.cache.get(m);g||(a=new u(s,f*p,i.count*p/l),g=new n.Z(a,p/l),t.cache.add(m,g)),o=new n.ab(g,c,h%p/l,d)}else a=null===s?new u(i.count*c):new u(s,h,i.count*c),o=new n.k(a,c,d);if(void 0!==i.sparse){var v=F.SCALAR,y=I[i.sparse.indices.componentType],b=i.sparse.indices.byteOffset||0,x=i.sparse.values.byteOffset||0,w=new y(e[1],b,i.sparse.count*v),_=new u(e[2],x,i.sparse.count*c);null!==s&&o.setArray(o.array.slice());for(var T,E=0,A=w.length;E<A;E++)if(T=w[E],o.setX(T,_[E*c]),2<=c&&o.setY(T,_[E*c+1]),3<=c&&o.setZ(T,_[E*c+2]),4<=c&&o.setW(T,_[E*c+3]),5<=c)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}return o})},y.prototype.loadTexture=function(e){var t,r=this,i=this.json,a=this.options,o=this.textureLoader,s=window.URL||window.webkitURL,c=i.textures[e],u=c.extensions||{},l=(t=u[x.MSFT_TEXTURE_DDS]?i.images[u[x.MSFT_TEXTURE_DDS].source]:i.images[c.source]).uri,p=!1;return void 0!==t.bufferView&&(l=r.getDependency("bufferView",t.bufferView).then(function(e){p=!0;var r=new Blob([e],{type:t.mimeType});return l=s.createObjectURL(r)})),Promise.resolve(l).then(function(e){var t=n.nb.Handlers.get(e);return t||(t=u[x.MSFT_TEXTURE_DDS]?r.extensions[x.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise(function(r,n){t.load(h(e,a.path),r,void 0,n)})}).then(function(e){1==p&&s.revokeObjectURL(l),e.flipY=!1,void 0!==c.name&&(e.name=c.name),t.mimeType in j&&(e.format=j[t.mimeType]);var r=(i.samplers||{})[c.sampler]||{};return e.magFilter=O[r.magFilter]||n.kb,e.minFilter=O[r.minFilter]||n.lb,e.wrapS=P[r.wrapS]||n.mc,e.wrapT=P[r.wrapT]||n.mc,e})},y.prototype.assignTexture=function(e,t,r){var i=this;return this.getDependency("texture",r.index).then(function(a){if(a.isCompressedTexture||("aoMap"===t||"emissiveMap"===t||"metalnessMap"===t||"normalMap"===t||"roughnessMap"===t)&&(a.format=n.fc),i.extensions[x.KHR_TEXTURE_TRANSFORM]){var o=void 0===r.extensions?void 0:r.extensions[x.KHR_TEXTURE_TRANSFORM];o&&(a=i.extensions[x.KHR_TEXTURE_TRANSFORM].extendTexture(a,o))}e[t]=a})},y.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,i=this.extensions,a=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,s=void 0===t.attributes.normal,c=!0===e.isSkinnedMesh,u=0<Object.keys(t.morphAttributes).length,l=u&&void 0!==t.morphAttributes.normal;if(e.isPoints){var h="PointsMaterial:"+r.uuid,p=this.cache.get(h);p||(p=new n.Tb,n.qb.prototype.copy.call(p,r),p.color.copy(r.color),p.map=r.map,p.lights=!1,this.cache.add(h,p)),r=p}else if(e.isLine){h="LineBasicMaterial:"+r.uuid;var d=this.cache.get(h);d||(d=new n.gb,n.qb.prototype.copy.call(d,r),d.color.copy(r.color),d.lights=!1,this.cache.add(h,d)),r=d}if(a||o||s||c||u){h="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(h+="specular-glossiness:"),c&&(h+="skinning:"),a&&(h+="vertex-tangents:"),o&&(h+="vertex-colors:"),s&&(h+="flat-shading:"),u&&(h+="morph-targets:"),l&&(h+="morph-normals:");var f=this.cache.get(h);f||(f=r.isGLTFSpecularGlossinessMaterial?i[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),c&&(f.skinning=!0),a&&(f.vertexTangents=!0),o&&(f.vertexColors=n.Mc),s&&(f.flatShading=!0),u&&(f.morphTargets=!0),l&&(f.morphNormals=!0),this.cache.add(h,f)),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new n.k(t.attributes.uv.array,2))),r.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=i[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=r},y.prototype.loadMaterial=function(e){var t,r=this,i=this.json,a=this.extensions,o=i.materials[e],s={},c=o.extensions||{},u=[];if(c[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=a[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),u.push(l.extendParams(s,o,r))}else if(c[x.KHR_MATERIALS_UNLIT]){var h=a[x.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),u.push(h.extendParams(s,o,r))}else{t=n.Ab;var f=o.pbrMetallicRoughness||{};if(s.color=new n.o(1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var m=f.baseColorFactor;s.color.fromArray(m),s.opacity=m[3]}void 0!==f.baseColorTexture&&u.push(r.assignTexture(s,"map",f.baseColorTexture)),s.metalness=void 0===f.metallicFactor?1:f.metallicFactor,s.roughness=void 0===f.roughnessFactor?1:f.roughnessFactor,void 0!==f.metallicRoughnessTexture&&(u.push(r.assignTexture(s,"metalnessMap",f.metallicRoughnessTexture)),u.push(r.assignTexture(s,"roughnessMap",f.metallicRoughnessTexture)))}!0===o.doubleSided&&(s.side=n.F);var g=o.alphaMode||B;return g===G?s.transparent=!0:(s.transparent=!1,g===z&&(s.alphaTest=void 0===o.alphaCutoff?.5:o.alphaCutoff)),void 0!==o.normalTexture&&t!==n.wb&&(u.push(r.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new n.Ic(1,1),void 0!==o.normalTexture.scale&&s.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&t!==n.wb&&(u.push(r.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==n.wb&&(s.emissive=(new n.o).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==n.wb&&u.push(r.assignTexture(s,"emissiveMap",o.emissiveTexture)),Promise.all(u).then(function(){var e;return e=t===n.pc?a[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),void 0!==o.name&&(e.name=o.name),e.map&&(e.map.encoding=n.Oc),e.emissiveMap&&(e.emissiveMap.encoding=n.Oc),e.specularMap&&(e.specularMap.encoding=n.Oc),d(e,o),o.extensions&&p(a,e,o),e})},y.prototype.loadGeometries=function(e){function t(e){return i[x.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then(function(t){return b(t,e,r)})}for(var r=this,i=this.extensions,a=this.primitiveCache,o=[],s=0,c=e.length;s<c;s++){var u,l=e[s],h=m(l),p=a[h];if(p)o.push(p.promise);else u=l.extensions&&l.extensions[x.KHR_DRACO_MESH_COMPRESSION]?t(l):b(new n.l,l,r),a[h]={primitive:l,promise:u},o.push(u)}return Promise.all(o)},y.prototype.loadMesh=function(e){for(var t,r=this,i=this.json.meshes[e],a=i.primitives,o=[],s=0,c=a.length;s<c;s++)t=void 0===a[s].material?E=E||new n.Ab({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.P}):this.getDependency("material",a[s].material),o.push(t);return Promise.all(o).then(function(t){return r.loadGeometries(a).then(function(o){for(var s=[],c=0,u=o.length;c<u;c++){var l,h=o[c],p=a[c],m=t[c];if(p.mode===N||p.mode===R||p.mode===C||void 0===p.mode)!0!==(l=!0===i.isSkinnedMesh?new n.sc(h,m):new n.vb(h,m)).isSkinnedMesh||l.geometry.attributes.skinWeight.normalized||l.normalizeSkinWeights(),p.mode===R?l.drawMode=n.Ac:p.mode===C&&(l.drawMode=n.zc);else if(p.mode===S)l=new n.ib(h,m);else if(p.mode===L)l=new n.fb(h,m);else if(p.mode===M)l=new n.hb(h,m);else{if(p.mode!==A)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);l=new n.Sb(h,m)}0<Object.keys(l.geometry.morphAttributes).length&&f(l,i),l.name=i.name||"mesh_"+e,1<o.length&&(l.name+="_"+c),d(l,i),r.assignFinalMaterial(l),s.push(l)}if(1===s.length)return s[0];var g=new n.R;for(c=0,u=s.length;c<u;c++)g.add(s[c]);return g})})},y.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],i=r[r.type];return i?("perspective"===r.type?t=new n.Pb(n.sb.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===r.type&&(t=new n.Nb(i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar)),void 0!==r.name&&(t.name=r.name),d(t,r),Promise.resolve(t)):void console.warn("THREE.GLTFLoader: Missing camera parameters.")},y.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},y.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],i=[],a=[],o=[],s=[],c=0,u=t.channels.length;c<u;c++){var h=t.channels[c],p=t.samplers[h.sampler],d=h.target,f=void 0===d.node?d.id:d.node,m=void 0===t.parameters?p.input:t.parameters[p.input],g=void 0===t.parameters?p.output:t.parameters[p.output];r.push(this.getDependency("node",f)),i.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",g)),o.push(p),s.push(d)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(o),Promise.all(s)]).then(function(r){for(var i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],u=[],h=0,p=i.length;h<p;h++){var d=i[h],f=a[h],m=o[h],g=s[h],v=c[h];if(void 0!==d){var y;switch(d.updateMatrix(),d.matrixAutoUpdate=!0,D[v.path]){case D.weights:y=n.Jb;break;case D.rotation:y=n.Wb;break;case D.position:case D.scale:default:y=n.Lc}var b=d.name?d.name:d.uuid,x=void 0===g.interpolation?n.db:U[g.interpolation],w=[];D[v.path]===D.weights?d.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&w.push(e.name?e.name:e.uuid)}):w.push(b);var _=m.array;if(m.normalized){var T;if(_.constructor===Int8Array)T=1/127;else if(_.constructor===Uint8Array)T=1/255;else if(_.constructor==Int16Array)T=1/32767;else{if(_.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");T=1/65535}for(var E=new Float32Array(_.length),A=0,S=_.length;A<S;A++)E[A]=_[A]*T;_=E}var M;for(A=0,S=w.length;A<S;A++)M=new y(w[A]+"."+D[v.path],f.array,_,x),"CUBICSPLINE"===g.interpolation&&(M.createInterpolant=function(e){return new l(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(M)}}var L=void 0===t.name?"animation_"+e:t.name;return new n.d(L,void 0,u)})},y.prototype.loadNode=function(e){var t=this.json,r=this.extensions,i=this,a=t.meshReferences,o=t.meshUses,s=t.nodes[e];return function(){var e=[];return void 0!==s.mesh&&e.push(i.getDependency("mesh",s.mesh).then(function(e){var t;if(1<a[s.mesh]){var r=o[s.mesh]++;(t=e.clone()).name+="_instance_"+r,t.onBeforeRender=e.onBeforeRender;for(var n=0,i=t.children.length;n<i;n++)t.children[n].name+="_instance_"+r,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==s.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=s.weights.length;t<r;t++)e.morphTargetInfluences[t]=s.weights[t]}),t})),void 0!==s.camera&&e.push(i.getDependency("camera",s.camera)),s.extensions&&s.extensions[x.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[x.KHR_LIGHTS_PUNCTUAL].light&&e.push(i.getDependency("light",s.extensions[x.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)}().then(function(e){var t;if((t=!0===s.isBone?new n.i:1<e.length?new n.R:1===e.length?e[0]:new n.Kb)!==e[0])for(var i=0,a=e.length;i<a;i++)t.add(e[i]);if(void 0!==s.name&&(t.userData.name=s.name,t.name=n.Ub.sanitizeNodeName(s.name)),d(t,s),s.extensions&&p(r,t,s),void 0!==s.matrix){var o=new n.ub;o.fromArray(s.matrix),t.applyMatrix(o)}else void 0!==s.translation&&t.position.fromArray(s.translation),void 0!==s.rotation&&t.quaternion.fromArray(s.rotation),void 0!==s.scale&&t.scale.fromArray(s.scale);return t})},y.prototype.loadScene=function(){function e(t,r,i,a){var o=i.nodes[t];return a.getDependency("node",t).then(function(e){return void 0===o.skin?e:a.getDependency("skin",o.skin).then(function(e){for(var r=[],n=0,i=(t=e).joints.length;n<i;n++)r.push(a.getDependency("node",t.joints[n]));return Promise.all(r)}).then(function(r){return e.traverse(function(e){if(e.isMesh){for(var i,a=[],o=[],s=0,c=r.length;s<c;s++)if(i=r[s]){a.push(i);var u=new n.ub;void 0!==t.inverseBindMatrices&&u.fromArray(t.inverseBindMatrices.array,16*s),o.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[s]);e.bind(new n.rc(a,o),e.matrixWorld)}}),e});var t}).then(function(t){r.add(t);var n=[];if(o.children)for(var s,c=o.children,u=0,l=c.length;u<l;u++)s=c[u],n.push(e(s,t,i,a));return Promise.all(n)})}return function(t){var r=this.json,i=this.extensions,a=this.json.scenes[t],o=new n.nc;void 0!==a.name&&(o.name=a.name),d(o,a),a.extensions&&p(i,o,a);for(var s=a.nodes||[],c=[],u=0,l=s.length;u<l;u++)c.push(e(s[u],o,r,this));return Promise.all(c).then(function(){return o})}}(),e}()},function(e,t,r){"use strict";var n=String.fromCharCode,i=Math.pow;r.d(t,"a",function(){return o});var a=r(0),o=function(e){this.manager=void 0===e?a.D:e,this.type=a.Hc};o.prototype=Object.create(a.C.prototype),o.prototype._parser=function(e){var t=function(e,t){switch(e){case 1:console.error("RGBELoader Read Error: "+(t||""));break;case 2:console.error("RGBELoader Write Error: "+(t||""));break;case 3:console.error("RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;for(var i=e.pos,a=-1,o=0,s="",c=n.apply(null,new Uint16Array(e.subarray(i,i+128)));0>(a=c.indexOf("\n"))&&o<t&&i<e.byteLength;)s+=c,o+=c.length,i+=128,c+=n.apply(null,new Uint16Array(e.subarray(i,i+128)));return!!(-1<a)&&(!1!==r&&(e.pos+=o+a+1),s+c.slice(0,a))},o=function(e,t,r,n){var a=e[t+3],o=i(2,a-128)/255;r[n+0]=e[t+0]*o,r[n+1]=e[t+1]*o,r[n+2]=e[t+2]*o},s=function(){function e(e){t[0]=e;var n=r[0],i=32768&n>>16,a=2047&n>>12,o=255&n>>23;return 103>o?i:142<o?(i|=31744,i|=(255==o?0:1)&&8388607&n):113>o?i|=((a|=2048)>>114-o)+(1&a>>113-o):(i|=o-112<<10|a>>1,i+=1&a)}var t=new Float32Array(1),r=new Int32Array(t.buffer);return function(t,r,n,a){var o=t[r+3],s=i(2,o-128)/255;n[a+0]=e(t[r+0]*s),n[a+1]=e(t[r+1]*s),n[a+2]=e(t[r+2]*s)}}(),c=new Uint8Array(e);c.pos=0;var u=function(e){var n,i,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,c=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(n=r(e)))return t(1,"no header found");if(!(i=n.match(/^#\?(\S+)$/)))return t(3,"bad initial token");for(u.valid|=1,u.programtype=i[1],u.string+=n+"\n";!1!==(n=r(e));)if(u.string+=n+"\n","#"!==n.charAt(0)){if((i=n.match(a))&&(u.gamma=parseFloat(i[1],10)),(i=n.match(o))&&(u.exposure=parseFloat(i[1],10)),(i=n.match(s))&&(u.valid|=2,u.format=i[1]),(i=n.match(c))&&(u.valid|=4,u.height=parseInt(i[1],10),u.width=parseInt(i[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=n+"\n";return 2&u.valid?4&u.valid?u:t(3,"missing image size specifier"):t(3,"missing format specifier")}(c);if(-1!==u){var l=u.width,h=u.height,p=function(e,r,n){var i,a,o,s,c,u,l,h,p,d,f,m,g,v=r,y=n;if(8>v||32767<v||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(v!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");if(!(i=new Uint8Array(4*r*n))||!i.length)return t(4,"unable to allocate buffer space");for(a=0,o=0,h=4*v,g=new Uint8Array(4),u=new Uint8Array(h);0<y&&o<e.byteLength;){if(o+4>e.byteLength)return t(1);if(g[0]=e[o++],g[1]=e[o++],g[2]=e[o++],g[3]=e[o++],2!=g[0]||2!=g[1]||(g[2]<<8|g[3])!=v)return t(3,"bad rgbe scanline format");for(l=0;l<h&&o<e.byteLength;){if((m=128<(s=e[o++]))&&(s-=128),0===s||l+s>h)return t(3,"bad scanline data");if(m)for(c=e[o++],p=0;p<s;p++)u[l++]=c;else u.set(e.subarray(o,o+s),l),l+=s,o+=s}for(d=v,p=0;p<d;p++)f=0,i[a]=u[p+f],f+=v,i[a+1]=u[p+f],f+=v,i[a+2]=u[p+f],f+=v,i[a+3]=u[p+f],a+=4;y--}return i}(c.subarray(c.pos),l,h);if(-1!==p){switch(this.type){case a.Hc:var d=p,f=a.ec,m=a.Hc;break;case a.N:for(var g=p.length/4*3,v=new Float32Array(g),y=0;y<g;y++)o(p,4*y,v,3*y);d=v,f=a.fc,m=a.N;break;case a.S:g=p.length/4*3;var b=new Uint16Array(g);for(y=0;y<g;y++)s(p,4*y,b,3*y);d=b,f=a.fc,m=a.S;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:l,height:h,data:d,header:u.string,gamma:u.gamma,exposure:u.exposure,format:f,type:m}}}return null},o.prototype.setDataType=function(e){return this.type=e,this},o.prototype.setType=function(e){return console.warn("THREE.RGBELoader: .setType() has been renamed to .setDataType()."),this.setDataType(e)},o.prototype.load=function(e,t,r,n){return a.C.prototype.load.call(this,e,function(e,r){switch(e.type){case a.Hc:e.encoding=a.dc,e.minFilter=a.Eb,e.magFilter=a.Eb,e.generateMipmaps=!1,e.flipY=!0;break;case a.N:e.encoding=a.jb,e.minFilter=a.kb,e.magFilter=a.kb,e.generateMipmaps=!1,e.flipY=!0;break;case a.S:e.encoding=a.jb,e.minFilter=a.kb,e.magFilter=a.kb,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,n)}},function(e,t,r){"use strict";var n=String.fromCharCode;r.d(t,"a",function(){return i});const i=function(){this.callbacks={onProgress:null,onAssetAvailable:null,onError:null},this.contentRef=null,this.legacyMode=!1,this.materials={},this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0},this.logging={enabled:!0,debug:!1}};i.prototype={constructor:i,resetRawMesh:function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this.pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},setMaterialPerSmoothingGroup:function(e){this.materialPerSmoothingGroup=e},setUseOAsMesh:function(e){this.useOAsMesh=e},setUseIndices:function(e){this.useIndices=e},setDisregardNormals:function(e){this.disregardNormals=e},setMaterials:function(e){if(null!=e)for(let t in e)e.hasOwnProperty(t)&&(this.materials[t]=e[t])},setCallbackOnAssetAvailable:function(e){null!=e&&(this.callbacks.onAssetAvailable=e)},setCallbackOnProgress:function(e){null!=e&&(this.callbacks.onProgress=e)},setCallbackOnError:function(e){null!=e&&(this.callbacks.onError=e)},setLogging:function(e,t){this.logging.enabled=!0===e,this.logging.debug=!0===t},configure:function(){if(null===this.callbacks.onAssetAvailable){let e="Unable to run as no callback for building meshes is set.";if(null===this.callbacks.onError)throw e;this.callbacks.onError(e)}if(this.pushSmoothingGroup(1),this.logging.enabled){let e=Object.keys(this.materials),t="OBJLoader.Parser configuration:"+(0<e.length?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseOAsMesh: "+this.useOAsMesh+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals;null!==this.callbacks.onProgress&&(t+="\n\tcallbacks.onProgress: "+this.callbacks.onProgress.name),null!==this.callbacks.onAssetAvailable&&(t+="\n\tcallbacks.onAssetAvailable: "+this.callbacks.onAssetAvailable.name),null!==this.callbacks.onError&&(t+="\n\tcallbacks.onError: "+this.callbacks.onError.name),console.info(t)}},parse:function(e){this.logging.enabled&&console.time("OBJLoader.Parser.parse"),this.configure();let t=new Uint8Array(e);this.contentRef=t;let r=t.byteLength;this.globalCounts.totalBytes=r;let i=Array(128);for(let e,a="",o=0,s=0,c=0;c<r;c++)switch(e=t[c],e){case 32:0<a.length&&(i[o++]=a),a="";break;case 47:0<a.length&&(i[o++]=a),s++,a="";break;case 10:0<a.length&&(i[o++]=a),a="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=c,this.processLine(i,o,s),o=0,s=0;break;case 13:break;default:a+=n(e)}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader.Parser.parse")},parseText:function(e){this.logging.enabled&&console.time("OBJLoader.Parser.parseText"),this.configure(),this.legacyMode=!0,this.contentRef=e;let t=e.length;this.globalCounts.totalBytes=t;let r=Array(128);for(let n,i="",a=0,o=0,s=0;s<t;s++)switch(n=e[s],n){case" ":0<i.length&&(r[a++]=i),i="";break;case"/":0<i.length&&(r[a++]=i),o++,i="";break;case"\n":0<i.length&&(r[a++]=i),i="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=s,this.processLine(r,a,o),a=0,o=0;break;case"\r":break;default:i+=n}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader.Parser.parseText")},processLine:function(e,t,r){if(1>t)return;let i,a,o,s,c=function(e,t,r,i){let a="";if(i>r){let o;if(t)for(o=r;o<i;o++)a+=e[o];else for(o=r;o<i;o++)a+=n(e[o]);a=a.trim()}return a};switch(s=e[0]){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),4<t&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(i=t-1,0===r)for(this.checkFaceType(0),o=2,a=i;o<a;o++)this.buildFace(e[1]),this.buildFace(e[o]),this.buildFace(e[o+1]);else if(i===2*r)for(this.checkFaceType(1),o=3,a=i-2;o<a;o+=2)this.buildFace(e[1],e[2]),this.buildFace(e[o],e[o+1]),this.buildFace(e[o+2],e[o+3]);else if(2*i==3*r)for(this.checkFaceType(2),o=4,a=i-3;o<a;o+=3)this.buildFace(e[1],e[2],e[3]),this.buildFace(e[o],e[o+1],e[o+2]),this.buildFace(e[o+3],e[o+4],e[o+5]);else for(this.checkFaceType(3),o=3,a=i-2;o<a;o+=2)this.buildFace(e[1],void 0,e[2]),this.buildFace(e[o],void 0,e[o+1]),this.buildFace(e[o+2],void 0,e[o+3]);break;case"l":case"p":if((i=t-1)===2*r)for(this.checkFaceType(4),o=1,a=i+1;o<a;o+=2)this.buildFace(e[o],e[o+1]);else for(this.checkFaceType("l"===s?5:6),o=1,a=i+1;o<a;o++)this.buildFace(e[o]);break;case"s":this.pushSmoothingGroup(e[1]);break;case"g":this.processCompletedMesh(),this.rawMesh.groupName=c(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.useOAsMesh&&this.processCompletedMesh(),this.rawMesh.objectName=c(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=c(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":let n=c(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==n&&this.rawMesh.activeMtlName!==n&&(this.rawMesh.activeMtlName=n,this.rawMesh.counts.mtlCount++,this.checkSubGroup())}},pushSmoothingGroup:function(e){let t=parseInt(e);isNaN(t)&&(t="off"===e?0:1);let r=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?t:0===t?0:1,this.rawMesh.smoothingGroup.real=t,r!==t&&(this.rawMesh.counts.smoothingGroupCount++,this.checkSubGroup())},checkFaceType:function(e){this.rawMesh.faceType!==e&&(this.processCompletedMesh(),this.rawMesh.faceType=e,this.checkSubGroup())},checkSubGroup:function(){let e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],(void 0===this.rawMesh.subGroupInUse||null===this.rawMesh.subGroupInUse)&&(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},buildFace:function(e,t,r){let n=this.rawMesh.subGroupInUse,i=this,a=function(){let a=parseInt(e),o=3*(0<a?a-1:a+i.vertices.length/3),s=0<i.colors.length?o:null,c=n.vertices;if(c.push(i.vertices[o++]),c.push(i.vertices[o++]),c.push(i.vertices[o]),null!==s){let e=n.colors;e.push(i.colors[s++]),e.push(i.colors[s++]),e.push(i.colors[s])}if(t){let e=parseInt(t),r=2*(0<e?e-1:e+i.uvs.length/2),a=n.uvs;a.push(i.uvs[r++]),a.push(i.uvs[r])}if(r&&!i.disregardNormals){let e=parseInt(r),t=3*(0<e?e-1:e+i.normals.length/3),a=n.normals;a.push(i.normals[t++]),a.push(i.normals[t++]),a.push(i.normals[t])}};if(this.useIndices){this.disregardNormals&&(r=void 0);let i=e+(t?"_"+t:"_n")+(r?"_"+r:"_n"),o=n.indexMappings[i];null==o?(o=this.rawMesh.subGroupInUse.vertices.length/3,a(),n.indexMappings[i]=o,n.indexMappingsCount++):this.rawMesh.counts.doubleIndicesCount++,n.indices.push(o)}else a();this.rawMesh.counts.faceCount++},createRawMeshReport:function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},finalizeRawMesh:function(){let e,t,r=[],n=0,i=0,a=0,o=0,s=0,c=0;for(let u in this.rawMesh.subGroups)if(0<(e=this.rawMesh.subGroups[u]).vertices.length){if(0<(t=e.indices).length&&0<i)for(let e=0;e<t.length;e++)t[e]+=i;r.push(e),n+=e.vertices.length,i+=e.indexMappingsCount,a+=e.indices.length,o+=e.colors.length,c+=e.uvs.length,s+=e.normals.length}let u=null;return 0<r.length&&(u={name:""===this.rawMesh.groupName?this.rawMesh.objectName:this.rawMesh.groupName,subGroups:r,absoluteVertexCount:n,absoluteIndexCount:a,absoluteColorCount:o,absoluteNormalCount:s,absoluteUvCount:c,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),u},processCompletedMesh:function(){let e=this.finalizeRawMesh(),t=null!==e;if(t){0<this.colors.length&&this.colors.length!==this.vertices.length&&null!==this.callbacks.onError&&this.callbacks.onError("Vertex Colors were detected, but vertex count and color count do not match!"),this.logging.enabled&&this.logging.debug&&console.debug(this.createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this.buildMesh(e);let t=this.globalCounts.currentByte/this.globalCounts.totalBytes;null!==this.callbacks.onProgress&&this.callbacks.onProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*t).toFixed(2)+"%",t),this.resetRawMesh()}return t},buildMesh:function(e){let t=e.subGroups,r=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;let n,i,a,o,s,c,u,l=0<e.absoluteIndexCount?new Uint32Array(e.absoluteIndexCount):null,h=0<e.absoluteColorCount?new Float32Array(e.absoluteColorCount):null,p=0<e.absoluteNormalCount?new Float32Array(e.absoluteNormalCount):null,d=0<e.absoluteUvCount?new Float32Array(e.absoluteUvCount):null,f=null!==h,m=[],g=1<t.length,v=0,y=[],b=[],x=0,w=0,_=0,T=0,E=0,A=0,S=0;for(let e in t)if(t.hasOwnProperty(e)){if(u=(n=t[e]).materialName,c=4>this.rawMesh.faceType?u+(f?"_vertexColor":"")+(0===n.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",o=this.materials[u],s=this.materials[c],null==o&&null==s&&(c=f?"defaultVertexColorMaterial":"defaultMaterial",s=this.materials[c],this.logging.enabled&&console.info('object_group "'+n.objectName+"_"+n.groupName+'" was defined with unresolvable material "'+u+'"! Assigning "'+c+'".')),null==s){let e={materialNameOrg:u,materialName:c,materialProperties:{vertexColors:f?2:0,flatShading:0===n.smoothingGroup}};this.callbacks.onAssetAvailable({cmd:"assetAvailable",type:"material",materials:{materialCloneInstructions:e}});let t=this.materials[c];null==t&&(this.materials[c]=e)}if(g?(!(i=y[c])&&(i=v,y[c]=v,m.push(c),v++),a={start:A,count:S=this.useIndices?n.indices.length:n.vertices.length/3,index:i},b.push(a),A+=S):m.push(c),r.set(n.vertices,x),x+=n.vertices.length,l&&(l.set(n.indices,w),w+=n.indices.length),h&&(h.set(n.colors,_),_+=n.colors.length),p&&(p.set(n.normals,T),T+=n.normals.length),d&&(d.set(n.uvs,E),E+=n.uvs.length),this.logging.enabled&&this.logging.debug){let e=null==i?"":"\n\t\tmaterialIndex: "+i,t="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+n.groupName+"\n\t\tIndex: "+n.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+n.materialName+"\n\t\tsmoothingGroup: "+n.smoothingGroup+e+"\n\t\tobjectName: "+n.objectName+"\n\t\t#vertices: "+n.vertices.length/3+"\n\t\t#indices: "+n.indices.length+"\n\t\t#colors: "+n.colors.length/3+"\n\t\t#uvs: "+n.uvs.length/2+"\n\t\t#normals: "+n.normals.length/3;console.debug(t)}}this.outputObjectCount++,this.callbacks.onAssetAvailable({cmd:"assetAvailable",type:"mesh",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:g,materialNames:m,materialGroups:b},buffers:{vertices:r,indices:l,colors:h,normals:p,uvs:d},geometryType:4>this.rawMesh.faceType?0:6===this.rawMesh.faceType?2:1},[r.buffer],null===l?null:[l.buffer],null===h?null:[h.buffer],null===p?null:[p.buffer],null===d?null:[d.buffer])},finalizeParsing:function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this.processCompletedMesh()&&this.logging.enabled){let e="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(e)}}}},function(e,t,r){"use strict";r.r(t);var n=r(14),i={};n.keys().forEach(function(e){"./index.js"===e||(i[e.replace(/(\.\/|\.js)/g,"")]=n(e).default)}),t.default=loaders},function(module,__webpack_exports__,__webpack_require__){"use strict";var _Mathabs2=Math.abs,_MathPI2=Math.PI,_Mathfloor2=Math.floor;__webpack_require__.d(__webpack_exports__,"a",function(){return Volume});var _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_misc_VolumeSlice_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(12),Volume=function(e,t,r,n,i){if(0<arguments.length){switch(this.xLength=+e||1,this.yLength=+t||1,this.zLength=+r||1,n){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":this.data=new Uint8Array(i);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(i);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(i);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(i);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(i);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(i);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw"Error in Volume constructor : this type is not supported in JavaScript";case"Float32":case"float32":case"float":this.data=new Float32Array(i);break;case"Float64":case"float64":case"double":this.data=new Float64Array(i);break;default:this.data=new Uint8Array(i)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw"Error in Volume constructor, lengths are not matching arrayBuffer size"}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.tb,this.matrix.identity();var a=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return a},set:function(e){a=e,this.sliceList.forEach(function(e){e.geometryNeedsUpdate=!0})}});var o=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return o},set:function(e){o=e,this.sliceList.forEach(function(e){e.geometryNeedsUpdate=!0})}}),this.sliceList=[]};Volume.prototype={constructor:Volume,getData:function(e,t,r){return this.data[r*this.xLength*this.yLength+t*this.xLength+e]},access:function(e,t,r){return r*this.xLength*this.yLength+t*this.xLength+e},reverseAccess:function(e){var t=_Mathfloor2(e/(this.yLength*this.xLength)),r=_Mathfloor2((e-t*this.yLength*this.xLength)/this.xLength);return[e-t*this.yLength*this.xLength-r*this.xLength,r,t]},map:function(e,t){var r=this.data.length;t=t||this;for(var n=0;n<r;n++)this.data[n]=e.call(t,this.data[n],n,this.data);return this},extractPerpendicularPlane:function(axis,RASIndex){var planeMatrix=(new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.ub).identity(),volume=this,axisInIJK=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc,firstDirection=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc,secondDirection=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc,dimensions=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(this.xLength,this.yLength,this.zLength),iLength,jLength,sliceAccess,planeWidth,planeHeight,firstSpacing,secondSpacing,positionOffset,IJKIndex;switch(axis){case"x":axisInIJK.set(1,0,0),firstDirection.set(0,0,-1),secondDirection.set(0,-1,0),firstSpacing=this.spacing[2],secondSpacing=this.spacing[1],IJKIndex=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(RASIndex,0,0),planeMatrix.multiply((new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.ub).makeRotationY(_MathPI2/2)),positionOffset=(volume.RASDimensions[0]-1)/2,planeMatrix.setPosition(new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(RASIndex-positionOffset,0,0));break;case"y":axisInIJK.set(0,1,0),firstDirection.set(1,0,0),secondDirection.set(0,0,1),firstSpacing=this.spacing[0],secondSpacing=this.spacing[2],IJKIndex=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(0,RASIndex,0),planeMatrix.multiply((new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.ub).makeRotationX(-_MathPI2/2)),positionOffset=(volume.RASDimensions[1]-1)/2,planeMatrix.setPosition(new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(0,RASIndex-positionOffset,0));break;case"z":default:axisInIJK.set(0,0,1),firstDirection.set(1,0,0),secondDirection.set(0,-1,0),firstSpacing=this.spacing[0],secondSpacing=this.spacing[1],IJKIndex=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(0,0,RASIndex),positionOffset=(volume.RASDimensions[2]-1)/2,planeMatrix.setPosition(new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(0,0,RASIndex-positionOffset))}firstDirection.applyMatrix4(volume.inverseMatrix).normalize(),firstDirection.argVar="i",secondDirection.applyMatrix4(volume.inverseMatrix).normalize(),secondDirection.argVar="j",axisInIJK.applyMatrix4(volume.inverseMatrix).normalize(),iLength=_Mathfloor2(_Mathabs2(firstDirection.dot(dimensions))),jLength=_Mathfloor2(_Mathabs2(secondDirection.dot(dimensions))),planeWidth=_Mathabs2(iLength*firstSpacing),planeHeight=_Mathabs2(jLength*secondSpacing),IJKIndex=_Mathabs2(Math.round(IJKIndex.applyMatrix4(volume.inverseMatrix).dot(axisInIJK)));var base=[new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(1,0,0),new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(0,1,0),new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Jc(0,0,1)],iDirection=[firstDirection,secondDirection,axisInIJK].find(function(e){return.9<_Mathabs2(e.dot(base[0]))}),jDirection=[firstDirection,secondDirection,axisInIJK].find(function(e){return.9<_Mathabs2(e.dot(base[1]))}),kDirection=[firstDirection,secondDirection,axisInIJK].find(function(e){return.9<_Mathabs2(e.dot(base[2]))}),argumentsWithInversion=["volume.xLength-1-","volume.yLength-1-","volume.zLength-1-"],argArray=[iDirection,jDirection,kDirection].map(function(e,t){return(0<e.dot(base[t])?"":argumentsWithInversion[t])+(e===axisInIJK?"IJKIndex":e.argVar)}),argString=argArray.join(",");return sliceAccess=eval("(function sliceAccess (i,j) {return volume.access( "+argString+");})"),{iLength:iLength,jLength:jLength,sliceAccess:sliceAccess,matrix:planeMatrix,planeWidth:planeWidth,planeHeight:planeHeight}},extractSlice:function(e,t){var r=new _misc_VolumeSlice_js__WEBPACK_IMPORTED_MODULE_1__.a(this,t,e);return this.sliceList.push(r),r},repaintAllSlices:function(){return this.sliceList.forEach(function(e){e.repaint()}),this},computeMinMax:function(){var e=1/0,t=-1/0,r=this.data.length,n=0;for(n=0;n<r;n++)if(!isNaN(this.data[n])){var i=this.data[n];e=Math.min(e,i),t=Math.max(t,i)}return this.min=e,this.max=t,[e,t]}}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),i=function(e,t,r){var i=this;this.volume=e,t=t||0,Object.defineProperty(this,"index",{get:function(){return t},set:function(e){return t=e,i.geometryNeedsUpdate=!0,t}}),this.axis=r||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var a=new n.xc(this.canvas);a.minFilter=n.kb,a.wrapS=a.wrapT=n.n;var o=new n.wb({map:a,side:n.F,transparent:!0});this.mesh=new n.vb(this.geometry,o),this.mesh.matrixAutoUpdate=!1,this.geometryNeedsUpdate=!0,this.repaint()};i.prototype={constructor:i,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var e=this.iLength,t=this.jLength,r=this.sliceAccess,n=this.volume,i=this.canvasBuffer,a=this.ctxBuffer,o=a.getImageData(0,0,e,t),s=o.data,c=n.data,u=n.upperThreshold,l=n.lowerThreshold,h=n.windowLow,p=n.windowHigh,d=0;if("label"===n.dataType)for(var f=0;f<t;f++)for(var m,g=0;g<e;g++){m=(m=c[r(g,f)])>=this.colorMap.length?m%this.colorMap.length+1:m;var v=this.colorMap[m];s[4*d]=255&v>>24,s[4*d+1]=255&v>>16,s[4*d+2]=255&v>>8,s[4*d+3]=255&v,d++}else for(f=0;f<t;f++)for(g=0;g<e;g++){var y=c[r(g,f)],b=255;b=u>=y&&l<=y?b:0,y=255<(y=Math.floor(255*(y-h)/(p-h)))?255:0>y?0:0|y,s[4*d]=y,s[4*d+1]=y,s[4*d+2]=y,s[4*d+3]=b,d++}a.putImageData(o,0,0),this.ctx.drawImage(i,0,0,e,t,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var e=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=e.sliceAccess,this.jLength=e.jLength,this.iLength=e.iLength,this.matrix=e.matrix,this.canvas.width=e.planeWidth,this.canvas.height=e.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new n.Qb(e.planeWidth,e.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix(this.matrix)),this.geometryNeedsUpdate=!1}}},function(e,t,r){"use strict";r.r(t);var n=r(10);t.default=n.default},function(e,t,r){function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}var a={"./get-3mf.js":48,"./get-amf.js":70,"./get-animation.js":15,"./get-assimp-json.js":51,"./get-assimp.js":67,"./get-audio.js":16,"./get-awd.js":66,"./get-babylon.js":53,"./get-basis-texture.js":41,"./get-buffer-geo.js":17,"./get-bvh.js":38,"./get-collada.js":18,"./get-cube-texture.js":19,"./get-dds.js":54,"./get-draco.js":39,"./get-exr.js":40,"./get-fbx.js":34,"./get-font.js":20,"./get-gcode.js":44,"./get-gltf.js":21,"./get-hdr-cube-texture.js":45,"./get-image-bitmap.js":22,"./get-image.js":23,"./get-kmz.js":46,"./get-ktx.js":47,"./get-ldraw.js":69,"./get-lwd.js":49,"./get-material.js":24,"./get-md2.js":50,"./get-mmd.js":35,"./get-mtl.js":52,"./get-node-material.js":32,"./get-nrrd.js":36,"./get-obj.js":68,"./get-obj2-parallel.js":33,"./get-obj2.js":25,"./get-object.js":26,"./get-pcd.js":65,"./get-pdb.js":64,"./get-play-canvas.js":63,"./get-ply.js":62,"./get-prwm.js":61,"./get-pvr.js":60,"./get-rgbe.js":27,"./get-stl.js":59,"./get-svg.js":58,"./get-tds.js":57,"./get-texture.js":28,"./get-tga.js":29,"./get-ttf.js":56,"./get-vrm.js":55,"./get-vrml.js":37,"./get-vtk.js":43,"./get-x.js":42,"./index.js":10};n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id=14},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.e,e,t)}r.r(t),r.d(t,"GetAnimation",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.g,e,t)}r.r(t),r.d(t,"GetAudio",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.m,e,t)}r.r(t),r.d(t,"GetBufferGeo",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.a,e,t)}r.r(t),r.d(t,"GetCollada",function(){return n});var i=r(5),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.v,e,t)}r.r(t),r.d(t,"GetCubeTexture",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.O,e,t)}r.r(t),r.d(t,"GetFont",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.a,e,t)}r.r(t),r.d(t,"GetGLTF",function(){return n});var i=r(7),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.U,e,t)}r.r(t),r.d(t,"GetImageBitmap",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.V,e,t)}r.r(t),r.d(t,"GetImage",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.rb,e,t)}r.r(t),r.d(t,"GetMaterial",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.a,e,t)}r.r(t),r.d(t,"GetOBJ2",function(){return n});var i=r(2),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.Lb,e,t)}r.r(t),r.d(t,"GetObject",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.a,e,t)}r.r(t),r.d(t,"GetRGBE",function(){return n});var i=r(8),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.yc,e,t)}r.r(t),r.d(t,"GetTexture",function(){return n});var i=r(0),a=r(1)},function(e,t,r){"use strict";function n(e,t){return Object(a.a)(new i.a,e,t)}r.r(t),r.d(t,"GetTGA",function(){return n});var i=r(3),a=r(1)},function(e){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e){(function(t){e.exports=t}).call(this,{})},function(e,t,r){"use strict";function n(e){this.uuid=Ee.sb.generateUUID(),this.name="",this.type=e,this.userData={}}function i(e,t){n.call(this,e),t=t||{},this.shared=!(void 0!==t.shared)||t.shared,this.unique=void 0!==t.unique&&t.unique}function a(e,t){(t=t||{}).shared=void 0!==t.shared&&t.shared,i.call(this,e,t),this.readonly=!1}function o(e,t){i.call(this),this.parse(e||o.PI,t)}function s(e,t){n.call(this,e),this.value=t}function c(e){i.call(this),this.parse(e)}function u(e,t){n.call(this,t),this.name=e}function l(e,t,r,n,a){this.isMethod=void 0===a,i.call(this,a),this.parse(e,t,r,n)}function h(e,t,r,n,i){l.call(this,e,i,n,r,t)}function p(e,t){i.call(this),this.setFunction(e,t)}function d(e){this.time=void 0===e?0:e,this.id=0}function f(e){e=e||{},this.name=e.name,this.type=e.type,this.node=e.node,this.needsUpdate=e.needsUpdate}function m(e,t){a.call(this,"v2"),this.value=e instanceof Ee.Ic?e:new Ee.Ic(e,t)}function g(e,t,r){a.call(this,"v3"),this.value=e instanceof Ee.Jc?e:new Ee.Jc(e,t,r)}function v(e,t,r,n){a.call(this,"v4"),this.value=e instanceof Ee.Kc?e:new Ee.Kc(e,t,r,n)}function y(e){i.call(this,"v2",{shared:!1}),this.index=e||0}function b(e){a.call(this,"f"),this.value=e||0}function x(e,t){i.call(this,"v4"),this.input=e,this.method=t||x.LINEAR_TO_LINEAR}function w(e,t,r,n){a.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new y,this.bias=r,this.project=void 0!==n&&n}function _(e){i.call(this,"v3",{unique:!0}),this.scope=e||_.CUBE}function T(e,t,r){a.call(this,"v4",{shared:!0}),this.value=e,this.uv=t||new _,this.bias=r}function E(e,t,r){i.call(this,"TextureCubeUVData"),this.uv=e,this.textureSize=t,this.blinnExponentToRoughness=r}function A(e){i.call(this,"v3"),this.scope=e||A.LOCAL}function S(){i.call(this,"f")}function M(e){i.call(this,"f"),this.blinnExponent=e||new S}function L(e,t){i.call(this,"v4"),this.value=e,this.textureSize=t||new b(1024),this.radianceCache={uv:new E(new _(_.VECTOR),this.textureSize,new M)},this.irradianceCache={uv:new E(new A(A.WORLD),this.textureSize,new b(1).setReadonly(!0))}}function N(){this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.requires={uv:[],color:[],lights:!1,fog:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode="#ifdef TEXTURE_LOD_EXT\n\t#define texCube(a, b) textureCube(a, b)\n\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)\n\t#define tex2D(a, b) texture2D(a, b)\n\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)\n#else\n\t#define texCube(a, b) textureCube(a, b)\n\t#define texCubeBias(a, b, c) textureCube(a, b, c)\n\t#define tex2D(a, b) texture2D(a, b)\n\t#define tex2DBias(a, b, c) texture2D(a, b, c)\n#endif\n#include <packing>\n#include <common>",this.parsCode={vertex:"",fragment:""},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={},this.updaters=[],this.nodes=[],this.analyzing=!1}function R(e){a.call(this,"b"),this.value=!!e}function C(e){a.call(this,"i"),this.value=Math.floor(e||0)}function I(e,t,r){a.call(this,"c"),this.value=e instanceof Ee.o?e:new Ee.o(e||0,t,r)}function O(e){a.call(this,"m3"),this.value=e||new Ee.tb}function P(e){a.call(this,"m4"),this.value=e||new Ee.ub}function F(e){w.call(this,void 0,e)}function k(e){i.call(this,"v3"),this.scope=e||k.LOCAL}function D(e,t,r){i.call(this),this.a=e,this.b=t,this.op=r}function U(e){i.call(this,"v4"),e&&this.setMirror(e)}function B(e,t,r){a.call(this,r),this.object=e,this.property=t}function z(e){n.call(this,"v4"),this.value=e}function G(e,t){Ee.pc.call(this);var r=this;this.vertex=e||new z(new k(k.PROJECTION)),this.fragment=t||new z(new I(16711680)),this.updaters=[],this.onBeforeCompile=function(e,t){this.needsUpdate&&(this.build({renderer:t}),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader)},this.onBeforeCompile.toString=function(){return r.needsCompile}}function j(e,t,r,n){n=n||{},this.input=r,this.clear=!(void 0!==n.clear)||n.clear,this.renderTarget=new Ee.Nc(e,t,n),this.material=new G,this.camera=new Ee.Nb(-1,1,1,-1,0,1),this.scene=new Ee.nc,this.quad=new Ee.vb(new Ee.Qb(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.render=!0,w.call(this,this.renderTarget.texture)}function V(e){i.call(this,"v4",{shared:!1}),this.index=e||0}function H(e,t){i.call(this,"v3"),this.setScope(e||H.POSITION),this.setCamera(t)}function W(e){i.call(this,"v3",{shared:!1}),this.scope=e||W.TOTAL}function J(){m.call(this),this.size=new Ee.Ic}function X(e){i.call(this,"v2"),this.resolution=e||new J}function Y(e,t,r,n){i.call(this),this.a=e,"string"==typeof t?n=t:this.b=t,"string"==typeof r?n=r:this.c=r,this.method=n}function q(e,t,r,n,a){i.call(this),this.a=e,this.b=t,this.op=r,this.ifNode=n,this.elseNode=a}function K(e){i.call(this,"f"),this.uv=e||new y}function Z(e){i.call(this,"f"),this.uv=e||new y}function Q(e){b.call(this),this.texture=e,this.maxMIPLevel=0}function $(e){i.call(this,"f"),this.texture=e,this.maxMIPLevel=new Q(e),this.blinnShininessExponent=new S}function ee(e,t){i.call(this,"v3"),this.value=e,this.scale=t||new m(1,1)}function te(e,t){i.call(this,"v3"),this.value=e,this.scale=t||new b(1),this.toNormalMap=!1}function re(e,t){n.call(this),this.code=e,this.value=t}function ne(e,t,r,n){i.call(this,"f"),this.x=e,this.y=t,this.z=r,this.w=n}function ie(e,t){n.call(this),this.node=e,this.components=t||"x"}function ae(e,t,r){b.call(this),this.scale=void 0===e?1:e,this.scope=t||ae.GLOBAL,this.timeScale=void 0===r?void 0!==e:r}function oe(e,t){g.call(this),this.params={},this.velocity=new Ee.Jc,this.setTarget(e),this.setParams(t)}function se(e,t){h.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=e||new y,this.position=t||new O}function ce(e,t,r,n){i.call(this,"v4"),this.value=e,this.uv=t||new y,this.radius=r||new m(1,1),this.size=n,this.blurX=!0,this.blurY=!0,this.horizontal=new b(1/64),this.vertical=new b(1/64)}function ue(e){i.call(this,"f"),this.rgb=e}function le(e,t,r){i.call(this,"v3"),this.rgb=e,this.adjustment=t,this.method=r||le.SATURATION}function he(){n.call(this),this.color=new I(15658734),this.spherical=!0}function pe(){n.call(this),this.color=new I(15658734),this.specular=new I(1118481),this.shininess=new b(30)}function de(){n.call(this),this.color=new I(15658734),this.roughness=new b(.5),this.metalness=new b(.5)}function fe(){de.call(this),this.properties={color:new Ee.o(16777215),roughness:.5,metalness:.5,normalScale:new Ee.Ic(1,1)},this.inputs={color:new B(this.properties,"color","c"),roughness:new B(this.properties,"roughness","f"),metalness:new B(this.properties,"metalness","f"),normalScale:new B(this.properties,"normalScale","v2")}}function me(){var e=new he;G.call(this,e,e),this.type="SpriteNodeMaterial"}function ge(){var e=new pe;G.call(this,e,e),this.type="PhongNodeMaterial"}function ve(){var e=new de;G.call(this,e,e),this.type="StandardNodeMaterial"}function ye(){var e=new fe;G.call(this,e,e),this.type="MeshStandardNodeMaterial"}function be(e,t){if(void 0===t){var r={minFilter:Ee.kb,magFilter:Ee.kb,format:Ee.Xb,stencilBuffer:!1},n=e.getDrawingBufferSize(new Ee.Ic);t=new Ee.Nc(n.width,n.height,r)}this.renderer=e,this.renderTarget=t,this.output=new F,this.material=new G,this.camera=new Ee.Nb(-1,1,1,-1,0,1),this.scene=new Ee.nc,this.quad=new Ee.vb(new Ee.Qb(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.needsUpdate=!0}function xe(e,t){return Object(je.a)(new Ge,e,t)}var we=Math.pow,_e=Math.max;r.r(t);var Te={};r.r(Te),r.d(Te,"Node",function(){return n}),r.d(Te,"TempNode",function(){return i}),r.d(Te,"InputNode",function(){return a}),r.d(Te,"ConstNode",function(){return o}),r.d(Te,"VarNode",function(){return s}),r.d(Te,"StructNode",function(){return c}),r.d(Te,"AttributeNode",function(){return u}),r.d(Te,"FunctionNode",function(){return l}),r.d(Te,"ExpressionNode",function(){return h}),r.d(Te,"FunctionCallNode",function(){return p}),r.d(Te,"NodeLib",function(){return Le}),r.d(Te,"NodeUtils",function(){return Ce}),r.d(Te,"NodeFrame",function(){return d}),r.d(Te,"NodeUniform",function(){return f}),r.d(Te,"NodeBuilder",function(){return N}),r.d(Te,"BoolNode",function(){return R}),r.d(Te,"IntNode",function(){return C}),r.d(Te,"FloatNode",function(){return b}),r.d(Te,"Vector2Node",function(){return m}),r.d(Te,"Vector3Node",function(){return g}),r.d(Te,"Vector4Node",function(){return v}),r.d(Te,"ColorNode",function(){return I}),r.d(Te,"Matrix3Node",function(){return O}),r.d(Te,"Matrix4Node",function(){return P}),r.d(Te,"TextureNode",function(){return w}),r.d(Te,"CubeTextureNode",function(){return T}),r.d(Te,"ScreenNode",function(){return F}),r.d(Te,"ReflectorNode",function(){return U}),r.d(Te,"PropertyNode",function(){return B}),r.d(Te,"RTTNode",function(){return j}),r.d(Te,"UVNode",function(){return y}),r.d(Te,"ColorsNode",function(){return V}),r.d(Te,"PositionNode",function(){return k}),r.d(Te,"NormalNode",function(){return A}),r.d(Te,"CameraNode",function(){return H}),r.d(Te,"LightNode",function(){return W}),r.d(Te,"ReflectNode",function(){return _}),r.d(Te,"ScreenUVNode",function(){return X}),r.d(Te,"ResolutionNode",function(){return J}),r.d(Te,"MathNode",function(){return Y}),r.d(Te,"OperatorNode",function(){return D}),r.d(Te,"CondNode",function(){return q}),r.d(Te,"NoiseNode",function(){return K}),r.d(Te,"CheckerNode",function(){return Z}),r.d(Te,"BlinnShininessExponentNode",function(){return S}),r.d(Te,"BlinnExponentToRoughnessNode",function(){return M}),r.d(Te,"RoughnessToBlinnExponentNode",function(){return $}),r.d(Te,"TextureCubeUVNode",function(){return E}),r.d(Te,"TextureCubeNode",function(){return L}),r.d(Te,"NormalMapNode",function(){return ee}),r.d(Te,"BumpMapNode",function(){return te}),r.d(Te,"BypassNode",function(){return re}),r.d(Te,"JoinNode",function(){return ne}),r.d(Te,"SwitchNode",function(){return ie}),r.d(Te,"TimerNode",function(){return ae}),r.d(Te,"VelocityNode",function(){return oe}),r.d(Te,"UVTransformNode",function(){return se}),r.d(Te,"MaxMIPLevelNode",function(){return Q}),r.d(Te,"ColorSpaceNode",function(){return x}),r.d(Te,"BlurNode",function(){return ce}),r.d(Te,"ColorAdjustmentNode",function(){return le}),r.d(Te,"LuminanceNode",function(){return ue}),r.d(Te,"RawNode",function(){return z}),r.d(Te,"SpriteNode",function(){return he}),r.d(Te,"PhongNode",function(){return pe}),r.d(Te,"StandardNode",function(){return de}),r.d(Te,"MeshStandardNode",function(){return fe}),r.d(Te,"NodeMaterial",function(){return G}),r.d(Te,"SpriteNodeMaterial",function(){return me}),r.d(Te,"PhongNodeMaterial",function(){return ge}),r.d(Te,"StandardNodeMaterial",function(){return ve}),r.d(Te,"MeshStandardNodeMaterial",function(){return ye}),r.d(Te,"NodePostProcessing",function(){return be});var Ee=r(0);n.prototype={constructor:n,isNode:!0,analyze:function(e,t){t=t||{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1},analyzeAndFlow:function(e,t,r){return r=r||{},this.analyze(e,r),this.flow(e,t,r)},flow:function(e,t,r){r=r||{},e.addFlow(r.slot,r.cache,r.context);var n={};return n.result=this.build(e,t),n.code=e.clearNodeCode(),n.extra=e.context.extra,e.removeFlow(),n},build:function(e,t,r){t=t||this.getType(e,t);var n=e.getNodeData(r||this);return e.analyzing&&this.appendDepsNode(e,n,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,r)},appendDepsNode:function(e,t,r){t.deps=(t.deps||0)+1;var n=e.getTypeLength(r);(n>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=n,t.output=r)},setName:function(e){return this.name=e,this},getName:function(){return this.name},getType:function(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type},getJSONNode:function(e){if(void 0!==e&&"string"!=typeof e&&void 0!==e.nodes[this.uuid])return e.nodes[this.uuid]},copy:function(e){return void 0!==e.name&&(this.name=e.name),void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this},createJSONNode:function(e){var t={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return t.uuid=this.uuid,t.nodeType=this.nodeType,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),void 0===e||"string"==typeof e||(e.nodes[this.uuid]=t),t},toJSON:function(e){return this.getJSONNode(e)||this.createJSONNode(e)}},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.build=function(e,t,r,a){if(t=t||this.getType(e),this.getShared(e,t)){var o=this.getUnique(e,t);o&&void 0===this.constructor.uuid&&(this.constructor.uuid=Ee.sb.generateUUID()),r=e.getUuid(r||this.getUuid(),!o);var s=e.getNodeData(r),c=s.output||this.getType(e);if(e.analyzing)return 0<(s.deps||0)||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):n.prototype.build.call(this,e,t,r);if(o)return s.name=s.name||n.prototype.build.call(this,e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,c)||e.context.ignoreCache||1===s.deps))return n.prototype.build.call(this,e,t,r);r=this.getUuid(!1);var u=this.getTemp(e,r);if(u)return e.format(u,c,t);u=i.prototype.generate.call(this,e,t,r,s.output,a);var l=this.generate(e,c,r);return e.addNodeCode(u+" = "+l+";"),e.format(u,c,t)}return n.prototype.build.call(this,e,t,r)},i.prototype.getShared=function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared},i.prototype.getUnique=function(){return this.unique},i.prototype.setLabel=function(e){return this.label=e,this},i.prototype.getLabel=function(){return this.label},i.prototype.getUuid=function(e){var t=(e||null==e)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t},i.prototype.getTemp=function(e,t){t=t||this.uuid;var r=e.getVars()[t];return r?r.name:void 0},i.prototype.generate=function(e,t,r,n,i){return this.getShared(e,t)||console.error("THREE.TempNode is not shared!"),r=r||this.uuid,e.getTempVar(r,n||this.getType(e),i,this.getLabel()).name},a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype.setReadonly=function(e){return this.readonly=e,this},a.prototype.getReadonly=function(){return this.readonly},a.prototype.copy=function(e){return i.prototype.copy.call(this,e),void 0!==e.readonly&&(this.readonly=e.readonly),this},a.prototype.createJSONNode=function(e){var t=i.prototype.createJSONNode.call(this,e);return!0===this.readonly&&(t.readonly=this.readonly),t},a.prototype.generate=function(e,t,r,n,i,a){r=e.getUuid(r||this.getUuid()),n=n||this.getType(e);var o=e.getNodeData(r);return this.getReadonly(e)&&void 0!==this.generateReadonly?this.generateReadonly(e,t,r,n,i,a):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(n,this,i,a,this.getLabel())),e.format(o.vertex.name,n,t)):(o.fragment||(o.fragment=e.createFragmentUniform(n,this,i,a,this.getLabel())),e.format(o.fragment.name,n,t))};var Ae=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i;o.PI="PI",o.PI2="PI2",o.RECIPROCAL_PI="RECIPROCAL_PI",o.RECIPROCAL_PI2="RECIPROCAL_PI2",o.LOG2="LOG2",o.EPSILON="EPSILON",o.prototype=Object.create(i.prototype),o.prototype.constructor=o,o.prototype.nodeType="Const",o.prototype.getType=function(e){return e.getTypeByFormat(this.type)},o.prototype.parse=function(e,t){this.src=e||"";var r,n,i="",a=this.src.match(Ae);this.useDefine=t||"#"===this.src.charAt(0),a&&1<a.length?(n=a[1],r=a[2],i=a[3]):(r=this.src,n="f"),this.name=r,this.type=n,this.value=i},o.prototype.build=function(e,t){return"source"!==t?(e.include(this),e.format(this.name,this.getType(e),t)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":this.useDefine?this.src:void 0},o.prototype.generate=function(e,t){return e.format(this.name,this.getType(e),t)},o.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.parse(e.src,e.useDefine),this},o.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src,!0===t.useDefine&&(t.useDefine=!0)),t},s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.nodeType="Var",s.prototype.getType=function(e){return e.getTypeByFormat(this.type)},s.prototype.generate=function(e,t){var r=e.getVar(this.uuid,this.type);return this.value&&e.isShader("vertex")&&e.addNodeCode(r.name+" = "+this.value.build(e,this.getType(e))+";"),e.format(r.name,this.getType(e),t)},s.prototype.copy=function(e){return n.prototype.copy.call(this,e),this.type=e.type,this.value=e.value,this},s.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type,this.value&&(t.value=this.value.toJSON(e).uuid)),t};var Se=/^struct\s*([a-z_0-9]+)\s*{\s*((.|\n)*?)}/gim,Me=/\s*(\w*?)\s*(\w*?)(\=|\;)/gim;c.prototype=Object.create(i.prototype),c.prototype.constructor=c,c.prototype.nodeType="Struct",c.prototype.getType=function(e){return e.getTypeByFormat(this.name)},c.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},c.prototype.generate=function(e,t){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)},c.prototype.parse=function(e){this.src=e||"",this.inputs=[];var t=Se.exec(this.src);if(t){for(var r,n=t[2];r=Me.exec(n);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name},c.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src),t},u.prototype=Object.create(n.prototype),u.prototype.constructor=u,u.prototype.nodeType="Attribute",u.prototype.getAttributeType=function(e){return"number"==typeof this.type?e.getConstructorFromLength(this.type):this.type},u.prototype.getType=function(e){var t=this.getAttributeType(e);return e.getTypeByFormat(t)},u.prototype.generate=function(e,t){var r=this.getAttributeType(e),n=e.getAttribute(this.name,r),i=e.isShader("vertex")?this.name:n.varying.name;return e.format(i,this.getType(e),t)},u.prototype.copy=function(e){return n.prototype.copy.call(this,e),this.type=e.type,this},u.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).type=this.type),t};var Le={nodes:{},keywords:{},add:function(e){this.nodes[e.name]=e},addKeyword:function(e,t,r){r=!(void 0!==r)||r,this.keywords[e]={callback:t,cache:r}},remove:function(e){delete this.nodes[e.name]},removeKeyword:function(e){delete this.keywords[e]},get:function(e){return this.nodes[e]},getKeyword:function(e,t){return this.keywords[e].callback.call(this,t)},getKeywordData:function(e){return this.keywords[e]},contains:function(e){return void 0!==this.nodes[e]},containsKeyword:function(e){return void 0!==this.keywords[e]}},Ne=/^([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,Re=/[a-z_0-9]+/gi;l.prototype=Object.create(i.prototype),l.prototype.constructor=l,l.prototype.nodeType="Function",l.prototype.useKeywords=!0,l.prototype.getShared=function(){return!this.isMethod},l.prototype.getType=function(e){return e.getTypeByFormat(this.type)},l.prototype.getInputByName=function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]},l.prototype.getIncludeByName=function(e){for(var t=this.includes.length;t--;)if(this.includes[t].name===e)return this.includes[t]},l.prototype.generate=function(e,t){for(var r=0,n=this.src,i=0;i<this.includes.length;i++)e.include(this.includes[i],this);for(var a in this.extensions)e.extensions[a]=!0;for(var o=[];s=Re.exec(this.src);)o.push(s);for(i=0;i<o.length;i++){var s,c=(s=o[i])[0],u=!this.isMethod||!this.getInputByName(c),l=c;if(this.keywords[c]||this.useKeywords&&u&&Le.containsKeyword(c)){var h=this.keywords[c];if(!h){var p=Le.getKeywordData(c);p.cache&&(h=e.keywords[c]),h=h||Le.getKeyword(c,e),p.cache&&(e.keywords[c]=h)}l=h.build(e)}c!==l&&(n=n.substring(0,s.index+r)+l+n.substring(s.index+c.length+r),r+=l.length-c.length),void 0===this.getIncludeByName(l)&&Le.contains(l)&&e.include(Le.get(l))}return"source"===t?n:this.isMethod?(e.include(this,!1,n),this.name):e.format("( "+n+" )",this.getType(e),t)},l.prototype.parse=function(e,t,r,n){if(this.src=e||"",this.includes=t||[],this.extensions=r||{},this.keywords=n||{},this.isMethod){var i=this.src.match(Ne);if(this.inputs=[],i&&4==i.length){this.type=i[1],this.name=i[2];var a=i[3].match(Re);if(a)for(var o=0;o<a.length;){var s,c,u=a[o++];"in"==u||"out"==u||"inout"==u?s=a[o++]:(s=u,u=""),c=a[o++],this.inputs.push({name:c,type:s,qualifier:u})}}else this.type="",this.name=""}},l.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.isMethod=e.isMethod,this.useKeywords=e.useKeywords,this.parse(e.src,e.includes,e.extensions,e.keywords),void 0!==e.type&&(this.type=e.type),this},l.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){for(var r in(t=this.createJSONNode(e)).src=this.src,t.isMethod=this.isMethod,t.useKeywords=this.useKeywords,this.isMethod||(t.type=this.type),t.extensions=JSON.parse(JSON.stringify(this.extensions)),t.keywords={},this.keywords)t.keywords[r]=this.keywords[r].toJSON(e).uuid;if(this.includes.length){t.includes=[];for(var n=0;n<this.includes.length;n++)t.includes.push(this.includes[n].toJSON(e).uuid)}}return t},h.prototype=Object.create(l.prototype),h.prototype.constructor=h,h.prototype.nodeType="Expression",p.prototype=Object.create(i.prototype),p.prototype.constructor=p,p.prototype.nodeType="FunctionCall",p.prototype.setFunction=function(e,t){this.value=e,this.inputs=t||[]},p.prototype.getFunction=function(){return this.value},p.prototype.getType=function(e){return this.value.getType(e)},p.prototype.generate=function(e,t){for(var r=this.getType(e),n=this.value,i=n.build(e,t)+"( ",a=[],o=0;o<n.inputs.length;o++){var s=n.inputs[o],c=this.inputs[o]||this.inputs[s.name];a.push(c.build(e,e.getTypeByFormat(s.type)))}return i+=a.join(", ")+" )",e.format(i,r,t)},p.prototype.copy=function(e){for(var t in i.prototype.copy.call(this,e),e.inputs)this.inputs[t]=e.inputs[t];return this.value=e.value,this},p.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){var r=this.value;if((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,r.inputs.length){t.inputs={};for(var n=0;n<r.inputs.length;n++){var i=r.inputs[n],a=this.inputs[n]||this.inputs[i.name];t.inputs[i.name]=a.toJSON(e).uuid}}}return t};var Ce={elements:["x","y","z","w"],addShortcuts:function(){function e(e,t,r){return r?{get:function(){return this[e][t][r]},set:function(n){this[e][t][r]=n}}:{get:function(){return this[e][t]},set:function(r){this[e][t]=r}}}return function(t,r,n){for(var i={},a=0;a<n.length;++a){var o=n[a].split("."),s=o[0],c=o[1];i[s]=e(r,s,c)}Object.defineProperties(t,i)}}()};d.prototype={constructor:d,update:function(e){return++this.id,this.time+=e,this.delta=e,this},setRenderer:function(e){return this.renderer=e,this},setRenderTexture:function(e){return this.renderTexture=e,this},updateNode:function(e){return e.frameId===this.id?this:(e.updateFrame(this),e.frameId=this.id,this)}},Object.defineProperties(f.prototype,{value:{get:function(){return this.node.value},set:function(e){this.node.value=e}}}),m.prototype=Object.create(a.prototype),m.prototype.constructor=m,m.prototype.nodeType="Vector2",Ce.addShortcuts(m.prototype,"value",["x","y"]),m.prototype.generateReadonly=function(e,t,r,n){return e.format("vec2( "+this.x+", "+this.y+" )",n,t)},m.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value.copy(e),this},m.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,!0===this.readonly&&(t.readonly=!0)),t},g.prototype=Object.create(a.prototype),g.prototype.constructor=g,g.prototype.nodeType="Vector3",Ce.addShortcuts(g.prototype,"value",["x","y","z"]),g.prototype.generateReadonly=function(e,t,r,n){return e.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",n,t)},g.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value.copy(e),this},g.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,!0===this.readonly&&(t.readonly=!0)),t},v.prototype=Object.create(a.prototype),v.prototype.constructor=v,v.prototype.nodeType="Vector4",Ce.addShortcuts(v.prototype,"value",["x","y","z","w"]),v.prototype.generateReadonly=function(e,t,r,n){return e.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",n,t)},v.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value.copy(e),this},v.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,!0===this.readonly&&(t.readonly=!0)),t};var Ie=["uv","uv2"],Oe=["vUv","vUv2"];y.prototype=Object.create(i.prototype),y.prototype.constructor=y,y.prototype.nodeType="UV",y.prototype.generate=function(e,t){e.requires.uv[this.index]=!0;var r=e.isShader("vertex")?Ie[this.index]:Oe[this.index];return e.format(r,this.getType(e),t)},y.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.index=e.index,this},y.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},Le.addKeyword("uv",function(){return new y}),Le.addKeyword("uv2",function(){return new y(1)}),b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.nodeType="Float",b.prototype.generateReadonly=function(e,t,r,n){return e.format(this.value+(this.value%1?"":".0"),n,t)},b.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value=e.value,this},b.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},x.Nodes=function(){var e=new l("vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}"),t=new l("vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}"),r=new l("vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}"),n=new l("vec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}"),i=new l("vec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}"),a=new l("vec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}"),s=new l("vec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}"),c=new l("vec3 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}"),u=new l("vec3 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}"),h=new l("vec3 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}"),p=new l("vec3 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}"),d=new o("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );"),f=new l("vec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}",[d]),m=new o("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );");return{LinearToLinear:e,GammaToLinear:t,LinearToGamma:r,sRGBToLinear:n,LinearTosRGB:i,RGBEToLinear:a,LinearToRGBE:s,RGBMToLinear:c,LinearToRGBM:u,RGBDToLinear:h,LinearToRGBD:p,cLogLuvM:d,LinearToLogLuv:f,cLogLuvInverseM:m,LogLuvToLinear:new l("vec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}",[m])}}(),x.LINEAR_TO_LINEAR="LinearToLinear",x.GAMMA_TO_LINEAR="GammaToLinear",x.LINEAR_TO_GAMMA="LinearToGamma",x.SRGB_TO_LINEAR="sRGBToLinear",x.LINEAR_TO_SRGB="LinearTosRGB",x.RGBE_TO_LINEAR="RGBEToLinear",x.LINEAR_TO_RGBE="LinearToRGBE",x.RGBM_TO_LINEAR="RGBMToLinear",x.LINEAR_TO_RGBM="LinearToRGBM",x.RGBD_TO_LINEAR="RGBDToLinear",x.LINEAR_TO_RGBD="LinearToRGBD",x.LINEAR_TO_LOG_LUV="LinearToLogLuv",x.LOG_LUV_TO_LINEAR="LogLuvToLinear",x.getEncodingComponents=function(e){return e===Ee.jb?["Linear"]:e===Ee.Oc?["sRGB"]:e===Ee.dc?["RGBE"]:e===Ee.hc?["RGBM",new b(7).setReadonly(!0)]:e===Ee.gc?["RGBM",new b(16).setReadonly(!0)]:e===Ee.cc?["RGBD",new b(256).setReadonly(!0)]:e===Ee.Q?["Gamma",new h("float( GAMMA_FACTOR )","f")]:void 0},x.prototype=Object.create(i.prototype),x.prototype.constructor=x,x.prototype.nodeType="ColorSpace",x.prototype.generate=function(e,t){var r=this.input.build(e,"v4"),n=this.getType(e),i=x.Nodes[this.method],a=e.include(i);if(a===x.LINEAR_TO_LINEAR)return e.format(r,n,t);if(2===i.inputs.length){var o=this.factor.build(e,"f");return e.format(a+"( "+r+", "+o+" )",n,t)}return e.format(a+"( "+r+" )",n,t)},x.prototype.fromEncoding=function(e){var t=x.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]},x.prototype.fromDecoding=function(e){var t=x.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]},x.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.input=e.input,this.method=e.method,this},x.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).input=this.input.toJSON(e).uuid,t.method=this.method),t},w.prototype=Object.create(a.prototype),w.prototype.constructor=w,w.prototype.nodeType="Texture",w.prototype.getTexture=function(e,t){return a.prototype.generate.call(this,e,t,this.value.uuid,"t")},w.prototype.generate=function(e,t){if("sampler2D"===t)return this.getTexture(e,t);var r,n,i=this.getTexture(e,t),a=this.uv.build(e,this.project?"v4":"v2"),o=this.bias?this.bias.build(e,"f"):void 0;void 0===o&&e.context.bias&&(o=new e.context.bias(this).build(e,"f")),r=this.project?"texture2DProj":o?"tex2DBias":"tex2D",n=o?r+"( "+i+", "+a+", "+o+" )":r+"( "+i+", "+a+" )";var s={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(s),this.colorSpace=this.colorSpace||new x(new h("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(e,c),e.removeContext(),e.format(n,c,t)},w.prototype.copy=function(e){return a.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias),void 0!==e.project&&(this.project=e.project),this},w.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.uuid),t.uv=this.uv.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},_.CUBE="cube",_.SPHERE="sphere",_.VECTOR="vector",_.prototype=Object.create(i.prototype),_.prototype.constructor=_,_.prototype.nodeType="Reflect",_.prototype.getType=function(){switch(this.scope){case _.SPHERE:return"v2"}return this.type},_.prototype.generate=function(e,t){if(e.isShader("fragment")){var r;switch(this.scope){case _.VECTOR:e.addNodeCode("vec3 reflectVec = inverseTransformDirection( reflect( -normalize( vViewPosition ), normal ), viewMatrix );"),r="reflectVec";break;case _.CUBE:var n=new _(_.VECTOR).build(e,"v3");e.addNodeCode("vec3 reflectCubeVec = vec3( -1.0 * "+n+".x, "+n+".yz );"),r="reflectCubeVec";break;case _.SPHERE:n=new _(_.VECTOR).build(e,"v3");e.addNodeCode("vec2 reflectSphereVec = normalize( ( viewMatrix * vec4( "+n+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5;"),r="reflectSphereVec"}return e.format(r,this.getType(e),t)}return console.warn("THREE.ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)},_.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},T.prototype=Object.create(a.prototype),T.prototype.constructor=T,T.prototype.nodeType="CubeTexture",T.prototype.getTexture=function(e,t){return a.prototype.generate.call(this,e,t,this.value.uuid,"tc")},T.prototype.generate=function(e,t){if("samplerCube"===t)return this.getTexture(e,t);var r=this.getTexture(e,t),n=this.uv.build(e,"v3"),i=this.bias?this.bias.build(e,"f"):void 0;void 0===i&&e.context.bias&&(i=new e.context.bias(this).build(e,"f"));var a=i?"texCubeBias( "+r+", "+n+", "+i+" )":"texCube( "+r+", "+n+" )",o={include:e.isShader("vertex"),ignoreCache:!0},s=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace||new x(new h("",s)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,s),e.removeContext(),e.format(a,s,t)},T.prototype.copy=function(e){return a.prototype.copy.call(this,e),e.value&&(this.value=e.value),this.uv=e.uv,e.bias&&(this.bias=e.bias),this},T.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.uuid,t.uv=this.uv.toJSON(e).uuid,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t},E.Nodes=function(){var e=new c("struct TextureCubeUVData {\n\tvec2 uv_10;\n\tvec2 uv_20;\n\tfloat t;\n}"),t=new l("int getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}"),r=new l("vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness, in float cubeUV_textureSize ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}",[new o("#define cubeUV_maxLods1 ( log2( cubeUV_textureSize * 0.25 ) - 1.0 )"),new o("#define cubeUV_rangeClamp ( exp2( ( 6.0 - 1.0 ) * 2.0 ) )")],{derivatives:!0}),n=new l("vec2 getCubeUV( vec3 direction, float roughnessLevel, float mipLevel, in float cubeUV_textureSize ) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\n\tfloat rcpPowScale = 1.0 / powScale;\n\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}",[new o("#define cubeUV_maxLods2 ( log2( cubeUV_textureSize * 0.25 ) - 2.0 )"),new o("#define cubeUV_rcpTextureSize ( 1.0 / cubeUV_textureSize )"),t]);return{TextureCubeUVData:e,textureCubeUV:new l("TextureCubeUVData textureCubeUV( vec3 reflectedDirection, float roughness, in float cubeUV_textureSize ) {\n\tfloat roughnessVal = roughness * cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness, cubeUV_textureSize);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0, cubeUV_textureSize);\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0, cubeUV_textureSize);\n\n\treturn TextureCubeUVData(uv_10, uv_20, t);\n}",[e,new o("#define cubeUV_maxLods3 ( log2( cubeUV_textureSize * 0.25 ) - 3.0 )"),r,n])}}(),E.prototype=Object.create(i.prototype),E.prototype.constructor=E,E.prototype.nodeType="TextureCubeUV",E.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=e.include(E.Nodes.textureCubeUV);return e.format(r+"( "+this.uv.build(e,"v3")+", "+this.blinnExponentToRoughness.build(e,"f")+", "+this.textureSize.build(e,"f")+" )",this.getType(e),t)}return console.warn("THREE.TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},E.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.textureSize=this.textureSize.toJSON(e).uuid,t.blinnExponentToRoughness=this.blinnExponentToRoughness.toJSON(e).uuid),t},A.LOCAL="local",A.WORLD="world",A.prototype=Object.create(i.prototype),A.prototype.constructor=A,A.prototype.nodeType="Normal",A.prototype.getShared=function(){return this.scope===A.WORLD},A.prototype.generate=function(e,t){var r;switch(this.scope){case A.LOCAL:r="normal";break;case A.WORLD:r=e.isShader("vertex")?"( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz":"inverseTransformDirection( normal, viewMatrix )"}return e.format(r,this.getType(e),t)},A.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.scope=e.scope,this},A.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},Le.addKeyword("normal",function(){return new A}),Le.addKeyword("worldNormal",function(){return new A(A.WORLD)}),S.prototype=Object.create(i.prototype),S.prototype.constructor=S,S.prototype.nodeType="BlinnShininessExponent",S.prototype.generate=function(e,t){return e.isCache("clearCoat")?e.format("Material_ClearCoat_BlinnShininessExponent( material )",this.type,t):e.format("Material_BlinnShininessExponent( material )",this.type,t)},M.prototype=Object.create(i.prototype),M.prototype.constructor=M,M.prototype.nodeType="BlinnExponentToRoughness",M.prototype.generate=function(e,t){return e.format("BlinnExponentToGGXRoughness( "+this.blinnExponent.build(e,"f")+" )",this.type,t)},M.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.blinnExponent=e.blinnExponent,this},M.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).blinnExponent=this.blinnExponent),t},L.prototype=Object.create(i.prototype),L.prototype.constructor=L,L.prototype.nodeType="TextureCube",L.prototype.generateTextureCubeUV=function(e,t){var r=t.uv.build(e)+".uv_10",n=t.uv.build(e)+".uv_20",i=t.uv.build(e)+".t",a="texture2D( "+this.value.build(e,"sampler2D")+", "+r+" )",o="texture2D( "+this.value.build(e,"sampler2D")+", "+n+" )",s={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(s),t.colorSpace10=t.colorSpace10||new x(new h("",c)),t.colorSpace10.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),t.colorSpace10.input.parse(a),a=t.colorSpace10.build(e,c),t.colorSpace20=t.colorSpace20||new x(new h("",c)),t.colorSpace20.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),t.colorSpace20.input.parse(o),o=t.colorSpace20.build(e,c),e.removeContext(),"mix( "+a+", "+o+", "+i+" ).rgb"},L.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=this.generateTextureCubeUV(e,this.radianceCache),n=this.generateTextureCubeUV(e,this.irradianceCache);return e.context.extra.irradiance=n,e.format("vec4( "+r+", 1.0 )",this.getType(e),t)}return console.warn("THREE.TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},L.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t};var Pe=Ce.elements,Fe=["float","vec2","vec3","vec4"],ke={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b"},De={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"};N.prototype={constructor:N,build:function(e,t){return this.buildShader("vertex",e),this.buildShader("fragment",t),this.requires.uv[0]&&(this.addVaryCode("varying vec2 vUv;"),this.addVertexFinalCode("vUv = uv;")),this.requires.uv[1]&&(this.addVaryCode("varying vec2 vUv2;"),this.addVertexParsCode("attribute vec2 uv2;"),this.addVertexFinalCode("vUv2 = uv2;")),this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = ( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz;")),this},buildShader:function(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")},setMaterial:function(e,t){return this.material=e,this.renderer=t,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this},addFlow:function(e,t,r){return this.addSlot(e).addCache(t).addContext(r)},removeFlow:function(){return this.removeSlot().removeCache().removeContext()},addCache:function(e){return this.cache=e||"",this.caches.push(this.cache),this},removeCache:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this},addContext:function(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this},removeContext:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this},addSlot:function(e){return this.slot=e||"",this.slots.push(this.slot),this},removeSlot:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this},addVertexCode:function(e){this.addCode(e,"vertex")},addFragmentCode:function(e){this.addCode(e,"fragment")},addCode:function(e,t){this.code[t||this.shader]+=e+"\n"},addVertexNodeCode:function(e){this.addNodeCode(e,"vertex")},addFragmentNodeCode:function(e){this.addNodeCode(e,"fragment")},addNodeCode:function(e,t){this.nodeCode[t||this.shader]+=e+"\n"},clearNodeCode:function(e){e=e||this.shader;var t=this.nodeCode[e];return this.nodeCode[e]="",t},clearVertexNodeCode:function(){return this.clearNodeCode("vertex")},clearFragmentNodeCode:function(){return this.clearNodeCode("fragment")},addVertexFinalCode:function(e){this.addFinalCode(e,"vertex")},addFragmentFinalCode:function(e){this.addFinalCode(e,"fragment")},addFinalCode:function(e,t){this.finalCode[t||this.shader]+=e+"\n"},addVertexParsCode:function(e){this.addParsCode(e,"vertex")},addFragmentParsCode:function(e){this.addParsCode(e,"fragment")},addParsCode:function(e,t){this.parsCode[t||this.shader]+=e+"\n"},addVaryCode:function(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)},isCache:function(e){return-1!==this.caches.indexOf(e)},isSlot:function(e){return-1!==this.slots.indexOf(e)},define:function(e,t){this.defines[e]=void 0===t?1:t},isDefined:function(e){return void 0!==this.defines[e]},getVar:function(e,t,r,n="varying",i="V",a=""){var o=this.getVars(n),s=o[e];if(!s){var c=o.length;s={name:r||"node"+i+c+(a?"_"+a:""),type:t},o.push(s),o[e]=s}return s},getTempVar:function(e,t,r,n){return this.getVar(e,t,r,this.shader,"T",n)},getAttribute:function(e,t){if(!this.attributes[e]){var r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]},getCode:function(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")},getVarListCode:function(e,t){t=t||"";for(var r="",n=0,i=e.length;n<i;++n){var a=e[n],o=a.type,s=a.name,c=this.getFormatByType(o);if(void 0===c)throw new Error("Node pars "+c+" not found.");r+=t+" "+c+" "+s+";\n"}return r},getVars:function(e){return this.inputs.vars[e||this.shader]},getNodeData:function(e){var t=e.isNode?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}},createUniform:function(e,t,r,n,i,a){var o=this.inputs.uniforms,s=o.list.length,c=new f({type:t,name:n||"nodeU"+s+(a?"_"+a:""),node:r,needsUpdate:i});return o.list.push(c),o[e].push(c),o[e][c.name]=c,this.uniforms[c.name]=c,c},createVertexUniform:function(e,t,r,n,i){return this.createUniform("vertex",e,t,r,n,i)},createFragmentUniform:function(e,t,r,n,i){return this.createUniform("fragment",e,t,r,n,i)},include:function(e,t,r){var n;if(e="string"==typeof e?Le.get(e):e,!1===this.context.include)return e.name;e instanceof l?n=this.includes.functions:e instanceof o?n=this.includes.consts:e instanceof c&&(n=this.includes.structs);var i=n[this.shader]=n[this.shader]||[];if(e){var a=i[e.name];if(a||(a=i[e.name]={node:e,deps:[]},i.push(a),a.src=e.build(this,"source")),e instanceof l&&t&&i[t.name]&&-1==i[t.name].deps.indexOf(e)&&(i[t.name].deps.push(e),e.includes&&e.includes.length)){var s=0;do{this.include(e.includes[s++],t)}while(s<e.includes.length)}return r&&(a.src=r),e.name}throw new Error("Include not found.")},colorToVectorProperties:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},colorToVector:function(e){return e.replace(/c/g,"v3")},getIncludes:function(e,t){return this.includes[e][t||this.shader]},getIncludesCode:function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,r){if(!(i=this.getIncludes(t,r)))return"";for(var n="",i=i.sort(e),a=0;a<i.length;a++)i[a].src&&(n+=i[a].src+"\n");return n}}(),getConstructorFromLength:function(e){return Fe[e-1]},isTypeMatrix:function(e){return/^m/.test(e)},getTypeLength:function(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))},getTypeFromLength:function(e){return 1===e?"f":"v"+e},findNode:function(){for(var e,t=0;t<arguments.length;t++)if(void 0!==(e=arguments[t])&&e.isNode)return e},resolve:function(){for(var e,t=0;t<arguments.length;t++)if(void 0!==(e=arguments[t])){if(e.isNode)return e;if(e.isTexture)switch(e.mapping){case Ee.s:case Ee.t:return new T(e);case Ee.w:case Ee.x:return new L(new w(e));default:return new w(e)}else{if(e.isVector2)return new m(e);if(e.isVector3)return new g(e);if(e.isVector4)return new v(e)}}},format:function(e,t,r){var n=this.colorToVector(r+" <- "+t);return"f <- v2"===n?e+".x":"f <- v3"===n?e+".x":"f <- v4"===n?e+".x":"f <- i"===n||"f <- b"===n?"float( "+e+" )":"v2 <- f"===n?"vec2( "+e+" )":"v2 <- v3"===n?e+".xy":"v2 <- v4"===n?e+".xy":"v2 <- i"===n||"v2 <- b"===n?"vec2( float( "+e+" ) )":"v3 <- f"===n?"vec3( "+e+" )":"v3 <- v2"===n?"vec3( "+e+", 0.0 )":"v3 <- v4"===n?e+".xyz":"v3 <- i"===n||"v3 <- b"===n?"vec2( float( "+e+" ) )":"v4 <- f"===n?"vec4( "+e+" )":"v4 <- v2"===n?"vec4( "+e+", 0.0, 1.0 )":"v4 <- v3"===n?"vec4( "+e+", 1.0 )":"v4 <- i"===n||"v4 <- b"===n?"vec4( float( "+e+" ) )":"i <- f"===n||"i <- b"===n?"int( "+e+" )":"i <- v2"===n?"int( "+e+".x )":"i <- v3"===n?"int( "+e+".x )":"i <- v4"===n?"int( "+e+".x )":"b <- f"===n?"( "+e+" != 0.0 )":"b <- v2"===n?"( "+e+" != vec2( 0.0 ) )":"b <- v3"===n?"( "+e+" != vec3( 0.0 ) )":"b <- v4"===n?"( "+e+" != vec4( 0.0 ) )":"b <- i"===n?"( "+e+" != 0 )":e},getTypeByFormat:function(e){return ke[e]||e},getFormatByType:function(e){return De[e]||e},getUuid:function(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e},getElementByIndex:function(e){return Pe[e]},getIndexByElement:function(e){return Pe.indexOf(e)},isShader:function(e){return this.shader===e},setShader:function(e){return this.shader=e,this},mergeDefines:function(e){for(var t in e)this.defines[t]=e[t];return this.defines},mergeUniform:function(e){for(var t in e)this.uniforms[t]=e[t];return this.uniforms},getTextureEncodingFromMap:function(e,t){var r;return t=void 0===t?this.context.gamma&&!!this.renderer&&this.renderer.gammaInput:t,e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=Ee.jb,r===Ee.jb&&t&&(r=Ee.Q),r}},R.prototype=Object.create(a.prototype),R.prototype.constructor=R,R.prototype.nodeType="Bool",R.prototype.generateReadonly=function(e,t,r,n){return e.format(this.value,n,t)},R.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value=e.value,this},R.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},C.prototype=Object.create(a.prototype),C.prototype.constructor=C,C.prototype.nodeType="Int",C.prototype.generateReadonly=function(e,t,r,n){return e.format(this.value,n,t)},C.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value=e.value,this},C.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.readonly&&(t.readonly=!0)),t},I.prototype=Object.create(a.prototype),I.prototype.constructor=I,I.prototype.nodeType="Color",Ce.addShortcuts(I.prototype,"value",["r","g","b"]),I.prototype.generateReadonly=function(e,t,r,n){return e.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",n,t)},I.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value.copy(e),this},I.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).r=this.r,t.g=this.g,t.b=this.b,!0===this.readonly&&(t.readonly=!0)),t},O.prototype=Object.create(a.prototype),O.prototype.constructor=O,O.prototype.nodeType="Matrix3",Object.defineProperties(O.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),O.prototype.generateReadonly=function(e,t,r,n){return e.format("mat3( "+this.value.elements.join(", ")+" )",n,t)},O.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.value.fromArray(e.elements),this},O.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},P.prototype=Object.create(a.prototype),P.prototype.constructor=P,P.prototype.nodeType="Matrix4",Object.defineProperties(P.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),P.prototype.generateReadonly=function(e,t,r,n){return e.format("mat4( "+this.value.elements.join(", ")+" )",n,t)},P.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.scope.value.fromArray(e.elements),this},P.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t},F.prototype=Object.create(w.prototype),F.prototype.constructor=F,F.prototype.nodeType="Screen",F.prototype.getUnique=function(){return!0},F.prototype.getTexture=function(e,t){return a.prototype.generate.call(this,e,t,this.getUuid(),"t","renderTexture")},k.LOCAL="local",k.WORLD="world",k.VIEW="view",k.PROJECTION="projection",k.prototype=Object.create(i.prototype),k.prototype.constructor=k,k.prototype.nodeType="Position",k.prototype.getType=function(){switch(this.scope){case k.PROJECTION:return"v4"}return this.type},k.prototype.getShared=function(){switch(this.scope){case k.LOCAL:case k.WORLD:return!1}return!0},k.prototype.generate=function(e,t){var r;switch(this.scope){case k.LOCAL:e.isShader("vertex")?r="transformed":(e.requires.position=!0,r="vPosition");break;case k.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,r="vWPosition";break;case k.VIEW:r=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case k.PROJECTION:r=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(r,this.getType(e),t)},k.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.scope=e.scope,this},k.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},Le.addKeyword("position",function(){return new k}),Le.addKeyword("worldPosition",function(){return new k(k.WORLD)}),Le.addKeyword("viewPosition",function(){return new k(k.VIEW)}),D.ADD="+",D.SUB="-",D.MUL="*",D.DIV="/",D.prototype=Object.create(i.prototype),D.prototype.constructor=D,D.prototype.nodeType="Operator",D.prototype.getType=function(e){var t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t},D.prototype.generate=function(e,t){var r=this.getType(e),n=this.a.build(e,r),i=this.b.build(e,r);return e.format("( "+n+" "+this.op+" "+i+" )",r,t)},D.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op,this},D.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op),t},U.prototype=Object.create(i.prototype),U.prototype.constructor=U,U.prototype.nodeType="Reflector",U.prototype.setMirror=function(e){this.mirror=e,this.textureMatrix=new P(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new k(k.LOCAL),this.uv=new D(this.textureMatrix,this.localPosition,D.MUL),this.uvResult=new D(null,this.uv,D.ADD),this.texture=new w(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)},U.prototype.generate=function(e,t){return e.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===t?this.texture.build(e,t):e.format(this.texture.build(e,this.type),this.type,t)):(console.warn("THREE.ReflectorNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.type,t))},U.prototype.copy=function(e){return a.prototype.copy.call(this,e),this.scope.mirror=e.mirror,this},U.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).mirror=this.mirror.uuid,this.offset&&(t.offset=this.offset.toJSON(e).uuid)),t},B.prototype=Object.create(a.prototype),B.prototype.constructor=B,B.prototype.nodeType="Property",Object.defineProperties(B.prototype,{value:{get:function(){return this.object[this.property]},set:function(e){this.object[this.property]=e}}}),B.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,t.property=this.property),t},z.prototype=Object.create(n.prototype),z.prototype.constructor=z,z.prototype.nodeType="Raw",z.prototype.generate=function(e){var t=this.value.analyzeAndFlow(e,this.type),r=t.code+"\n";return r+=e.isShader("vertex")?"gl_Position = "+t.result+";":"gl_FragColor = "+t.result+";"},z.prototype.copy=function(e){return n.prototype.copy.call(this,e),this.value=e.value,this},z.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t},G.prototype=Object.create(Ee.pc.prototype),G.prototype.constructor=G,G.prototype.type="NodeMaterial",G.prototype.isNodeMaterial=!0,Object.defineProperties(G.prototype,{properties:{get:function(){return this.fragment.properties}},needsUpdate:{set:function(e){this.needsCompile=e},get:function(){return this.needsCompile}}}),G.prototype.updateFrame=function(e){for(var t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])},G.prototype.build=function(e){var t=(e=e||{}).builder||new N;return t.setMaterial(this,e.renderer),t.build(this.vertex,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters,this.fog=t.requires.fog,this.lights=t.requires.lights,this.transparent=t.requires.transparent||this.blending>Ee.Ib,this.needsUpdate=!1,this},G.prototype.copy=function(e){var t=this.uuid;for(var r in e)this[r]=e[r];return this.uuid=t,void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this},G.prototype.toJSON=function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.materials&&(e.materials={}),!e.materials[this.uuid]){var t={};t.uuid=this.uuid,t.type=this.type,e.materials[t.uuid]=t,""!==this.name&&(t.name=this.name),void 0!==this.size&&(t.size=this.size),void 0!==this.sizeAttenuation&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==Ee.Ib&&(t.blending=this.blending),!0===this.flatShading&&(t.flatShading=this.flatShading),this.side!==Ee.P&&(t.side=this.side),this.vertexColors!==Ee.Hb&&(t.vertexColors=this.vertexColors),this.depthFunc!==Ee.eb&&(t.depthFunc=this.depthFunc),!1===this.depthTest&&(t.depthTest=this.depthTest),!1===this.depthWrite&&(t.depthWrite=this.depthWrite),1!==this.linewidth&&(t.linewidth=this.linewidth),void 0!==this.dashSize&&(t.dashSize=this.dashSize),void 0!==this.gapSize&&(t.gapSize=this.gapSize),void 0!==this.scale&&(t.scale=this.scale),!0===this.dithering&&(t.dithering=!0),!0===this.wireframe&&(t.wireframe=this.wireframe),1<this.wireframeLinewidth&&(t.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(t.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(t.wireframeLinejoin=this.wireframeLinejoin),0<this.alphaTest&&(t.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(t.premultipliedAlpha=this.premultipliedAlpha),!0===this.morphTargets&&(t.morphTargets=!0),!0===this.skinning&&(t.skinning=!0),!1===this.visible&&(t.visible=!1),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.fog=this.fog,t.lights=this.lights,t.vertex=this.vertex.toJSON(e).uuid,t.fragment=this.fragment.toJSON(e).uuid}return e.material=this.uuid,e},j.prototype=Object.create(w.prototype),j.prototype.constructor=j,j.prototype.nodeType="RTT",j.prototype.build=function(e,t,r){var n=new N;return n.nodes=e.nodes,n.updaters=e.updaters,this.material.fragment.value=this.input,this.material.build({builder:n}),w.prototype.build.call(this,e,t,r)},j.prototype.updateFramesaveTo=function(e){if(this.saveTo.render=!1,this.saveTo!==this.saveToCurrent){this.saveToMaterial&&this.saveToMaterial.dispose();var t=new G;t.fragment.value=this,t.build();var r=new Ee.nc,n=new Ee.vb(new Ee.Qb(2,2),t);n.frustumCulled=!1,r.add(n),this.saveToScene=r,this.saveToMaterial=t}this.saveToCurrent=this.saveTo,e.renderer.setRenderTarget(this.saveTo.renderTarget),this.saveTo.clear&&e.renderer.clear(),e.renderer.render(this.saveToScene,this.camera)},j.prototype.updateFrame=function(e){e.renderer?(this.saveTo&&!1===this.saveTo.render&&this.updateFramesaveTo(e),this.render&&(this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=e.renderTexture),e.renderer.setRenderTarget(this.renderTarget),this.clear&&e.renderer.clear(),e.renderer.render(this.scene,this.camera)),this.saveTo&&!0===this.saveTo.render&&this.updateFramesaveTo(e)):console.warn("RTTNode need a renderer in NodeFrame")},j.prototype.copy=function(e){return w.prototype.copy.call(this,e),this.saveTo=e.saveTo,this},j.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=w.prototype.toJSON.call(this,e),this.saveTo&&(t.saveTo=this.saveTo.toJSON(e).uuid)),t};var Ue=["color","color2"],Be=["vColor","vColor2"];V.prototype=Object.create(i.prototype),V.prototype.constructor=V,V.prototype.nodeType="Colors",V.prototype.generate=function(e,t){e.requires.color[this.index]=!0;var r=e.isShader("vertex")?Ue[this.index]:Be[this.index];return e.format(r,this.getType(e),t)},V.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.index=e.index,this},V.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t},H.Nodes={depthColor:new l("float depthColor( float mNear, float mFar ) {\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\treturn 1.0 - smoothstep( mNear, mFar, depth );\n}")},H.POSITION="position",H.DEPTH="depth",H.TO_VERTEX="toVertex",H.prototype=Object.create(i.prototype),H.prototype.constructor=H,H.prototype.nodeType="Camera",H.prototype.setCamera=function(e){this.camera=e,this.updateFrame=void 0===e?void 0:this.onUpdateFrame},H.prototype.setScope=function(e){switch(this.scope){case H.DEPTH:delete this.near,delete this.far}switch(this.scope=e,e){case H.DEPTH:var t=this.camera;this.near=new b(t?t.near:1),this.far=new b(t?t.far:1200)}},H.prototype.getType=function(){switch(this.scope){case H.DEPTH:return"f"}return this.type},H.prototype.getUnique=function(){switch(this.scope){case H.DEPTH:case H.TO_VERTEX:return!0}return!1},H.prototype.getShared=function(){switch(this.scope){case H.POSITION:return!1}return!0},H.prototype.generate=function(e,t){var r;switch(this.scope){case H.POSITION:r="cameraPosition";break;case H.DEPTH:r=e.include(H.Nodes.depthColor)+"( "+this.near.build(e,"f")+", "+this.far.build(e,"f")+" )";break;case H.TO_VERTEX:r="normalize( "+new k(k.WORLD).build(e,"v3")+" - cameraPosition )"}return e.format(r,this.getType(e),t)},H.prototype.onUpdateFrame=function(){switch(this.scope){case H.DEPTH:var e=this.camera;this.near.value=e.near,this.far.value=e.far}},H.prototype.copy=function(e){switch(i.prototype.copy.call(this,e),this.setScope(e.scope),e.camera&&this.setCamera(e.camera),e.scope){case H.DEPTH:this.near.number=e.near,this.far.number=e.far}return this},H.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t)switch(t=this.createJSONNode(e),t.scope=this.scope,this.camera&&(t.camera=this.camera.uuid),this.scope){case H.DEPTH:t.near=this.near.value,t.far=this.far.value}return t},W.TOTAL="total",W.prototype=Object.create(i.prototype),W.prototype.constructor=W,W.prototype.nodeType="Light",W.prototype.generate=function(e,t){return e.isCache("light")?e.format("reflectedLight.directDiffuse",this.type,t):(console.warn('THREE.LightNode is only compatible in "light" channel.'),e.format("vec3( 0.0 )",this.type,t))},W.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.scope=e.scope,this},W.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t},J.prototype=Object.create(m.prototype),J.prototype.constructor=J,J.prototype.nodeType="Resolution",J.prototype.updateFrame=function(e){if(e.renderer){e.renderer.getSize(this.size);var t=e.renderer.getPixelRatio();this.x=this.size.width*t,this.y=this.size.height*t}else console.warn("ResolutionNode need a renderer in NodeFrame")},J.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.renderer=e.renderer,this},J.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).renderer=this.renderer.uuid),t},X.prototype=Object.create(i.prototype),X.prototype.constructor=X,X.prototype.nodeType="ScreenUV",X.prototype.generate=function(e,t){var r;return e.isShader("fragment")?r="( gl_FragCoord.xy / "+this.resolution.build(e,"v2")+")":(console.warn("THREE.ScreenUVNode is not compatible with "+e.shader+" shader."),r="vec2( 0.0 )"),e.format(r,this.getType(e),t)},X.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.resolution=e.resolution,this},X.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).resolution=this.resolution.toJSON(e).uuid),t},Y.RAD="radians",Y.DEG="degrees",Y.EXP="exp",Y.EXP2="exp2",Y.LOG="log",Y.LOG2="log2",Y.SQRT="sqrt",Y.INV_SQRT="inversesqrt",Y.FLOOR="floor",Y.CEIL="ceil",Y.NORMALIZE="normalize",Y.FRACT="fract",Y.SATURATE="saturate",Y.SIN="sin",Y.COS="cos",Y.TAN="tan",Y.ASIN="asin",Y.ACOS="acos",Y.ARCTAN="atan",Y.ABS="abs",Y.SIGN="sign",Y.LENGTH="length",Y.NEGATE="negate",Y.INVERT="invert",Y.MIN="min",Y.MAX="max",Y.MOD="mod",Y.STEP="step",Y.REFLECT="reflect",Y.DISTANCE="distance",Y.DOT="dot",Y.CROSS="cross",Y.POW="pow",Y.MIX="mix",Y.CLAMP="clamp",Y.REFRACT="refract",Y.SMOOTHSTEP="smoothstep",Y.FACEFORWARD="faceforward",Y.prototype=Object.create(i.prototype),Y.prototype.constructor=Y,Y.prototype.nodeType="Math",Y.prototype.getNumInputs=function(){switch(this.method){case Y.MIX:case Y.CLAMP:case Y.REFRACT:case Y.SMOOTHSTEP:case Y.FACEFORWARD:return 3;case Y.MIN:case Y.MAX:case Y.MOD:case Y.STEP:case Y.REFLECT:case Y.DISTANCE:case Y.DOT:case Y.CROSS:case Y.POW:return 2;default:return 1}},Y.prototype.getInputType=function(e){var t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,n=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>n?this.a.getType(e):r>n?this.b.getType(e):this.c.getType(e)},Y.prototype.getType=function(e){switch(this.method){case Y.LENGTH:case Y.DISTANCE:case Y.DOT:return"f";case Y.CROSS:return"v3"}return this.getInputType(e)},Y.prototype.generate=function(e,t){var r,n,i,a=this.a?e.getTypeLength(this.a.getType(e)):0,o=this.b?e.getTypeLength(this.b.getType(e)):0,s=this.c?e.getTypeLength(this.c.getType(e)):0,c=this.getInputType(e),u=this.getType(e);switch(this.method){case Y.NEGATE:return e.format("( -"+this.a.build(e,c)+" )",c,t);case Y.INVERT:return e.format("( 1.0 - "+this.a.build(e,c)+" )",c,t);case Y.CROSS:r=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case Y.STEP:r=this.a.build(e,1===a?"f":c),n=this.b.build(e,c);break;case Y.MIN:case Y.MAX:case Y.MOD:r=this.a.build(e,c),n=this.b.build(e,1===o?"f":c);break;case Y.REFRACT:r=this.a.build(e,c),n=this.b.build(e,c),i=this.c.build(e,"f");break;case Y.MIX:r=this.a.build(e,c),n=this.b.build(e,c),i=this.c.build(e,1===s?"f":c);break;default:r=this.a.build(e,c),this.b&&(n=this.b.build(e,c)),this.c&&(i=this.c.build(e,c))}var l=[];l.push(r),n&&l.push(n),i&&l.push(i);var h=this.getNumInputs(e);if(l.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${l.length}.`);return e.format(this.method+"( "+l.join(", ")+" )",u,t)},Y.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.c=e.c,this.method=e.method,this},Y.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,this.b&&(t.b=this.b.toJSON(e).uuid),this.c&&(t.c=this.c.toJSON(e).uuid),t.method=this.method),t},q.EQUAL="==",q.NOT_EQUAL="!=",q.GREATER=">",q.GREATER_EQUAL=">=",q.LESS="<",q.LESS_EQUAL="<=",q.prototype=Object.create(i.prototype),q.prototype.constructor=q,q.prototype.nodeType="Cond",q.prototype.getType=function(e){if(this.ifNode){var t=this.ifNode.getType(e),r=this.elseNode.getType(e);return e.getTypeLength(r)>e.getTypeLength(t)?r:t}return"b"},q.prototype.getCondType=function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)},q.prototype.generate=function(e,t){var r,n=this.getType(e),i=this.getCondType(e),a=this.a.build(e,i),o=this.b.build(e,i);if(this.ifNode){var s=this.ifNode.build(e,n),c=this.elseNode.build(e,n);r="( "+[a,this.op,o,"?",s,":",c].join(" ")+" )"}else r="( "+a+" "+this.op+" "+o+" )";return e.format(r,this.getType(e),t)},q.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.a=e.a,this.b=e.b,this.op=e.op,this.ifNode=e.ifNode,this.elseNode=e.elseNode,this},q.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op,t.ifNode&&(t.ifNode=this.ifNode.toJSON(e).uuid),t.elseNode&&(t.elseNode=this.elseNode.toJSON(e).uuid)),t},K.prototype=Object.create(i.prototype),K.prototype.constructor=K,K.prototype.nodeType="Noise",K.Nodes={snoise:new l("float snoise(vec2 co) {\n\treturn fract( sin( dot( co.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );\n}")},K.prototype.generate=function(e,t){var r=e.include(K.Nodes.snoise);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},K.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.uv=e.uv,this},K.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},Z.prototype=Object.create(i.prototype),Z.prototype.constructor=Z,Z.prototype.nodeType="Noise",Z.Nodes={checker:new l("float checker( vec2 uv ) {\n\tfloat cx = floor( uv.x );\n\tfloat cy = floor( uv.y ); \n\tfloat result = mod( cx + cy, 2.0 );\n\treturn sign( result );\n}")},Z.prototype.generate=function(e,t){var r=e.include(Z.Nodes.checker);return e.format(r+"( "+this.uv.build(e,"v2")+" )",this.getType(e),t)},Z.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.uv=e.uv,this},Z.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid),t},Q.prototype=Object.create(b.prototype),Q.prototype.constructor=Q,Q.prototype.nodeType="MaxMIPLevel",Object.defineProperties(Q.prototype,{value:{get:function(){if(0===this.maxMIPLevel){var e=this.texture.value.image?this.texture.value.image[0]:void 0;this.maxMIPLevel=void 0===e?0:Math.log(_e(e.width,e.height))*Math.LOG2E}return this.maxMIPLevel},set:function(){}}}),Q.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture.uuid),t},$.Nodes={getSpecularMIPLevel:new l("float getSpecularMIPLevel( const in float blinnShininessExponent, const in float maxMIPLevelScalar ) {\n\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n}")},$.prototype=Object.create(i.prototype),$.prototype.constructor=$,$.prototype.nodeType="RoughnessToBlinnExponent",$.prototype.generate=function(e,t){if(e.isShader("fragment")){this.maxMIPLevel.texture=this.texture;var r=e.include($.Nodes.getSpecularMIPLevel);return e.format(r+"( "+this.blinnShininessExponent.build(e,"f")+", "+this.maxMIPLevel.build(e,"f")+" )",this.type,t)}return console.warn("THREE.RoughnessToBlinnExponentNode is not compatible with "+e.shader+" shader."),e.format("0.0",this.type,t)},$.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.texture=e.texture,this},$.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture),t},ee.Nodes={perturbNormal2Arb:new l("vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 normalScale ) {\n\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\tvec2 st0 = dFdx( mUv.st );\n\tvec2 st1 = dFdy( mUv.st );\n\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\tvec3 N = normalize( surf_norm );\n\tmat3 tsn = mat3( S, T, N );\n\tvec3 mapN = map * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\treturn normalize( tsn * mapN );\n}",null,{derivatives:!0})},ee.prototype=Object.create(i.prototype),ee.prototype.constructor=ee,ee.prototype.nodeType="NormalMap",ee.prototype.generate=function(e,t){if(e.isShader("fragment")){var r=e.include(ee.Nodes.perturbNormal2Arb);return this.normal=this.normal||new A,this.position=this.position||new k(k.VIEW),this.uv=this.uv||new y,e.format(r+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+this.value.build(e,"v3")+", "+this.uv.build(e,"v2")+", "+this.scale.build(e,"v2")+" )",this.getType(e),t)}return console.warn("THREE.NormalMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},ee.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale,this},ee.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},te.Nodes=function(){var e=new l("vec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {\n\tvec2 dSTdx = dFdx( vUv );\n\tvec2 dSTdy = dFdy( vUv );\n\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\treturn vec2( dBx, dBy );\n}",null,{derivatives:!0});return{dHdxy_fwd:e,perturbNormalArb:new l("vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\tvec3 vN = surf_norm;\n\tvec3 R1 = cross( vSigmaY, vN );\n\tvec3 R2 = cross( vN, vSigmaX );\n\tfloat fDet = dot( vSigmaX, R1 );\n\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n}",[e],{derivatives:!0}),bumpToNormal:new l("vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {\n\tvec2 dSTdx = dFdx( uv );\n\tvec2 dSTdy = dFdy( uv );\n\tfloat Hll = texture2D( bumpMap, uv ).x;\n\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;\n\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;\n\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );\n}",null,{derivatives:!0})}}(),te.prototype=Object.create(i.prototype),te.prototype.constructor=te,te.prototype.nodeType="BumpMap",te.prototype.generate=function(e,t){if(e.isShader("fragment")){if(this.toNormalMap){var r=e.include(te.Nodes.bumpToNormal);return e.format(r+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )",this.getType(e),t)}var n=e.include(te.Nodes.dHdxy_fwd),i=e.include(te.Nodes.perturbNormalArb);this.normal=this.normal||new A,this.position=this.position||new k(k.VIEW);var a=n+"( "+this.value.build(e,"sampler2D")+", "+this.value.uv.build(e,"v2")+", "+this.scale.build(e,"f")+" )";return e.format(i+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+a+" )",this.getType(e),t)}return console.warn("THREE.BumpMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)},te.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.value=e.value,this.scale=e.scale,this},te.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid),t},re.prototype=Object.create(n.prototype),re.prototype.constructor=re,re.prototype.nodeType="Bypass",re.prototype.getType=function(e){return this.value?this.value.getType(e):e.isShader("fragment")?"f":"void"},re.prototype.generate=function(e,t){var r=this.code.build(e,t)+";";return e.addNodeCode(r),e.isShader("vertex")?this.value?this.value.build(e,t):void 0:this.value?this.value.build(e,t):e.format("0.0","f",t)},re.prototype.copy=function(e){return n.prototype.copy.call(this,e),this.code=e.code,this.value=e.value,this},re.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).code=this.code.toJSON(e).uuid,this.value&&(t.value=this.value.toJSON(e).uuid)),t};var ze=Ce.elements;ne.prototype=Object.create(i.prototype),ne.prototype.constructor=ne,ne.prototype.nodeType="Join",ne.prototype.getNumElements=function(){for(var e=ze.length;e--;)if(void 0!==this[ze[e]]){++e;break}return _e(e,2)},ne.prototype.getType=function(e){return e.getTypeFromLength(this.getNumElements())},ne.prototype.generate=function(e,t){for(var r,n=this.getType(e),i=this.getNumElements(),a=[],o=0;o<i;o++)r=this[ze[o]],a.push(r?r.build(e,"f"):"0.0");var s=(1<i?e.getConstructorFromLength(i):"")+"( "+a.join(", ")+" )";return e.format(s,n,t)},ne.prototype.copy=function(e){for(var t in i.prototype.copy.call(this,e),e.inputs)this[t]=e.inputs[t];return this},ne.prototype.toJSON=function(e){var t=this.getJSONNode(e);if(!t){(t=this.createJSONNode(e)).inputs={};for(var r,n=this.getNumElements(),i=0;i<n;i++)(r=this[ze[i]])&&(t.inputs[ze[i]]=r.toJSON(e).uuid)}return t},ie.prototype=Object.create(n.prototype),ie.prototype.constructor=ie,ie.prototype.nodeType="Switch",ie.prototype.getType=function(e){return e.getTypeFromLength(this.components.length)},ie.prototype.generate=function(e,t){var r=this.node.getType(e),n=this.node.build(e,r),i=e.getTypeLength(r)-1;if(0<i){var a,o=0,s=e.colorToVectorProperties(this.components),c=s.length;for(a=0;a<c;a++)o=_e(o,e.getIndexByElement(s.charAt(a)));for(o>i&&(o=i),n+=".",a=0;a<c;a++){s.charAt(a);var u=e.getIndexByElement(s.charAt(a));u>o&&(u=o),n+=e.getElementByIndex(u)}return e.format(n,this.getType(e),t)}return e.format(n,r,t)},ie.prototype.copy=function(e){return n.prototype.copy.call(this,e),this.node=e.node,this.components=e.components,this},ie.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).node=this.node.toJSON(e).uuid,t.components=this.components),t},ae.GLOBAL="global",ae.LOCAL="local",ae.DELTA="delta",ae.prototype=Object.create(b.prototype),ae.prototype.constructor=ae,ae.prototype.nodeType="Timer",ae.prototype.getReadonly=function(){return!1},ae.prototype.getUnique=function(){return this.timeScale&&(this.scope===ae.GLOBAL||this.scope===ae.DELTA)},ae.prototype.updateFrame=function(e){var t=this.timeScale?this.scale:1;switch(this.scope){case ae.LOCAL:this.value+=e.delta*t;break;case ae.DELTA:this.value=e.delta*t;break;default:this.value=e.time*t}},ae.prototype.copy=function(e){return b.prototype.copy.call(this,e),this.scope=e.scope,this.scale=e.scale,this.timeScale=e.timeScale,this},ae.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope,t.scale=this.scale,t.timeScale=this.timeScale),t},Le.addKeyword("time",function(){return new ae}),oe.prototype=Object.create(g.prototype),oe.prototype.constructor=oe,oe.prototype.nodeType="Velocity",oe.prototype.getReadonly=function(){return!1},oe.prototype.setParams=function(e){switch(this.params.type){case"elastic":delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity}switch(this.params=e||{},this.params.type){case"elastic":this.moment=new Ee.Jc,this.speed=new Ee.Jc,this.springVelocity=new Ee.Jc,this.lastVelocity=new Ee.Jc}},oe.prototype.setTarget=function(e){this.target&&(delete this.position,delete this.oldPosition),this.target=e,e&&(this.position=e.getWorldPosition(this.position||new Ee.Jc),this.oldPosition=this.position.clone())},oe.prototype.updateFrameVelocity=function(){this.target&&(this.position=this.target.getWorldPosition(this.position||new Ee.Jc),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},oe.prototype.updateFrame=function(e){switch(this.updateFrameVelocity(e),this.params.type){case"elastic":var t=e.delta*(this.params.fps||60),r=we(this.params.spring,t),n=we(this.params.damping,t);this.velocity.multiplyScalar(Math.exp(-this.params.damping*t)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(n).multiplyScalar(1-r)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(r),this.moment.add(this.springVelocity),this.moment.multiplyScalar(n),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment);break;default:this.value.copy(this.velocity)}},oe.prototype.copy=function(e){return g.prototype.copy.call(this,e),e.target&&this.setTarget(e.target),this.setParams(e.params),this},oe.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.target&&(t.target=this.target.uuid),t.params=JSON.parse(JSON.stringify(this.params))),t},se.prototype=Object.create(h.prototype),se.prototype.constructor=se,se.prototype.nodeType="UVTransform",se.prototype.generate=function(e,t){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.position,h.prototype.generate.call(this,e,t)},se.prototype.setUvTransform=function(e,t,r,n,i,a,o){a=void 0===a?.5:a,o=void 0===o?.5:o,this.position.value.setUvTransform(e,t,r,n,i,a,o)},se.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.uv=e.uv,this.position=e.position,this},se.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).uv=this.uv.toJSON(e).uuid,t.position=this.position.toJSON(e).uuid),t},ce.Nodes={blurX:new l("vec4 blurX( sampler2D texture, vec2 uv, float s ) {\n\tvec4 sum = vec4( 0.0 );\n\tsum += texture2D( texture, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;\n\tsum += texture2D( texture, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;\n\tsum += texture2D( texture, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;\n\tsum += texture2D( texture, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;\n\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;\n\tsum += texture2D( texture, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;\n\tsum += texture2D( texture, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;\n\tsum += texture2D( texture, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;\n\tsum += texture2D( texture, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;\n\treturn sum * .667;\n}"),blurY:new l("vec4 blurY( sampler2D texture, vec2 uv, float s ) {\n\tvec4 sum = vec4( 0.0 );\n\tsum += texture2D( texture, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;\n\tsum += texture2D( texture, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;\n\tsum += texture2D( texture, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;\n\tsum += texture2D( texture, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;\n\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;\n\tsum += texture2D( texture, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;\n\tsum += texture2D( texture, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;\n\tsum += texture2D( texture, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;\n\tsum += texture2D( texture, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;\n\treturn sum * .667;\n}")},ce.prototype=Object.create(i.prototype),ce.prototype.constructor=ce,ce.prototype.nodeType="Blur",ce.prototype.updateFrame=function(){if(this.size)this.horizontal.value=this.radius.x/this.size.x,this.vertical.value=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var e=this.value.value.image;this.horizontal.value=this.radius.x/e.width,this.vertical.value=this.radius.y/e.height}},ce.prototype.generate=function(e,t){if(e.isShader("fragment")){var r,n=[],i=e.include(ce.Nodes.blurX),a=e.include(ce.Nodes.blurY);return this.blurX&&n.push(i+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.horizontal.build(e,"f")+" )"),this.blurY&&n.push(a+"( "+this.value.build(e,"sampler2D")+", "+this.uv.build(e,"v2")+", "+this.vertical.build(e,"f")+" )"),r=2==n.length?"( "+n.join(" + ")+" / 2.0 )":n.length?"( "+n[0]+" )":"vec4( 0.0 )",e.format(r,this.getType(e),t)}return console.warn("THREE.BlurNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)},ce.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.value=e.value,this.uv=e.uv,this.radius=e.radius,void 0!==e.size&&(this.size=new Ee.Ic(e.size.x,e.size.y)),this.blurX=e.blurX,this.blurY=e.blurY,this},ce.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.uv=this.uv.toJSON(e).uuid,t.radius=this.radius.toJSON(e).uuid,this.size&&(t.size={x:this.size.x,y:this.size.y}),t.blurX=this.blurX,t.blurY=this.blurY),t},ue.Nodes=function(){var e=new o("vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )");return{LUMA:e,luminance:new l("float luminance( vec3 rgb ) {\n\treturn dot( rgb, LUMA );\n}",[e])}}(),ue.prototype=Object.create(i.prototype),ue.prototype.constructor=ue,ue.prototype.nodeType="Luminance",ue.prototype.generate=function(e,t){var r=e.include(ue.Nodes.luminance);return e.format(r+"( "+this.rgb.build(e,"v3")+" )",this.getType(e),t)},ue.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.rgb=e.rgb,this},ue.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid),t},le.Nodes={hue:new l("vec3 hue(vec3 rgb, float adjustment) {\n\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);\n\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);\n\tvec3 yiq = RGBtoYIQ * rgb;\n\tfloat hue = atan(yiq.z, yiq.y) + adjustment;\n\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\n\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\n}"),saturation:new l("vec3 saturation(vec3 rgb, float adjustment) {\n\tvec3 intensity = vec3( luminance( rgb ) );\n\treturn mix( intensity, rgb, adjustment );\n}",[ue.Nodes.luminance]),vibrance:new l("vec3 vibrance(vec3 rgb, float adjustment) {\n\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;\n\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));\n\tfloat amt = (mx - average) * (-3.0 * adjustment);\n\treturn mix(rgb.rgb, vec3(mx), amt);\n}")},le.SATURATION="saturation",le.HUE="hue",le.VIBRANCE="vibrance",le.BRIGHTNESS="brightness",le.CONTRAST="contrast",le.prototype=Object.create(i.prototype),le.prototype.constructor=le,le.prototype.nodeType="ColorAdjustment",le.prototype.generate=function(e,t){var r=this.rgb.build(e,"v3"),n=this.adjustment.build(e,"f");switch(this.method){case le.BRIGHTNESS:return e.format("( "+r+" + "+n+" )",this.getType(e),t);case le.CONTRAST:return e.format("( "+r+" * "+n+" )",this.getType(e),t)}var i=e.include(le.Nodes[this.method]);return e.format(i+"( "+r+", "+n+" )",this.getType(e),t)},le.prototype.copy=function(e){return i.prototype.copy.call(this,e),this.rgb=e.rgb,this.adjustment=e.adjustment,this.method=e.method,this},le.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).rgb=this.rgb.toJSON(e).uuid,t.adjustment=this.adjustment.toJSON(e).uuid,t.method=this.method),t},he.prototype=Object.create(n.prototype),he.prototype.constructor=he,he.prototype.nodeType="Sprite",he.prototype.build=function(e){if(e.define("SPRITE"),e.requires.lights=!1,e.requires.transparent=void 0!==this.alpha,e.isShader("vertex")){var t=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Ee.Gc.merge([Ee.Fc.fog])),e.addParsCode("#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>"),a=["#include <clipping_planes_fragment>","#include <begin_vertex>"],t&&a.push(t.code,t.result?"transformed = "+t.result+";":""),a.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||a.push("modelMtx[1][1] = 1.0;"),a.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&a.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),a.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>")}else{e.addParsCode("#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>"),e.addCode("#include <clipping_planes_fragment>\n#include <logdepthbuf_fragment>"),this.mask&&this.mask.analyze(e),this.alpha&&this.alpha.analyze(e),this.color.analyze(e,{slot:"color"});var r=this.mask?this.mask.flow(e,"b"):void 0,n=this.alpha?this.alpha.flow(e,"f"):void 0,i=this.color.flow(e,"c",{slot:"color"}),a=[];r&&a.push(r.code,"if ( ! "+r.result+" ) discard;"),n?a.push(n.code,"#ifdef ALPHATEST","if ( "+n.result+" <= ALPHATEST ) discard;","#endif",i.code,"gl_FragColor = vec4( "+i.result+", "+n.result+" );"):a.push(i.code,"gl_FragColor = vec4( "+i.result+", 1.0 );"),a.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>")}return a.join("\n")},he.prototype.copy=function(e){return n.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,void 0!==e.spherical&&(this.spherical=e.spherical),e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),this},he.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,!1===this.spherical&&(t.spherical=!1),this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid)),t},pe.prototype=Object.create(n.prototype),pe.prototype.constructor=pe,pe.prototype.nodeType="Phong",pe.prototype.build=function(e){var t;if(e.define("PHONG"),e.requires.lights=!0,e.isShader("vertex")){var r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Ee.Gc.merge([Ee.Fc.fog,Ee.Fc.lights])),e.addParsCode("varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>");var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),t=n.join("\n")}else{this.mask&&this.mask.analyze(e),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&this.environment.analyze(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(e);var i=this.mask?this.mask.flow(e,"b"):void 0,a=this.color.flow(e,"c",{slot:"color"}),o=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.normal?this.normal.flow(e,"v3"):void 0,l=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,h=this.ao?this.ao.flow(e,"f"):void 0,p=this.ambient?this.ambient.flow(e,"c"):void 0,d=this.shadow?this.shadow.flow(e,"c"):void 0,f=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0,m=this.environment?this.environment.flow(e,"c",{slot:"environment"}):void 0,g=this.environmentAlpha&&this.environment?this.environmentAlpha.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode("#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>");n=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;"];i&&n.push(i.code,"if ( ! "+i.result+" ) discard;"),n.push(a.code,"\tvec3 diffuseColor = "+a.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",o.code,"\tvec3 specular = "+o.result+";",s.code,"\tfloat shininess = max( 0.0001, "+s.result+" );","\tfloat specularStrength = 1.0;"),c&&n.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u&&n.push(u.code,"normal = "+u.result+";"),n.push("material.diffuseColor = "+(l?"vec3( 1.0 )":"diffuseColor")+";"),n.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),l&&(n.push(l.code,"reflectedLight.directDiffuse = "+l.result+";"),n.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),h&&n.push(h.code,"reflectedLight.indirectDiffuse *= "+h.result+";"),p&&n.push(p.code,"reflectedLight.indirectDiffuse += "+p.result+";"),d&&n.push(d.code,"reflectedLight.directDiffuse *= "+d.result+";","reflectedLight.directSpecular *= "+d.result+";"),f&&n.push(f.code,"reflectedLight.directDiffuse += "+f.result+";"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),m&&(n.push(m.code),g?n.push(g.code,"outgoingLight = mix( outgoingLight, "+m.result+", "+g.result+" );"):n.push("outgoingLight = "+m.result+";")),c?n.push("gl_FragColor = vec4( outgoingLight, "+c.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),t=n.join("\n")}return t},pe.prototype.copy=function(e){return n.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.specular=e.specular,this.shininess=e.shininess,e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha),this},pe.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t},de.prototype=Object.create(n.prototype),de.prototype.constructor=de,de.prototype.nodeType="Standard",de.prototype.build=function(e){var t;if(e.define(this.clearCoat||this.clearCoatRoughness?"PHYSICAL":"STANDARD"),e.requires.lights=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){var r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Ee.Gc.merge([Ee.Fc.fog,Ee.Fc.lights])),Ee.Fc.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode("varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>");var n=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),t=n.join("\n")}else{var i={bias:$,gamma:!0},a={gamma:!0},o=!e.isDefined("STANDARD");this.mask&&this.mask.analyze(e),this.color.analyze(e,{slot:"color",context:a}),this.roughness.analyze(e),this.metalness.analyze(e),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.clearCoat&&this.clearCoat.analyze(e),this.clearCoatRoughness&&this.clearCoatRoughness.analyze(e),this.reflectivity&&this.reflectivity.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&this.environment.analyze(e,{cache:"env",context:i,slot:"environment"});var s=this.mask?this.mask.flow(e,"b"):void 0,c=this.color.flow(e,"c",{slot:"color",context:a}),u=this.roughness.flow(e,"f"),l=this.metalness.flow(e,"f"),h=this.alpha?this.alpha.flow(e,"f"):void 0,p=this.normal?this.normal.flow(e,"v3"):void 0,d=this.clearCoat?this.clearCoat.flow(e,"f"):void 0,f=this.clearCoatRoughness?this.clearCoatRoughness.flow(e,"f"):void 0,m=this.reflectivity?this.reflectivity.flow(e,"f"):void 0,g=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,v=this.ao?this.ao.flow(e,"f"):void 0,y=this.ambient?this.ambient.flow(e,"c"):void 0,b=this.shadow?this.shadow.flow(e,"c"):void 0,x=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0,w=this.environment?this.environment.flow(e,"c",{cache:"env",context:i,slot:"environment"}):void 0,_=o&&w?this.environment.flow(e,"c",{cache:"clearCoat",context:i,slot:"environment"}):void 0;e.requires.transparent=void 0!==h,e.addParsCode("varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <dithering_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>");n=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];s&&n.push(s.code,"if ( ! "+s.result+" ) discard;"),n.push(c.code,"\tvec3 diffuseColor = "+c.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",u.code,"\tfloat roughnessFactor = "+u.result+";",l.code,"\tfloat metalnessFactor = "+l.result+";"),h&&n.push(h.code,"#ifdef ALPHATEST","\tif ( "+h.result+" <= ALPHATEST ) discard;","#endif"),p&&n.push(p.code,"normal = "+p.result+";"),n.push("material.diffuseColor = "+(g?"vec3( 1.0 )":"diffuseColor * (1.0 - metalnessFactor)")+";","material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?n.push(d.code,"material.clearCoat = saturate( "+d.result+" );"):o&&n.push("material.clearCoat = 0.0;"),f?n.push(f.code,"material.clearCoatRoughness = clamp( "+f.result+", 0.04, 1.0 );"):o&&n.push("material.clearCoatRoughness = 0.0;"),m?n.push(m.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+m.result+" ) ), diffuseColor, metalnessFactor );"):n.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),n.push("#include <lights_fragment_begin>"),g&&(n.push(g.code,"reflectedLight.directDiffuse = "+g.result+";"),n.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),v&&n.push(v.code,"reflectedLight.indirectDiffuse *= "+v.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+v.result+", material.specularRoughness );"),y&&n.push(y.code,"reflectedLight.indirectDiffuse += "+y.result+";"),b&&n.push(b.code,"reflectedLight.directDiffuse *= "+b.result+";","reflectedLight.directSpecular *= "+b.result+";"),x&&n.push(x.code,"reflectedLight.directDiffuse += "+x.result+";"),w&&(n.push(w.code),_&&n.push(_.code,"clearCoatRadiance += "+_.result+";"),n.push("radiance += "+w.result+";"),w.extra.irradiance&&n.push("irradiance += PI * "+w.extra.irradiance+";")),n.push("#include <lights_fragment_end>"),n.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),h?n.push("gl_FragColor = vec4( outgoingLight, "+h.result+" );"):n.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),n.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),t=n.join("\n")}return t},de.prototype.copy=function(e){return n.prototype.copy.call(this,e),e.position&&(this.position=e.position),this.color=e.color,this.roughness=e.roughness,this.metalness=e.metalness,e.mask&&(this.mask=e.mask),e.alpha&&(this.alpha=e.alpha),e.normal&&(this.normal=e.normal),e.clearCoat&&(this.clearCoat=e.clearCoat),e.clearCoatRoughness&&(this.clearCoatRoughness=e.clearCoatRoughness),e.reflectivity&&(this.reflectivity=e.reflectivity),e.light&&(this.light=e.light),e.shadow&&(this.shadow=e.shadow),e.ao&&(this.ao=e.ao),e.emissive&&(this.emissive=e.emissive),e.ambient&&(this.ambient=e.ambient),e.environment&&(this.environment=e.environment),this},de.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),t.color=this.color.toJSON(e).uuid,t.roughness=this.roughness.toJSON(e).uuid,t.metalness=this.metalness.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.clearCoat&&(t.clearCoat=this.clearCoat.toJSON(e).uuid),this.clearCoatRoughness&&(t.clearCoatRoughness=this.clearCoatRoughness.toJSON(e).uuid),this.reflectivity&&(t.reflectivity=this.reflectivity.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid)),t},fe.prototype=Object.create(de.prototype),fe.prototype.constructor=fe,fe.prototype.nodeType="MeshStandard",fe.prototype.build=function(e){var t=this.properties,r=this.inputs;if(e.isShader("fragment")){var n=e.findNode(t.color,r.color),i=e.resolve(t.map);this.color=i?new D(n,i,D.MUL):n;var a=e.findNode(t.roughness,r.roughness),o=e.resolve(t.roughnessMap);this.roughness=o?new D(a,new ie(o,"g"),D.MUL):a;var s=e.findNode(t.metalness,r.metalness),c=e.resolve(t.metalnessMap);this.metalness=c?new D(s,new ie(c,"b"),D.MUL):s,t.normalMap?(this.normal=new ee(e.resolve(t.normalMap)),this.normal.scale=e.findNode(t.normalScale,r.normalScale)):this.normal=void 0,this.environment=e.resolve(t.envMap)}return de.prototype.build.call(this,e)},fe.prototype.toJSON=function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),console.warn(".toJSON not implemented in",this)),t},me.prototype=Object.create(G.prototype),me.prototype.constructor=me,Ce.addShortcuts(me.prototype,"fragment",["color","alpha","mask","position","spherical"]),ge.prototype=Object.create(G.prototype),ge.prototype.constructor=ge,Ce.addShortcuts(ge.prototype,"fragment",["color","alpha","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]),ve.prototype=Object.create(G.prototype),ve.prototype.constructor=ve,Ce.addShortcuts(ve.prototype,"fragment",["color","alpha","roughness","metalness","reflectivity","clearCoat","clearCoatRoughness","normal","emissive","ambient","light","shadow","ao","environment","mask","position"]),ye.prototype=Object.create(G.prototype),ye.prototype.constructor=ye,Ce.addShortcuts(ye.prototype,"properties",["color","roughness","metalness","map","normalMap","normalScale","metalnessMap","roughnessMap","envMap"]),be.prototype={constructor:be,render:function(e,t,r){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.output,this.material.build(),this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=this.renderTarget.texture),this.needsUpdate=!1),r.setRenderer(this.renderer).setRenderTexture(this.renderTarget.texture),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(e,t),r.updateNode(this.material),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},setSize:function(e,t){this.renderTarget.setSize(e,t),this.renderer.setSize(e,t)},copy:function(e){return this.output=e.output,this},toJSON:function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.post&&(e.post={}),!e.post[this.uuid]){var t={};t.uuid=this.uuid,t.type="NodePostProcessing",e.post[this.uuid]=t,""!==this.name&&(t.name=this.name),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.output=this.output.toJSON(e).uuid}return e.post=this.uuid,e}};var Ge=function(e,t){this.manager=void 0===e?Ee.D:e,this.nodes={},this.materials={},this.passes={},this.names={},this.library=t||{}};Object.assign(Ge.prototype,{load:function(e,t,r,n){var i=this,a=new Ee.L(i.manager);return a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n),this},setPath:function(e){return this.path=e,this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.materials[e]||this.passes[e]||this.names[e]},getNode:function(e){var t=this.getObjectById(e);return t||console.warn('Node "'+e+'" not found.'),t},resolve:function(e){switch(typeof e){case"boolean":case"number":return e;case"string":return/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/i.test(e)||this.library[e]?this.getNode(e):e;default:if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=this.resolve(e[t]);else for(var r in e)"uuid"!==r&&(e[r]=this.resolve(e[r]))}return e},declare:function(e){var t,r,n;for(t in e.nodes)r=e.nodes[t],n=new Te[r.nodeType+"Node"],r.name&&(n.name=r.name,this.names[n.name]=n),this.nodes[t]=n;for(t in e.materials)r=e.materials[t],n=new Te[r.type],r.name&&(n.name=r.name,this.names[n.name]=n),this.materials[t]=n;for(t in e.passes)r=e.passes[t],n=new Te[r.type],r.name&&(n.name=r.name,this.names[n.name]=n),this.passes[t]=n;return e.material&&(this.material=this.materials[e.material]),e.pass&&(this.pass=this.passes[e.pass]),e},parse:function(e){for(var t in(e=this.resolve(this.declare(e))).nodes)this.nodes[t].copy(e.nodes[t]);for(t in e.materials)this.materials[t].copy(e.materials[t]);for(t in e.passes)this.passes[t].copy(e.passes[t]);return this.material||this.pass||this}});var je=r(1);r.d(t,"GetNodeMaterial",function(){return xe})},function(e,t,r){"use strict";function n(e,t){return Object(m.a)(new f,e,t)}r.r(t);const i=function(e,t,r){this.supportsStandardWorker=e,this.supportsJsmWorker=t,this.preferJsmWorker=r,this.startCode="",this.codeFragments=[],this.importStatements=[],this.jsmWorkerFile=null,this.defaultGeometryType=0};i.prototype={constructor:i,isSupportsStandardWorker:function(){return this.supportsStandardWorker},isSupportsJsmWorker:function(){return this.supportsJsmWorker},isPreferJsmWorker:function(){return this.preferJsmWorker},setJsmWorkerFile:function(e){null!=e&&(this.jsmWorkerFile=e)},addStartCode:function(e){this.startCode=e},addCodeFragment:function(e){this.codeFragments.push(e)},addLibraryImport:function(e){let t=new URL(e,window.location.href).href;this.importStatements.push('importScripts( "'+t+'" );')},getImportStatements:function(){return this.importStatements},getCodeFragments:function(){return this.codeFragments},getStartCode:function(){return this.startCode}};const a=function(){if(void 0===window.Worker)throw"This browser does not support web workers!";if(void 0===window.Blob)throw"This browser does not support Blob!";if("function"!=typeof window.URL.createObjectURL)throw"This browser does not support Object creation from URL!";this._reset()};a.WORKER_SUPPORT_VERSION="3.0.0-beta2",console.info("Using WorkerSupport version: "+a.WORKER_SUPPORT_VERSION),a.prototype={constructor:a,_reset:function(){this.logging={enabled:!0,debug:!1};let e=this;this.worker={native:null,jsmWorker:!1,logging:!0,workerRunner:{name:"WorkerRunner",usesMeshDisassembler:!1,defaultGeometryType:0},terminateWorkerOnLoad:!0,forceWorkerDataCopy:!1,started:!1,queuedMessage:null,callbacks:{onAssetAvailable:null,onLoad:null,terminate:function(){e._terminate()}}}},setLogging:function(e,t){return this.logging.enabled=!0===e,this.logging.debug=!0===t,this.worker.logging=!0===e,this},setForceWorkerDataCopy:function(e){return this.worker.forceWorkerDataCopy=!0===e,this},setTerminateWorkerOnLoad:function(e){return this.worker.terminateWorkerOnLoad=!0===e,this.worker.terminateWorkerOnLoad&&this.isWorkerLoaded(this.worker.jsmWorker)&&null===this.worker.queuedMessage&&this.worker.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate()),this},updateCallbacks:function(e,t){null!=e&&(this.worker.callbacks.onAssetAvailable=e),null!=t&&(this.worker.callbacks.onLoad=t),this._verifyCallbacks()},_verifyCallbacks:function(){if(void 0===this.worker.callbacks.onAssetAvailable||null===this.worker.callbacks.onAssetAvailable)throw'Unable to run as no "onAssetAvailable" callback is set.'},buildWorker:function(e){let t=!1;e.isSupportsJsmWorker()&&e.isPreferJsmWorker()&&(t=this._buildWorkerJsm(e)),!t&&e.isSupportsStandardWorker()&&this._buildWorkerStandard(e)},_buildWorkerJsm:function(e){let t="buildWorkerJsm";if(!this._buildWorkerCheckPreconditions(!0,t)){let r=new URL(e.jsmWorkerFile,window.location.href).href;try{let n=new Worker(r,{type:"module"});this._configureWorkerCommunication(n,!0,e.defaultGeometryType,t)}catch(t){n=!1,(t instanceof TypeError||t instanceof SyntaxError)&&console.error("Modules are not supported in workers.")}}return!0},_buildWorkerStandard:function(e){let t="buildWorkerStandard";if(!this._buildWorkerCheckPreconditions(!1,t)){let r="";e.getImportStatements().forEach(function(e){r+=e+"\n"}),r+="\n",e.getCodeFragments().forEach(function(e){r+=e+"\n"}),r+="\n",r+=e.getStartCode();let n=new Blob([r],{type:"application/javascript"}),i=new Worker(window.URL.createObjectURL(n));this._configureWorkerCommunication(i,!1,e.defaultGeometryType,t)}},_buildWorkerCheckPreconditions:function(e,t){let r=!1;return this.isWorkerLoaded(e)?r=!0:this.logging.enabled&&(console.info("WorkerExecutionSupport: Building "+(e?"jsm":"standard")+" worker code..."),console.time(t)),r},_configureWorkerCommunication:function(e,t,r,n){this.worker.native=e,this.worker.jsmWorker=t;let i=this;this.worker.native.onmessage=function(e){i._receiveWorkerMessage(e)},null!=r&&(this.worker.workerRunner.defaultGeometryType=r),this.logging.enabled&&console.timeEnd(n)},isWorkerLoaded:function(e){return null!==this.worker.native&&(e&&this.worker.jsmWorker||!e&&!this.worker.jsmWorker)},_receiveWorkerMessage:function(e){let t=e.data,r=this.worker.workerRunner.name;switch(t.cmd){case"assetAvailable":this.worker.callbacks.onAssetAvailable(t);break;case"completeOverall":this.worker.queuedMessage=null,this.worker.started=!1,null!==this.worker.callbacks.onLoad&&this.worker.callbacks.onLoad(t.msg),this.worker.terminateWorkerOnLoad&&(this.worker.logging.enabled&&console.info("WorkerSupport ["+r+"]: Run is complete. Terminating application on request!"),this.worker.callbacks.terminate());break;case"error":console.error("WorkerSupport ["+r+"]: Reported error: "+t.msg),this.worker.queuedMessage=null,this.worker.started=!1,null!==this.worker.callbacks.onLoad&&this.worker.callbacks.onLoad(t.msg),this.worker.terminateWorkerOnLoad&&(this.worker.logging.enabled&&console.info("WorkerSupport ["+r+"]: Run reported error. Terminating application on request!"),this.worker.callbacks.terminate());break;default:console.error("WorkerSupport ["+r+"]: Received unknown command: "+t.cmd)}},executeParallel:function(e,t){e.cmd="parse",e.usesMeshDisassembler=this.worker.workerRunner.usesMeshDisassembler,e.defaultGeometryType=this.worker.workerRunner.defaultGeometryType,this._verifyWorkerIsAvailable(e,t)&&this._postMessage()},_verifyWorkerIsAvailable:function(e,t){this._verifyCallbacks();let r=!0;return null===this.worker.queuedMessage?(this.worker.queuedMessage={payload:e,transferables:null==t?[]:t},this.worker.started=!0):(console.warn("Already processing message. Rejecting new run instruction"),r=!1),r},_postMessage:function(){if(null!==this.worker.queuedMessage)if(this.worker.queuedMessage.payload.data.input instanceof ArrayBuffer){let e=[];this.worker.forceWorkerDataCopy?e.push(this.worker.queuedMessage.payload.data.input.slice(0)):e.push(this.worker.queuedMessage.payload.data.input),0<this.worker.queuedMessage.transferables.length&&(e=e.concat(this.worker.queuedMessage.transferables)),this.worker.native.postMessage(this.worker.queuedMessage.payload,e)}else this.worker.native.postMessage(this.worker.queuedMessage.payload)},_terminate:function(){this.worker.native.terminate(),this._reset()}};const o=function(e,t){let r,n=e+" = {\n\n";for(let e in t)"string"==typeof(r=t[e])||r instanceof String?n+="\t"+e+': "'+(r=(r=r.replace("\n","\\n")).replace("\r","\\r"))+'",\n':r instanceof Array?n+="\t"+e+": ["+r+"],\n":"object"==typeof r?(console.log('Omitting object "'+e+'" and replace it with empty object.'),n+="\t"+e+": {},\n"):n+="\t"+e+": "+r+",\n";return n+="}\n\n"},s=function(e,t,r,n){let i,a,o,s,u,l=[],h=[],p=[],d=null!=r;for(let r in Array.isArray(n)||(n=[]),t.prototype)i=t.prototype[r],(s=new c(r,e+".prototype."+r)).setCode(i.toString()),"constructor"==r?!s.isRemoveCode()&&(a=e+" = "+s.getCode()+";\n\n"):"function"==typeof i&&((u=n[r])instanceof c&&u.getName()===s.getName()&&(s=u),!s.isRemoveCode()&&(d?l.push(s.getFullName()+" = "+s.getCode()+";\n\n"):l.push("\t"+s.getName()+": "+s.getCode()+",\n\n")));for(let r in t)i=t[r],s=new c(r,e+"."+r),"function"==typeof i?((u=n[r])instanceof c&&u.getName()===s.getName()?s=u:s.setCode(i.toString()),!s.isRemoveCode()&&p.push(s.getFullName()+" = "+s.getCode()+";\n\n")):("string"==typeof i||i instanceof String?s.setCode('"'+i.toString()+'"'):"object"==typeof i?(console.log('Omitting object "'+s.getName()+'" and replace it with empty object.'),s.setCode("{}")):s.setCode(i),!s.isRemoveCode()&&h.push(s.getFullName()+" = "+s.getCode()+";\n"));let f=a+"\n\n";for(d&&(f+=e+".prototype = Object.create( "+r+".prototype );\n"),f+=e+".prototype.constructor = "+e+";\n",f+="\n\n",o=0;o<h.length;o++)f+=h[o];for(f+="\n\n",o=0;o<p.length;o++)f+=p[o];if(f+="\n\n",d)for(o=0;o<l.length;o++)f+=l[o];else{for(f+=e+".prototype = {\n\n",o=0;o<l.length;o++)f+=l[o];f+="\n};"}return f+="\n\n"},c=function(e,t){this.name=e,this.fullName=t,this.code=null,this.removeCode=!1};c.prototype={constructor:c,getName:function(){return this.name},getFullName:function(){return this.fullName},setCode:function(e){return this.code=e,this},getCode:function(){return this.code},setRemoveCode:function(e){return this.removeCode=e,this},isRemoveCode:function(){return this.removeCode}};var u=r(2),l=r(9);const h={applyProperties:function(e,t,r){if(null==e||null==t)return;let n,i,a;for(n in t)i="set"+n.substring(0,1).toLocaleUpperCase()+n.substring(1),a=t[n],"function"==typeof e[i]?e[i](a):(e.hasOwnProperty(n)||r)&&(e[n]=a)}},p=function(e){this.parser=e,this.logging={enabled:!1,debug:!1}};p.prototype={constructor:p,handlePayload:function(e){if(e.logging&&(this.logging.enabled=!0===e.logging.enabled,this.logging.debug=!0===e.logging.debug),"parse"===e.cmd){let t=this,r=this.parser;"function"==typeof r.setLogging&&r.setLogging(this.logging.enabled,this.logging.debug),h.applyProperties(r,e.params),h.applyProperties(r,e.materials),h.applyProperties(r,{callbackOnAssetAvailable:function(e){self.postMessage(e)},callbackOnProgress:function(e){t.logging.enabled&&t.logging.debug&&console.debug("WorkerRunner: progress: "+e)}});let n=e.params&&void 0!==e.params.index&&null!==e.params.index?this.resourceDescriptors[e.params.index].content:e.data.input,i="parse";"function"==typeof r.getParseFunctionName&&(i=r.getParseFunctionName()),e.usesMeshDisassembler||r[i](n,e.data.options),this.logging.enabled&&console.log("WorkerRunner: Run complete!"),self.postMessage({cmd:"completeOverall",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+e.cmd)}};const d=function(e){this.resourceDescriptors=[],this.payloadHandler=e;let t=this;self.addEventListener("message",function(e){t.processMessage(e.data)},!1)};d.prototype={constructor:d,processMessage:function(e){if(e.data.resourceDescriptors&&0===this.resourceDescriptors.length)for(let t in e.data.resourceDescriptors)this.resourceDescriptors.push(e.data.resourceDescriptors[t]);this.payloadHandler.handlePayload(e)}};const f=function(e){u.a.call(this,e),this.preferJsmWorker=!1,this.callbacks.onParseComplete=null,this.executeParallel=!0,this.workerExecutionSupport=new a};f.prototype=Object.create(u.a.prototype),f.prototype.constructor=f,u.a.OBJLOADER2_PARALLEL_VERSION="3.0.0-beta2",console.info("Using OBJLoader2Parallel version: "+u.a.OBJLOADER2_PARALLEL_VERSION),f.prototype.setPreferJsmWorker=function(e){return this.preferJsmWorker=!0===e,this},f.prototype.setCallbackOnParseComplete=function(e){return null!=e&&(this.callbacks.onParseComplete=e),this},f.prototype.setExecuteParallel=function(e){return this.executeParallel=!0===e,this},f.prototype.getWorkerExecutionSupport=function(){return this.workerExecutionSupport},f.prototype.buildWorkerCode=function(){let e=new i(!0,!0,this.preferJsmWorker);if(e.isSupportsJsmWorker()&&e.setJsmWorkerFile("../../src/loaders/worker/parallel/jsm/OBJLoader2Worker.js"),e.isSupportsStandardWorker()){let t=s("OBJLoader2Parser",l.a),r=o("ObjectManipulator",h),n=s("DefaultWorkerPayloadHandler",p),i=s("WorkerRunner",d);e.addCodeFragment(t),e.addCodeFragment(r),e.addCodeFragment(n),e.addCodeFragment(i),e.addStartCode("new WorkerRunner( new DefaultWorkerPayloadHandler( new OBJLoader2Parser() ) );")}return e},f.prototype._configure=function(){if(null===this.callbacks.onParseComplete)throw"No callbackOnLoad was provided! Aborting!";if(this.workerExecutionSupport.isWorkerLoaded(this.preferJsmWorker))return;this.workerExecutionSupport.buildWorker(this.buildWorkerCode());let e=this;this.workerExecutionSupport.updateCallbacks(function(t){e._onAssetAvailable(t)},this.callbacks.onParseComplete)},f.prototype.load=function(e,t,r,n,i){this.setCallbackOnParseComplete(t),u.a.prototype.load.call(this,e,function(){},r,n,i)},f.prototype.parse=function(e){this.executeParallel?(this._configure(),this.workerExecutionSupport.executeParallel({params:{modelName:this.modelName,instanceNo:this.instanceNo,useIndices:this.useIndices,disregardNormals:this.disregardNormals,materialPerSmoothingGroup:this.materialPerSmoothingGroup,useOAsMesh:this.useOAsMesh},materials:this.materialHandler.getMaterialsJSON(),data:{input:e,options:null},logging:{enabled:this.logging.enabled,debug:this.logging.debug}})):this.callbacks.onParseComplete(u.a.prototype.parse.call(this,e))};var m=r(1);r.d(t,"GetOBJ2Parallel",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(l.a)(new u,e,t)}var i=Math.floor;r.r(t);var a=r(0),o=r(6),s={findSpan:function(e,t,r){var n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;for(var a=e,o=n,s=i((a+o)/2);t<r[s]||t>=r[s+1];)t<r[s]?o=s:a=s,s=i((a+o)/2);return s},calcBasisFunctions:function(e,t,r,n){var i=[],a=[],o=[];i[0]=1;for(var s=1;s<=r;++s){a[s]=t-n[e+1-s],o[s]=n[e+s]-t;for(var c=0,u=0;u<s;++u){var l=o[u+1],h=a[s-u],p=i[u]/(l+h);i[u]=c+l*p,c=h*p}i[s]=c}return i},calcBSplinePoint:function(e,t,r,n){for(var i=this.findSpan(e,n,t),o=this.calcBasisFunctions(i,n,e,t),s=new a.Kc(0,0,0,0),c=0;c<=e;++c){var u=r[i-e+c],l=o[c],h=u.w*l;s.x+=u.x*h,s.y+=u.y*h,s.z+=u.z*h,s.w+=u.w*l}return s},calcBasisFunctionDerivatives:function(e,t,r,n,i){for(var a=[],o=0;o<=r;++o)a[o]=0;var s=[];for(o=0;o<=n;++o)s[o]=a.slice(0);var c=[];for(o=0;o<=r;++o)c[o]=a.slice(0);c[0][0]=1;for(var u=a.slice(0),l=a.slice(0),h=1;h<=r;++h){u[h]=t-i[e+1-h],l[h]=i[e+h]-t;for(var p=0,d=0;d<h;++d){var f=l[d+1],m=u[h-d];c[h][d]=f+m;var g=c[d][h-1]/c[h][d];c[d][h]=p+f*g,p=m*g}c[h][h]=p}for(h=0;h<=r;++h)s[0][h]=c[h][r];for(d=0;d<=r;++d){var v=0,y=1,b=[];for(o=0;o<=r;++o)b[o]=a.slice(0);b[0][0]=1;for(var x=1;x<=n;++x){var w=0,_=d-x,T=r-x;d>=x&&(b[y][0]=b[v][0]/c[T+1][_],w=b[y][0]*c[_][T]);var E=d-1<=T?x-1:r-d;for(h=-1<=_?1:-_;h<=E;++h)b[y][h]=(b[v][h]-b[v][h-1])/c[T+1][_+h],w+=b[y][h]*c[_+h][T];d<=T&&(b[y][x]=-b[v][x-1]/c[T+1][d],w+=b[y][x]*c[d][T]),s[x][d]=w;h=v;v=y,y=h}}for(d=r,x=1;x<=n;++x){for(h=0;h<=r;++h)s[x][h]*=d;d*=r-x}return s},calcBSplineDerivatives:function(e,t,r,n,i){for(var o=i<e?i:e,s=[],c=this.findSpan(e,n,t),u=this.calcBasisFunctionDerivatives(c,n,e,o,t),l=[],h=0;h<r.length;++h){var p=(d=r[h].clone()).w;d.x*=p,d.y*=p,d.z*=p,l[h]=d}for(var d,f=0;f<=o;++f){d=l[c-e].clone().multiplyScalar(u[f][0]);for(var m=1;m<=e;++m)d.add(l[c-e+m].clone().multiplyScalar(u[f][m]));s[f]=d}for(f=o+1;f<=i+1;++f)s[f]=new a.Kc(0,0,0);return s},calcKoverI:function(e,t){for(var r=1,n=2;n<=e;++n)r*=n;var i=1;for(n=2;n<=t;++n)i*=n;for(n=2;n<=e-t;++n)i*=n;return r/i},calcRationalCurveDerivatives:function(e){for(var t,r=e.length,n=[],i=[],o=0;o<r;++o)t=e[o],n[o]=new a.Jc(t.x,t.y,t.z),i[o]=t.w;for(var s,c=[],u=0;u<r;++u){s=n[u].clone();for(o=1;o<=u;++o)s.sub(c[u-o].clone().multiplyScalar(this.calcKoverI(u,o)*i[o]));c[u]=s.divideScalar(i[0])}return c},calcNURBSDerivatives:function(e,t,r,n,i){var a=this.calcBSplineDerivatives(e,t,r,n,i);return this.calcRationalCurveDerivatives(a)},calcSurfacePoint:function(e,t,r,n,i,o,s,c){for(var u=this.findSpan(e,o,r),l=this.findSpan(t,s,n),h=this.calcBasisFunctions(u,o,e,r),p=this.calcBasisFunctions(l,s,t,n),d=[],f=0;f<=t;++f){d[f]=new a.Kc(0,0,0,0);for(var m=0;m<=e;++m){var g=i[u-e+m][l-t+f].clone(),v=g.w;g.x*=v,g.y*=v,g.z*=v,d[f].add(g.multiplyScalar(h[m]))}}var y=new a.Kc(0,0,0,0);for(f=0;f<=t;++f)y.add(d[f].multiplyScalar(p[f]));y.divideScalar(y.w),c.set(y.x,y.y,y.z)}},c=function(e,t,r,n,i){a.y.call(this),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=i||this.knots.length-1;for(var o,s=0;s<r.length;++s)o=r[s],this.controlPoints[s]=new a.Kc(o.x,o.y,o.z,o.w)};(c.prototype=Object.create(a.y.prototype)).constructor=c,c.prototype.getPoint=function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=s.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=r.w&&r.divideScalar(r.w),new a.Jc(r.x,r.y,r.z)},c.prototype.getTangent=function(e){var t=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),r=s.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,t,1)[1].clone();return r.normalize(),r};var u=function(){function e(e){this.manager=void 0===e?a.D:e}function t(e){this.textureLoader=e}function r(){}function n(){}function i(){}function s(){}function u(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=!(void 0!==t)||t}function l(){}function h(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function p(e){return e/46186158e3}function d(e,t,r,n){var i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);var a=i*n.dataSize,o=a+n.dataSize;return function(e,t,r,n){for(var i=r,a=0;i<n;i++,a++)e[a]=t[i];return e}(_,n.buffer,a,o)}function f(e){var t,r=new a.ub,n=new a.ub,i=new a.ub,o=new a.ub,s=new a.ub,c=new a.ub,u=new a.ub,l=new a.ub,h=new a.ub,p=new a.ub,d=new a.ub,f=e.inheritType?e.inheritType:0;(e.translation&&r.setPosition(E.fromArray(e.translation)),e.preRotation)&&((t=e.preRotation.map(a.sb.degToRad)).push(e.eulerOrder),n.makeRotationFromEuler(T.fromArray(t)));e.rotation&&((t=e.rotation.map(a.sb.degToRad)).push(e.eulerOrder),i.makeRotationFromEuler(T.fromArray(t)));e.postRotation&&((t=e.postRotation.map(a.sb.degToRad)).push(e.eulerOrder),o.makeRotationFromEuler(T.fromArray(t)));e.scale&&s.scale(E.fromArray(e.scale)),e.scalingOffset&&u.setPosition(E.fromArray(e.scalingOffset)),e.scalingPivot&&c.setPosition(E.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(E.fromArray(e.rotationOffset)),e.rotationPivot&&h.setPosition(E.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(p=e.parentMatrixWorld);var m=n.multiply(i).multiply(o),g=new a.ub;p.extractRotation(g);var v,y,b,x,w=new a.ub;if(w.copyPosition(p),b=w.getInverse(w).multiply(p),y=g.getInverse(g).multiply(b),v=s,0===f)x=g.multiply(m).multiply(y).multiply(v);else if(1===f)x=g.multiply(y).multiply(m).multiply(v);else{var _=(new a.ub).copy(s),A=y.multiply(_.getInverse(_));x=g.multiply(m).multiply(A).multiply(v)}var S=r.multiply(l).multiply(h).multiply(n).multiply(i).multiply(o).multiply(h.getInverse(h)).multiply(u).multiply(c).multiply(s).multiply(c.getInverse(c)),M=(new a.ub).copyPosition(S),L=p.multiply(M);return d.copyPosition(L),S=d.multiply(x)}function m(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function g(e){return e.split(",").map(function(e){return parseFloat(e)})}function v(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),a.ob.decodeText(new Uint8Array(e,t,r))}function y(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}var b,x,w;e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?a.ob.extractUrlBase(e):i.path,s=new a.L(this.manager);s.setPath(i.path),s.setResponseType("arraybuffer"),s.load(e,function(r){try{t(i.parse(r,o))}catch(t){setTimeout(function(){n&&n(t),i.manager.itemError(e)},0)}},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,r){if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===v(e,0,t.length)}(e))b=(new s).parse(e);else{var n=v(e);if(!function(e){function t(t){var r=e[t-1];return e=e.slice(n+t),n++,r}for(var r=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],n=0,i=0;i<r.length;++i)if(t(1)===r[i])return!1;return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(7e3>h(n))throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+h(n));b=(new i).parse(n)}return new t(new a.yc(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin)).parse(b)}},t.prototype={constructor:t,parse:function(){x=this.parseConnections();var e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),i=this.parseDeformers(),a=(new r).parse(i);return this.parseScene(i,a,n),w},parseConnections:function(){var e=new Map;"Connections"in b&&b.Connections.connections.forEach(function(t){var r=t[0],n=t[1],i=t[2];e.has(r)||e.set(r,{parents:[],children:[]}),e.get(r).parents.push({ID:n,relationship:i}),e.has(n)||e.set(n,{parents:[],children:[]}),e.get(n).children.push({ID:r,relationship:i})});return e},parseImages:function(){var e={},t={};if("Video"in b.Objects){var r=b.Objects.Video;for(var n in r){var i=r[n];if(e[c=parseInt(n)]=i.RelativeFilename||i.Filename,"Content"in i){var a=i.Content instanceof ArrayBuffer&&0<i.Content.byteLength,o="string"==typeof i.Content&&""!==i.Content;if(a||o){var s=this.parseImage(r[n]);t[i.RelativeFilename||i.Filename]=s}}}}for(var c in e){var u=e[c];e[c]=void 0===t[u]?e[c].split("\\").pop():t[u]}return e},parseImage:function(e){var t,r=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===a.nb.Handlers.get(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof r)return"data:"+t+";base64,"+r;var o=new Uint8Array(r);return window.URL.createObjectURL(new Blob([o],{type:t}))},parseTextures:function(e){var t=new Map;if("Texture"in b.Objects){var r=b.Objects.Texture;for(var n in r){var i=this.parseTexture(r[n],e);t.set(parseInt(n),i)}}return t},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;var n=e.WrapModeU,i=e.WrapModeV,o=void 0===n?0:n.value,s=void 0===i?0:i.value;if(r.wrapS=0===o?a.mc:a.n,r.wrapT=0===s?a.mc:a.n,"Scaling"in e){var c=e.Scaling.value;r.repeat.x=c[0],r.repeat.y=c[1]}return r},loadTexture:function(e,t){var r,n=this.textureLoader.path,i=x.get(e.id).children;void 0!==i&&0<i.length&&void 0!==t[i[0].ID]&&((0===(r=t[i[0].ID]).indexOf("blob:")||0===r.indexOf("data:"))&&this.textureLoader.setPath(void 0));var o,s=e.FileName.slice(-3).toLowerCase();if("tga"===s){var c=a.nb.Handlers.get(".tga");null===c?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new a.xc):o=c.load(r)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new a.xc):o=this.textureLoader.load(r);return this.textureLoader.setPath(n),o},parseMaterials:function(e){var t=new Map;if("Material"in b.Objects){var r=b.Objects.Material;for(var n in r){var i=this.parseMaterial(r[n],e);null!==i&&t.set(parseInt(n),i)}}return t},parseMaterial:function(e,t){var r=e.id,n=e.attrName,i=e.ShadingModel;if("object"==typeof i&&(i=i.value),!x.has(r))return null;var o,s=this.parseParameters(e,t,r);switch(i.toLowerCase()){case"phong":o=new a.yb;break;case"lambert":o=new a.xb;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),o=new a.yb}return o.setValues(s),o.name=n,o},parseParameters:function(e,t,r){var n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=(new a.o).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(n.color=(new a.o).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=(new a.o).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(n.emissive=(new a.o).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(n.opacity=parseFloat(e.Opacity.value)),1>n.opacity&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=(new a.o).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(n.specular=(new a.o).fromArray(e.SpecularColor.value));var i=this;return x.get(r).children.forEach(function(e){var r=e.relationship;switch(r){case"Bump":n.bumpMap=i.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":n.aoMap=i.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=i.getTexture(t,e.ID),n.map.encoding=a.Oc;break;case"DisplacementColor":n.displacementMap=i.getTexture(t,e.ID);break;case"EmissiveColor":n.emissiveMap=i.getTexture(t,e.ID),n.emissiveMap.encoding=a.Oc;break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=i.getTexture(t,e.ID);break;case"ReflectionColor":n.envMap=i.getTexture(t,e.ID),n.envMap.mapping=a.H,n.envMap.encoding=a.Oc;break;case"SpecularColor":n.specularMap=i.getTexture(t,e.ID),n.specularMap.encoding=a.Oc;break;case"TransparentColor":n.alphaMap=i.getTexture(t,e.ID),n.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",r)}}),n},getTexture:function(e,t){return"LayeredTexture"in b.Objects&&t in b.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=x.get(t).children[0].ID),e.get(t)},parseDeformers:function(){var e={},t={};if("Deformer"in b.Objects){var r=b.Objects.Deformer;for(var n in r){var i=r[n],a=x.get(parseInt(n));if("Skin"===i.attrType){var o=this.parseSkeleton(a,r);o.ID=n,1<a.parents.length&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),o.geometryID=a.parents[0].ID,e[n]=o}else if("BlendShape"===i.attrType){var s={id:n};s.rawTargets=this.parseMorphTargets(a,r),s.id=n,1<a.parents.length&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[n]=s}}}return{skeletons:e,morphTargets:t}},parseSkeleton:function(e,t){var r=[];return e.children.forEach(function(e){var n=t[e.ID];if("Cluster"===n.attrType){var i={ID:e.ID,indices:[],weights:[],transformLink:(new a.ub).fromArray(n.TransformLink.a)};"Indexes"in n&&(i.indices=n.Indexes.a,i.weights=n.Weights.a),r.push(i)}}),{rawBones:r,bones:[]}},parseMorphTargets:function(e,t){for(var r=[],n=0;n<e.children.length;n++){var i=e.children[n],a=t[i.ID],o={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;o.geoID=x.get(parseInt(i.ID)).children.filter(function(e){return void 0===e.relationship})[0].ID,r.push(o)}return r},parseScene:function(e,t,r){w=new a.R;var i=this.parseModels(e.skeletons,t,r),o=b.Objects.Model,s=this;i.forEach(function(e){var t=o[e.ID];s.setLookAtProperties(e,t),x.get(e.ID).parents.forEach(function(t){var r=i.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&w.add(e)}),this.bindSkeleton(e.skeletons,t,i),this.createAmbientLight(),this.setupMorphMaterials(),w.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrixWorld=e.parent.matrix);var t=f(e.userData.transformData);e.applyMatrix(t)}});var c=(new n).parse();1===w.children.length&&w.children[0].isGroup&&(w.children[0].animations=c,w=w.children[0]),w.animations=c},parseModels:function(e,t,r){var n=new Map,i=b.Objects.Model;for(var o in i){var s=parseInt(o),c=i[o],u=x.get(s),l=this.buildSkeleton(u,e,s,c.attrName);if(!l){switch(c.attrType){case"Camera":l=this.createCamera(u);break;case"Light":l=this.createLight(u);break;case"Mesh":l=this.createMesh(u,t,r);break;case"NurbsCurve":l=this.createCurve(u,t);break;case"LimbNode":case"Root":l=new a.i;break;case"Null":default:l=new a.R}l.name=a.Ub.sanitizeNodeName(c.attrName),l.ID=s}this.getTransformData(l,c),n.set(s,l)}return n},buildSkeleton:function(e,t,r,n){var i=null;return e.parents.forEach(function(e){for(var o in t){var s=t[o];s.rawBones.forEach(function(t,o){if(t.ID===e.ID){var c=i;(i=new a.i).matrixWorld.copy(t.transformLink),i.name=a.Ub.sanitizeNodeName(n),i.ID=r,s.bones[o]=i,null!=c&&i.add(c)}})}}),i},createCamera:function(e){var t,r;if(e.children.forEach(function(e){var t=b.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new a.Kb;else{var n=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(n=1);var i=1;void 0!==r.NearPlane&&(i=r.NearPlane.value/1e3);var o=1e3;void 0!==r.FarPlane&&(o=r.FarPlane.value/1e3);var s=window.innerWidth,c=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(s=r.AspectWidth.value,c=r.AspectHeight.value);var u=s/c,l=45;void 0!==r.FieldOfView&&(l=r.FieldOfView.value);var h=r.FocalLength?r.FocalLength.value:null;0==n?(t=new a.Pb(l,u,i,o),null!==h&&t.setFocalLength(h)):1==n?t=new a.Nb(-s/2,s/2,c/2,-c/2,i,o):(console.warn("THREE.FBXLoader: Unknown camera type "+n+"."),t=new a.Kb)}return t},createLight:function(e){var t,r;if(e.children.forEach(function(e){var t=b.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new a.Kb;else{var n=void 0===r.LightType?0:r.LightType.value,i=16777215;void 0!==r.Color&&(i=(new a.o).fromArray(r.Color.value));var o=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(o=0);var s=0;void 0!==r.FarAttenuationEnd&&(s=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value);switch(n){case 0:t=new a.Rb(i,o,s,1);break;case 1:t=new a.E(i,o);break;case 2:var c=Math.PI/3;void 0!==r.InnerAngle&&(c=a.sb.degToRad(r.InnerAngle.value));var u=0;void 0!==r.OuterAngle&&(u=a.sb.degToRad(r.OuterAngle.value),u=Math.max(u,1)),t=new a.vc(i,o,s,c,u,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),t=new a.Rb(i,o)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(t.castShadow=!0)}return t},createMesh:function(e,t,r){var n,i=null,o=null,s=[];return e.children.forEach(function(e){t.has(e.ID)&&(i=t.get(e.ID)),r.has(e.ID)&&s.push(r.get(e.ID))}),1<s.length?o=s:0<s.length?o=s[0]:(o=new a.yb({color:13421772}),s.push(o)),"color"in i.attributes&&s.forEach(function(e){e.vertexColors=a.Mc}),i.FBX_Deformer?(s.forEach(function(e){e.skinning=!0}),(n=new a.sc(i,o)).normalizeSkinWeights()):n=new a.vb(i,o),n},createCurve:function(e,t){var r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),n=new a.gb({color:3342591,linewidth:1});return new a.fb(r,n)},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?m(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(e,t){"LookAtProperty"in t&&x.get(e.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){var r=b.Objects.Model[t.ID];if("Lcl_Translation"in r){var n=r.Lcl_Translation.value;void 0===e.target?e.lookAt((new a.Jc).fromArray(n)):(e.target.position.fromArray(n),w.add(e.target))}}})},bindSkeleton:function(e,t,r){var n=this.parsePoseNodes();for(var i in e){var o=e[i];x.get(parseInt(o.ID)).parents.forEach(function(e){if(t.has(e.ID)){var i=e.ID;x.get(i).parents.forEach(function(e){r.has(e.ID)&&r.get(e.ID).bind(new a.rc(o.bones),n[e.ID])})}})}},parsePoseNodes:function(){var e={};if("Pose"in b.Objects){var t=b.Objects.Pose;for(var r in t)if("BindPose"===t[r].attrType){var n=t[r].PoseNode;Array.isArray(n)?n.forEach(function(t){e[t.Node]=(new a.ub).fromArray(t.Matrix.a)}):e[n.Node]=(new a.ub).fromArray(n.Matrix.a)}}return e},createAmbientLight:function(){if("GlobalSettings"in b&&"AmbientColor"in b.GlobalSettings){var e=b.GlobalSettings.AmbientColor.value,t=e[0],r=e[1],n=e[2];if(0!==t||0!==r||0!==n){var i=new a.o(t,r,n);w.add(new a.c(i,1))}}},setupMorphMaterials:function(){var e=this;w.traverse(function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach(function(r,n){e.setupMorphMaterial(t,r,n)}):e.setupMorphMaterial(t,t.material))})},setupMorphMaterial:function(e,t,r){var n=e.uuid,i=t.uuid,a=!1;if(w.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(t){t.uuid===i&&e.uuid!==n&&(a=!0)}):e.material.uuid===i&&e.uuid!==n&&(a=!0))}),1==a){var o=t.clone();o.morphTargets=!0,void 0===r?e.material=o:e.material[r]=o}else t.morphTargets=!0}},r.prototype={constructor:r,parse:function(e){var t=new Map;if("Geometry"in b.Objects){var r=b.Objects.Geometry;for(var n in r){var i=x.get(parseInt(n)),a=this.parseGeometry(i,r[n],e);t.set(parseInt(n),a)}}return t},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(e,t,r){var n=r.skeletons,i=r.morphTargets,a=e.parents.map(function(e){return b.Objects.Model[e.ID]});if(0!==a.length){var o=e.children.reduce(function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e},null),s=e.children.reduce(function(e,t){return void 0!==i[t.ID]&&(e=i[t.ID]),e},null),c=a[0],u={};"RotationOrder"in c&&(u.eulerOrder=m(c.RotationOrder.value)),"InheritType"in c&&(u.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(u.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(u.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(u.scale=c.GeometricScaling.value);var l=f(u);return this.genGeometry(t,o,s,l)}},genGeometry:function(e,t,r,n){var i=new a.l;e.attrName&&(i.name=e.attrName);var o=this.parseGeoNode(e,t),s=this.genBuffers(o),c=new a.M(s.vertex,3);if(n.applyToBufferAttribute(c),i.addAttribute("position",c),0<s.colors.length&&i.addAttribute("color",new a.M(s.colors,3)),t&&(i.addAttribute("skinIndex",new a.Cc(s.weightsIndices,4)),i.addAttribute("skinWeight",new a.M(s.vertexWeights,4)),i.FBX_Deformer=t),0<s.normal.length){var u=new a.M(s.normal,3);(new a.tb).getNormalMatrix(n).applyToBufferAttribute(u),i.addAttribute("normal",u)}if(s.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();0===t&&(r="uv"),i.addAttribute(r,new a.M(s.uvs[t],2))}),o.material&&"AllSame"!==o.material.mappingType){var l=s.materialIndex[0],h=0;if(s.materialIndex.forEach(function(e,t){e!==l&&(i.addGroup(h,t-h,l),l=e,h=t)}),0<i.groups.length){var p=i.groups[i.groups.length-1],d=p.start+p.count;d!==s.materialIndex.length&&i.addGroup(d,s.materialIndex.length-d,l)}0===i.groups.length&&i.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(i,e,r,n),i},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0===e.Vertices?[]:e.Vertices.a,r.vertexIndices=void 0===e.PolygonVertexIndex?[]:e.PolygonVertexIndex.a,e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var n=0;e.LayerElementUV[n];)r.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,i){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[i]})})})),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,i=!1,a=[],o=[],s=[],c=[],u=[],l=[],h=this;return e.vertexIndices.forEach(function(p,f){var m=!1;0>p&&(p^=-1,m=!0);var g=[],v=[];if(a.push(3*p,3*p+1,3*p+2),e.color){var y=d(f,r,p,e.color);s.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[p]&&e.weightTable[p].forEach(function(e){v.push(e.weight),g.push(e.id)}),4<v.length){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var b=[0,0,0,0],x=[0,0,0,0];v.forEach(function(e,t){var r=e,n=g[t];x.forEach(function(e,t,i){if(r>e){i[t]=r,r=e;var a=b[t];b[t]=n,n=a}})}),g=b,v=x}for(;4>v.length;)v.push(0),g.push(0);for(var w=0;4>w;++w)u.push(v[w]),l.push(g[w])}if(e.normal){y=d(f,r,p,e.normal);o.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var _=d(f,r,p,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var n=d(f,r,p,e);void 0===c[t]&&(c[t]=[]),c[t].push(n[0]),c[t].push(n[1])}),n++,m&&(h.genFace(t,e,a,_,o,s,c,u,l,n),r++,n=0,a=[],o=[],s=[],c=[],u=[],l=[])}),t},genFace:function(e,t,r,n,i,a,o,s,c,u){for(var l=2;l<u;l++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(l-1)]]),e.vertex.push(t.vertexPositions[r[3*(l-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(l-1)+2]]),e.vertex.push(t.vertexPositions[r[3*l]]),e.vertex.push(t.vertexPositions[r[3*l+1]]),e.vertex.push(t.vertexPositions[r[3*l+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(l-1)]),e.vertexWeights.push(s[4*(l-1)+1]),e.vertexWeights.push(s[4*(l-1)+2]),e.vertexWeights.push(s[4*(l-1)+3]),e.vertexWeights.push(s[4*l]),e.vertexWeights.push(s[4*l+1]),e.vertexWeights.push(s[4*l+2]),e.vertexWeights.push(s[4*l+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(l-1)]),e.weightsIndices.push(c[4*(l-1)+1]),e.weightsIndices.push(c[4*(l-1)+2]),e.weightsIndices.push(c[4*(l-1)+3]),e.weightsIndices.push(c[4*l]),e.weightsIndices.push(c[4*l+1]),e.weightsIndices.push(c[4*l+2]),e.weightsIndices.push(c[4*l+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(l-1)]),e.colors.push(a[3*(l-1)+1]),e.colors.push(a[3*(l-1)+2]),e.colors.push(a[3*l]),e.colors.push(a[3*l+1]),e.colors.push(a[3*l+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(l-1)]),e.normal.push(i[3*(l-1)+1]),e.normal.push(i[3*(l-1)+2]),e.normal.push(i[3*l]),e.normal.push(i[3*l+1]),e.normal.push(i[3*l+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(o[r][0]),e.uvs[r].push(o[r][1]),e.uvs[r].push(o[r][2*(l-1)]),e.uvs[r].push(o[r][2*(l-1)+1]),e.uvs[r].push(o[r][2*l]),e.uvs[r].push(o[r][2*l+1])})},addMorphTargets:function(e,t,r,n){if(null!==r){e.morphAttributes.position=[];var i=this;r.rawTargets.forEach(function(r){var a=b.Objects.Geometry[r.geoID];void 0!==a&&i.genMorphGeometry(e,t,a,n,r.name)})}},genMorphGeometry:function(e,t,r,n,i){var o=new a.l;r.attrName&&(o.name=r.attrName);for(var s,c=void 0===t.PolygonVertexIndex?[]:t.PolygonVertexIndex.a,u=void 0===t.Vertices?[]:t.Vertices.a.slice(),l=void 0===r.Vertices?[]:r.Vertices.a,h=void 0===r.Indexes?[]:r.Indexes.a,p=0;p<h.length;p++)u[s=3*h[p]]+=l[3*p],u[s+1]+=l[3*p+1],u[s+2]+=l[3*p+2];var d=this.genBuffers({vertexIndices:c,vertexPositions:u}),f=new a.M(d.vertex,3);f.name=i||r.attrName,n.applyToBufferAttribute(f),e.morphAttributes.position.push(f)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var n=e.Materials.a,i=[],a=0;a<n.length;++a)i.push(a);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(void 0===c)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new a.l;var t,r,n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new a.l;for(var i=n-1,o=e.KnotVector.a,s=[],u=e.Points.a,l=0,h=u.length;l<h;l+=4)s.push((new a.Kc).fromArray(u,l));if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){t=i,r=o.length-1-t;for(l=0;l<i;++l)s.push(s[l])}var p=new c(i,o,s,t,r).getPoints(7*s.length),d=new Float32Array(3*p.length);p.forEach(function(e,t){e.toArray(d,3*t)});var f=new a.l;return f.addAttribute("position",new a.k(d,3)),f}},n.prototype={constructor:n,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var r in t){var n=t[r],i=this.addClip(n);e.push(i)}return e},parseClips:function(){if(void 0!==b.Objects.AnimationCurve){var e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);var t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}},parseAnimationCurveNodes:function(){var e=b.Objects.AnimationCurveNode,t=new Map;for(var r in e){var n=e[r];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){var i={id:n.id,attr:n.attrName,curves:{}};t.set(i.id,i)}}return t},parseAnimationCurves:function(e){var t=b.Objects.AnimationCurve;for(var r in t){var n={id:t[r].id,times:t[r].KeyTime.a.map(p),values:t[r].KeyValueFloat.a},i=x.get(n.id);if(void 0!==i){var a=i.parents[0].ID,o=i.parents[0].relationship;o.match(/X/)?e.get(a).curves.x=n:o.match(/Y/)?e.get(a).curves.y=n:o.match(/Z/)?e.get(a).curves.z=n:o.match(/d|DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=n)}}},parseAnimationLayers:function(e){var t=b.Objects.AnimationLayer,r=new Map;for(var n in t){var i=[],o=x.get(parseInt(n));if(void 0!==o)o.children.forEach(function(t,r){if(e.has(t.ID)){var n=e.get(t.ID);if(void 0!==n.curves.x||void 0!==n.curves.y||void 0!==n.curves.z){if(void 0===i[r])if(void 0!==(h=x.get(t.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID)){var o=b.Objects.Model[h.toString()],s={modelName:a.Ub.sanitizeNodeName(o.attrName),ID:o.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};w.traverse(function(e){e.ID===o.id&&(s.transform=e.matrix,e.userData.transformData&&(s.eulerOrder=e.userData.transformData.eulerOrder))}),s.transform||(s.transform=new a.ub),"PreRotation"in o&&(s.preRotation=o.PreRotation.value),"PostRotation"in o&&(s.postRotation=o.PostRotation.value),i[r]=s}i[r]&&(i[r][n.attr]=n)}else if(void 0!==n.curves.morph){if(void 0===i[r]){var c=x.get(t.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID,u=x.get(c).parents[0].ID,l=x.get(u).parents[0].ID,h=x.get(l).parents[0].ID;o=b.Objects.Model[h],s={modelName:a.Ub.sanitizeNodeName(o.attrName),morphName:b.Objects.Deformer[c].attrName};i[r]=s}i[r][n.attr]=n}}}),r.set(parseInt(n),i)}return r},parseAnimStacks:function(e){var t=b.Objects.AnimationStack,r={};for(var n in t){var i=x.get(parseInt(n)).children;1<i.length&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var a=e.get(i[0].ID);r[n]={name:t[n].attrName,layer:a}}return r},addClip:function(e){var t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new a.d(e.name,-1,t)},generateTracks:function(e){var t=[],r=new a.Jc,n=new a.Vb,i=new a.Jc;if(e.transform&&e.transform.decompose(r,n,i),r=r.toArray(),n=(new a.J).setFromQuaternion(n,e.eulerOrder).toArray(),i=i.toArray(),void 0!==e.T&&0<Object.keys(e.T.curves).length){var o=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&0<Object.keys(e.R.curves).length){var s=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==s&&t.push(s)}if(void 0!==e.S&&0<Object.keys(e.S.curves).length){var c=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==c&&t.push(c)}if(void 0!==e.DeformPercent){var u=this.generateMorphTrack(e);void 0!==u&&t.push(u)}return t},generateVectorTrack:function(e,t,r,n){var i=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(i,t,r);return new a.Lc(e+"."+n,i,o)},generateRotationTrack:function(e,t,r,n,i,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(a.sb.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(a.sb.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(a.sb.degToRad));var s=this.getTimesForAllAxes(t),c=this.getKeyframeTrackValues(s,t,r);void 0!==n&&((n=n.map(a.sb.degToRad)).push(o),n=(new a.J).fromArray(n),n=(new a.Vb).setFromEuler(n)),void 0!==i&&((i=i.map(a.sb.degToRad)).push(o),i=(new a.J).fromArray(i),i=(new a.Vb).setFromEuler(i).inverse());for(var u=new a.Vb,l=new a.J,h=[],p=0;p<c.length;p+=3)l.set(c[p],c[p+1],c[p+2],o),u.setFromEuler(l),void 0!==n&&u.premultiply(n),void 0!==i&&u.multiply(i),u.toArray(h,p/3*4);return new a.Wb(e+".quaternion",s,h)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,r=t.values.map(function(e){return e/100}),n=w.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new a.Jb(e.modelName+".morphTargetInfluences["+n+"]",t.times,r)},getTimesForAllAxes:function(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t})},getKeyframeTrackValues:function(e,t,r){var n=r,i=[],a=-1,o=-1,s=-1;return e.forEach(function(e){if(t.x&&(a=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==a){var r=t.x.values[a];i.push(r),n[0]=r}else i.push(n[0]);if(-1!==o){var c=t.y.values[o];i.push(c),n[1]=c}else i.push(n[1]);if(-1!==s){var u=t.z.values[s];i.push(u),n[2]=u}else i.push(n[2])}),i},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],n=e.values[t]-r,i=Math.abs(n);if(180<=i){for(var a=i/180,o=n/a,s=r+o,c=e.times[t-1],u=(e.times[t]-c)/a,l=c+u,h=[],p=[];l<e.times[t];)h.push(l),l+=u,p.push(s),s+=o;e.times=y(e.times,t,h),e.values=y(e.values,t,p)}}}},i.prototype={constructor:i,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new l,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){var i=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(!i&&!a){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,r[++n]):c?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:r},a=this.parseNodeAttr(n),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in o?("PoseNode"===r?o.PoseNode.push(i):void 0!==o[r].id&&(o[r]={},o[r][o[r].id]=o[r]),""!==a.id&&(o[r][a.id]=i)):"number"==typeof a.id?(o[r]={},o[r][a.id]=i):"Properties70"!==r&&(o[r]="PoseNode"===r?[i]:i),"number"==typeof a.id&&(i.id=a.id),""!==a.name&&(i.attrName=a.name),""!==a.type&&(i.attrType=a.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",n="";return 1<e.length&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===n){var o=i.split(",").slice(1),s=parseInt(o[0]),c=parseInt(o[1]),u=i.split(",").slice(3);n="connections",function(e,t){for(var r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[s,c],u=u.map(function(e){return e.trim().replace(/^"/,"")})),void 0===a[n]&&(a[n]=[])}"Node"===n&&(a.id=i),n in a&&Array.isArray(a[n])?a[n].push(i):"a"===n?a.a=i:a[n]=i,this.setCurrentProp(a,n),"a"===n&&","!==i.slice(-1)&&(a.a=g(i))}else this.parseNodeSpecialProperty(e,n,i)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=g(t.a))},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=n[0],a=n[1],o=n[2],s=n[3],c=n[4];"int"===a||"enum"===a||"bool"===a||"ULongLong"===a||"double"===a||"Number"===a||"FieldOfView"===a?c=parseFloat(c):("Color"===a||"ColorRGB"===a||"Vector3D"===a||"Lcl_Translation"===a||"Lcl_Rotation"===a||"Lcl_Scaling"===a)&&(c=g(c)),this.getPrevNode()[i]={type:a,type2:o,flag:s,value:c},this.setCurrentProp(this.getPrevNode(),i)}},s.prototype={constructor:s,parse:function(e){var t=new u(e);t.skip(23);var r=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+r);for(var n=new l;!this.endOfContent(t);){var i=this.parseNode(t,r);null!==i&&n.add(i.name,i)}return n},endOfContent:function(e){return 0==e.size()%16?(-16&e.getOffset()+160+16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},n=7500<=t?e.getUint64():e.getUint32(),i=7500<=t?e.getUint64():e.getUint32(),a=(7500<=t?e.getUint64():e.getUint32(),e.getUint8()),o=e.getString(a);if(0===n)return null;for(var s=[],c=0;c<i;c++)s.push(this.parseProperty(e));var u=0<s.length?s[0]:"",l=1<s.length?s[1]:"",h=2<s.length?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===n;n>e.getOffset();){var p=this.parseNode(e,t);null!==p&&this.parseSubNode(o,r,p)}return r.propertyList=s,"number"==typeof u&&(r.id=u),""!==l&&(r.attrName=l),""!==h&&(r.attrType=h),""!==o&&(r.name=o),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var n=r.propertyList[0];Array.isArray(n)?(t[r.name]=r,r.a=n):t[r.name]=n}else if("Connections"===e&&"C"===r.name){var i=[];r.propertyList.forEach(function(e,t){0!==t&&i.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===r.name){Object.keys(r).forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){var a,o=r.propertyList[0],s=r.propertyList[1],c=r.propertyList[2],u=r.propertyList[3];0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),a="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[o]={type:s,type2:c,flag:u,value:a}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(!Array.isArray(t[r.name])&&(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(0===i)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}void 0===o.a&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var s=new u(new o.a.Inflate(new Uint8Array(e.getArrayBuffer(a))).decompress().buffer);switch(t){case"b":case"c":return s.getBooleanArray(n);case"d":return s.getFloat64Array(n);case"f":return s.getFloat32Array(n);case"i":return s.getInt32Array(n);case"l":return s.getInt64Array(n)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},u.prototype={constructor:u,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=4294967295&t+1),-(4294967296*t+(e=4294967295&e+1))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],r=0;r<e;r++)t[r]=this.getUint8();var n=t.indexOf(0);return 0<=n&&(t=t.slice(0,n)),a.ob.decodeText(new Uint8Array(t))}},l.prototype={constructor:l,add:function(e,t){this[e]=t}};var _=[],T=new a.J,E=new a.Jc;return e}(),l=r(1);r.d(t,"GetFBX",function(){return n})},function(e,t,r){"use strict";function n(){}function i(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=!(void 0!==t)||t,this.encoder=new n}function a(){}function o(){}function s(e,t){return Object(m.a)(new f,e,t)}var c=String.fromCharCode,u=Math.round,l=Math.max;r.r(t);var h=r(0),p=r(3);n.prototype.s2u=function(e){for(var t,r=this.s2uTable,n="",i=0;i<e.length;){if(!(0<=(t=e[i++])&&126>=t||161<=t&&223>=t)&&i<e.length&&(t=t<<8|e[i++]),void 0===r[t])throw"unknown char code "+t+".";n+=c(r[t])}return n},n.prototype.s2uTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:65340,33120:65374,33121:8741,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:65293,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:65504,33170:65505,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:65506,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34624:9312,34625:9313,34626:9314,34627:9315,34628:9316,34629:9317,34630:9318,34631:9319,34632:9320,34633:9321,34634:9322,34635:9323,34636:9324,34637:9325,34638:9326,34639:9327,34640:9328,34641:9329,34642:9330,34643:9331,34644:8544,34645:8545,34646:8546,34647:8547,34648:8548,34649:8549,34650:8550,34651:8551,34652:8552,34653:8553,34655:13129,34656:13076,34657:13090,34658:13133,34659:13080,34660:13095,34661:13059,34662:13110,34663:13137,34664:13143,34665:13069,34666:13094,34667:13091,34668:13099,34669:13130,34670:13115,34671:13212,34672:13213,34673:13214,34674:13198,34675:13199,34676:13252,34677:13217,34686:13179,34688:12317,34689:12319,34690:8470,34691:13261,34692:8481,34693:12964,34694:12965,34695:12966,34696:12967,34697:12968,34698:12849,34699:12850,34700:12857,34701:13182,34702:13181,34703:13180,34704:8786,34705:8801,34706:8747,34707:8750,34708:8721,34709:8730,34710:8869,34711:8736,34712:8735,34713:8895,34714:8757,34715:8745,34716:8746,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081,60736:32394,60737:35100,60738:37704,60739:37512,60740:34012,60741:20425,60742:28859,60743:26161,60744:26824,60745:37625,60746:26363,60747:24389,60748:20008,60749:20193,60750:20220,60751:20224,60752:20227,60753:20281,60754:20310,60755:20370,60756:20362,60757:20378,60758:20372,60759:20429,60760:20544,60761:20514,60762:20479,60763:20510,60764:20550,60765:20592,60766:20546,60767:20628,60768:20724,60769:20696,60770:20810,60771:20836,60772:20893,60773:20926,60774:20972,60775:21013,60776:21148,60777:21158,60778:21184,60779:21211,60780:21248,60781:21255,60782:21284,60783:21362,60784:21395,60785:21426,60786:21469,60787:64014,60788:21660,60789:21642,60790:21673,60791:21759,60792:21894,60793:22361,60794:22373,60795:22444,60796:22472,60797:22471,60798:64015,60800:64016,60801:22686,60802:22706,60803:22795,60804:22867,60805:22875,60806:22877,60807:22883,60808:22948,60809:22970,60810:23382,60811:23488,60812:29999,60813:23512,60814:23532,60815:23582,60816:23718,60817:23738,60818:23797,60819:23847,60820:23891,60821:64017,60822:23874,60823:23917,60824:23992,60825:23993,60826:24016,60827:24353,60828:24372,60829:24423,60830:24503,60831:24542,60832:24669,60833:24709,60834:24714,60835:24798,60836:24789,60837:24864,60838:24818,60839:24849,60840:24887,60841:24880,60842:24984,60843:25107,60844:25254,60845:25589,60846:25696,60847:25757,60848:25806,60849:25934,60850:26112,60851:26133,60852:26171,60853:26121,60854:26158,60855:26142,60856:26148,60857:26213,60858:26199,60859:26201,60860:64018,60861:26227,60862:26265,60863:26272,60864:26290,60865:26303,60866:26362,60867:26382,60868:63785,60869:26470,60870:26555,60871:26706,60872:26560,60873:26625,60874:26692,60875:26831,60876:64019,60877:26984,60878:64020,60879:27032,60880:27106,60881:27184,60882:27243,60883:27206,60884:27251,60885:27262,60886:27362,60887:27364,60888:27606,60889:27711,60890:27740,60891:27782,60892:27759,60893:27866,60894:27908,60895:28039,60896:28015,60897:28054,60898:28076,60899:28111,60900:28152,60901:28146,60902:28156,60903:28217,60904:28252,60905:28199,60906:28220,60907:28351,60908:28552,60909:28597,60910:28661,60911:28677,60912:28679,60913:28712,60914:28805,60915:28843,60916:28943,60917:28932,60918:29020,60919:28998,60920:28999,60921:64021,60922:29121,60923:29182,60924:29361,60992:29374,60993:29476,60994:64022,60995:29559,60996:29629,60997:29641,60998:29654,60999:29667,61e3:29650,61001:29703,61002:29685,61003:29734,61004:29738,61005:29737,61006:29742,61007:29794,61008:29833,61009:29855,61010:29953,61011:30063,61012:30338,61013:30364,61014:30366,61015:30363,61016:30374,61017:64023,61018:30534,61019:21167,61020:30753,61021:30798,61022:30820,61023:30842,61024:31024,61025:64024,61026:64025,61027:64026,61028:31124,61029:64027,61030:31131,61031:31441,61032:31463,61033:64028,61034:31467,61035:31646,61036:64029,61037:32072,61038:32092,61039:32183,61040:32160,61041:32214,61042:32338,61043:32583,61044:32673,61045:64030,61046:33537,61047:33634,61048:33663,61049:33735,61050:33782,61051:33864,61052:33972,61053:34131,61054:34137,61056:34155,61057:64031,61058:34224,61059:64032,61060:64033,61061:34823,61062:35061,61063:35346,61064:35383,61065:35449,61066:35495,61067:35518,61068:35551,61069:64034,61070:35574,61071:35667,61072:35711,61073:36080,61074:36084,61075:36114,61076:36214,61077:64035,61078:36559,61079:64036,61080:64037,61081:36967,61082:37086,61083:64038,61084:37141,61085:37159,61086:37338,61087:37335,61088:37342,61089:37357,61090:37358,61091:37348,61092:37349,61093:37382,61094:37392,61095:37386,61096:37434,61097:37440,61098:37436,61099:37454,61100:37465,61101:37457,61102:37433,61103:37479,61104:37543,61105:37495,61106:37496,61107:37607,61108:37591,61109:37593,61110:37584,61111:64039,61112:37589,61113:37600,61114:37587,61115:37669,61116:37665,61117:37627,61118:64040,61119:37662,61120:37631,61121:37661,61122:37634,61123:37744,61124:37719,61125:37796,61126:37830,61127:37854,61128:37880,61129:37937,61130:37957,61131:37960,61132:38290,61133:63964,61134:64041,61135:38557,61136:38575,61137:38707,61138:38715,61139:38723,61140:38733,61141:38735,61142:38737,61143:38741,61144:38999,61145:39013,61146:64042,61147:64043,61148:39207,61149:64044,61150:39326,61151:39502,61152:39641,61153:39644,61154:39797,61155:39794,61156:39823,61157:39857,61158:39867,61159:39936,61160:40304,61161:40299,61162:64045,61163:40473,61164:40657,61167:8560,61168:8561,61169:8562,61170:8563,61171:8564,61172:8565,61173:8566,61174:8567,61175:8568,61176:8569,61177:65506,61178:65508,61179:65287,61180:65282,61504:57344,61505:57345,61506:57346,61507:57347,61508:57348,61509:57349,61510:57350,61511:57351,61512:57352,61513:57353,61514:57354,61515:57355,61516:57356,61517:57357,61518:57358,61519:57359,61520:57360,61521:57361,61522:57362,61523:57363,61524:57364,61525:57365,61526:57366,61527:57367,61528:57368,61529:57369,61530:57370,61531:57371,61532:57372,61533:57373,61534:57374,61535:57375,61536:57376,61537:57377,61538:57378,61539:57379,61540:57380,61541:57381,61542:57382,61543:57383,61544:57384,61545:57385,61546:57386,61547:57387,61548:57388,61549:57389,61550:57390,61551:57391,61552:57392,61553:57393,61554:57394,61555:57395,61556:57396,61557:57397,61558:57398,61559:57399,61560:57400,61561:57401,61562:57402,61563:57403,61564:57404,61565:57405,61566:57406,61568:57407,61569:57408,61570:57409,61571:57410,61572:57411,61573:57412,61574:57413,61575:57414,61576:57415,61577:57416,61578:57417,61579:57418,61580:57419,61581:57420,61582:57421,61583:57422,61584:57423,61585:57424,61586:57425,61587:57426,61588:57427,61589:57428,61590:57429,61591:57430,61592:57431,61593:57432,61594:57433,61595:57434,61596:57435,61597:57436,61598:57437,61599:57438,61600:57439,61601:57440,61602:57441,61603:57442,61604:57443,61605:57444,61606:57445,61607:57446,61608:57447,61609:57448,61610:57449,61611:57450,61612:57451,61613:57452,61614:57453,61615:57454,61616:57455,61617:57456,61618:57457,61619:57458,61620:57459,61621:57460,61622:57461,61623:57462,61624:57463,61625:57464,61626:57465,61627:57466,61628:57467,61629:57468,61630:57469,61631:57470,61632:57471,61633:57472,61634:57473,61635:57474,61636:57475,61637:57476,61638:57477,61639:57478,61640:57479,61641:57480,61642:57481,61643:57482,61644:57483,61645:57484,61646:57485,61647:57486,61648:57487,61649:57488,61650:57489,61651:57490,61652:57491,61653:57492,61654:57493,61655:57494,61656:57495,61657:57496,61658:57497,61659:57498,61660:57499,61661:57500,61662:57501,61663:57502,61664:57503,61665:57504,61666:57505,61667:57506,61668:57507,61669:57508,61670:57509,61671:57510,61672:57511,61673:57512,61674:57513,61675:57514,61676:57515,61677:57516,61678:57517,61679:57518,61680:57519,61681:57520,61682:57521,61683:57522,61684:57523,61685:57524,61686:57525,61687:57526,61688:57527,61689:57528,61690:57529,61691:57530,61692:57531,61760:57532,61761:57533,61762:57534,61763:57535,61764:57536,61765:57537,61766:57538,61767:57539,61768:57540,61769:57541,61770:57542,61771:57543,61772:57544,61773:57545,61774:57546,61775:57547,61776:57548,61777:57549,61778:57550,61779:57551,61780:57552,61781:57553,61782:57554,61783:57555,61784:57556,61785:57557,61786:57558,61787:57559,61788:57560,61789:57561,61790:57562,61791:57563,61792:57564,61793:57565,61794:57566,61795:57567,61796:57568,61797:57569,61798:57570,61799:57571,61800:57572,61801:57573,61802:57574,61803:57575,61804:57576,61805:57577,61806:57578,61807:57579,61808:57580,61809:57581,61810:57582,61811:57583,61812:57584,61813:57585,61814:57586,61815:57587,61816:57588,61817:57589,61818:57590,61819:57591,61820:57592,61821:57593,61822:57594,61824:57595,61825:57596,61826:57597,61827:57598,61828:57599,61829:57600,61830:57601,61831:57602,61832:57603,61833:57604,61834:57605,61835:57606,61836:57607,61837:57608,61838:57609,61839:57610,61840:57611,61841:57612,61842:57613,61843:57614,61844:57615,61845:57616,61846:57617,61847:57618,61848:57619,61849:57620,61850:57621,61851:57622,61852:57623,61853:57624,61854:57625,61855:57626,61856:57627,61857:57628,61858:57629,61859:57630,61860:57631,61861:57632,61862:57633,61863:57634,61864:57635,61865:57636,61866:57637,61867:57638,61868:57639,61869:57640,61870:57641,61871:57642,61872:57643,61873:57644,61874:57645,61875:57646,61876:57647,61877:57648,61878:57649,61879:57650,61880:57651,61881:57652,61882:57653,61883:57654,61884:57655,61885:57656,61886:57657,61887:57658,61888:57659,61889:57660,61890:57661,61891:57662,61892:57663,61893:57664,61894:57665,61895:57666,61896:57667,61897:57668,61898:57669,61899:57670,61900:57671,61901:57672,61902:57673,61903:57674,61904:57675,61905:57676,61906:57677,61907:57678,61908:57679,61909:57680,61910:57681,61911:57682,61912:57683,61913:57684,61914:57685,61915:57686,61916:57687,61917:57688,61918:57689,61919:57690,61920:57691,61921:57692,61922:57693,61923:57694,61924:57695,61925:57696,61926:57697,61927:57698,61928:57699,61929:57700,61930:57701,61931:57702,61932:57703,61933:57704,61934:57705,61935:57706,61936:57707,61937:57708,61938:57709,61939:57710,61940:57711,61941:57712,61942:57713,61943:57714,61944:57715,61945:57716,61946:57717,61947:57718,61948:57719,62016:57720,62017:57721,62018:57722,62019:57723,62020:57724,62021:57725,62022:57726,62023:57727,62024:57728,62025:57729,62026:57730,62027:57731,62028:57732,62029:57733,62030:57734,62031:57735,62032:57736,62033:57737,62034:57738,62035:57739,62036:57740,62037:57741,62038:57742,62039:57743,62040:57744,62041:57745,62042:57746,62043:57747,62044:57748,62045:57749,62046:57750,62047:57751,62048:57752,62049:57753,62050:57754,62051:57755,62052:57756,62053:57757,62054:57758,62055:57759,62056:57760,62057:57761,62058:57762,62059:57763,62060:57764,62061:57765,62062:57766,62063:57767,62064:57768,62065:57769,62066:57770,62067:57771,62068:57772,62069:57773,62070:57774,62071:57775,62072:57776,62073:57777,62074:57778,62075:57779,62076:57780,62077:57781,62078:57782,62080:57783,62081:57784,62082:57785,62083:57786,62084:57787,62085:57788,62086:57789,62087:57790,62088:57791,62089:57792,62090:57793,62091:57794,62092:57795,62093:57796,62094:57797,62095:57798,62096:57799,62097:57800,62098:57801,62099:57802,62100:57803,62101:57804,62102:57805,62103:57806,62104:57807,62105:57808,62106:57809,62107:57810,62108:57811,62109:57812,62110:57813,62111:57814,62112:57815,62113:57816,62114:57817,62115:57818,62116:57819,62117:57820,62118:57821,62119:57822,62120:57823,62121:57824,62122:57825,62123:57826,62124:57827,62125:57828,62126:57829,62127:57830,62128:57831,62129:57832,62130:57833,62131:57834,62132:57835,62133:57836,62134:57837,62135:57838,62136:57839,62137:57840,62138:57841,62139:57842,62140:57843,62141:57844,62142:57845,62143:57846,62144:57847,62145:57848,62146:57849,62147:57850,62148:57851,62149:57852,62150:57853,62151:57854,62152:57855,62153:57856,62154:57857,62155:57858,62156:57859,62157:57860,62158:57861,62159:57862,62160:57863,62161:57864,62162:57865,62163:57866,62164:57867,62165:57868,62166:57869,62167:57870,62168:57871,62169:57872,62170:57873,62171:57874,62172:57875,62173:57876,62174:57877,62175:57878,62176:57879,62177:57880,62178:57881,62179:57882,62180:57883,62181:57884,62182:57885,62183:57886,62184:57887,62185:57888,62186:57889,62187:57890,62188:57891,62189:57892,62190:57893,62191:57894,62192:57895,62193:57896,62194:57897,62195:57898,62196:57899,62197:57900,62198:57901,62199:57902,62200:57903,62201:57904,62202:57905,62203:57906,62204:57907,62272:57908,62273:57909,62274:57910,62275:57911,62276:57912,62277:57913,62278:57914,62279:57915,62280:57916,62281:57917,62282:57918,62283:57919,62284:57920,62285:57921,62286:57922,62287:57923,62288:57924,62289:57925,62290:57926,62291:57927,62292:57928,62293:57929,62294:57930,62295:57931,62296:57932,62297:57933,62298:57934,62299:57935,62300:57936,62301:57937,62302:57938,62303:57939,62304:57940,62305:57941,62306:57942,62307:57943,62308:57944,62309:57945,62310:57946,62311:57947,62312:57948,62313:57949,62314:57950,62315:57951,62316:57952,62317:57953,62318:57954,62319:57955,62320:57956,62321:57957,62322:57958,62323:57959,62324:57960,62325:57961,62326:57962,62327:57963,62328:57964,62329:57965,62330:57966,62331:57967,62332:57968,62333:57969,62334:57970,62336:57971,62337:57972,62338:57973,62339:57974,62340:57975,62341:57976,62342:57977,62343:57978,62344:57979,62345:57980,62346:57981,62347:57982,62348:57983,62349:57984,62350:57985,62351:57986,62352:57987,62353:57988,62354:57989,62355:57990,62356:57991,62357:57992,62358:57993,62359:57994,62360:57995,62361:57996,62362:57997,62363:57998,62364:57999,62365:58e3,62366:58001,62367:58002,62368:58003,62369:58004,62370:58005,62371:58006,62372:58007,62373:58008,62374:58009,62375:58010,62376:58011,62377:58012,62378:58013,62379:58014,62380:58015,62381:58016,62382:58017,62383:58018,62384:58019,62385:58020,62386:58021,62387:58022,62388:58023,62389:58024,62390:58025,62391:58026,62392:58027,62393:58028,62394:58029,62395:58030,62396:58031,62397:58032,62398:58033,62399:58034,62400:58035,62401:58036,62402:58037,62403:58038,62404:58039,62405:58040,62406:58041,62407:58042,62408:58043,62409:58044,62410:58045,62411:58046,62412:58047,62413:58048,62414:58049,62415:58050,62416:58051,62417:58052,62418:58053,62419:58054,62420:58055,62421:58056,62422:58057,62423:58058,62424:58059,62425:58060,62426:58061,62427:58062,62428:58063,62429:58064,62430:58065,62431:58066,62432:58067,62433:58068,62434:58069,62435:58070,62436:58071,62437:58072,62438:58073,62439:58074,62440:58075,62441:58076,62442:58077,62443:58078,62444:58079,62445:58080,62446:58081,62447:58082,62448:58083,62449:58084,62450:58085,62451:58086,62452:58087,62453:58088,62454:58089,62455:58090,62456:58091,62457:58092,62458:58093,62459:58094,62460:58095,62528:58096,62529:58097,62530:58098,62531:58099,62532:58100,62533:58101,62534:58102,62535:58103,62536:58104,62537:58105,62538:58106,62539:58107,62540:58108,62541:58109,62542:58110,62543:58111,62544:58112,62545:58113,62546:58114,62547:58115,62548:58116,62549:58117,62550:58118,62551:58119,62552:58120,62553:58121,62554:58122,62555:58123,62556:58124,62557:58125,62558:58126,62559:58127,62560:58128,62561:58129,62562:58130,62563:58131,62564:58132,62565:58133,62566:58134,62567:58135,62568:58136,62569:58137,62570:58138,62571:58139,62572:58140,62573:58141,62574:58142,62575:58143,62576:58144,62577:58145,62578:58146,62579:58147,62580:58148,62581:58149,62582:58150,62583:58151,62584:58152,62585:58153,62586:58154,62587:58155,62588:58156,62589:58157,62590:58158,62592:58159,62593:58160,62594:58161,62595:58162,62596:58163,62597:58164,62598:58165,62599:58166,62600:58167,62601:58168,62602:58169,62603:58170,62604:58171,62605:58172,62606:58173,62607:58174,62608:58175,62609:58176,62610:58177,62611:58178,62612:58179,62613:58180,62614:58181,62615:58182,62616:58183,62617:58184,62618:58185,62619:58186,62620:58187,62621:58188,62622:58189,62623:58190,62624:58191,62625:58192,62626:58193,62627:58194,62628:58195,62629:58196,62630:58197,62631:58198,62632:58199,62633:58200,62634:58201,62635:58202,62636:58203,62637:58204,62638:58205,62639:58206,62640:58207,62641:58208,62642:58209,62643:58210,62644:58211,62645:58212,62646:58213,62647:58214,62648:58215,62649:58216,62650:58217,62651:58218,62652:58219,62653:58220,62654:58221,62655:58222,62656:58223,62657:58224,62658:58225,62659:58226,62660:58227,62661:58228,62662:58229,62663:58230,62664:58231,62665:58232,62666:58233,62667:58234,62668:58235,62669:58236,62670:58237,62671:58238,62672:58239,62673:58240,62674:58241,62675:58242,62676:58243,62677:58244,62678:58245,62679:58246,62680:58247,62681:58248,62682:58249,62683:58250,62684:58251,62685:58252,62686:58253,62687:58254,62688:58255,62689:58256,62690:58257,62691:58258,62692:58259,62693:58260,62694:58261,62695:58262,62696:58263,62697:58264,62698:58265,62699:58266,62700:58267,62701:58268,62702:58269,62703:58270,62704:58271,62705:58272,62706:58273,62707:58274,62708:58275,62709:58276,62710:58277,62711:58278,62712:58279,62713:58280,62714:58281,62715:58282,62716:58283,62784:58284,62785:58285,62786:58286,62787:58287,62788:58288,62789:58289,62790:58290,62791:58291,62792:58292,62793:58293,62794:58294,62795:58295,62796:58296,62797:58297,62798:58298,62799:58299,62800:58300,62801:58301,62802:58302,62803:58303,62804:58304,62805:58305,62806:58306,62807:58307,62808:58308,62809:58309,62810:58310,62811:58311,62812:58312,62813:58313,62814:58314,62815:58315,62816:58316,62817:58317,62818:58318,62819:58319,62820:58320,62821:58321,62822:58322,62823:58323,62824:58324,62825:58325,62826:58326,62827:58327,62828:58328,62829:58329,62830:58330,62831:58331,62832:58332,62833:58333,62834:58334,62835:58335,62836:58336,62837:58337,62838:58338,62839:58339,62840:58340,62841:58341,62842:58342,62843:58343,62844:58344,62845:58345,62846:58346,62848:58347,62849:58348,62850:58349,62851:58350,62852:58351,62853:58352,62854:58353,62855:58354,62856:58355,62857:58356,62858:58357,62859:58358,62860:58359,62861:58360,62862:58361,62863:58362,62864:58363,62865:58364,62866:58365,62867:58366,62868:58367,62869:58368,62870:58369,62871:58370,62872:58371,62873:58372,62874:58373,62875:58374,62876:58375,62877:58376,62878:58377,62879:58378,62880:58379,62881:58380,62882:58381,62883:58382,62884:58383,62885:58384,62886:58385,62887:58386,62888:58387,62889:58388,62890:58389,62891:58390,62892:58391,62893:58392,62894:58393,62895:58394,62896:58395,62897:58396,62898:58397,62899:58398,62900:58399,62901:58400,62902:58401,62903:58402,62904:58403,62905:58404,62906:58405,62907:58406,62908:58407,62909:58408,62910:58409,62911:58410,62912:58411,62913:58412,62914:58413,62915:58414,62916:58415,62917:58416,62918:58417,62919:58418,62920:58419,62921:58420,62922:58421,62923:58422,62924:58423,62925:58424,62926:58425,62927:58426,62928:58427,62929:58428,62930:58429,62931:58430,62932:58431,62933:58432,62934:58433,62935:58434,62936:58435,62937:58436,62938:58437,62939:58438,62940:58439,62941:58440,62942:58441,62943:58442,62944:58443,62945:58444,62946:58445,62947:58446,62948:58447,62949:58448,62950:58449,62951:58450,62952:58451,62953:58452,62954:58453,62955:58454,62956:58455,62957:58456,62958:58457,62959:58458,62960:58459,62961:58460,62962:58461,62963:58462,62964:58463,62965:58464,62966:58465,62967:58466,62968:58467,62969:58468,62970:58469,62971:58470,62972:58471,63040:58472,63041:58473,63042:58474,63043:58475,63044:58476,63045:58477,63046:58478,63047:58479,63048:58480,63049:58481,63050:58482,63051:58483,63052:58484,63053:58485,63054:58486,63055:58487,63056:58488,63057:58489,63058:58490,63059:58491,63060:58492,63061:58493,63062:58494,63063:58495,63064:58496,63065:58497,63066:58498,63067:58499,63068:58500,63069:58501,63070:58502,63071:58503,63072:58504,63073:58505,63074:58506,63075:58507,63076:58508,63077:58509,63078:58510,63079:58511,63080:58512,63081:58513,63082:58514,63083:58515,63084:58516,63085:58517,63086:58518,63087:58519,63088:58520,63089:58521,63090:58522,63091:58523,63092:58524,63093:58525,63094:58526,63095:58527,63096:58528,63097:58529,63098:58530,63099:58531,63100:58532,63101:58533,63102:58534,63104:58535,63105:58536,63106:58537,63107:58538,63108:58539,63109:58540,63110:58541,63111:58542,63112:58543,63113:58544,63114:58545,63115:58546,63116:58547,63117:58548,63118:58549,63119:58550,63120:58551,63121:58552,63122:58553,63123:58554,63124:58555,63125:58556,63126:58557,63127:58558,63128:58559,63129:58560,63130:58561,63131:58562,63132:58563,63133:58564,63134:58565,63135:58566,63136:58567,63137:58568,63138:58569,63139:58570,63140:58571,63141:58572,63142:58573,63143:58574,63144:58575,63145:58576,63146:58577,63147:58578,63148:58579,63149:58580,63150:58581,63151:58582,63152:58583,63153:58584,63154:58585,63155:58586,63156:58587,63157:58588,63158:58589,63159:58590,63160:58591,63161:58592,63162:58593,63163:58594,63164:58595,63165:58596,63166:58597,63167:58598,63168:58599,63169:58600,63170:58601,63171:58602,63172:58603,63173:58604,63174:58605,63175:58606,63176:58607,63177:58608,63178:58609,63179:58610,63180:58611,63181:58612,63182:58613,63183:58614,63184:58615,63185:58616,63186:58617,63187:58618,63188:58619,63189:58620,63190:58621,63191:58622,63192:58623,63193:58624,63194:58625,63195:58626,63196:58627,63197:58628,63198:58629,63199:58630,63200:58631,63201:58632,63202:58633,63203:58634,63204:58635,63205:58636,63206:58637,63207:58638,63208:58639,63209:58640,63210:58641,63211:58642,63212:58643,63213:58644,63214:58645,63215:58646,63216:58647,63217:58648,63218:58649,63219:58650,63220:58651,63221:58652,63222:58653,63223:58654,63224:58655,63225:58656,63226:58657,63227:58658,63228:58659,63296:58660,63297:58661,63298:58662,63299:58663,63300:58664,63301:58665,63302:58666,63303:58667,63304:58668,63305:58669,63306:58670,63307:58671,63308:58672,63309:58673,63310:58674,63311:58675,63312:58676,63313:58677,63314:58678,63315:58679,63316:58680,63317:58681,63318:58682,63319:58683,63320:58684,63321:58685,63322:58686,63323:58687,63324:58688,63325:58689,63326:58690,63327:58691,63328:58692,63329:58693,63330:58694,63331:58695,63332:58696,63333:58697,63334:58698,63335:58699,63336:58700,63337:58701,63338:58702,63339:58703,63340:58704,63341:58705,63342:58706,63343:58707,63344:58708,63345:58709,63346:58710,63347:58711,63348:58712,63349:58713,63350:58714,63351:58715,63352:58716,63353:58717,63354:58718,63355:58719,63356:58720,63357:58721,63358:58722,63360:58723,63361:58724,63362:58725,63363:58726,63364:58727,63365:58728,63366:58729,63367:58730,63368:58731,63369:58732,63370:58733,63371:58734,63372:58735,63373:58736,63374:58737,63375:58738,63376:58739,63377:58740,63378:58741,63379:58742,63380:58743,63381:58744,63382:58745,63383:58746,63384:58747,63385:58748,63386:58749,63387:58750,63388:58751,63389:58752,63390:58753,63391:58754,63392:58755,63393:58756,63394:58757,63395:58758,63396:58759,63397:58760,63398:58761,63399:58762,63400:58763,63401:58764,63402:58765,63403:58766,63404:58767,63405:58768,63406:58769,63407:58770,63408:58771,63409:58772,63410:58773,63411:58774,63412:58775,63413:58776,63414:58777,63415:58778,63416:58779,63417:58780,63418:58781,63419:58782,63420:58783,63421:58784,63422:58785,63423:58786,63424:58787,63425:58788,63426:58789,63427:58790,63428:58791,63429:58792,63430:58793,63431:58794,63432:58795,63433:58796,63434:58797,63435:58798,63436:58799,63437:58800,63438:58801,63439:58802,63440:58803,63441:58804,63442:58805,63443:58806,63444:58807,63445:58808,63446:58809,63447:58810,63448:58811,63449:58812,63450:58813,63451:58814,63452:58815,63453:58816,63454:58817,63455:58818,63456:58819,63457:58820,63458:58821,63459:58822,63460:58823,63461:58824,63462:58825,63463:58826,63464:58827,63465:58828,63466:58829,63467:58830,63468:58831,63469:58832,63470:58833,63471:58834,63472:58835,63473:58836,63474:58837,63475:58838,63476:58839,63477:58840,63478:58841,63479:58842,63480:58843,63481:58844,63482:58845,63483:58846,63484:58847,63552:58848,63553:58849,63554:58850,63555:58851,63556:58852,63557:58853,63558:58854,63559:58855,63560:58856,63561:58857,63562:58858,63563:58859,63564:58860,63565:58861,63566:58862,63567:58863,63568:58864,63569:58865,63570:58866,63571:58867,63572:58868,63573:58869,63574:58870,63575:58871,63576:58872,63577:58873,63578:58874,63579:58875,63580:58876,63581:58877,63582:58878,63583:58879,63584:58880,63585:58881,63586:58882,63587:58883,63588:58884,63589:58885,63590:58886,63591:58887,63592:58888,63593:58889,63594:58890,63595:58891,63596:58892,63597:58893,63598:58894,63599:58895,63600:58896,63601:58897,63602:58898,63603:58899,63604:58900,63605:58901,63606:58902,63607:58903,63608:58904,63609:58905,63610:58906,63611:58907,63612:58908,63613:58909,63614:58910,63616:58911,63617:58912,63618:58913,63619:58914,63620:58915,63621:58916,63622:58917,63623:58918,63624:58919,63625:58920,63626:58921,63627:58922,63628:58923,63629:58924,63630:58925,63631:58926,63632:58927,63633:58928,63634:58929,63635:58930,63636:58931,63637:58932,63638:58933,63639:58934,63640:58935,63641:58936,63642:58937,63643:58938,63644:58939,63645:58940,63646:58941,63647:58942,63648:58943,63649:58944,63650:58945,63651:58946,63652:58947,63653:58948,63654:58949,63655:58950,63656:58951,63657:58952,63658:58953,63659:58954,63660:58955,63661:58956,63662:58957,63663:58958,63664:58959,63665:58960,63666:58961,63667:58962,63668:58963,63669:58964,63670:58965,63671:58966,63672:58967,63673:58968,63674:58969,63675:58970,63676:58971,63677:58972,63678:58973,63679:58974,63680:58975,63681:58976,63682:58977,63683:58978,63684:58979,63685:58980,63686:58981,63687:58982,63688:58983,63689:58984,63690:58985,63691:58986,63692:58987,63693:58988,63694:58989,63695:58990,63696:58991,63697:58992,63698:58993,63699:58994,63700:58995,63701:58996,63702:58997,63703:58998,63704:58999,63705:59e3,63706:59001,63707:59002,63708:59003,63709:59004,63710:59005,63711:59006,63712:59007,63713:59008,63714:59009,63715:59010,63716:59011,63717:59012,63718:59013,63719:59014,63720:59015,63721:59016,63722:59017,63723:59018,63724:59019,63725:59020,63726:59021,63727:59022,63728:59023,63729:59024,63730:59025,63731:59026,63732:59027,63733:59028,63734:59029,63735:59030,63736:59031,63737:59032,63738:59033,63739:59034,63740:59035,64064:8560,64065:8561,64066:8562,64067:8563,64068:8564,64069:8565,64070:8566,64071:8567,64072:8568,64073:8569,64074:8544,64075:8545,64076:8546,64077:8547,64078:8548,64079:8549,64080:8550,64081:8551,64082:8552,64083:8553,64084:65506,64085:65508,64086:65287,64087:65282,64088:12849,64089:8470,64090:8481,64091:8757,64092:32394,64093:35100,64094:37704,64095:37512,64096:34012,64097:20425,64098:28859,64099:26161,64100:26824,64101:37625,64102:26363,64103:24389,64104:20008,64105:20193,64106:20220,64107:20224,64108:20227,64109:20281,64110:20310,64111:20370,64112:20362,64113:20378,64114:20372,64115:20429,64116:20544,64117:20514,64118:20479,64119:20510,64120:20550,64121:20592,64122:20546,64123:20628,64124:20724,64125:20696,64126:20810,64128:20836,64129:20893,64130:20926,64131:20972,64132:21013,64133:21148,64134:21158,64135:21184,64136:21211,64137:21248,64138:21255,64139:21284,64140:21362,64141:21395,64142:21426,64143:21469,64144:64014,64145:21660,64146:21642,64147:21673,64148:21759,64149:21894,64150:22361,64151:22373,64152:22444,64153:22472,64154:22471,64155:64015,64156:64016,64157:22686,64158:22706,64159:22795,64160:22867,64161:22875,64162:22877,64163:22883,64164:22948,64165:22970,64166:23382,64167:23488,64168:29999,64169:23512,64170:23532,64171:23582,64172:23718,64173:23738,64174:23797,64175:23847,64176:23891,64177:64017,64178:23874,64179:23917,64180:23992,64181:23993,64182:24016,64183:24353,64184:24372,64185:24423,64186:24503,64187:24542,64188:24669,64189:24709,64190:24714,64191:24798,64192:24789,64193:24864,64194:24818,64195:24849,64196:24887,64197:24880,64198:24984,64199:25107,64200:25254,64201:25589,64202:25696,64203:25757,64204:25806,64205:25934,64206:26112,64207:26133,64208:26171,64209:26121,64210:26158,64211:26142,64212:26148,64213:26213,64214:26199,64215:26201,64216:64018,64217:26227,64218:26265,64219:26272,64220:26290,64221:26303,64222:26362,64223:26382,64224:63785,64225:26470,64226:26555,64227:26706,64228:26560,64229:26625,64230:26692,64231:26831,64232:64019,64233:26984,64234:64020,64235:27032,64236:27106,64237:27184,64238:27243,64239:27206,64240:27251,64241:27262,64242:27362,64243:27364,64244:27606,64245:27711,64246:27740,64247:27782,64248:27759,64249:27866,64250:27908,64251:28039,64252:28015,64320:28054,64321:28076,64322:28111,64323:28152,64324:28146,64325:28156,64326:28217,64327:28252,64328:28199,64329:28220,64330:28351,64331:28552,64332:28597,64333:28661,64334:28677,64335:28679,64336:28712,64337:28805,64338:28843,64339:28943,64340:28932,64341:29020,64342:28998,64343:28999,64344:64021,64345:29121,64346:29182,64347:29361,64348:29374,64349:29476,64350:64022,64351:29559,64352:29629,64353:29641,64354:29654,64355:29667,64356:29650,64357:29703,64358:29685,64359:29734,64360:29738,64361:29737,64362:29742,64363:29794,64364:29833,64365:29855,64366:29953,64367:30063,64368:30338,64369:30364,64370:30366,64371:30363,64372:30374,64373:64023,64374:30534,64375:21167,64376:30753,64377:30798,64378:30820,64379:30842,64380:31024,64381:64024,64382:64025,64384:64026,64385:31124,64386:64027,64387:31131,64388:31441,64389:31463,64390:64028,64391:31467,64392:31646,64393:64029,64394:32072,64395:32092,64396:32183,64397:32160,64398:32214,64399:32338,64400:32583,64401:32673,64402:64030,64403:33537,64404:33634,64405:33663,64406:33735,64407:33782,64408:33864,64409:33972,64410:34131,64411:34137,64412:34155,64413:64031,64414:34224,64415:64032,64416:64033,64417:34823,64418:35061,64419:35346,64420:35383,64421:35449,64422:35495,64423:35518,64424:35551,64425:64034,64426:35574,64427:35667,64428:35711,64429:36080,64430:36084,64431:36114,64432:36214,64433:64035,64434:36559,64435:64036,64436:64037,64437:36967,64438:37086,64439:64038,64440:37141,64441:37159,64442:37338,64443:37335,64444:37342,64445:37357,64446:37358,64447:37348,64448:37349,64449:37382,64450:37392,64451:37386,64452:37434,64453:37440,64454:37436,64455:37454,64456:37465,64457:37457,64458:37433,64459:37479,64460:37543,64461:37495,64462:37496,64463:37607,64464:37591,64465:37593,64466:37584,64467:64039,64468:37589,64469:37600,64470:37587,64471:37669,64472:37665,64473:37627,64474:64040,64475:37662,64476:37631,64477:37661,64478:37634,64479:37744,64480:37719,64481:37796,64482:37830,64483:37854,64484:37880,64485:37937,64486:37957,64487:37960,64488:38290,64489:63964,64490:64041,64491:38557,64492:38575,64493:38707,64494:38715,64495:38723,64496:38733,64497:38735,64498:38737,64499:38741,64500:38999,64501:39013,64502:64042,64503:64043,64504:39207,64505:64044,64506:39326,64507:39502,64508:39641,64576:39644,64577:39797,64578:39794,64579:39823,64580:39857,64581:39867,64582:39936,64583:40304,64584:40299,64585:64045,64586:40473,64587:40657},i.prototype={constructor:i,getInt8:function(){var e=this.dv.getInt8(this.offset);return this.offset+=1,e},getInt8Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt8());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint8Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint8());return t},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt16Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt16());return t},getUint16:function(){var e=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,e},getUint16Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint16());return t},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getUint32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getUint32());return t},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getIndex:function(e,t){switch(e){case 1:return!0===t?this.getUint8():this.getInt8();case 2:return!0===t?this.getUint16():this.getInt16();case 4:return this.getInt32();default:throw"unknown number type "+e+" exception."}},getIndexArray:function(e,t,r){for(var n=[],i=0;i<t;i++)n.push(this.getIndex(e,r));return n},getChars:function(e){for(var t,r="";0<e&&(e--,0!==(t=this.getUint8()));)r+=c(t);for(;0<e;)this.getUint8(),e--;return r},getSjisStringsAsUnicode:function(e){for(var t,r=[];0<e&&(e--,0!==(t=this.getUint8()));)r.push(t);for(;0<e;)this.getUint8(),e--;return this.encoder.s2u(new Uint8Array(r))},getUnicodeStrings:function(e){for(var t,r="";0<e&&(e-=2,0!==(t=this.getUint16()));)r+=c(t);for(;0<e;)this.getUint8(),e--;return r},getTextBuffer:function(){var e=this.getUint32();return this.getUnicodeStrings(e)}},a.prototype={constructor:a,leftToRightVector3:function(e){e[2]=-e[2]},leftToRightQuaternion:function(e){e[0]=-e[0],e[1]=-e[1]},leftToRightEuler:function(e){e[0]=-e[0],e[1]=-e[1]},leftToRightIndexOrder:function(e){var t=e[2];e[2]=e[0],e[0]=t},leftToRightVector3Range:function(e,t){var r=-t[2];t[2]=-e[2],e[2]=r},leftToRightEulerRange:function(e,t){var r=-t[0],n=-t[1];t[0]=-e[0],t[1]=-e[1],e[0]=r,e[1]=n}},o.prototype.parsePmd=function(e,t){var r={},n=new i(e);return r.metadata={},r.metadata.format="pmd",r.metadata.coordinateSystem="left",function(){var e=r.metadata;if(e.magic=n.getChars(3),"Pmd"!==e.magic)throw"PMD file magic is not Pmd, but "+e.magic;e.version=n.getFloat32(),e.modelName=n.getSjisStringsAsUnicode(20),e.comment=n.getSjisStringsAsUnicode(256)}(),function(){var e=function(){var e={};return e.position=n.getFloat32Array(3),e.normal=n.getFloat32Array(3),e.uv=n.getFloat32Array(2),e.skinIndices=n.getUint16Array(2),e.skinWeights=[n.getUint8()/100],e.skinWeights.push(1-e.skinWeights[0]),e.edgeFlag=n.getUint8(),e},t=r.metadata;t.vertexCount=n.getUint32(),r.vertices=[];for(var i=0;i<t.vertexCount;i++)r.vertices.push(e())}(),function(){var e=r.metadata;e.faceCount=n.getUint32()/3,r.faces=[];for(var t=0;t<e.faceCount;t++)r.faces.push({indices:n.getUint16Array(3)})}(),function(){var e=r.metadata;e.materialCount=n.getUint32(),r.materials=[];for(var t=0;t<e.materialCount;t++)r.materials.push({diffuse:n.getFloat32Array(4),shininess:n.getFloat32(),specular:n.getFloat32Array(3),ambient:n.getFloat32Array(3),toonIndex:n.getInt8(),edgeFlag:n.getUint8(),faceCount:n.getUint32()/3,fileName:n.getSjisStringsAsUnicode(20)})}(),function(){var e=r.metadata;e.boneCount=n.getUint16(),r.bones=[];for(var t=0;t<e.boneCount;t++)r.bones.push({name:n.getSjisStringsAsUnicode(20),parentIndex:n.getInt16(),tailIndex:n.getInt16(),type:n.getUint8(),ikIndex:n.getInt16(),position:n.getFloat32Array(3)})}(),function(){var e=function(){for(var e,t={target:n.getUint16(),effector:n.getUint16(),linkCount:n.getUint8(),iteration:n.getUint16(),maxAngle:n.getFloat32(),links:[]},r=0;r<t.linkCount;r++)(e={}).index=n.getUint16(),t.links.push(e);return t},t=r.metadata;t.ikCount=n.getUint16(),r.iks=[];for(var i=0;i<t.ikCount;i++)r.iks.push(e())}(),function(){var e=function(){for(var e={name:n.getSjisStringsAsUnicode(20),elementCount:n.getUint32(),type:n.getUint8(),elements:[]},t=0;t<e.elementCount;t++)e.elements.push({index:n.getUint32(),position:n.getFloat32Array(3)});return e},t=r.metadata;t.morphCount=n.getUint16(),r.morphs=[];for(var i=0;i<t.morphCount;i++)r.morphs.push(e())}(),function(){var e=r.metadata;e.morphFrameCount=n.getUint8(),r.morphFrames=[];for(var t=0;t<e.morphFrameCount;t++)r.morphFrames.push({index:n.getUint16()})}(),function(){var e=r.metadata;e.boneFrameNameCount=n.getUint8(),r.boneFrameNames=[];for(var t=0;t<e.boneFrameNameCount;t++)r.boneFrameNames.push({name:n.getSjisStringsAsUnicode(50)})}(),function(){var e=r.metadata;e.boneFrameCount=n.getUint32(),r.boneFrames=[];for(var t=0;t<e.boneFrameCount;t++)r.boneFrames.push({boneIndex:n.getInt16(),frameIndex:n.getUint8()})}(),function(){var e=r.metadata;e.englishCompatibility=n.getUint8(),0<e.englishCompatibility&&(e.englishModelName=n.getSjisStringsAsUnicode(20),e.englishComment=n.getSjisStringsAsUnicode(256))}(),function(){var e=r.metadata;if(0!==e.englishCompatibility){r.englishBoneNames=[];for(var t=0;t<e.boneCount;t++)r.englishBoneNames.push({name:n.getSjisStringsAsUnicode(20)})}}(),function(){var e=r.metadata;if(0!==e.englishCompatibility){r.englishMorphNames=[];for(var t=0;t<e.morphCount-1;t++)r.englishMorphNames.push({name:n.getSjisStringsAsUnicode(20)})}}(),function(){var e=r.metadata;if(0!==e.englishCompatibility){r.englishBoneFrameNames=[];for(var t=0;t<e.boneFrameNameCount;t++)r.englishBoneFrameNames.push({name:n.getSjisStringsAsUnicode(50)})}}(),function(){r.toonTextures=[];for(var e=0;10>e;e++)r.toonTextures.push({fileName:n.getSjisStringsAsUnicode(100)})}(),function(){var e=r.metadata;e.rigidBodyCount=n.getUint32(),r.rigidBodies=[];for(var t=0;t<e.rigidBodyCount;t++)r.rigidBodies.push({name:n.getSjisStringsAsUnicode(20),boneIndex:n.getInt16(),groupIndex:n.getUint8(),groupTarget:n.getUint16(),shapeType:n.getUint8(),width:n.getFloat32(),height:n.getFloat32(),depth:n.getFloat32(),position:n.getFloat32Array(3),rotation:n.getFloat32Array(3),weight:n.getFloat32(),positionDamping:n.getFloat32(),rotationDamping:n.getFloat32(),restitution:n.getFloat32(),friction:n.getFloat32(),type:n.getUint8()})}(),function(){var e=r.metadata;e.constraintCount=n.getUint32(),r.constraints=[];for(var t=0;t<e.constraintCount;t++)r.constraints.push({name:n.getSjisStringsAsUnicode(20),rigidBodyIndex1:n.getUint32(),rigidBodyIndex2:n.getUint32(),position:n.getFloat32Array(3),rotation:n.getFloat32Array(3),translationLimitation1:n.getFloat32Array(3),translationLimitation2:n.getFloat32Array(3),rotationLimitation1:n.getFloat32Array(3),rotationLimitation2:n.getFloat32Array(3),springPosition:n.getFloat32Array(3),springRotation:n.getFloat32Array(3)})}(),!0===t&&this.leftToRightModel(r),r},o.prototype.parsePmx=function(e,t){var r={},n=new i(e);return r.metadata={},r.metadata.format="pmx",r.metadata.coordinateSystem="left",function(){var e=r.metadata;if(e.magic=n.getChars(4),"PMX "!==e.magic)throw"PMX file magic is not PMX , but "+e.magic;if(e.version=n.getFloat32(),2!==e.version&&2.1!==e.version)throw"PMX version "+e.version+" is not supported.";e.headerSize=n.getUint8(),e.encoding=n.getUint8(),e.additionalUvNum=n.getUint8(),e.vertexIndexSize=n.getUint8(),e.textureIndexSize=n.getUint8(),e.materialIndexSize=n.getUint8(),e.boneIndexSize=n.getUint8(),e.morphIndexSize=n.getUint8(),e.rigidBodyIndexSize=n.getUint8(),e.modelName=n.getTextBuffer(),e.englishModelName=n.getTextBuffer(),e.comment=n.getTextBuffer(),e.englishComment=n.getTextBuffer()}(),function(){var e=function(){for(var e={position:n.getFloat32Array(3),normal:n.getFloat32Array(3),uv:n.getFloat32Array(2),auvs:[]},i=0;i<r.metadata.additionalUvNum;i++)e.auvs.push(n.getFloat32Array(4));e.type=n.getUint8();var a=t.boneIndexSize;if(0===e.type)e.skinIndices=n.getIndexArray(a,1),e.skinWeights=[1];else if(1===e.type)e.skinIndices=n.getIndexArray(a,2),e.skinWeights=n.getFloat32Array(1),e.skinWeights.push(1-e.skinWeights[0]);else if(2===e.type)e.skinIndices=n.getIndexArray(a,4),e.skinWeights=n.getFloat32Array(4);else{if(3!==e.type)throw"unsupport bone type "+e.type+" exception.";e.skinIndices=n.getIndexArray(a,2),e.skinWeights=n.getFloat32Array(1),e.skinWeights.push(1-e.skinWeights[0]),e.skinC=n.getFloat32Array(3),e.skinR0=n.getFloat32Array(3),e.skinR1=n.getFloat32Array(3),e.type=1}return e.edgeRatio=n.getFloat32(),e},t=r.metadata;t.vertexCount=n.getUint32(),r.vertices=[];for(var i=0;i<t.vertexCount;i++)r.vertices.push(e())}(),function(){var e=r.metadata;e.faceCount=n.getUint32()/3,r.faces=[];for(var t=0;t<e.faceCount;t++)r.faces.push({indices:n.getIndexArray(e.vertexIndexSize,3,!0)})}(),function(){var e=r.metadata;e.textureCount=n.getUint32(),r.textures=[];for(var t=0;t<e.textureCount;t++)r.textures.push(n.getTextBuffer())}(),function(){var e=function(){var e={name:n.getTextBuffer(),englishName:n.getTextBuffer(),diffuse:n.getFloat32Array(4),specular:n.getFloat32Array(3),shininess:n.getFloat32(),ambient:n.getFloat32Array(3),flag:n.getUint8(),edgeColor:n.getFloat32Array(4),edgeSize:n.getFloat32(),textureIndex:n.getIndex(r.metadata.textureIndexSize),envTextureIndex:n.getIndex(r.metadata.textureIndexSize),envFlag:n.getUint8(),toonFlag:n.getUint8()};if(0===e.toonFlag)e.toonIndex=n.getIndex(r.metadata.textureIndexSize);else{if(1!==e.toonFlag)throw"unknown toon flag "+e.toonFlag+" exception.";e.toonIndex=n.getInt8()}return e.comment=n.getTextBuffer(),e.faceCount=n.getUint32()/3,e},t=r.metadata;t.materialCount=n.getUint32(),r.materials=[];for(var i=0;i<t.materialCount;i++)r.materials.push(e())}(),function(){var e=function(){var e={};if(e.name=n.getTextBuffer(),e.englishName=n.getTextBuffer(),e.position=n.getFloat32Array(3),e.parentIndex=n.getIndex(r.metadata.boneIndexSize),e.transformationClass=n.getUint32(),e.flag=n.getUint16(),1&e.flag?e.connectIndex=n.getIndex(r.metadata.boneIndexSize):e.offsetPosition=n.getFloat32Array(3),256&e.flag||512&e.flag){var t={};t.isLocal=0!=(128&e.flag),t.affectRotation=0!=(256&e.flag),t.affectPosition=0!=(512&e.flag),t.parentIndex=n.getIndex(r.metadata.boneIndexSize),t.ratio=n.getFloat32(),e.grant=t}if(1024&e.flag&&(e.fixAxis=n.getFloat32Array(3)),2048&e.flag&&(e.localXVector=n.getFloat32Array(3),e.localZVector=n.getFloat32Array(3)),8192&e.flag&&(e.key=n.getUint32()),32&e.flag){for(var i,a={effector:n.getIndex(r.metadata.boneIndexSize),target:null,iteration:n.getUint32(),maxAngle:n.getFloat32(),linkCount:n.getUint32(),links:[]},o=0;o<a.linkCount;o++)(i={}).index=n.getIndex(r.metadata.boneIndexSize),i.angleLimitation=n.getUint8(),1===i.angleLimitation&&(i.lowerLimitationAngle=n.getFloat32Array(3),i.upperLimitationAngle=n.getFloat32Array(3)),a.links.push(i);e.ik=a}return e},t=r.metadata;t.boneCount=n.getUint32(),r.bones=[];for(var i=0;i<t.boneCount;i++)r.bones.push(e())}(),function(){var e=function(){for(var e={name:n.getTextBuffer(),englishName:n.getTextBuffer(),panel:n.getUint8(),type:n.getUint8(),elementCount:n.getUint32(),elements:[]},t=0;t<e.elementCount;t++)if(0===e.type){(i={}).index=n.getIndex(r.metadata.morphIndexSize),i.ratio=n.getFloat32(),e.elements.push(i)}else if(1===e.type){(i={}).index=n.getIndex(r.metadata.vertexIndexSize,!0),i.position=n.getFloat32Array(3),e.elements.push(i)}else if(2===e.type){(i={}).index=n.getIndex(r.metadata.boneIndexSize),i.position=n.getFloat32Array(3),i.rotation=n.getFloat32Array(4),e.elements.push(i)}else if(3===e.type){(i={}).index=n.getIndex(r.metadata.vertexIndexSize,!0),i.uv=n.getFloat32Array(4),e.elements.push(i)}else if(4===e.type);else if(5===e.type);else if(6===e.type);else if(7===e.type);else if(8===e.type){var i;(i={}).index=n.getIndex(r.metadata.materialIndexSize),i.type=n.getUint8(),i.diffuse=n.getFloat32Array(4),i.specular=n.getFloat32Array(3),i.shininess=n.getFloat32(),i.ambient=n.getFloat32Array(3),i.edgeColor=n.getFloat32Array(4),i.edgeSize=n.getFloat32(),i.textureColor=n.getFloat32Array(4),i.sphereTextureColor=n.getFloat32Array(4),i.toonColor=n.getFloat32Array(4),e.elements.push(i)}return e},t=r.metadata;t.morphCount=n.getUint32(),r.morphs=[];for(var i=0;i<t.morphCount;i++)r.morphs.push(e())}(),function(){var e=function(){for(var e,t={name:n.getTextBuffer(),englishName:n.getTextBuffer(),type:n.getUint8(),elementCount:n.getUint32(),elements:[]},i=0;i<t.elementCount;i++)(e={}).target=n.getUint8(),e.index=0===e.target?n.getIndex(r.metadata.boneIndexSize):n.getIndex(r.metadata.morphIndexSize),t.elements.push(e);return t},t=r.metadata;t.frameCount=n.getUint32(),r.frames=[];for(var i=0;i<t.frameCount;i++)r.frames.push(e())}(),function(){var e=r.metadata;e.rigidBodyCount=n.getUint32(),r.rigidBodies=[];for(var t=0;t<e.rigidBodyCount;t++)r.rigidBodies.push({name:n.getTextBuffer(),englishName:n.getTextBuffer(),boneIndex:n.getIndex(r.metadata.boneIndexSize),groupIndex:n.getUint8(),groupTarget:n.getUint16(),shapeType:n.getUint8(),width:n.getFloat32(),height:n.getFloat32(),depth:n.getFloat32(),position:n.getFloat32Array(3),rotation:n.getFloat32Array(3),weight:n.getFloat32(),positionDamping:n.getFloat32(),rotationDamping:n.getFloat32(),restitution:n.getFloat32(),friction:n.getFloat32(),type:n.getUint8()})}(),function(){var e=r.metadata;e.constraintCount=n.getUint32(),r.constraints=[];for(var t=0;t<e.constraintCount;t++)r.constraints.push({name:n.getTextBuffer(),englishName:n.getTextBuffer(),type:n.getUint8(),rigidBodyIndex1:n.getIndex(r.metadata.rigidBodyIndexSize),rigidBodyIndex2:n.getIndex(r.metadata.rigidBodyIndexSize),position:n.getFloat32Array(3),rotation:n.getFloat32Array(3),translationLimitation1:n.getFloat32Array(3),translationLimitation2:n.getFloat32Array(3),rotationLimitation1:n.getFloat32Array(3),rotationLimitation2:n.getFloat32Array(3),springPosition:n.getFloat32Array(3),springRotation:n.getFloat32Array(3)})}(),!0===t&&this.leftToRightModel(r),r},o.prototype.parseVmd=function(e,t){var r={},n=new i(e);return r.metadata={},r.metadata.coordinateSystem="left",function(){var e=r.metadata;if(e.magic=n.getChars(30),"Vocaloid Motion Data 0002"!==e.magic)throw"VMD file magic is not Vocaloid Motion Data 0002, but "+e.magic;e.name=n.getSjisStringsAsUnicode(20)}(),function(){var e=r.metadata;e.motionCount=n.getUint32(),r.motions=[];for(var t=0;t<e.motionCount;t++)r.motions.push({boneName:n.getSjisStringsAsUnicode(15),frameNum:n.getUint32(),position:n.getFloat32Array(3),rotation:n.getFloat32Array(4),interpolation:n.getUint8Array(64)})}(),function(){var e=r.metadata;e.morphCount=n.getUint32(),r.morphs=[];for(var t=0;t<e.morphCount;t++)r.morphs.push({morphName:n.getSjisStringsAsUnicode(15),frameNum:n.getUint32(),weight:n.getFloat32()})}(),function(){var e=r.metadata;e.cameraCount=n.getUint32(),r.cameras=[];for(var t=0;t<e.cameraCount;t++)r.cameras.push({frameNum:n.getUint32(),distance:n.getFloat32(),position:n.getFloat32Array(3),rotation:n.getFloat32Array(3),interpolation:n.getUint8Array(24),fov:n.getUint32(),perspective:n.getUint8()})}(),!0===t&&this.leftToRightVmd(r),r},o.prototype.parseVpd=function(e,t){function r(){throw"the file seems not vpd file."}var n={metadata:{}};n.metadata.coordinateSystem="left",n.bones=[];var i=e.replace(/\/\/\w*(\r|\n|\r\n)/g,"").split(/\r|\n|\r\n/);return"Vocaloid Pose Data file"!==i[0]&&r(),4>i.length&&r(),n.metadata.parentFile=i[2],n.metadata.boneCount=parseInt(i[3]),function(){for(var e=/^\s*(Bone[0-9]+)\s*\{\s*(.*)$/,t=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,a=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,o=/^\s*}/,s=n.bones,c=null,u=null,l=null,h=4;h<i.length;h++){var p,d=i[h];null!==(p=d.match(e))&&(null!==c&&r(),c=p[2]),null!==(p=d.match(t))&&(null!=u&&r(),u=[parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])]),null!==(p=d.match(a))&&(null!=l&&r(),l=[parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]),parseFloat(p[4])]),null!==(p=d.match(o))&&((null===c||null==u||null==l)&&r(),s.push({name:c,translation:u,quaternion:l}),c=null,u=null,l=null)}(null!==c||null!==u||null!==l)&&r()}(),!0===t&&this.leftToRightVpd(n),n},o.prototype.mergeVmds=function(e){var t={metadata:{}};t.metadata.name=e[0].metadata.name,t.metadata.coordinateSystem=e[0].metadata.coordinateSystem,t.metadata.motionCount=0,t.metadata.morphCount=0,t.metadata.cameraCount=0,t.motions=[],t.morphs=[],t.cameras=[];for(var r,n=0;n<e.length;n++){r=e[n],t.metadata.motionCount+=r.metadata.motionCount,t.metadata.morphCount+=r.metadata.morphCount,t.metadata.cameraCount+=r.metadata.cameraCount;for(var i=0;i<r.metadata.motionCount;i++)t.motions.push(r.motions[i]);for(i=0;i<r.metadata.morphCount;i++)t.morphs.push(r.morphs[i]);for(i=0;i<r.metadata.cameraCount;i++)t.cameras.push(r.cameras[i])}return t},o.prototype.leftToRightModel=function(e){if("right"!==e.metadata.coordinateSystem){e.metadata.coordinateSystem="right";for(var t=new a,r=0;r<e.metadata.vertexCount;r++)t.leftToRightVector3(e.vertices[r].position),t.leftToRightVector3(e.vertices[r].normal);for(r=0;r<e.metadata.faceCount;r++)t.leftToRightIndexOrder(e.faces[r].indices);for(r=0;r<e.metadata.boneCount;r++)t.leftToRightVector3(e.bones[r].position);var n;for(r=0;r<e.metadata.morphCount;r++)if(n=e.morphs[r],"pmx"!==e.metadata.format||1===n.type)for(var i=0;i<n.elements.length;i++)t.leftToRightVector3(n.elements[i].position);for(r=0;r<e.metadata.rigidBodyCount;r++)t.leftToRightVector3(e.rigidBodies[r].position),t.leftToRightEuler(e.rigidBodies[r].rotation);for(r=0;r<e.metadata.constraintCount;r++)t.leftToRightVector3(e.constraints[r].position),t.leftToRightEuler(e.constraints[r].rotation),t.leftToRightVector3Range(e.constraints[r].translationLimitation1,e.constraints[r].translationLimitation2),t.leftToRightEulerRange(e.constraints[r].rotationLimitation1,e.constraints[r].rotationLimitation2)}},o.prototype.leftToRightVmd=function(e){if("right"!==e.metadata.coordinateSystem){e.metadata.coordinateSystem="right";for(var t=new a,r=0;r<e.metadata.motionCount;r++)t.leftToRightVector3(e.motions[r].position),t.leftToRightQuaternion(e.motions[r].rotation);for(r=0;r<e.metadata.cameraCount;r++)t.leftToRightVector3(e.cameras[r].position),t.leftToRightEuler(e.cameras[r].rotation)}},o.prototype.leftToRightVpd=function(e){if("right"!==e.metadata.coordinateSystem){e.metadata.coordinateSystem="right";for(var t=new a,r=0;r<e.bones.length;r++)t.leftToRightVector3(e.bones[r].translation),t.leftToRightQuaternion(e.bones[r].quaternion)}};var d={CharsetEncoder:n,Parser:o},f=function(){function e(e){this.manager=void 0===e?h.D:e,this.loader=new h.L(this.manager),this.parser=null,this.meshBuilder=new t(this.manager),this.animationBuilder=new i}function t(e){this.geometryBuilder=new r,this.materialBuilder=new n(e)}function r(){}function n(e){this.manager=e,this.textureLoader=new h.yc(this.manager),this.tgaLoader=null}function i(){}function a(e,t,r,n,i){h.bb.call(this,e,t,r,n),this.interpolationParams=i}e.prototype={constructor:e,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setAnimationPath:function(e){return this.animationPath=e,this},setPath:function(e){return this.path=e,this},setResoucePath:function(e){return this.resourcePath=e,this},load:function(e,t,r,n){var i,a=this.meshBuilder.setCrossOrigin(this.crossOrigin);i=void 0===this.resourcePath?void 0===this.path?h.ob.extractUrlBase(e):this.path:this.resourcePath;var o=this._extractExtension(e).toLowerCase();return"pmd"!==o&&"pmx"!==o?void(n&&n(new Error("THREE.MMDLoader: Unknown model file extension ."+o+"."))):void this["pmd"===o?"loadPMD":"loadPMX"](e,function(e){t(a.build(e,i,r,n))},r,n)},loadAnimation:function(e,t,r,n,i){var a=this.animationBuilder;this.loadVMD(e,function(e){r(t.isCamera?a.buildCameraAnimation(e):a.build(e,t))},n,i)},loadWithAnimation:function(e,t,r,n,i){var a=this;this.load(e,function(e){a.loadAnimation(t,e,function(t){r({mesh:e,animation:t})},n,i)},n,i)},loadPMD:function(e,t,r,n){var i=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").load(e,function(e){t(i.parsePmd(e,!0))},r,n)},loadPMX:function(e,t,r,n){var i=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").load(e,function(e){t(i.parsePmx(e,!0))},r,n)},loadVMD:function(e,t,r,n){var i=Array.isArray(e)?e:[e],a=[],o=i.length,s=this._getParser();this.loader.setMimeType(void 0).setPath(this.animationPath).setResponseType("arraybuffer");for(var c=0,u=i.length;c<u;c++)this.loader.load(i[c],function(e){a.push(s.parseVmd(e,!0)),a.length===o&&t(s.mergeVmds(a))},r,n)},loadVPD:function(e,t,r,n,i){var a=this._getParser();this.loader.setMimeType(t?void 0:"text/plain; charset=shift_jis").setPath(this.animationPath).setResponseType("text").load(e,function(e){r(a.parseVpd(e,!0))},n,i)},_extractExtension:function(e){var t=e.lastIndexOf(".");return 0>t?"":e.slice(t+1)},_getParser:function(){if(null===this.parser){if(void 0===d)throw new Error("THREE.MMDLoader: Import MMDParser https://github.com/takahirox/mmd-parser");this.parser=new d.Parser}return this.parser}};var o=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="];return t.prototype={constructor:t,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},build:function(e,t,r,n){var i=this.geometryBuilder.build(e),a=this.materialBuilder.setCrossOrigin(this.crossOrigin).setResourcePath(t).build(e,i,r,n),o=new h.sc(i,a),s=new h.rc(function(e){var t,r,n,i,a=e.geometry,o=[];if(a&&void 0!==a.bones){for(n=0,i=a.bones.length;n<i;n++)r=a.bones[n],t=new h.i,o.push(t),t.name=r.name,t.position.fromArray(r.pos),t.quaternion.fromArray(r.rotq),void 0!==r.scl&&t.scale.fromArray(r.scl);for(n=0,i=a.bones.length;n<i;n++)-1!==(r=a.bones[n]).parent&&null!==r.parent&&void 0!==o[r.parent]?o[r.parent].add(o[n]):e.add(o[n])}return e.updateMatrixWorld(!0),o}(o));return o.bind(s),o}},r.prototype={constructor:r,build:function(e){function t(t,r,n){for(var i=0;i<r.elementCount;i++){var a,o=r.elements[i];a="pmd"===e.metadata.format?e.morphs[0].elements[o.index].index:o.index,t.array[3*a+0]+=o.position[0]*n,t.array[3*a+1]+=o.position[1]*n,t.array[3*a+2]+=o.position[2]*n}}for(var r,n=[],i=[],a=[],o=[],s=[],c=[],u=[],p=[],d=[],f=[],m=[],g=[],v=[],y=[],b=0,x={},w=0;w<e.metadata.vertexCount;w++){for(var _=0,T=(r=e.vertices[w]).position.length;_<T;_++)n.push(r.position[_]);for(_=0,T=r.normal.length;_<T;_++)a.push(r.normal[_]);for(_=0,T=r.uv.length;_<T;_++)i.push(r.uv[_]);for(_=0;4>_;_++)u.push(r.skinIndices.length-1>=_?r.skinIndices[_]:0);for(_=0;4>_;_++)p.push(r.skinWeights.length-1>=_?r.skinWeights[_]:0)}var E;for(w=0;w<e.metadata.faceCount;w++)for(_=0,T=(E=e.faces[w]).indices.length;_<T;_++)o.push(E.indices[_]);var A;for(w=0;w<e.metadata.materialCount;w++)A=e.materials[w],s.push({offset:3*b,count:3*A.faceCount}),b+=A.faceCount;for(w=0;w<e.metadata.rigidBodyCount;w++){var S=e.rigidBodies[w],M=x[S.boneIndex];M=void 0===M?S.type:l(S.type,M),x[S.boneIndex]=M}for(w=0;w<e.metadata.boneCount;w++){-1!==(H={parent:(F=e.bones[w]).parentIndex,name:F.name,pos:F.position.slice(0,3),rotq:[0,0,0,1],scl:[1,1,1],rigidBodyType:void 0===x[w]?-1:x[w]}).parent&&(H.pos[0]-=e.bones[H.parent].position[0],H.pos[1]-=e.bones[H.parent].position[1],H.pos[2]-=e.bones[H.parent].position[2]),c.push(H)}if("pmd"===e.metadata.format)for(w=0;w<e.metadata.ikCount;w++){var L={target:(N=e.iks[w]).target,effector:N.effector,iteration:N.iteration,maxAngle:4*N.maxAngle,links:[]};for(_=0,T=N.links.length;_<T;_++)(R={}).index=N.links[_].index,R.enabled=!0,0<=e.bones[R.index].name.indexOf("ひざ")&&(R.limitation=new h.Jc(1,0,0)),L.links.push(R);m.push(L)}else{var N;for(w=0;w<e.metadata.boneCount;w++)if(void 0!==(N=e.bones[w].ik)){var R;for(L={target:w,effector:N.effector,iteration:N.iteration,maxAngle:N.maxAngle,links:[]},_=0,T=N.links.length;_<T;_++){if((R={}).index=N.links[_].index,R.enabled=!0,1===N.links[_].angleLimitation){var C=N.links[_].lowerLimitationAngle,I=N.links[_].upperLimitationAngle,O=-I[0],P=-I[1];I[0]=-C[0],I[1]=-C[1],C[0]=O,C[1]=P,R.rotationMin=(new h.Jc).fromArray(C),R.rotationMax=(new h.Jc).fromArray(I)}L.links.push(R)}m.push(L)}}if("pmx"===e.metadata.format){for(w=0;w<e.metadata.boneCount;w++){var F,k=(F=e.bones[w]).grant;if(void 0!==k){L={index:w,parentIndex:k.parentIndex,ratio:k.ratio,isLocal:k.isLocal,affectRotation:k.affectRotation,affectPosition:k.affectPosition,transformationClass:F.transformationClass};g.push(L)}}g.sort(function(e,t){return e.transformationClass-t.transformationClass})}for(w=0;w<e.metadata.morphCount;w++){var D=e.morphs[w],U={name:D.name},B=new h.M(3*e.metadata.vertexCount,3);B.name=D.name;for(_=0;_<3*e.metadata.vertexCount;_++)B.array[_]=n[_];if("pmd"===e.metadata.format)0!==w&&t(B,D,1);else if(0===D.type)for(_=0;_<D.elementCount;_++){var z=e.morphs[D.elements[_].index],G=D.elements[_].ratio;1===z.type&&t(B,z,G)}else 1===D.type?t(B,D,1):2===D.type||3===D.type||4===D.type||5===D.type||6===D.type||7===D.type||D.type;d.push(U),f.push(B)}for(w=0;w<e.metadata.rigidBodyCount;w++){var j=e.rigidBodies[w];U={};for(var V in j)U[V]=j[V];if("pmx"===e.metadata.format&&-1!==U.boneIndex){var H=e.bones[U.boneIndex];U.position[0]-=H.position[0],U.position[1]-=H.position[1],U.position[2]-=H.position[2]}v.push(U)}for(w=0;w<e.metadata.constraintCount;w++){var W=e.constraints[w];U={};for(var V in W)U[V]=W[V];var J=v[U.rigidBodyIndex1],X=v[U.rigidBodyIndex2];0!==J.type&&2===X.type&&-1!==J.boneIndex&&-1!==X.boneIndex&&e.bones[X.boneIndex].parentIndex===J.boneIndex&&(X.type=1),y.push(U)}var Y=new h.l;Y.addAttribute("position",new h.M(n,3)),Y.addAttribute("normal",new h.M(a,3)),Y.addAttribute("uv",new h.M(i,2)),Y.addAttribute("skinIndex",new h.Cc(u,4)),Y.addAttribute("skinWeight",new h.M(p,4)),Y.setIndex(o);w=0;for(var q=s.length;w<q;w++)Y.addGroup(s[w].offset,s[w].count,w);return Y.bones=c,Y.morphTargets=d,Y.morphAttributes.position=f,Y.userData.MMD={bones:c,iks:m,grants:g,rigidBodies:v,constraints:y,format:e.metadata.format},Y.computeBoundingSphere(),Y}},n.prototype={constructor:n,crossOrigin:"anonymous",resourcePath:void 0,setCrossOrigin:function(e){return this.crossOrigin=e,this},setResourcePath:function(e){return this.resourcePath=e,this},build:function(e,t){var r=[],n={};this.textureLoader.setCrossOrigin(this.crossOrigin);for(var i=0;i<e.metadata.materialCount;i++){var a=e.materials[i],o={userData:{}};if(void 0!==a.name&&(o.name=a.name),o.color=(new h.o).fromArray(a.diffuse),o.opacity=a.diffuse[3],o.specular=(new h.o).fromArray(a.specular),o.emissive=(new h.o).fromArray(a.ambient),o.shininess=l(a.shininess,1e-4),o.transparent=1!==o.opacity,o.skinning=!!(0<t.bones.length),o.morphTargets=!!(0<t.morphTargets.length),o.lights=!0,o.fog=!0,o.blending=h.z,o.blendSrc=h.wc,o.blendDst=h.Mb,o.blendSrcAlpha=h.wc,o.blendDstAlpha=h.G,o.side="pmx"===e.metadata.format&&1==(1&a.flag)?h.F:1===o.opacity?h.P:h.F,"pmd"===e.metadata.format){if(a.fileName){var s=a.fileName.split("*");if(o.map=this._loadTexture(s[0],n),1<s.length){var c=s[1].slice(-4).toLowerCase();o.envMap=this._loadTexture(s[1],n,{sphericalReflectionMapping:!0}),o.combine=".sph"===c?h.Db:h.a}}var u=-1===a.toonIndex?"toon00.bmp":e.toonTextures[a.toonIndex].fileName;o.gradientMap=this._loadTexture(u,n,{isToonTexture:!0,isDefaultToonTexture:this._isDefaultToonTexture(u)}),o.userData.outlineParameters={thickness:1===a.edgeFlag?.003:0,color:[0,0,0],alpha:1,visible:1===a.edgeFlag}}else{var p;-1!==a.textureIndex&&(o.map=this._loadTexture(e.textures[a.textureIndex],n)),-1!==a.envTextureIndex&&(1===a.envFlag||2==a.envFlag)&&(o.envMap=this._loadTexture(e.textures[a.envTextureIndex],n,{sphericalReflectionMapping:!0}),o.combine=1===a.envFlag?h.Db:h.a),-1===a.toonIndex||0!==a.toonFlag?(u="toon"+("0"+(a.toonIndex+1)).slice(-2)+".bmp",p=!0):(u=e.textures[a.toonIndex],p=!1),o.gradientMap=this._loadTexture(u,n,{isToonTexture:!0,isDefaultToonTexture:p}),o.userData.outlineParameters={thickness:a.edgeSize/300,color:a.edgeColor.slice(0,3),alpha:a.edgeColor[3],visible:0!=(16&a.flag)&&0<a.edgeSize}}void 0!==o.map&&(!o.transparent&&this._checkImageTransparency(o.map,t,i),o.emissive.multiplyScalar(.2)),r.push(new h.Bb(o))}if("pmx"===e.metadata.format){function t(e,t){for(var r,n=0,i=e.length;n<i;n++)if(-1!==(r=e[n]).index){var a=t[r.index];a.opacity!==r.diffuse[3]&&(a.transparent=!0)}}i=0;for(var d=e.morphs.length;i<d;i++){var f=e.morphs[i],m=f.elements;if(0===f.type)for(var g,v=0,y=m.length;v<y;v++)8===(g=e.morphs[m[v].index]).type&&t(g.elements,r);else 8===f.type&&t(m,r)}}return r},_getTGALoader:function(){if(null===this.tgaLoader){if(void 0===p.a)throw new Error("THREE.MMDLoader: Import TGALoader");this.tgaLoader=new p.a(this.manager)}return this.tgaLoader},_isDefaultToonTexture:function(e){return 10===e.length&&/toon(10|0[0-9])\.bmp/.test(e)},_loadTexture:function(e,t,r,n,i){var a,s=this;if(!0===(r=r||{}).isDefaultToonTexture){var c;try{c=parseInt(e.match("toon([0-9]{2}).bmp$")[1])}catch(t){console.warn("THREE.MMDLoader: "+e+" seems like a not right default texture path. Using toon00.bmp instead."),c=0}a=o[c]}else a=this.resourcePath+e;if(void 0!==t[a])return t[a];var u=h.nb.Handlers.get(a);null===u&&(u=".tga"===e.slice(-4).toLowerCase()?this._getTGALoader():this.textureLoader);var l=u.load(a,function(e){!0===r.isToonTexture&&(e.image=s._getRotatedImage(e.image),e.magFilter=h.Eb,e.minFilter=h.Eb),e.flipY=!1,e.wrapS=h.mc,e.wrapT=h.mc;for(var t=0;t<l.readyCallbacks.length;t++)l.readyCallbacks[t](l);delete l.readyCallbacks},n,i);return!0===r.sphericalReflectionMapping&&(l.mapping=h.uc),l.readyCallbacks=[],t[a]=l,l},_getRotatedImage:function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),n=e.width,i=e.height;return t.width=n,t.height=i,r.clearRect(0,0,n,i),r.translate(n/2,i/2),r.rotate(.5*Math.PI),r.translate(-n/2,-i/2),r.drawImage(e,0,0),r.getImageData(0,0,n,i)},_checkImageTransparency:function(e,t,r){e.readyCallbacks.push(function(n){function i(e,t){var r=e.width,n=e.height,i=u(t.x*r)%r,a=u(t.y*n)%n;0>i&&(i+=r),0>a&&(a+=n);var o=a*r+i;return e.data[4*o+3]}var a=void 0===n.image.data?function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return r.drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)}(n.image):n.image,o=t.groups[r];(function(e,t,r){var n=e.width,a=e.height;if(4!=e.data.length/(n*a))return!1;for(var o,s=0;s<r.length;s+=3){o={x:0,y:0};for(var c=0;3>c;c++){var u=r[3*s+c],l={x:t[2*u+0],y:t[2*u+1]};if(i(e,l)<253)return!0;o.x+=l.x,o.y+=l.y}if(o.x/=3,o.y/=3,i(e,o)<253)return!0}return!1})(a,t.attributes.uv.array,t.index.array.slice(o.start,o.start+o.count))&&(e.transparent=!0)})}},i.prototype={constructor:i,build:function(e,t){for(var r=this.buildSkeletalAnimation(e,t).tracks,n=this.buildMorphAnimation(e,t).tracks,i=0,a=n.length;i<a;i++)r.push(n[i]);return new h.d("",-1,r)},buildSkeletalAnimation:function(e,t){function r(e,t,r){e.push(t[r+0]/127),e.push(t[r+8]/127),e.push(t[r+4]/127),e.push(t[r+12]/127)}for(var n=[],i={},a=t.skeleton.bones,o={},s=0,c=a.length;s<c;s++)o[a[s].name]=!0;for(s=0;s<e.metadata.motionCount;s++){var u=e.motions[s],l=u.boneName;void 0===o[l]||(i[l]=i[l]||[],i[l].push(u))}for(var p in i){var d=i[p];d.sort(function(e,t){return e.frameNum-t.frameNum});var f=[],m=[],g=[],v=[],y=[],b=t.skeleton.getBoneByName(p).position.toArray();for(s=0,c=d.length;s<c;s++){var x=d[s].frameNum/30,w=d[s].position,_=d[s].rotation,T=d[s].interpolation;f.push(x);for(var E=0;3>E;E++)m.push(b[E]+w[E]);for(E=0;4>E;E++)g.push(_[E]);for(E=0;3>E;E++)r(v,T,E);r(y,T,3)}var A=".bones["+p+"]";n.push(this._createTrack(A+".position",h.Lc,f,m,v)),n.push(this._createTrack(A+".quaternion",h.Wb,f,g,y))}return new h.d("",-1,n)},buildMorphAnimation:function(e,t){for(var r=[],n={},i=t.morphTargetDictionary,a=0;a<e.metadata.morphCount;a++){var o=e.morphs[a],s=o.morphName;void 0===i[s]||(n[s]=n[s]||[],n[s].push(o))}for(var c in n){var u=n[c];u.sort(function(e,t){return e.frameNum-t.frameNum});for(var l=[],p=[],d=(a=0,u.length);a<d;a++)l.push(u[a].frameNum/30),p.push(u[a].weight);r.push(new h.Jb(".morphTargetInfluences["+i[c]+"]",l,p))}return new h.d("",-1,r)},buildCameraAnimation:function(e){function t(e,t){e.push(t.x),e.push(t.y),e.push(t.z)}function r(e,t){e.push(t.x),e.push(t.y),e.push(t.z),e.push(t.w)}function n(e,t,r){e.push(t[4*r+0]/127),e.push(t[4*r+1]/127),e.push(t[4*r+2]/127),e.push(t[4*r+3]/127)}var i=void 0===e.cameras?[]:e.cameras.slice();i.sort(function(e,t){return e.frameNum-t.frameNum});for(var a=[],o=[],s=[],c=[],u=[],l=[],p=[],d=[],f=[],m=new h.Vb,g=new h.J,v=new h.Jc,y=new h.Jc,b=0,x=i.length;b<x;b++){var w=i[b],_=w.frameNum/30,T=w.position,E=w.rotation,A=w.distance,S=w.fov,M=w.interpolation;a.push(_),v.set(0,0,-A),y.set(T[0],T[1],T[2]),g.set(-E[0],-E[1],-E[2]),m.setFromEuler(g),v.add(y),v.applyQuaternion(m),t(o,y),r(s,m),t(c,v),u.push(S);for(var L=0;3>L;L++)n(l,M,L);n(p,M,3);for(L=0;3>L;L++)n(d,M,4);n(f,M,5)}var N=[this._createTrack("target.position",h.Lc,a,o,l),this._createTrack(".quaternion",h.Wb,a,s,p),this._createTrack(".position",h.Lc,a,c,d),this._createTrack(".fov",h.Jb,a,u,f)];return new h.d("",-1,N)},_createTrack:function(e,t,r,n,i){if(2<r.length){r=r.slice(),n=n.slice(),i=i.slice();for(var o=n.length/r.length,s=i.length/r.length,c=1,u=2,l=r.length;u<l;u++){for(var h=0;h<o;h++)if(n[c*o+h]!==n[(c-1)*o+h]||n[c*o+h]!==n[u*o+h]){c++;break}if(u>c){r[c]=r[u];for(h=0;h<o;h++)n[c*o+h]=n[u*o+h];for(h=0;h<s;h++)i[c*s+h]=i[u*s+h]}}r.length=c+1,n.length=(c+1)*o,i.length=(c+1)*s}var p=new t(e,r,n);return p.createInterpolant=function(e){return new a(this.times,this.values,this.getValueSize(),e,new Float32Array(i))},p}},a.prototype=Object.assign(Object.create(h.bb.prototype),{constructor:a,interpolate_:function(e,t,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=this.interpolationParams,c=e*o,u=c-o,l=n-t<.05?0:(r-t)/(n-t);if(4===o){var p=s[4*e+0],d=s[4*e+1],f=s[4*e+2],m=s[4*e+3],g=this._calculate(p,d,f,m,l);h.Vb.slerpFlat(i,0,a,u,a,c,g)}else if(3===o)for(var v=0;v!==o;++v){p=s[12*e+4*v+0],d=s[12*e+4*v+1],f=s[12*e+4*v+2],m=s[12*e+4*v+3],g=this._calculate(p,d,f,m,l);i[v]=a[u+v]*(1-g)+a[c+v]*g}else{p=s[4*e+0],d=s[4*e+1],f=s[4*e+2],m=s[4*e+3],g=this._calculate(p,d,f,m,l);i[0]=a[u]*(1-g)+a[c]*g}return i},_calculate:function(e,t,r,n,i){for(var a,o,s,c=.5,u=c,l=1-u,h=Math,p=0;p<15;p++){var d=(a=3*l*l*u)*e+(o=3*l*u*u)*t+(s=u*u*u)-i;if(h.abs(d)<1e-5)break;c/=2,l=1-(u+=0>d?c:-c)}return a*r+o*n+s}}),e}(),m=r(1);r.d(t,"GetMMD",function(){return s})},function(e,t,r){"use strict";/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */function n(e){throw e}function i(e,t){var r,n=e.split("."),i=y;!(n[0]in i)&&i.execScript&&i.execScript("var "+n[0]);for(;n.length&&(r=n.shift());)n.length||t===v?i=i[r]?i[r]:i[r]={}:i[r]=t}function a(e,t,r){var n,i="number"==typeof t?t:t=0,a="number"==typeof r?r:e.length;for(n=-1,i=7&a;i--;++t)n=n>>>8^_[255&(n^e[t])];for(i=a>>3;i--;t+=8)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^_[255&(n^e[t])])>>>8^_[255&(n^e[t+1])])>>>8^_[255&(n^e[t+2])])>>>8^_[255&(n^e[t+3])])>>>8^_[255&(n^e[t+4])])>>>8^_[255&(n^e[t+5])])>>>8^_[255&(n^e[t+6])])>>>8^_[255&(n^e[t+7])];return(4294967295^n)>>>0}function o(){}function s(e){var t,r,n,i,a,o,s,c,u,l,h=e.length,p=0,d=Number.POSITIVE_INFINITY;for(c=0;c<h;++c)e[c]>p&&(p=e[c]),e[c]<d&&(d=e[c]);for(t=1<<p,r=new(b?Uint32Array:Array)(t),n=1,i=0,a=2;n<=p;){for(c=0;c<h;++c)if(e[c]===n){for(o=0,s=i,u=0;u<n;++u)o=o<<1|1&s,s>>=1;for(l=n<<16|c,u=o;u<t;u+=a)r[u]=l;++i}++n,i<<=1,a<<=1}return[r,p,d]}function c(e,t){switch(this.i=[],this.j=32768,this.d=this.f=this.c=this.n=0,this.input=b?new Uint8Array(e):e,this.o=!1,this.k=M,this.z=!1,(t||!(t={}))&&(t.index&&(this.c=t.index),t.bufferSize&&(this.j=t.bufferSize),t.bufferType&&(this.k=t.bufferType),t.resize&&(this.z=t.resize)),this.k){case S:this.a=32768,this.b=new(b?Uint8Array:Array)(32768+this.j+258);break;case M:this.a=0,this.b=new(b?Uint8Array:Array)(this.j),this.e=this.F,this.q=this.B,this.l=this.D;break;default:n(Error("invalid inflate mode"))}}function u(e,t){for(var r,i=e.f,a=e.d,o=e.input,s=e.c,c=o.length;a<t;)s>=c&&n(Error("input buffer is broken")),i|=o[s++]<<a,a+=8;return r=i&(1<<t)-1,e.f=i>>>t,e.d=a-t,e.c=s,r}function l(e,t){for(var r,n,i=e.f,a=e.d,o=e.input,s=e.c,c=o.length,u=t[0],l=t[1];a<l&&!(s>=c);)i|=o[s++]<<a,a+=8;return n=(r=u[i&(1<<l)-1])>>>16,e.f=i>>n,e.d=a-n,e.c=s,65535&r}function h(e){function t(e,t,r){var n,i,a,o=this.w;for(a=0;a<e;)switch(n=l(this,t),n){case 16:for(i=3+u(this,2);i--;)r[a++]=o;break;case 17:for(i=3+u(this,3);i--;)r[a++]=0;o=0;break;case 18:for(i=11+u(this,7);i--;)r[a++]=0;o=0;break;default:o=r[a++]=n}return this.w=o,r}var r,n,i,a,o=u(e,5)+257,c=u(e,5)+1,h=u(e,4)+4,p=new(b?Uint8Array:Array)(C.length);for(a=0;a<h;++a)p[C[a]]=u(e,3);if(!b)for(a=h,h=p.length;a<h;++a)p[C[a]]=0;r=s(p),n=new(b?Uint8Array:Array)(o),i=new(b?Uint8Array:Array)(c),e.w=0,e.l(s(t.call(e,o,r,n)),s(t.call(e,c,r,i)))}function p(e){this.input=e,this.c=0,this.m=[],this.s=!1}function d(e,t){return Object(q.a)(new Y,e,t)}var f=String.fromCharCode;r.r(t);var m,g=r(0),v=void 0,y={},b="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;for(new(b?Uint8Array:Array)(256),m=0;256>m;++m)for(var x=(x=m)>>>1;x;x>>>=1)0;var w=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],_=b?new Uint32Array(w):w;o.prototype.getName=function(){return this.name},o.prototype.getData=function(){return this.data},o.prototype.H=function(){return this.I},i("Zlib.GunzipMember",o),i("Zlib.GunzipMember.prototype.getName",o.prototype.getName),i("Zlib.GunzipMember.prototype.getData",o.prototype.getData),i("Zlib.GunzipMember.prototype.getMtime",o.prototype.H);var T,E=[];for(T=0;288>T;T++)switch(!0){case 143>=T:E.push([T+48,8]);break;case 255>=T:E.push([T-144+400,9]);break;case 279>=T:E.push([T-256+0,7]);break;case 287>=T:E.push([T-280+192,8]);break;default:n("invalid literal: "+T)}var A=function(){function e(e){switch(!0){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:n("invalid length: "+e)}}var t,r,i=[];for(t=3;258>=t;t++)r=e(t),i[t]=r[2]<<24|r[1]<<16|r[0];return i}();b&&new Uint32Array(A);var S=0,M=1;c.prototype.g=function(){for(;!this.o;){var e=u(this,3);switch(1&e&&(this.o=!0),e>>>=1){case 0:var t=this.input,r=this.c,i=this.b,a=this.a,o=t.length,s=v,c=i.length,l=v;switch(this.d=this.f=0,r+1>=o&&n(Error("invalid uncompressed block header: LEN")),s=t[r++]|t[r++]<<8,r+1>=o&&n(Error("invalid uncompressed block header: NLEN")),s===~(t[r++]|t[r++]<<8)&&n(Error("invalid uncompressed block header: length verify")),r+s>t.length&&n(Error("input buffer is broken")),this.k){case S:for(;a+s>i.length;){if(s-=l=c-a,b)i.set(t.subarray(r,r+l),a),a+=l,r+=l;else for(;l--;)i[a++]=t[r++];this.a=a,i=this.e(),a=this.a}break;case M:for(;a+s>i.length;)i=this.e({t:2});break;default:n(Error("invalid inflate mode"))}if(b)i.set(t.subarray(r,r+s),a),a+=s,r+=s;else for(;s--;)i[a++]=t[r++];this.c=r,this.a=a,this.b=i;break;case 1:this.l(V,W);break;case 2:h(this);break;default:n(Error("unknown BTYPE: "+e))}}return this.q()};var L,N,R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=b?new Uint16Array(R):R,I=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],O=b?new Uint16Array(I):I,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],F=b?new Uint8Array(P):P,k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],D=b?new Uint16Array(k):k,U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=b?new Uint8Array(U):U,z=new(b?Uint8Array:Array)(288);for(L=0,N=z.length;L<N;++L)z[L]=143>=L?8:255>=L?9:279>=L?7:8;var G,j,V=s(z),H=new(b?Uint8Array:Array)(30);for(G=0,j=H.length;G<j;++G)H[G]=5;var W=s(H);c.prototype.l=function(e,t){var r=this.b,n=this.a;this.r=e;for(var i,a,o,s,c=r.length-258;256!==(i=l(this,e));)if(256>i)n>=c&&(this.a=n,r=this.e(),n=this.a),r[n++]=i;else for(s=O[a=i-257],0<F[a]&&(s+=u(this,F[a])),i=l(this,t),o=D[i],0<B[i]&&(o+=u(this,B[i])),n>=c&&(this.a=n,r=this.e(),n=this.a);s--;)r[n]=r[n++-o];for(;8<=this.d;)this.d-=8,this.c--;this.a=n},c.prototype.D=function(e,t){var r=this.b,n=this.a;this.r=e;for(var i,a,o,s,c=r.length;256!==(i=l(this,e));)if(256>i)n>=c&&(c=(r=this.e()).length),r[n++]=i;else for(s=O[a=i-257],0<F[a]&&(s+=u(this,F[a])),i=l(this,t),o=D[i],0<B[i]&&(o+=u(this,B[i])),n+s>c&&(c=(r=this.e()).length);s--;)r[n]=r[n++-o];for(;8<=this.d;)this.d-=8,this.c--;this.a=n},c.prototype.e=function(){var e,t,r=new(b?Uint8Array:Array)(this.a-32768),n=this.a-32768,i=this.b;if(b)r.set(i.subarray(32768,r.length));else for(e=0,t=r.length;e<t;++e)r[e]=i[e+32768];if(this.i.push(r),this.n+=r.length,b)i.set(i.subarray(n,n+32768));else for(e=0;32768>e;++e)i[e]=i[n+e];return this.a=32768,i},c.prototype.F=function(e){var t,r,n,i=0|this.input.length/this.c+1,a=this.input,o=this.b;return e&&("number"==typeof e.t&&(i=e.t),"number"==typeof e.A&&(i+=e.A)),2>i?r=(n=0|(a.length-this.c)/this.r[2]/2*258)<o.length?o.length+n:o.length<<1:r=o.length*i,b?(t=new Uint8Array(r)).set(o):t=o,this.b=t},c.prototype.q=function(){var e,t,r,n,i,a=0,o=this.b,s=this.i,c=new(b?Uint8Array:Array)(this.n+(this.a-32768));if(0===s.length)return b?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);for(t=0,r=s.length;t<r;++t)for(n=0,i=(e=s[t]).length;n<i;++n)c[a++]=e[n];for(t=32768,r=this.a;t<r;++t)c[a++]=o[t];return this.i=[],this.buffer=c},c.prototype.B=function(){var e,t=this.a;return b?this.z?(e=new Uint8Array(t)).set(this.b.subarray(0,t)):e=this.b.subarray(0,t):(this.b.length>t&&(this.b.length=t),e=this.b),this.buffer=e},p.prototype.G=function(){return this.s||this.g(),this.m.slice()},p.prototype.g=function(){for(var e=this.input.length;this.c<e;){var t,r,i=new o,s=v,u=v,l=v,h=v,p=v,d=v,m=v,g=this.input,y=this.c;switch(i.u=g[y++],i.v=g[y++],(31!==i.u||139!==i.v)&&n(Error("invalid file signature:"+i.u+","+i.v)),i.p=g[y++],i.p){case 8:break;default:n(Error("unknown compression method: "+i.p))}if(i.h=g[y++],r=g[y++]|g[y++]<<8|g[y++]<<16|g[y++]<<24,i.I=new Date(1e3*r),i.O=g[y++],i.N=g[y++],0<(4&i.h)&&(i.J=g[y++]|g[y++]<<8,y+=i.J),0<(8&i.h)){for(d=[],p=0;0<(h=g[y++]);)d[p++]=f(h);i.name=d.join("")}if(0<(16&i.h)){for(d=[],p=0;0<(h=g[y++]);)d[p++]=f(h);i.K=d.join("")}0<(2&i.h)&&(i.C=65535&a(g,0,y),i.C!==(g[y++]|g[y++]<<8)&&n(Error("invalid header crc16"))),s=g[g.length-4]|g[g.length-3]<<8|g[g.length-2]<<16|g[g.length-1]<<24,g.length-y-4-4<512*s&&(l=s),u=new c(g,{index:y,bufferSize:l}),i.data=t=u.g(),y=u.c,i.L=m=(g[y++]|g[y++]<<8|g[y++]<<16|g[y++]<<24)>>>0,a(t,v,v)!==m&&n(Error("invalid CRC-32 checksum: 0x"+a(t,v,v).toString(16)+" / 0x"+m.toString(16))),i.M=s=(g[y++]|g[y++]<<8|g[y++]<<16|g[y++]<<24)>>>0,(4294967295&t.length)!==s&&n(Error("invalid input size: "+(4294967295&t.length)+" / "+s)),this.m.push(i),this.c=y}this.s=!0;var x,w,_,T=this.m,E=0,A=0;for(x=0,w=T.length;x<w;++x)A+=T[x].data.length;if(b)for(_=new Uint8Array(A),x=0;x<w;++x)_.set(T[x].data,E),E+=T[x].data.length;else{for(_=[],x=0;x<w;++x)_[x]=T[x].data;_=Array.prototype.concat.apply([],_)}return _},i("Zlib.Gunzip",p),i("Zlib.Gunzip.prototype.decompress",p.prototype.g),i("Zlib.Gunzip.prototype.getMembers",p.prototype.G);var J=y.Zlib,X=r(11),Y=function(e){this.manager=void 0===e?g.D:e};Y.prototype={constructor:Y,load:function(e,t,r,n){var i=this,a=new g.L(i.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){var t=e,r=0,n=0<new Int8Array(new Int16Array([1]).buffer)[0],i=!0,a={},o=function(e,a){null==a&&(a=1);var o=1,s=Uint8Array;switch(e){case"uchar":break;case"schar":s=Int8Array;break;case"ushort":s=Uint16Array,o=2;break;case"sshort":s=Int16Array,o=2;break;case"uint":s=Uint32Array,o=4;break;case"sint":s=Int32Array,o=4;break;case"float":s=Float32Array,o=4;break;case"complex":s=Float64Array,o=8;break;case"double":s=Float64Array,o=8}var c=new s(t.slice(r,r+=a*o));return n!=i&&(c=function(e,t){for(var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=0;n<e.byteLength;n+=t)for(var i,a=n+t-1,o=n;a>o;a--,o++)i=r[o],r[o]=r[a],r[a]=i;return e}(c,o)),1==a?c[0]:c}("uchar",e.byteLength),s=o.length,c=null,u=0;for(p=1;p<s;p++)if(10==o[p-1]&&10==o[p]){c=this.parseChars(o,0,p-2),u=p+1;break}!function(e){var t,r,n,i,o,s,c,u,l;for(u=0,l=(s=e.split(/\r?\n/)).length;u<l;u++)(o=s[u]).match(/NRRD\d+/)?a.isNrrd=!0:o.match(/^#/)||(c=o.match(/(.*):(.*)/))&&(r=c[1].trim(),t=c[2].trim(),(n=Y.prototype.fieldFunctions[r])?n.call(a,t):a[r]=t);if(!a.isNrrd)throw new Error("Not an NRRD file");if("bz2"===a.encoding||"bzip2"===a.encoding)throw new Error("Bzip is not supported");if(!a.vectors&&(a.vectors=[new g.Jc(1,0,0),new g.Jc(0,1,0),new g.Jc(0,0,1)],a.spacings))for(i=0;2>=i;i++)isNaN(a.spacings[i])||a.vectors[i].multiplyScalar(a.spacings[i])}(c);t=o.subarray(u);if("gzip"===a.encoding||"gz"===a.encoding){var l=new J.Gunzip(new Uint8Array(t));t=l.decompress()}else if("ascii"===a.encoding||"text"===a.encoding||"txt"===a.encoding||"hex"===a.encoding)t=function(e,t,r){var n="";t=t||0,r=r||e.length;var i,o=a.sizes.reduce(function(e,t){return e*t},1),s=10;"hex"===a.encoding&&(s=16);var c=new a.__array(o),u=0,l=parseInt;(a.__array===Float32Array||a.__array===Float64Array)&&(l=parseFloat);for(var h=t;h<r;h++)(9>(i=e[h])||13<i)&&32!==i?n+=f(i):(""!==n&&(c[u]=l(n,s),u++),n="");return""!==n&&(c[u]=l(n,s),u++),c}(t);else if("raw"===a.encoding){for(var h=new Uint8Array(t.length),p=0;p<t.length;p++)h[p]=t[p];t=h}t=t.buffer;var d=new X.a;d.header=a,d.data=new a.__array(t);var m=d.computeMinMax(),v=m[0],y=m[1];d.windowLow=v,d.windowHigh=y,d.dimensions=[a.sizes[0],a.sizes[1],a.sizes[2]],d.xLength=d.dimensions[0],d.yLength=d.dimensions[1],d.zLength=d.dimensions[2];var b=new g.Jc(a.vectors[0][0],a.vectors[0][1],a.vectors[0][2]).length(),x=new g.Jc(a.vectors[1][0],a.vectors[1][1],a.vectors[1][2]).length(),w=new g.Jc(a.vectors[2][0],a.vectors[2][1],a.vectors[2][2]).length();d.spacing=[b,x,w],d.matrix=new g.ub;var _=1,T=1;if("left-posterior-superior"==a.space?(_=-1,T=-1):"left-anterior-superior"===a.space&&(_=-1),a.vectors){var E=a.vectors;d.matrix.set(_*E[0][0],_*E[1][0],_*E[2][0],0,T*E[0][1],T*E[1][1],T*E[2][1],0,1*E[0][2],1*E[1][2],1*E[2][2],0,0,0,0,1)}else d.matrix.set(_,0,0,0,0,T,0,0,0,0,1,0,0,0,0,1);return d.inverseMatrix=new g.ub,d.inverseMatrix.getInverse(d.matrix),d.RASDimensions=new g.Jc(d.xLength,d.yLength,d.zLength).applyMatrix4(d.matrix).round().toArray().map(Math.abs),d.lowerThreshold===-1/0&&(d.lowerThreshold=v),d.upperThreshold===1/0&&(d.upperThreshold=y),d},parseChars:function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);var n="",i=0;for(i=t;i<r;++i)n+=f(e[i]);return n},fieldFunctions:{type:function(e){switch(e){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+e)}return this.type=e},endian:function(e){return this.endian=e},encoding:function(e){return this.encoding=e},dimension:function(e){return this.dim=parseInt(e,10)},sizes:function(e){var t;return this.sizes=function(){var r,n,i,a;for(a=[],r=0,n=(i=e.split(/\s+/)).length;r<n;r++)t=i[r],a.push(parseInt(t,10));return a}()},space:function(e){return this.space=e},"space origin":function(e){return this.space_origin=e.split("(")[1].split(")")[0].split(",")},"space directions":function(e){var t,r,n;return r=e.match(/\(.*?\)/g),this.vectors=function(){var e,i,a;for(a=[],e=0,i=r.length;e<i;e++)n=r[e],a.push(function(){var e,r,i,a;for(a=[],e=0,r=(i=n.slice(1,-1).split(/,/)).length;e<r;e++)t=i[e],a.push(parseFloat(t));return a}());return a}()},spacings:function(e){var t,r;return r=e.split(/\s+/),this.spacings=function(){var e,n,i=[];for(e=0,n=r.length;e<n;e++)t=r[e],i.push(parseFloat(t));return i}()}}};var q=r(1);r.d(t,"GetNRRD",function(){return d})},function(e,t,r){"use strict";function n(e,t){return Object(c.a)(new s,e,t)}var i=Math.PI;r.r(t);var a=r(0),o=r(4),s=function(){function e(e){this.manager=void 0===e?a.D:e}function t(e){this.lexer=new o.a.Lexer(e)}function r(e){o.a.Parser.call(this,e);var t=this,r=e.Version,n=e.LCurly,i=e.RCurly,a=e.LSquare,s=e.RSquare,c=e.Identifier,u=e.RouteIdentifier,l=e.StringLiteral,h=e.NumberLiteral,p=e.TrueLiteral,d=e.FalseLiteral,f=e.NullLiteral,m=e.DEF,g=e.USE,v=e.ROUTE,y=e.TO,b=e.NodeName;t.RULE("vrml",function(){t.SUBRULE(t.version),t.AT_LEAST_ONE(function(){t.SUBRULE(t.node)}),t.MANY(function(){t.SUBRULE(t.route)})}),t.RULE("version",function(){t.CONSUME(r)}),t.RULE("node",function(){t.OPTION(function(){t.SUBRULE(t.def)}),t.CONSUME(b),t.CONSUME(n),t.MANY(function(){t.SUBRULE(t.field)}),t.CONSUME(i)}),t.RULE("field",function(){t.CONSUME(c),t.OR2([{ALT:function(){t.SUBRULE(t.singleFieldValue)}},{ALT:function(){t.SUBRULE(t.multiFieldValue)}}])}),t.RULE("def",function(){t.CONSUME(m),t.CONSUME(c)}),t.RULE("use",function(){t.CONSUME(g),t.CONSUME(c)}),t.RULE("singleFieldValue",function(){t.AT_LEAST_ONE(function(){t.OR([{ALT:function(){t.SUBRULE(t.node)}},{ALT:function(){t.SUBRULE(t.use)}},{ALT:function(){t.CONSUME(l)}},{ALT:function(){t.CONSUME(h)}},{ALT:function(){t.CONSUME(p)}},{ALT:function(){t.CONSUME(d)}},{ALT:function(){t.CONSUME(f)}}])})}),t.RULE("multiFieldValue",function(){t.CONSUME(a),t.MANY(function(){t.OR([{ALT:function(){t.SUBRULE(t.node)}},{ALT:function(){t.SUBRULE(t.use)}},{ALT:function(){t.CONSUME(l)}},{ALT:function(){t.CONSUME(h)}},{ALT:function(){t.CONSUME(f)}}])}),t.CONSUME(s)}),t.RULE("route",function(){t.CONSUME(v),t.CONSUME(u),t.CONSUME(y),t.CONSUME2(u)}),this.performSelfAnalysis()}function n(e,t,r){this.a=e,this.b=t,this.c=r,this.normal=new a.Jc}if(void 0===o.a)throw Error("THREE.VRMLLoader: External library chevrotain.min.js required.");return e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,o=void 0===i.path?a.ob.extractUrlBase(e):i.path,s=new a.L(this.manager);s.setPath(i.path),s.load(e,function(e){t(i.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,s){function c(){for(var e,t=o.a.createToken,r=t({name:"RouteIdentifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*[\.][^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/}),n=t({name:"Identifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/,longer_alt:r}),i=t({name:"Version",pattern:/#VRML.*/,longer_alt:n}),a=t({name:"NodeName",pattern:new RegExp(["Anchor","Billboard","Collision","Group","Transform","Inline","LOD","Switch","AudioClip","DirectionalLight","PointLight","Script","Shape","Sound","SpotLight","WorldInfo","CylinderSensor","PlaneSensor","ProximitySensor","SphereSensor","TimeSensor","TouchSensor","VisibilitySensor","Box","Cone","Cylinder","ElevationGrid","Extrusion","IndexedFaceSet","IndexedLineSet","PointSet","Sphere","Color","Coordinate","Normal","TextureCoordinate","Appearance","FontStyle","ImageTexture","Material","MovieTexture","PixelTexture","TextureTransform","ColorInterpolator","CoordinateInterpolator","NormalInterpolator","OrientationInterpolator","PositionInterpolator","ScalarInterpolator","Background","Fog","NavigationInfo","Viewpoint","Text"].join("|")),longer_alt:n}),s=t({name:"DEF",pattern:/DEF/,longer_alt:n}),c=t({name:"USE",pattern:/USE/,longer_alt:n}),u=t({name:"ROUTE",pattern:/ROUTE/,longer_alt:n}),l=t({name:"TO",pattern:/TO/,longer_alt:n}),h=t({name:"StringLiteral",pattern:/"(:?[^\\"\n\r]+|\\(:?[bfnrtv"\\\/]|u[0-9a-fA-F]{4}))*"/}),p=t({name:"NumberLiteral",pattern:/[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/}),d=t({name:"TrueLiteral",pattern:/TRUE/}),f=t({name:"FalseLiteral",pattern:/FALSE/}),m=t({name:"NullLiteral",pattern:/NULL/}),g=t({name:"LSquare",pattern:/\[/}),v=t({name:"RSquare",pattern:/]/}),y=t({name:"LCurly",pattern:/{/}),b=t({name:"RCurly",pattern:/}/}),x=t({name:"Comment",pattern:/#.*/,group:o.a.Lexer.SKIPPED}),w=[t({name:"WhiteSpace",pattern:/[ ,\s]/,group:o.a.Lexer.SKIPPED}),a,s,c,u,l,d,f,m,i,n,r,h,p,g,v,y,b,x],_={},T=0,E=w.length;T<E;T++)_[(e=w[T]).name]=e;return{tokens:w,tokenVocabulary:_}}function u(e){e.DEF&&(A[e.DEF]=e);for(var t,r=e.fields,n=0,i=r.length;n<i;n++)if("node"===(t=r[n]).type)for(var a=t.values,o=0,s=a.length;o<s;o++)u(a[o])}function l(e){return e.USE?function(e){var t=l(A[e]);return t.isObject3D||t.isMaterial?t.clone():t}(e.USE):void 0===e.build?(e.build=function(e){var t,r=e.name;switch(r){case"Group":case"Transform":t=function(e){for(var t=new a.R,r=e.fields,n=0,i=r.length;n<i;n++){var o=r[n],s=o.name,c=o.values;switch(s){case"center":break;case"children":h(c,t);break;case"rotation":var u=new a.Jc(c[0],c[1],c[2]),l=c[3];t.quaternion.setFromAxisAngle(u,l);break;case"scale":t.scale.set(c[0],c[1],c[2]);break;case"scaleOrientation":break;case"translation":t.position.set(c[0],c[1],c[2]);break;case"bboxCenter":case"bboxSize":break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return t}(e);break;case"Background":t=function(e){for(var t,r,n,o,s=new a.R,c=e.fields,u=0,l=c.length;u<l;u++){var h=c[u],p=h.name,d=h.values;switch(p){case"groundAngle":t=d;break;case"groundColor":r=d;break;case"backUrl":case"bottomUrl":case"frontUrl":case"leftUrl":case"rightUrl":case"topUrl":break;case"skyAngle":n=d;break;case"skyColor":o=d;break;default:console.warn("THREE.VRMLLoader: Unknown field:",p)}}if(o){var f=1e4,m=new a.tc(f,32,16),g=new a.wb({fog:!1,side:a.h,depthWrite:!1,depthTest:!1});3<o.length?(E(m,f,n,T(o),!0),g.vertexColors=a.Mc):g.color.setRGB(o[0],o[1],o[2]);var v=new a.vb(m,g);s.add(v)}if(r&&0<r.length){var y=new a.tc(f,32,16,0,2*i,.5*i,1.5*i),b=new a.wb({fog:!1,side:a.h,vertexColors:a.Mc,depthWrite:!1,depthTest:!1});E(y,f,t,T(r),!1);var x=new a.vb(y,b);s.add(x)}return s.renderOrder=-1/0,s}(e);break;case"Shape":t=function(e){for(var t,r=e.fields,n=new a.wb({color:0}),i=0,o=r.length;i<o;i++){var s=r[i],c=s.name,u=s.values;"appearance"===c?null!==u[0]&&(n=l(u[0])):"geometry"===c?null!==u[0]&&(t=l(u[0])):console.warn("THREE.VRMLLoader: Unknown field:",c)}var h;if(t&&t.attributes.position){var p=t._type;if("points"===p){var d=new a.Tb({color:16777215});void 0===t.attributes.color?n.isMeshPhongMaterial&&d.color.copy(n.emissive):d.vertexColors=a.Mc,h=new a.Sb(t,d)}else if("line"===p){var f=new a.gb({color:16777215});void 0===t.attributes.color?n.isMeshPhongMaterial&&f.color.copy(n.emissive):f.vertexColors=a.Mc,h=new a.ib(t,f)}else void 0!==t._solid&&(n.side=t._solid?a.P:a.F),void 0!==t.attributes.color&&(n.vertexColors=a.Mc),h=new a.vb(t,n)}else(h=new a.Kb).visible=!1;return h}(e);break;case"Appearance":t=function(e){for(var t,r=new a.yb,n=e.fields,i=0,o=n.length;i<o;i++){var s=n[i],c=s.name,u=s.values;switch(c){case"material":if(null!==u[0]){var h=l(u[0]);h.diffuseColor&&r.color.copy(h.diffuseColor),h.emissiveColor&&r.emissive.copy(h.emissiveColor),h.shininess&&(r.shininess=h.shininess),h.specularColor&&r.specular.copy(h.specularColor),h.transparency&&(r.opacity=1-h.transparency),0<h.transparency&&(r.transparent=!0)}else r=new a.wb({color:0});break;case"texture":var p=u[0];null!==p&&"ImageTexture"===p.name&&(r.map=l(p));break;case"textureTransform":null!==u[0]&&(t=l(u[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}return r.map&&t&&(r.map.center.copy(t.center),r.map.rotation=t.rotation,r.map.repeat.copy(t.scale),r.map.offset.copy(t.translation)),r}(e);break;case"Material":t=function(e){for(var t={},r=e.fields,n=0,i=r.length;n<i;n++){var o=r[n],s=o.name,c=o.values;switch(s){case"ambientIntensity":break;case"diffuseColor":t.diffuseColor=new a.o(c[0],c[1],c[2]);break;case"emissiveColor":t.emissiveColor=new a.o(c[0],c[1],c[2]);break;case"shininess":t.shininess=c[0];break;case"specularColor":t.emissiveColor=new a.o(c[0],c[1],c[2]);break;case"transparency":t.transparency=c[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",s)}}return t}(e);break;case"ImageTexture":t=function(e){for(var t,r=a.mc,n=a.mc,i=e.fields,o=0,s=i.length;o<s;o++){var c=i[o],u=c.name,l=c.values;switch(u){case"url":var h=l[0];h&&(t=P.load(h));break;case"repeatS":!1===l[0]&&(r=a.n);break;case"repeatT":!1===l[0]&&(n=a.n);break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}return t&&(t.wrapS=r,t.wrapT=n),t}(e);break;case"TextureTransform":t=function(e){for(var t={center:new a.Ic,rotation:new a.Ic,scale:new a.Ic,translation:new a.Ic},r=e.fields,n=0,i=r.length;n<i;n++){var o=r[n],s=o.name,c=o.values;"center"===s?t.center.set(c[0],c[1]):"rotation"===s?t.rotation=c[0]:"scale"===s?t.scale.set(c[0],c[1]):"translation"===s?t.translation.set(c[0],c[1]):console.warn("THREE.VRMLLoader: Unknown field:",s)}return t}(e);break;case"IndexedFaceSet":t=function(e){for(var t,r,n,i,o,s,c,u,h,m=!0,g=!0,b=!0,_=!0,T=e.fields,E=0,A=T.length;E<A;E++){var S=T[E],M=S.name,L=S.values;switch(M){case"color":var N=L[0];null!==N&&(t=l(N));break;case"coord":var R=L[0];null!==R&&(r=l(R));break;case"normal":var C=L[0];null!==C&&(n=l(C));break;case"texCoord":var I=L[0];null!==I&&(i=l(I));break;case"ccw":m=L[0];break;case"colorIndex":s=L;break;case"colorPerVertex":b=L[0];break;case"convex":break;case"coordIndex":c=L;break;case"creaseAngle":o=L[0];break;case"normalIndex":u=L;break;case"normalPerVertex":_=L[0];break;case"solid":g=L[0];break;case"texCoordIndex":h=L;break;default:console.warn("THREE.VRMLLoader: Unknown field:",M)}}if(void 0===c)return console.warn("THREE.VRMLLoader: Missing coordIndex."),new a.l;var O,P,F,k,D=p(c,m);if(t)if(!0===b)if(s&&0<s.length){var U=p(s,m);P=v(D,U,t,3)}else P=x(D,new a.M(t,3));else if(s&&0<s.length){var B=d(f(t,s),c);P=y(D,B)}else{B=d(t,c);P=y(D,B)}if(n)if(!0===_)if(u&&0<u.length){var z=p(u,m);F=v(D,z,n,3)}else F=x(D,new a.M(n,3));else if(u&&0<u.length){var G=d(f(n,u),c);F=y(D,G)}else{G=d(n,c);F=y(D,G)}else F=w(D,r,o);if(i)if(h&&0<h.length){var j=p(h,m);k=v(D,j,i,2)}else k=x(D,new a.M(i,2));var V=new a.l;return O=x(D,new a.M(r,3)),V.addAttribute("position",O),V.addAttribute("normal",F),P&&V.addAttribute("color",P),k&&V.addAttribute("uv",k),V._solid=g,V._type="mesh",V}(e);break;case"IndexedLineSet":t=function(e){for(var t,r,n,i,o=!0,s=e.fields,c=0,u=s.length;c<u;c++){var h=s[c],p=h.name,d=h.values;switch(p){case"color":var y=d[0];null!==y&&(t=l(y));break;case"coord":var w=d[0];null!==w&&(r=l(w));break;case"colorIndex":n=d;break;case"colorPerVertex":o=d[0];break;case"coordIndex":i=d;break;default:console.warn("THREE.VRMLLoader: Unknown field:",p)}}var _,T=m(i);if(t)if(!0===o)if(0<n.length){var E=m(n);_=v(T,E,t,3)}else _=x(T,new a.M(t,3));else if(0<n.length){var A=g(f(t,n),i);_=b(T,A)}else{A=g(t,i);_=b(T,A)}var S=new a.l,M=x(T,new a.M(r,3));return S.addAttribute("position",M),_&&S.addAttribute("color",_),S._type="line",S}(e);break;case"PointSet":t=function(e){for(var t,r,n=e.fields,i=0,o=n.length;i<o;i++){var s=n[i],c=s.name,u=s.values;switch(c){case"color":var h=u[0];null!==h&&(t=l(h));break;case"coord":var p=u[0];null!==p&&(r=l(p));break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}var d;return(d=new a.l).addAttribute("position",new a.M(r,3)),t&&d.addAttribute("color",new a.M(t,3)),d._type="points",d}(e);break;case"Box":t=function(e){for(var t=new a.Jc(2,2,2),r=e.fields,n=0,i=r.length;n<i;n++){var o=r[n],s=o.name,c=o.values;"size"===s?(t.x=c[0],t.y=c[1],t.z=c[2]):console.warn("THREE.VRMLLoader: Unknown field:",s)}return new a.j(t.x,t.y,t.z)}(e);break;case"Cone":t=function(e){for(var t=1,r=2,n=!1,i=e.fields,o=0,s=i.length;o<s;o++){var c=i[o],u=c.name,l=c.values;switch(u){case"bottom":n=!l[0];break;case"bottomRadius":t=l[0];break;case"height":r=l[0];break;case"side":break;default:console.warn("THREE.VRMLLoader: Unknown field:",u)}}return new a.r(t,r,16,1,n)}(e);break;case"Cylinder":t=function(e){for(var t=1,r=2,n=e.fields,i=0,o=n.length;i<o;i++){var s=n[i],c=s.name,u=s.values;switch(c){case"bottom":break;case"radius":t=u[0];break;case"height":r=u[0];break;case"side":case"top":break;default:console.warn("THREE.VRMLLoader: Unknown field:",c)}}return new a.A(t,t,r,16,1)}(e);break;case"Sphere":t=function(e){for(var t=1,r=e.fields,n=0,i=r.length;n<i;n++){var o=r[n],s=o.name,c=o.values;"radius"===s?t=c[0]:console.warn("THREE.VRMLLoader: Unknown field:",s)}return new a.tc(t,16,16)}(e);break;case"Color":case"Coordinate":case"Normal":case"TextureCoordinate":t=function(e){return e.fields[0].values}(e);break;case"Anchor":case"Billboard":case"Collision":case"Inline":case"LOD":case"Switch":case"AudioClip":case"DirectionalLight":case"PointLight":case"Script":case"Sound":case"SpotLight":case"WorldInfo":case"CylinderSensor":case"PlaneSensor":case"ProximitySensor":case"SphereSensor":case"TimeSensor":case"TouchSensor":case"VisibilitySensor":case"ElevationGrid":case"Extrusion":case"Text":case"FontStyle":case"MovieTexture":case"PixelTexture":case"ColorInterpolator":case"CoordinateInterpolator":case"NormalInterpolator":case"OrientationInterpolator":case"PositionInterpolator":case"ScalarInterpolator":case"Fog":case"NavigationInfo":case"Viewpoint":break;default:console.warn("THREE.VRMLLoader: Unknown node:",r)}return t}(e),e.build):e.build}function h(e,t){for(var r,n=0,i=e.length;n<i;n++)(r=l(e[n]))instanceof a.Kb&&t.add(r)}function p(e,t){for(var r=[],n=0,i=0,a=e.length;i<a;i++){var o=e[n],s=e[i+(t?1:2)],c=e[i+(t?2:1)];r.push(o,s,c),(-1===e[i+3]||i+3>=a)&&(n=(i+=3)+1)}return r}function d(e,t){for(var r=[],n=0,i=0,a=t.length;i<a;i++){var o=3*n,s=e[o],c=e[o+1],u=e[o+2];r.push(s,c,u),(-1===t[i+3]||i+3>=a)&&(i+=3,n++)}return r}function f(e,t){for(var r=[],n=0,i=t.length;n<i;n++){var a=3*t[n],o=e[a],s=e[a+1],c=e[a+2];r.push(o,s,c)}return r}function m(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],a=e[r+1];t.push(i,a),(-1===e[r+2]||r+2>=n)&&(r+=2)}return t}function g(e,t){for(var r=[],n=0,i=0,a=t.length;i<a;i++){var o=3*n,s=e[o],c=e[o+1],u=e[o+2];r.push(s,c,u),(-1===t[i+2]||i+2>=a)&&(i+=2,n++)}return r}function v(e,t,r,n){for(var i=[],o=0,s=e.length;o<s;o+=3){var c=t[o],u=t[o+1],l=t[o+2];2===n?(N.fromArray(r,c*n),R.fromArray(r,u*n),C.fromArray(r,l*n),i.push(N.x,N.y),i.push(R.x,R.y),i.push(C.x,C.y)):(S.fromArray(r,c*n),M.fromArray(r,u*n),L.fromArray(r,l*n),i.push(S.x,S.y,S.z),i.push(M.x,M.y,M.z),i.push(L.x,L.y,L.z))}return new a.M(i,n)}function y(e,t){for(var r=[],n=0,i=0,o=e.length;n<o;n+=3,i++)S.fromArray(t,3*i),r.push(S.x,S.y,S.z),r.push(S.x,S.y,S.z),r.push(S.x,S.y,S.z);return new a.M(r,3)}function b(e,t){for(var r=[],n=0,i=0,o=e.length;n<o;n+=2,i++)S.fromArray(t,3*i),r.push(S.x,S.y,S.z),r.push(S.x,S.y,S.z);return new a.M(r,3)}function x(e,t){for(var r=t.array,n=t.itemSize,i=new r.constructor(e.length*n),o=0,s=0,c=0,u=e.length;c<u;c++){o=e[c]*n;for(var l=0;l<n;l++)i[s++]=r[o++]}return new a.M(i,n)}function w(e,t,r){for(var i=[],o={},s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2],p=new n(u,l,h);S.fromArray(t,3*u),M.fromArray(t,3*l),L.fromArray(t,3*h),O.subVectors(L,M),I.subVectors(S,M),O.cross(I),O.normalize(),p.normal.copy(O),void 0===o[u]&&(o[u]=[]),void 0===o[l]&&(o[l]=[]),void 0===o[h]&&(o[h]=[]),o[u].push(p.normal),o[l].push(p.normal),o[h].push(p.normal),i.push(p)}var d=[];for(s=0,c=i.length;s<c;s++){var f=_(o[(p=i[s]).a],p.normal,r),m=_(o[p.b],p.normal,r),g=_(o[p.c],p.normal,r);S.fromArray(t,3*p.a),M.fromArray(t,3*p.b),L.fromArray(t,3*p.c),d.push(f.x,f.y,f.z),d.push(m.x,m.y,m.z),d.push(g.x,g.y,g.z)}return new a.M(d,3)}function _(e,t,r){for(var n=t.clone(),i=0,a=e.length;i<a;i++)e[i].angleTo(t)<r&&n.add(e[i]);return n.normalize()}function T(e){for(var t=[],r=0,n=e.length;r<n;r+=3)t.push(new a.o(e[r],e[r+1],e[r+2]));return t}function E(e,t,r,n,i){for(var o,s=!0===i?1:-1,c=[],u={},l={},h=0;h<r.length;h++)o={x:s*(Math.cos(r[h])*t),y:s*(Math.sin(r[h])*t)},c.push(o);for(var p,d=e.index,f=e.attributes.position,m=new a.k(new Float32Array(3*e.attributes.position.count),3),g=new a.Jc,v=new a.o,y=0;y<d.count;y++){p=d.getX(y),g.fromBufferAttribute(f,p);for(var b=0;b<n.length;b++)if(0===b?(u.x=0,u.y=!0===i?t:-1*t):(u.x=c[b-1].x,u.y=c[b-1].y),void 0!==(l=c[b]))if(1==(!0===i?g.y<=u.y&&g.y>l.y:g.y>=u.y&&g.y<l.y)){var x=n[b],w=n[b+1],_=Math.abs(g.y-u.y)/(u.y-l.y);v.copy(x).lerp(w,_),m.setXYZ(p,v.r,v.g,v.b)}else{var T=n[!0===i?n.length-1:0];m.setXYZ(p,T.r,T.g,T.b)}}e.addAttribute("color",m)}var A={},S=new a.Jc,M=new a.Jc,L=new a.Jc,N=new a.Ic,R=new a.Ic,C=new a.Ic,I=new a.Jc,O=new a.Jc,P=new a.yc(this.manager);P.setPath(this.resourcePath||s).setCrossOrigin(this.crossOrigin);var F=function(e){var n=c(),i=new t(n.tokens),a=new r(n.tokenVocabulary),o=function(e){function t(){e.call(this),this.validateVisitor()}function r(e,t){var r={type:null,values:[]};if(t.node){r.type="node";for(var n,i=0,a=t.node.length;i<a;i++)n=t.node[i],r.values.push(e.visit(n))}if(t.use){r.type="use";var o;for(i=0,a=t.use.length;i<a;i++)o=t.use[i],r.values.push(e.visit(o))}if(t.StringLiteral){r.type="string";var s;for(i=0,a=t.StringLiteral.length;i<a;i++)s=t.StringLiteral[i],r.values.push(s.image.replace(/'|"/g,""))}if(t.NumberLiteral){r.type="number";var c;for(i=0,a=t.NumberLiteral.length;i<a;i++)c=t.NumberLiteral[i],r.values.push(parseFloat(c.image))}if(t.TrueLiteral){r.type="boolean";for(i=0,a=t.TrueLiteral.length;i<a;i++)"TRUE"===t.TrueLiteral[i].image&&r.values.push(!0)}if(t.FalseLiteral){r.type="boolean";for(i=0,a=t.FalseLiteral.length;i<a;i++)"FALSE"===t.FalseLiteral[i].image&&r.values.push(!1)}return t.NullLiteral&&(r.type="null",t.NullLiteral.forEach(function(){r.values.push(null)})),r}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,vrml:function(e){for(var t,r={version:this.visit(e.version),nodes:[],routes:[]},n=0,i=e.node.length;n<i;n++)t=e.node[n],r.nodes.push(this.visit(t));if(e.route){var a;for(n=0,i=e.route.length;n<i;n++)a=e.route[n],r.routes.push(this.visit(a))}return r},version:function(e){return e.Version[0].image},node:function(e){var t={name:e.NodeName[0].image,fields:[]};if(e.field)for(var r,n=0,i=e.field.length;n<i;n++)r=e.field[n],t.fields.push(this.visit(r));return e.def&&(t.DEF=this.visit(e.def[0])),t},field:function(e){var t,r={name:e.Identifier[0].image,type:null,values:null};return e.singleFieldValue&&(t=this.visit(e.singleFieldValue[0])),e.multiFieldValue&&(t=this.visit(e.multiFieldValue[0])),r.type=t.type,r.values=t.values,r},def:function(e){return e.Identifier[0].image},use:function(e){return{USE:e.Identifier[0].image}},singleFieldValue:function(e){return r(this,e)},multiFieldValue:function(e){return r(this,e)},route:function(e){return{FROM:e.RouteIdentifier[0].image,TO:e.RouteIdentifier[1].image}}}),new t}(a.getBaseCstVisitorConstructor()),s=i.lex(e);a.input=s.tokens;var u=a.vrml();if(0<a.errors.length)throw console.error(a.errors),Error("THREE.VRMLLoader: Parsing errors detected.");return o.visit(u)}(e);if(-1===F.version.indexOf("V2.0"))throw Error("THREE.VRMLLexer: Version of VRML asset not supported.");return function(e){for(var t=F.nodes,r=new a.nc,n=0,i=t.length;n<i;n++)u(t[n]);for(n=0,i=t.length;n<i;n++){var o=l(t[n]);o instanceof a.Kb&&r.add(o)}return r}()}},t.prototype={constructor:t,lex:function(e){var t=this.lexer.tokenize(e);if(0<t.errors.length)throw console.error(t.errors),Error("THREE.VRMLLexer: Lexing errors detected.");return t}},r.prototype=Object.create(o.a.Parser.prototype),r.prototype.constructor=r,e}(),c=r(1);r.d(t,"GetVRML",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}var i=Math.PI;r.r(t);var a=r(0),o=function(e){this.manager=void 0===e?a.D:e,this.animateBonePositions=!0,this.animateBoneRotations=!0};o.prototype={constructor:o,load:function(e,t,r,n){var i=this,o=new a.L(i.manager);o.setPath(i.path),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,r,n){if("ENDSITE"!==n.type){var o={time:r,position:new a.Jc,rotation:new a.Vb};n.frames.push(o);for(var s=new a.Vb,c=new a.Jc(1,0,0),u=new a.Jc(0,1,0),l=new a.Jc(0,0,1),h=0;h<n.channels.length;h++)switch(n.channels[h]){case"Xposition":o.position.x=parseFloat(e.shift().trim());break;case"Yposition":o.position.y=parseFloat(e.shift().trim());break;case"Zposition":o.position.z=parseFloat(e.shift().trim());break;case"Xrotation":s.setFromAxisAngle(c,parseFloat(e.shift().trim())*i/180),o.rotation.multiply(s);break;case"Yrotation":s.setFromAxisAngle(u,parseFloat(e.shift().trim())*i/180),o.rotation.multiply(s);break;case"Zrotation":s.setFromAxisAngle(l,parseFloat(e.shift().trim())*i/180),o.rotation.multiply(s);break;default:console.warn("THREE.BVHLoader: Invalid channel type.")}for(h=0;h<n.children.length;h++)t(e,r,n.children[h])}}function r(e,t,i){var o={name:"",type:"",frames:[]};i.push(o);var s=t.split(/[\s]+/);"END"===s[0].toUpperCase()&&"SITE"===s[1].toUpperCase()?(o.type="ENDSITE",o.name="ENDSITE"):(o.name=s[1],o.type=s[0].toUpperCase()),"{"!==n(e)&&console.error("THREE.BVHLoader: Expected opening { after type & name"),"OFFSET"!==(s=n(e).split(/[\s]+/))[0]&&console.error("THREE.BVHLoader: Expected OFFSET but got: "+s[0]),4!==s.length&&console.error("THREE.BVHLoader: Invalid number of values for OFFSET.");var c=new a.Jc(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));if((isNaN(c.x)||isNaN(c.y)||isNaN(c.z))&&console.error("THREE.BVHLoader: Invalid values of OFFSET."),o.offset=c,"ENDSITE"!==o.type){"CHANNELS"!==(s=n(e).split(/[\s]+/))[0]&&console.error("THREE.BVHLoader: Expected CHANNELS definition.");var u=parseInt(s[1]);o.channels=s.splice(2,u),o.children=[]}for(;;){var l=n(e);if("}"===l)return o;o.children.push(r(e,l,i))}}function n(e){for(var t;0===(t=e.shift().trim()).length;);return t}var o=this,s=function(e){"HIERARCHY"!==n(e)&&console.error("THREE.BVHLoader: HIERARCHY expected.");var i=[],a=r(e,n(e),i);"MOTION"!==n(e)&&console.error("THREE.BVHLoader: MOTION expected.");var o=n(e).split(/[\s]+/),s=parseInt(o[1]);isNaN(s)&&console.error("THREE.BVHLoader: Failed to read number of frames."),o=n(e).split(/[\s]+/);var c=parseFloat(o[2]);isNaN(c)&&console.error("THREE.BVHLoader: Failed to read frame time.");for(var u=0;u<s;u++)t(o=n(e).split(/[\s]+/),u*c,a);return i}(e.split(/[\r\n]+/g)),c=[];!function e(t,r){var n=new a.i;if(r.push(n),n.position.add(t.offset),n.name=t.name,"ENDSITE"!==t.type)for(var i=0;i<t.children.length;i++)n.add(e(t.children[i],r));return n}(s[0],c);var u=function(e){for(var t,r=[],n=0;n<e.length;n++)if("ENDSITE"!==(t=e[n]).type){for(var i,s=[],c=[],u=[],l=0;l<t.frames.length;l++)i=t.frames[l],s.push(i.time),c.push(i.position.x+t.offset.x),c.push(i.position.y+t.offset.y),c.push(i.position.z+t.offset.z),u.push(i.rotation.x),u.push(i.rotation.y),u.push(i.rotation.z),u.push(i.rotation.w);o.animateBonePositions&&r.push(new a.Lc(".bones["+t.name+"].position",s,c)),o.animateBoneRotations&&r.push(new a.Wb(".bones["+t.name+"].quaternion",s,u))}return new a.d("animation",-1,r)}(s);return{skeleton:new a.rc(c),clip:u}}};var s=r(1);r.d(t,"GetBVH",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.timeLoaded=0,this.manager=e||i.D,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=i.Bc,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){a.decodeDracoFile(e,t)},r,n)},setPath:function(e){return this.path=e,this},setVerbosity:function(e){return this.verbosity=e,this},setDrawMode:function(e){return this.drawMode=e,this},setSkipDequantization:function(e,t){var r=!0;return void 0!==t&&(r=t),this.getAttributeOptions(e).skipDequantization=r,this},decodeDracoFile:function(e,t,r,n){var i=this;a.getDecoderModule().then(function(a){i.decodeDracoFileInternal(e,a.decoder,t,r,n)})},decodeDracoFileInternal:function(e,t,r,n,i){var a=new t.DecoderBuffer;a.Init(new Int8Array(e),e.byteLength);var o=new t.Decoder,s=o.GetEncodedGeometryType(a);if(s==t.TRIANGULAR_MESH)0<this.verbosity&&console.log("Loaded a mesh.");else{if(s!=t.POINT_CLOUD){var c="DRACOLoader: Unknown geometry type.";throw console.error(c),new Error(c)}0<this.verbosity&&console.log("Loaded a point cloud.")}r(this.convertDracoGeometryTo3JS(t,o,s,a,n,i))},addAttributeToGeometry:function(e,t,r,n,a,o,s,c){if(0===o.ptr){var u="DRACOLoader: No attribute "+n;throw console.error(u),new Error(u)}var l,h,p=o.num_components(),d=r.num_points()*p;switch(a){case Float32Array:l=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,o,l),c[n]=new Float32Array(d),h=i.M;break;case Int8Array:l=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,o,l),c[n]=new Int8Array(d),h=i.Y;break;case Int16Array:l=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,o,l),c[n]=new Int16Array(d),h=i.W;break;case Int32Array:l=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,o,l),c[n]=new Int32Array(d),h=i.X;break;case Uint8Array:l=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,o,l),c[n]=new Uint8Array(d),h=i.Ec;break;case Uint16Array:l=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,o,l),c[n]=new Uint16Array(d),h=i.Cc;break;case Uint32Array:l=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,o,l),c[n]=new Uint32Array(d),h=i.Dc;break;default:u="DRACOLoader: Unexpected attribute type.";throw console.error(u),new Error(u)}for(var f=0;f<d;f++)c[n][f]=l.GetValue(f);s.addAttribute(n,new h(c[n],p)),e.destroy(l)},convertDracoGeometryTo3JS:function(e,t,r,n,a,o){!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var s,c,u=performance.now();if(r===e.TRIANGULAR_MESH?(s=new e.Mesh,c=t.DecodeBufferToMesh(n,s)):(s=new e.PointCloud,c=t.DecodeBufferToPointCloud(n,s)),!c.ok()||0==s.ptr){var l="DRACOLoader: Decoding failed: ";throw l+=c.error_msg(),console.error(l),e.destroy(t),e.destroy(s),new Error(l)}var h,p=performance.now();e.destroy(n),r==e.TRIANGULAR_MESH?(h=s.num_faces(),0<this.verbosity&&console.log("Number of faces loaded: "+h.toString())):h=0;var d=s.num_points(),f=s.num_attributes();0<this.verbosity&&(console.log("Number of points loaded: "+d.toString()),console.log("Number of attributes loaded: "+f.toString()));var m=t.GetAttributeId(s,e.POSITION);if(-1==m){l="DRACOLoader: No position attribute found.";throw console.error(l),e.destroy(t),e.destroy(s),new Error(l)}var g=t.GetAttribute(s,m),v={},y=new i.l;if(a)for(var b in a){var x=o[b],w=a[b],_=t.GetAttributeByUniqueId(s,w);this.addAttributeToGeometry(e,t,s,b,x,_,y,v)}else for(var b in this.nativeAttributeMap){var T=t.GetAttributeId(s,e[this.nativeAttributeMap[b]]);if(-1!==T){0<this.verbosity&&console.log("Loaded "+b+" attribute.");_=t.GetAttribute(s,T);this.addAttributeToGeometry(e,t,s,b,Float32Array,_,y,v)}}if(r==e.TRIANGULAR_MESH)if(this.drawMode===i.Ac){var E=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(s,E),v.indices=new Uint32Array(E.size());for(var A=0;A<E.size();++A)v.indices[A]=E.GetValue(A);e.destroy(E)}else{var S=3*h;v.indices=new Uint32Array(S);var M=new e.DracoInt32Array;for(A=0;A<h;++A){t.GetFaceFromMesh(s,A,M);var L=3*A;v.indices[L]=M.GetValue(0),v.indices[L+1]=M.GetValue(1),v.indices[L+2]=M.GetValue(2)}e.destroy(M)}y.drawMode=this.drawMode,r==e.TRIANGULAR_MESH&&y.setIndex(new(65535<v.indices.length?i.Dc:i.Cc)(v.indices,1));var N=new e.AttributeQuantizationTransform;if(N.InitFromAttribute(g)){y.attributes.position.isQuantized=!0,y.attributes.position.maxRange=N.range(),y.attributes.position.numQuantizationBits=N.quantization_bits(),y.attributes.position.minValues=new Float32Array(3);for(A=0;3>A;++A)y.attributes.position.minValues[A]=N.min_value(A)}return e.destroy(N),e.destroy(t),e.destroy(s),this.decode_time=p-u,this.import_time=performance.now()-p,0<this.verbosity&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),y},isVersionSupported:function(e,t){a.getDecoderModule().then(function(r){t(r.decoder.isVersionSupported(e))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},a.decoderPath="./",a.decoderConfig={},a.decoderModulePromise=null,a.setDecoderPath=function(e){a.decoderPath=e},a.setDecoderConfig=function(e){var t=a.decoderConfig.wasmBinary;a.decoderConfig=e||{},a.releaseDecoderModule(),t&&(a.decoderConfig.wasmBinary=t)},a.releaseDecoderModule=function(){a.decoderModulePromise=null},a.getDecoderModule=function(){var e=this,t=a.decoderPath,r=a.decoderConfig,n=a.decoderModulePromise;return n||("undefined"==typeof DracoDecoderModule?"object"!=typeof WebAssembly||"js"===r.type?n=a._loadScript(t+"draco_decoder.js"):(r.wasmBinaryFile=t+"draco_decoder.wasm",n=a._loadScript(t+"draco_wasm_wrapper.js").then(function(){return a._loadArrayBuffer(r.wasmBinaryFile)}).then(function(e){r.wasmBinary=e})):n=Promise.resolve(),n=n.then(function(){return new Promise(function(t){r.onModuleLoaded=function(r){e.timeLoaded=performance.now(),t({decoder:r})},DracoDecoderModule(r)})}),a.decoderModulePromise=n,n)},a._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var r=document.getElementsByTagName("head")[0],n=document.createElement("script");return n.id="decoder_script",n.type="text/javascript",n.src=e,new Promise(function(e){n.onload=e,r.appendChild(n)})},a._loadArrayBuffer=function(e){var t=new i.L;return t.setResponseType("arraybuffer"),new Promise(function(r,n){t.load(e,r,void 0,n)})};var o=r(1);r.d(t,"GetDRACO",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.type=i.N};a.prototype=Object.create(i.C.prototype),a.prototype.setDataType=function(e){return this.type=e,this},a.prototype.setType=function(e){return console.warn("THREE.EXRLoader: .setType() has been renamed to .setDataType()."),this.setDataType(e)},a.prototype._parser=function(e){function t(e,t,r,n,i){for(;r<e;)t=t<<8|y(n,i),r+=8;r-=e,B.l=t>>r&(1<<e)-1,B.c=t,B.lc=r}function r(e,r,n,i,a,o,s){for(var c=n,u=0,l=0;a<=o;a++){if(c.value-n.value>i)return!1;t(6,u,l,e,c);var h=B.l;if(u=B.c,l=B.lc,s[a]=h,h==I){if(c.value-n.value>i)throw"Something wrong with hufUnpackEncTable";t(8,u,l,e,c);var p=B.l+O;if(u=B.c,l=B.lc,a+p>o+1)throw"Something wrong with hufUnpackEncTable";for(;p--;)s[a++]=0;a--}else if(h>=C){if(a+(p=h-C+2)>o+1)throw"Something wrong with hufUnpackEncTable";for(;p--;)s[a++]=0;a--}}!function(e){for(var t=0;58>=t;++t)z[t]=0;for(t=0;t<L;++t)z[e[t]]+=1;var r,n,i=0;for(t=58;0<t;--t)r=i+z[t]>>1,z[t]=i,i=r;for(t=0;t<L;++t)0<(n=e[t])&&(e[t]=n|z[n]++<<6)}(s)}function n(e){return 63&e}function a(e){return e>>6}function o(e,t,r,i){for(;t<=r;t++){var o=a(e[t]),s=n(e[t]);if(o>>s)throw"Invalid table entry";if(s>M){if((l=i[o>>s-M]).len)throw"Invalid table entry";if(l.lit++,l.p){var c=l.p;l.p=Array(l.lit);for(var u=0;u<l.lit-1;++u)l.p[u]=c[u]}else l.p=[,];l.p[l.lit-1]=t}else if(s){var l,h=0;for(u=1<<M-s;0<u;u--){if((l=i[(o<<M-s)+h]).len||l.p)throw"Invalid table entry";l.len=s,l.lit=t,h++}}}return!0}function s(e,t,r,n){e=e<<8|y(r,n),t+=8,G.c=e,G.lc=t}function c(e,t,r,n,i,a,o,c,u,l){if(e==t){8>n&&(s(r,n,i,o),r=G.c,n=G.lc);var h=r>>(n-=8);h=new Uint8Array([h])[0];if(u.value+h>l)return!1;for(var p=c[u.value-1];0<h--;)c[u.value++]=p}else{if(!(u.value<l))return!1;c[u.value++]=e}j.c=r,j.lc=n}function u(e){var t=function(e){return 65535&e}(e);return 32767<t?t-65536:t}function l(e,t){var r=u(e),n=u(t),i=r+(1&n)+(n>>1);V.a=i,V.b=i-n}function h(e,t,r,n,i,a){for(var o,s=r>i?i:r,c=1;c<=s;)c<<=1;for(o=c>>=1,c>>=1;1<=c;){for(var u,h,p,d,f=0,m=f+a*(i-o),g=a*c,v=a*o,y=n*c,b=n*o;f<=m;f+=v){for(var x=f,w=f+n*(r-o);x<=w;x+=b){var _=x+y,T=(E=x+g)+y;l(t[x+e],t[E+e]),u=V.a,p=V.b,l(t[_+e],t[T+e]),h=V.a,d=V.b,l(u,h),t[x+e]=V.a,t[_+e]=V.b,l(p,d),t[E+e]=V.a,t[T+e]=V.b}if(r&c){var E=x+g;l(t[x+e],t[E+e]),u=V.a,t[E+e]=V.b,t[x+e]=u}}if(i&c)for(x=f,w=f+n*(r-o);x<=w;x+=b)_=x+y,l(t[x+e],t[_+e]),u=V.a,t[_+e]=V.b,t[x+e]=u;o=c,c>>=1}return f}function p(e,t,r,i,o,u,l,h,p,d){for(var f=0,m=0,g=h,v=Math.trunc(o.value+(u+7)/8);o.value<v;)for(s(f,m,r,o),f=G.c,m=G.lc;m>=M;){if((w=t[f>>m-M&R]).len)m-=w.len,c(w.lit,l,f,m,r,0,o,p,d,g),f=j.c,m=j.lc;else{if(!w.p)throw"hufDecode issues";var y;for(y=0;y<w.lit;y++){for(var b=n(e[w.p[y]]);m<b&&o.value<v;)s(f,m,r,o),f=G.c,m=G.lc;if(m>=b&&a(e[w.p[y]])==(f>>m-b&(1<<b)-1)){m-=b,c(w.p[y],l,f,m,r,0,o,p,d,g),f=j.c,m=j.lc;break}}if(y==w.lit)throw"hufDecode issues"}}var x=7&8-u;for(f>>=x,m-=x;0<m;){var w;if(!(w=t[f<<M-m&R]).len)throw"hufDecode issues";m-=w.len,c(w.lit,l,f,m,r,0,o,p,d,g),f=j.c,m=j.lc}return!0}function d(e,t,n,i,a,s,c){var u=n.value,l=v(t,n),h=v(t,n);n.value+=4;var d=v(t,n);if(n.value+=4,0>l||l>=L||0>h||h>=L)throw"Something wrong with HUF_ENCSIZE";var f=Array(L),m=Array(N);if(function(e){for(var t=0;t<N;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(m),r(e,0,n,i-(n.value-u),l,h,f),d>8*(i-(n.value-u)))throw"Something wrong with hufUncompress";o(f,l,h,m),p(f,m,e,0,n,d,h,c,a,s)}function f(e,t,r,n,i,a,o,s,c,u){var l=new Uint8Array(S),p=_(n,i),f=_(n,i);if(f>=S)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(p<=f)for(var m=0;m<f-p+1;m++)l[m+p]=b(n,i);var g=new Uint16Array(A);!function(e,t){for(var r=0,n=0;n<A;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[r++]=n);for(var i=r-1;r<A;)t[r++]=0}(l,g),d(r,n,i,v(n,i),e,t,a);var y=Array(o),x=0;for(m=0;m<o;m++)y[m]={},y[m].start=x,y[m].end=y[m].start,y[m].nx=c,y[m].ny=u,y[m].size=1,x+=y[m].nx*y[m].ny*y[m].size;var w=0;for(m=0;m<o;m++)for(var T=0;T<y[m].size;++T)w+=h(T+w,e,y[m].nx,y[m].size,y[m].ny,y[m].nx*y[m].size);return function(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}(g,e,x),!0}function m(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var i=(new TextDecoder).decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function g(e,t){var r=e.getUint32(0,!0);return t.value+=P,r}function v(e,t){var r=e.getUint32(t.value,!0);return t.value+=k,r}function y(e,t){var r=e[t.value];return t.value+=U,r}function b(e,t){var r=e.getUint8(t.value);return t.value+=U,r}function x(e,t){var r=e.getFloat32(t.value,!0);return t.value+=F,r}function w(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31==t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function _(e,t){var r=e.getUint16(t.value,!0);return t.value+=D,r}function T(e,t){return w(_(e,t))}function E(e,t,r,n,i){if("string"===n||"iccProfile"===n)return function(e,t,r){var n=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value+=r,n}(t,r,i);if("chlist"===n)return function(e,t,r,n){for(var i=r.value,a=[];r.value<i+n-1;){var o=m(t,r),s=v(e,r),c=b(e,r);r.value+=3;var u=v(e,r),l=v(e,r);a.push({name:o,pixelType:s,pLinear:c,xSampling:u,ySampling:l})}return r.value+=1,a}(e,t,r,i);if("chromaticities"===n)return function(e,t){return{redX:x(e,t),redY:x(e,t),greenX:x(e,t),greenY:x(e,t),blueX:x(e,t),blueY:x(e,t),whiteX:x(e,t),whiteY:x(e,t)}}(e,r);if("compression"===n)return function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][b(e,t)]}(e,r);if("box2i"===n)return function(e,t){return{xMin:v(e,t),yMin:v(e,t),xMax:v(e,t),yMax:v(e,t)}}(e,r);if("lineOrder"===n)return function(e,t){return["INCREASING_Y"][b(e,t)]}(e,r);if("float"===n)return x(e,r);if("v2f"===n)return function(e,t){return[x(e,t),x(e,t)]}(e,r);if("int"===n)return v(e,r);throw"Cannot parse value for unsupported type: "+n}const A=65536,S=A>>3,M=14,L=65537,N=1<<M,R=N-1,C=59,I=63,O=2+I-C,P=8,F=4,k=4,D=2,U=1,B={l:0,c:0,lc:0},z=Array(59),G={c:0,lc:0},j={c:0,lc:0},V={a:0,b:0};var H=new DataView(e),W=new Uint8Array(e),J={};H.getUint32(0,!0),H.getUint8(4,!0),H.getUint8(5,!0);for(var X={value:8},Y=!0;Y;){var q=m(e,X);if(0==q)Y=!1;else{var K=E(H,e,X,m(e,X),v(H,X));J[q]=K}}var Z=J.dataWindow.yMax+1,Q=1;"PIZ_COMPRESSION"===J.compression&&(Q=32);for(var $=Z/Q,ee=0;ee<$;ee++)g(H,X);var te=J.dataWindow.xMax-J.dataWindow.xMin+1,re=J.dataWindow.yMax-J.dataWindow.yMin+1,ne=J.channels.length;switch(this.type){case i.N:var ie=new Float32Array(te*re*ne);break;case i.S:ie=new Uint16Array(te*re*ne);break;default:console.error("THREE.EXRLoader: unsupported type: ",this.type)}var ae={R:0,G:1,B:2,A:3};if("NO_COMPRESSION"===J.compression)for(var oe,se=0;se<re;se++){oe=v(H,X),v(H,X);for(var ce=0;ce<J.channels.length;ce++){if(me=ae[J.channels[ce].name],1!==J.channels[ce].pixelType)throw"EXRLoader._parser: unsupported pixelType "+J.channels[ce].pixelType+". Only pixelType is 1 (HALF) is supported.";for(var ue=0;ue<te;ue++){switch(this.type){case i.N:var le=T(H,X);break;case i.S:le=_(H,X)}ie[te*ne*(re-oe)+ue*ne+me]=le}}}else{if("PIZ_COMPRESSION"!==J.compression)throw"EXRLoader._parser: "+J.compression+" is unsupported";for(var he=0;he<re/Q;he++){v(H,X),v(H,X);var pe=te*Q*(2*J.channels.length),de=new Uint16Array(pe);f(de,{value:0},W,H,X,pe,ne,J.channels,te,Q);for(var fe=0;fe<Q;fe++){var me;for(ce=0;ce<J.channels.length;ce++){if(me=ae[J.channels[ce].name],1!==J.channels[ce].pixelType)throw"EXRLoader._parser: unsupported pixelType "+J.channels[ce].pixelType+". Only pixelType is 1 (HALF) is supported.";var ge;for(ue=0;ue<te;ue++){switch(ge=ce*(Q*te)+fe*te+ue,this.type){case i.N:le=w(de[ge]);break;case i.S:le=de[ge]}ie[te*ne*(re-(fe+he*Q))+ue*ne+me]=le}}}}}return{header:J,width:te,height:re,data:ie,format:4==J.channels.length?i.Xb:i.fc,type:this.type}};var o=r(1);r.d(t,"GetEXR",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=e||i.D,this.crossOrigin="anonymous",this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={format:null,etcSupported:!1,dxtSupported:!1,pvrtcSupported:!1}};a.prototype={constructor:a,setCrossOrigin:function(e){return this.crossOrigin=e,this},setTranscoderPath:function(e){return this.transcoderPath=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},detectSupport:function(e){var t=this.workerConfig;if(t.etcSupported=!!e.extensions.get("WEBGL_compressed_texture_etc1"),t.dxtSupported=!!e.extensions.get("WEBGL_compressed_texture_s3tc"),t.pvrtcSupported=!!e.extensions.get("WEBGL_compressed_texture_pvrtc")||!!e.extensions.get("WEBKIT_WEBGL_compressed_texture_pvrtc"),t.etcSupported)t.format=a.BASIS_FORMAT.cTFETC1;else if(t.dxtSupported)t.format=a.BASIS_FORMAT.cTFBC1;else{if(!t.pvrtcSupported)throw new Error("THREE.BasisTextureLoader: No suitable compressed texture format found.");t.format=a.BASIS_FORMAT.cTFPVRTC1_4_OPAQUE_ONLY}return this},load:function(e,t,r,n){var a=new i.L(this.manager);a.setResponseType("arraybuffer"),a.load(e,e=>{this._createTexture(e).then(t).catch(n)},r,n)},_createTexture:function(e){var t,r,n=this._getWorker().then(n=>(t=n,r=this.workerNextTaskID++,new Promise((n,i)=>{t._callbacks[r]={resolve:n,reject:i},t._taskCosts[r]=e.byteLength,t._taskLoad+=t._taskCosts[r],t.postMessage({type:"transcode",id:r,buffer:e},[e])}))).then(e=>{var t,r=this.workerConfig,{width:n,height:o,mipmaps:s}=e;if(r.etcSupported)t=new i.p(s,n,o,i.ic);else if(r.dxtSupported)t=new i.p(s,n,o,a.DXT_FORMAT_MAP[r.format],i.Hc);else{if(!r.pvrtcSupported)throw new Error("THREE.BasisTextureLoader: No supported format available.");t=new i.p(s,n,o,i.kc)}return t.minFilter=1===s.length?i.kb:i.lb,t.magFilter=i.kb,t.generateMipmaps=!1,t.needsUpdate=!0,t});return n.finally(()=>{t&&r&&(t._taskLoad-=t._taskCosts[r],delete t._callbacks[r],delete t._taskCosts[r])}),n},_initTranscoder:function(){if(!this.transcoderBinary){var e=new i.L(this.manager);e.setPath(this.transcoderPath);var t=new Promise((t,r)=>{e.load("basis_transcoder.js",t,void 0,r)}),r=new i.L(this.manager);r.setPath(this.transcoderPath),r.setResponseType("arraybuffer");var n=new Promise((e,t)=>{r.load("basis_transcoder.wasm",e,void 0,t)});this.transcoderPending=Promise.all([t,n]).then(([e,t])=>{var r=a.BasisWorker.toString(),n=["/* basis_transcoder.js */","var Module;","function createBasisModule () {","  "+e,"  return Module;","}","","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n])),this.transcoderBinary=t})}return this.transcoderPending},_getWorker:function(){return this._initTranscoder().then(()=>{if(this.workerPool.length<this.workerLimit){var e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:this.transcoderBinary}),e.onmessage=function(t){var r=t.data;switch(r.type){case"transcode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});return this.workerPool[this.workerPool.length-1]})},dispose:function(){for(var e=0;e<this.workerPool.length;e++)this.workerPool[e].terminate();return this.workerPool.length=0,this}},a.BASIS_FORMAT={cTFETC1:0,cTFBC1:1,cTFBC4:2,cTFPVRTC1_4_OPAQUE_ONLY:3,cTFBC7_M6_OPAQUE_ONLY:4,cTFETC2:5,cTFBC3:6,cTFBC5:7},a.DXT_FORMAT={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779},a.DXT_FORMAT_MAP={},a.DXT_FORMAT_MAP[a.BASIS_FORMAT.cTFBC1]=a.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT,a.DXT_FORMAT_MAP[a.BASIS_FORMAT.cTFBC3]=a.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT,a.BasisWorker=function(){function e(e){n=new Promise(t=>{Module={wasmBinary:e,onRuntimeInitialized:t}}).then(()=>{var{BasisFile:e,initializeBasis:t}=Module;i=e,t()}),createBasisModule()}function t(e){function t(){n.close(),n.delete()}var n=new i(new Uint8Array(e)),a=n.getImageWidth(0,0),o=n.getImageHeight(0,0),s=n.getNumLevels(0);if(!a||!o||!s)throw t(),new Error("THREE.BasisTextureLoader:  Invalid .basis file");if(!n.startTranscoding())throw t(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");n.getHasAlpha()&&console.warn("THREE.BasisTextureLoader: Alpha not yet implemented.");for(var c=[],u=0;u<s;u++){var l=n.getImageWidth(0,u),h=n.getImageHeight(0,u),p=new Uint8Array(n.getImageTranscodedSizeInBytes(0,u,r.format));if(!n.transcodeImage(p,0,u,r.format,r.etcSupported?0:r.dxtSupported?1:0,0))throw t(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");c.push({data:p,width:l,height:h})}return t(),{width:a,height:o,mipmaps:c}}var r,n,i;onmessage=function(i){var a=i.data;switch(a.type){case"init":r=a.config,e(a.transcoderBinary);break;case"transcode":n.then(()=>{try{for(var{width:e,height:r,mipmaps:n}=t(a.buffer),i=[],o=0;o<n.length;++o)i.push(n[o].data.buffer);self.postMessage({type:"transcode",id:a.id,width:e,height:r,mipmaps:n},i)}catch(e){console.error(e),self.postMessage({type:"error",id:a.id,error:e.message})}})}}};var o=r(1);r.d(t,"GetBasisTexture",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(){var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),r=function t(){e(this,t),this.boneName="",this.BoneIndex=0,this.Indeces=[],this.Weights=[],this.initMatrix=null,this.OffsetMatrix=null},n=function t(){e(this,t),this.animeName="",this.boneName="",this.targetBone=null,this.keyType=4,this.frameStartLv=0,this.keyFrames=[],this.InverseMx=null},a=function(){function r(t){e(this,r),this.fps=30,this.name="xanimation",this.length=0,this.hierarchy=[],this.putFlags=t,void 0===this.putFlags.putPos&&(this.putFlags.putPos=!0),void 0===this.putFlags.putRot&&(this.putFlags.putRot=!0),void 0===this.putFlags.putScl&&(this.putFlags.putScl=!0)}return t(r,[{key:"make",value:function(e){for(var t=0;t<e.length;t++)this.hierarchy.push(this.makeBonekeys(e[t]));this.length=this.hierarchy[0].keys[this.hierarchy[0].keys.length-1].time}},{key:"clone",value:function(){return Object.assign({},this)}},{key:"makeBonekeys",value:function(e){return{name:e.boneName,parent:"",keys:this.keyFrameRefactor(e),copy:function(){return Object.assign({},this)}}}},{key:"keyFrameRefactor",value:function(e){for(var t,r=[],n=0;n<e.keyFrames.length;n++)(t={}).time=e.keyFrames[n].time*this.fps,e.keyFrames[n].pos&&this.putFlags.putPos&&(t.pos=e.keyFrames[n].pos),e.keyFrames[n].rot&&this.putFlags.putRot&&(t.rot=e.keyFrames[n].rot),e.keyFrames[n].scl&&this.putFlags.putScl&&(t.scl=e.keyFrames[n].scl),e.keyFrames[n].matrix&&(t.matrix=e.keyFrames[n].matrix,this.putFlags.putPos&&(t.pos=(new i.Jc).setFromMatrixPosition(t.matrix)),this.putFlags.putRot&&(t.rot=(new i.Vb).setFromRotationMatrix(t.matrix)),this.putFlags.putScl&&(t.scl=(new i.Jc).setFromMatrixScale(t.matrix))),r.push(t);return r}}]),r}(),o=function t(){e(this,t),this.index=0,this.Frame=0,this.time=0,this.matrix=null};return function(){function s(t){e(this,s),this.debug=!1,this.manager=void 0===t?i.D:t,this.texloader=new i.yc(this.manager),this.url="",this._putMatLength=0,this._nowMat=null,this._nowFrameName="",this.frameHierarchie=[],this.Hierarchies={},this.HieStack=[],this._currentObject={},this._currentFrame={},this._data=null,this.onLoad=null,this.IsUvYReverse=!0,this.Meshes=[],this.animations=[],this.animTicksPerSecond=30,this._currentGeo=null,this._currentAnime=null,this._currentAnimeFrames=null}return t(s,[{key:"crossOrigin",value:"anonymous"},{key:"_setArgOption",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(e){for(var r=t;r<e.length;r++)0===r?this.url=e[r]:1===r&&(this.options=e[r]);void 0===this.options&&(this.options={})}}},{key:"load",value:function(e,t,r,n){var a=this;this._setArgOption(e);var o=new i.L(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(this.url,function(e){a.parse(e,t)},r,n)}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"_readLine",value:function(e){for(var t,r,n=0;t=-1,-1===(t=e.indexOf("//",n))&&(t=e.indexOf("#",n)),-1<t&&2>t;)r=-1,0<(r=e.indexOf("\r\n",n))?n=r+2:n=0<(r=e.indexOf("\r",n))?r+1:e.indexOf("\n",n)+1;return e.substr(n)}},{key:"_readLine",value:function(e){for(var t,r,n=0;t=-1,-1===(t=e.indexOf("//",n))&&(t=e.indexOf("#",n)),-1<t&&2>t;)r=-1,0<(r=e.indexOf("\r\n",n))?n=r+2:n=0<(r=e.indexOf("\r",n))?r+1:e.indexOf("\n",n)+1;return e.substr(n)}},{key:"_isBinary",value:function(e){var t=new DataView(e);if(84+50*t.getUint32(80,!0)===t.byteLength)return!0;for(var r=t.byteLength,n=0;n<r;n++)if(127<t.getUint8(n,!1))return!0;return!1}},{key:"_ensureBinary",value:function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}},{key:"_ensureString",value:function(e){return"string"==typeof e?e:i.ob.decodeText(new Uint8Array(e))}},{key:"parse",value:function(e,t){var r=this._ensureBinary(e);return this._data=this._ensureString(e),this.onLoad=t,this._isBinary(r)?this._parseBinary(r):this._parseASCII()}},{key:"_parseBinary",value:function(e){return this._parseASCII(i.ob.decodeText(new Uint8Array(e)))}},{key:"_parseASCII",value:function(){var e;e=void 0===this.resourcePath?void 0===this.path?i.ob.extractUrlBase(this.url):this.path:this.resourcePath,this.texloader.setPath(e).setCrossOrigin(this.crossOrigin),this.Hierarchies.children=[],this._hierarchieParse(this.Hierarchies,16),this._changeRoot(),this._currentObject=this.Hierarchies.children.shift(),this._mainloop()}},{key:"_hierarchieParse",value:function(e,t){for(var r=t;;){var n=this._data.indexOf("{",r)+1,i=this._data.indexOf("}",r),a=this._data.indexOf("{",n)+1;if(!(0<n&&i>n)){r=-1===n?this._data.length:i+1;break}var o={children:[]},s=this._readLine(this._data.substr(r,n-r-1)).trim(),c=s.split(/ /g);if(0<c.length?(o.type=c[0],o.name=2<=c.length?c[1]:c[0]+this.Hierarchies.children.length):(o.name=s,o.type=""),"Animation"===o.type){o.data=this._data.substr(a,i-a).trim();var u=this._hierarchieParse(o,i+1);r=u.end,o.children=u.parent.children}else{var l=this._data.lastIndexOf(";",0<a?Math.min(a,i):i);if(o.data=this._data.substr(n,l-n).trim(),0>=a||i<a)r=i+1;else{var h=Math.max(l+1,n),p=this._hierarchieParse(o,h);r=p.end,o.children=p.parent.children}}o.parent=e,"template"!=o.type&&e.children.push(o)}return{parent:e,end:r}}},{key:"_mainloop",value:function(){var e=this;this._mainProc(),this._currentObject.parent||0<this._currentObject.children.length||!this._currentObject.worked?setTimeout(function(){e._mainloop()},1):setTimeout(function(){e.onLoad({models:e.Meshes,animations:e.animations})},1)}},{key:"_mainProc",value:function(){for(var e=!1;;){if(!this._currentObject.worked){switch(this._currentObject.type){case"template":break;case"AnimTicksPerSecond":this.animTicksPerSecond=parseInt(this._currentObject.data);break;case"Frame":this._setFrame();break;case"FrameTransformMatrix":this._setFrameTransformMatrix();break;case"Mesh":this._changeRoot(),this._currentGeo={},this._currentGeo.name=this._currentObject.name.trim(),this._currentGeo.parentName=this._getParentName(this._currentObject).trim(),this._currentGeo.VertexSetedBoneCount=[],this._currentGeo.GeometryData={vertices:[],normals:[],uvs:[],skinIndices:[],skinWeights:[],indices:[],materialIndices:[]},this._currentGeo.Materials=[],this._currentGeo.normalVectors=[],this._currentGeo.BoneInfs=[],this._currentGeo.baseFrame=this._currentFrame,this._makeBoneFrom_CurrentFrame(),this._readVertexDatas(),e=!0;break;case"MeshNormals":this._readVertexDatas();break;case"MeshTextureCoords":this._setMeshTextureCoords();break;case"VertexDuplicationIndices":break;case"MeshMaterialList":this._setMeshMaterialList();break;case"Material":this._setMaterial();break;case"SkinWeights":this._setSkinWeights();break;case"AnimationSet":this._changeRoot(),this._currentAnime={},this._currentAnime.name=this._currentObject.name.trim(),this._currentAnime.AnimeFrames=[];break;case"Animation":this._currentAnimeFrames&&this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=new n,this._currentAnimeFrames.boneName=this._currentObject.data.trim();break;case"AnimationKey":this._readAnimationKey(),e=!0}this._currentObject.worked=!0}if(0<this._currentObject.children.length){if(this._currentObject=this._currentObject.children.shift(),this.debug&&console.log("processing "+this._currentObject.name),e)break}else if(this._currentObject.worked&&this._currentObject.parent&&!this._currentObject.parent.parent&&this._changeRoot(),this._currentObject.parent?this._currentObject=this._currentObject.parent:e=!0,e)break}}},{key:"_changeRoot",value:function(){null!=this._currentGeo&&this._currentGeo.name&&this._makeOutputGeometry(),this._currentGeo={},null!=this._currentAnime&&this._currentAnime.name&&(this._currentAnimeFrames&&(this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=null),this._makeOutputAnimation()),this._currentAnime={}}},{key:"_getParentName",value:function(e){return e.parent?e.parent.name?e.parent.name:this._getParentName(e.parent):""}},{key:"_setFrame",value:function(){this._nowFrameName=this._currentObject.name.trim(),this._currentFrame={},this._currentFrame.name=this._nowFrameName,this._currentFrame.children=[],this._currentObject.parent&&this._currentObject.parent.name&&(this._currentFrame.parentName=this._currentObject.parent.name),this.frameHierarchie.push(this._nowFrameName),this.HieStack[this._nowFrameName]=this._currentFrame}},{key:"_setFrameTransformMatrix",value:function(){this._currentFrame.FrameTransformMatrix=new i.ub;var e=this._currentObject.data.split(",");this._ParseMatrixData(this._currentFrame.FrameTransformMatrix,e),this._makeBoneFrom_CurrentFrame()}},{key:"_makeBoneFrom_CurrentFrame",value:function(){if(this._currentFrame.FrameTransformMatrix){var e=new i.i;if(e.name=this._currentFrame.name,e.applyMatrix(this._currentFrame.FrameTransformMatrix),e.matrixWorld=e.matrix,e.FrameTransformMatrix=this._currentFrame.FrameTransformMatrix,this._currentFrame.putBone=e,this._currentFrame.parentName)for(var t in this.HieStack)this.HieStack[t].name===this._currentFrame.parentName&&this.HieStack[t].putBone.add(this._currentFrame.putBone)}}},{key:"_readVertexDatas",value:function(){for(var e,t=0,r=0,n=0,i=0;;){if(e=!1,0==n){t=this._readInt1(t).endRead,n=1,0>=(i=this._currentObject.data.indexOf(";;",t)+1)&&(i=this._currentObject.data.length)}else{var a=0;switch(0==r?a=this._currentObject.data.indexOf(",",t)+1:1==r&&(a=this._currentObject.data.indexOf(";,",t)+1),(0===a||a>i)&&(a=i,n=0,e=!0),this._currentObject.type){case"Mesh":0==r?this._readVertex1(this._currentObject.data.substr(t,a-t)):1==r&&this._readFace1(this._currentObject.data.substr(t,a-t));break;case"MeshNormals":0==r&&this._readNormalVector1(this._currentObject.data.substr(t,a-t))}t=a+1,e&&r++}if(t>=this._currentObject.data.length)break}}},{key:"_readInt1",value:function(e){var t=this._currentObject.data.indexOf(";",e);return{refI:parseInt(this._currentObject.data.substr(e,t-e)),endRead:t+1}}},{key:"_readVertex1",value:function(e){var t=this._readLine(e.trim()).substr(0,e.length-2).split(";");this._currentGeo.GeometryData.vertices.push(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])),this._currentGeo.GeometryData.skinIndices.push(0,0,0,0),this._currentGeo.GeometryData.skinWeights.push(1,0,0,0),this._currentGeo.VertexSetedBoneCount.push(0)}},{key:"_readFace1",value:function(e){var t=this._readLine(e.trim()).substr(2,e.length-4).split(",");this._currentGeo.GeometryData.indices.push(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))}},{key:"_readNormalVector1",value:function(e){var t=this._readLine(e.trim()).substr(0,e.length-2).split(";");this._currentGeo.GeometryData.normals.push(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))}},{key:"_buildGeometry",value:function(){for(var e=new i.l,t=[],r=[],n=[],a=[],o=[],s=this._currentGeo.GeometryData,c=0,u=s.indices.length;c<u;c++){var l=2*s.indices[c],h=3*s.indices[c],p=4*s.indices[c];t.push(s.vertices[h],s.vertices[h+1],s.vertices[h+2]),r.push(s.normals[h],s.normals[h+1],s.normals[h+2]),a.push(s.skinIndices[p],s.skinIndices[p+1],s.skinIndices[p+2],s.skinIndices[p+3]),o.push(s.skinWeights[p],s.skinWeights[p+1],s.skinWeights[p+2],s.skinWeights[p+3]),n.push(s.uvs[l],s.uvs[l+1])}return e.addAttribute("position",new i.M(t,3)),e.addAttribute("normal",new i.M(r,3)),e.addAttribute("uv",new i.M(n,2)),e.addAttribute("skinIndex",new i.Cc(a,4)),e.addAttribute("skinWeight",new i.M(o,4)),this._computeGroups(e,s.materialIndices),e}},{key:"_computeGroups",value:function(e,t){for(var r,n,i=[],a=void 0,o=0;o<t.length;o++)(n=t[o])!==a&&(a=n,null!=r&&(r.count=3*o-r.start,i.push(r)),r={start:3*o,materialIndex:a});void 0!==r&&(r.count=3*o-r.start,i.push(r)),e.groups=i}},{key:"_setMeshTextureCoords",value:function(){for(var e=0,t=0,r=0;;){switch(t){case 0:if(0==r){e=this._readInt1(0).endRead,r=1}else{var n=this._currentObject.data.indexOf(",",e)+1;0===n&&(n=this._currentObject.data.length,t=2,r=0);var i=this._currentObject.data.substr(e,n-e),a=this._readLine(i.trim()).split(";");this.IsUvYReverse?this._currentGeo.GeometryData.uvs.push(parseFloat(a[0]),1-parseFloat(a[1])):this._currentGeo.GeometryData.uvs.push(parseFloat(a[0]),parseFloat(a[1])),e=n+1}}if(e>=this._currentObject.data.length)break}}},{key:"_setMeshMaterialList",value:function(){for(var e=0,t=0,r=0;;){if(2>r){e=this._readInt1(e).endRead,r++}else{var n=this._currentObject.data.indexOf(";",e);-1===n&&(n=this._currentObject.data.length,t=3,r=0);for(var i=this._currentObject.data.substr(e,n-e),a=this._readLine(i.trim()).split(","),o=0;o<a.length;o++)this._currentGeo.GeometryData.materialIndices[o]=parseInt(a[o]);e=this._currentObject.data.length}if(e>=this._currentObject.data.length||3<=t)break}}},{key:"_setMaterial",value:function(){var e=new i.yb({color:16777215*Math.random()});e.side=i.P,e.name=this._currentObject.name;var t=0,r=this._currentObject.data.indexOf(";;",t),n=this._currentObject.data.substr(t,r-t),a=this._readLine(n.trim()).split(";");e.color.r=parseFloat(a[0]),e.color.g=parseFloat(a[1]),e.color.b=parseFloat(a[2]),t=r+2,r=this._currentObject.data.indexOf(";",t),n=this._currentObject.data.substr(t,r-t),e.shininess=parseFloat(this._readLine(n)),t=r+1,r=this._currentObject.data.indexOf(";;",t),n=this._currentObject.data.substr(t,r-t);var o=this._readLine(n.trim()).split(";");e.specular.r=parseFloat(o[0]),e.specular.g=parseFloat(o[1]),e.specular.b=parseFloat(o[2]),t=r+2,-1===(r=this._currentObject.data.indexOf(";;",t))&&(r=this._currentObject.data.length),n=this._currentObject.data.substr(t,r-t);var s=this._readLine(n.trim()).split(";");e.emissive.r=parseFloat(s[0]),e.emissive.g=parseFloat(s[1]),e.emissive.b=parseFloat(s[2]);for(var c=null;0<this._currentObject.children.length;){c=this._currentObject.children.shift(),this.debug&&console.log("processing "+c.name);var u=c.data.substr(1,c.data.length-2);switch(c.type){case"TextureFilename":e.map=this.texloader.load(u);break;case"BumpMapFilename":e.bumpMap=this.texloader.load(u),e.bumpScale=.05;break;case"NormalMapFilename":e.normalMap=this.texloader.load(u),e.normalScale=new i.Ic(2,2);break;case"EmissiveMapFilename":e.emissiveMap=this.texloader.load(u);break;case"LightMapFilename":e.lightMap=this.texloader.load(u)}}this._currentGeo.Materials.push(e)}},{key:"_setSkinWeights",value:function(){var e=new r,t=0,n=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,n-t);t=n+1,e.boneName=a.substr(1,a.length-2),e.BoneIndex=this._currentGeo.BoneInfs.length,t=(n=this._currentObject.data.indexOf(";",t))+1,n=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,n-t);for(var o=this._readLine(a.trim()).split(","),s=0;s<o.length;s++)e.Indeces.push(parseInt(o[s]));t=n+1,n=this._currentObject.data.indexOf(";",t),a=this._currentObject.data.substr(t,n-t);for(var c=this._readLine(a.trim()).split(","),u=0;u<c.length;u++)e.Weights.push(parseFloat(c[u]));t=n+1,0>=(n=this._currentObject.data.indexOf(";",t))&&(n=this._currentObject.data.length),a=this._currentObject.data.substr(t,n-t);var l=this._readLine(a.trim()).split(",");e.OffsetMatrix=new i.ub,this._ParseMatrixData(e.OffsetMatrix,l),this._currentGeo.BoneInfs.push(e)}},{key:"_makePutBoneList",value:function(e,t){var r=!1;for(var n in this.HieStack)if(this.HieStack[n].name===e||r){r=!0;var a=new i.i;if(a.name=this.HieStack[n].name,a.applyMatrix(this.HieStack[n].FrameTransformMatrix),a.matrixWorld=a.matrix,a.FrameTransformMatrix=this.HieStack[n].FrameTransformMatrix,a.pos=(new i.Jc).setFromMatrixPosition(a.FrameTransformMatrix).toArray(),a.rotq=(new i.Vb).setFromRotationMatrix(a.FrameTransformMatrix).toArray(),a.scl=(new i.Jc).setFromMatrixScale(a.FrameTransformMatrix).toArray(),this.HieStack[n].parentName&&0<this.HieStack[n].parentName.length)for(var o=0;o<t.length;o++)if(this.HieStack[n].parentName===t[o].name){t[o].add(a),a.parent=o;break}t.push(a)}}},{key:"_makeOutputGeometry",value:function(){var e=null;if(0<this._currentGeo.BoneInfs.length){var t=[];this._makePutBoneList(this._currentGeo.baseFrame.parentName,t);for(var r,n=0;n<this._currentGeo.BoneInfs.length;n++){r=0;for(var a=0;a<t.length;a++)if(t[a].name===this._currentGeo.BoneInfs[n].boneName){r=a,t[a].OffsetMatrix=new i.ub,t[a].OffsetMatrix.copy(this._currentGeo.BoneInfs[n].OffsetMatrix);break}for(var o=0;o<this._currentGeo.BoneInfs[n].Indeces.length;o++){var s=this._currentGeo.BoneInfs[n].Indeces[o],c=this._currentGeo.BoneInfs[n].Weights[o],u=4*s;switch(this._currentGeo.VertexSetedBoneCount[s]){case 0:this._currentGeo.GeometryData.skinIndices[u]=r,this._currentGeo.GeometryData.skinWeights[u]=c;break;case 1:this._currentGeo.GeometryData.skinIndices[u+1]=r,this._currentGeo.GeometryData.skinWeights[u+1]=c;break;case 2:this._currentGeo.GeometryData.skinIndices[u+2]=r,this._currentGeo.GeometryData.skinWeights[u+2]=c;break;case 3:this._currentGeo.GeometryData.skinIndices[u+3]=r,this._currentGeo.GeometryData.skinWeights[u+3]=c}this._currentGeo.VertexSetedBoneCount[s]++,4<this._currentGeo.VertexSetedBoneCount[s]&&console.log("warn! over 4 bone weight! :"+s)}}for(var l=0;l<this._currentGeo.Materials.length;l++)this._currentGeo.Materials[l].skinning=!0;for(var h=[],p=0;p<t.length;p++)t[p].OffsetMatrix?h.push(t[p].OffsetMatrix):h.push(new i.ub);var d=this._buildGeometry();e=new i.sc(d,1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials),this._initSkeleton(e,t,h)}else{var f=this._buildGeometry();e=new i.vb(f,1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials)}e.name=this._currentGeo.name;var m=new i.ub,g=this._currentGeo.baseFrame.putBone;if(g&&g.parent){for(;g=g.parent;)m.multiply(g.FrameTransformMatrix);e.applyMatrix(m)}this.Meshes.push(e)}},{key:"_initSkeleton",value:function(e,t,r){var n,a,o,s,c=[];for(o=0,s=t.length;o<s;o++)a=t[o],n=new i.i,c.push(n),n.name=a.name,n.position.fromArray(a.pos),n.quaternion.fromArray(a.rotq),void 0!==a.scl&&n.scale.fromArray(a.scl);for(o=0,s=t.length;o<s;o++)-1!==(a=t[o]).parent&&null!==a.parent&&void 0!==c[a.parent]?c[a.parent].add(c[o]):e.add(c[o]);e.updateMatrixWorld(!0);var u=new i.rc(c,r);e.bind(u,e.matrixWorld)}},{key:"_readAnimationKey",value:function(){var e=0,t=this._currentObject.data.indexOf(";",e),r=this._currentObject.data.substr(e,t-e);e=t+1;var n=parseInt(this._readLine(r));e=(t=this._currentObject.data.indexOf(";",e))+1,r=this._currentObject.data.substr(e);for(var a=this._readLine(r.trim()).split(";;,"),s=0;s<a.length;s++){var c=a[s].split(";"),u=new o;if(u.type=n,u.Frame=parseInt(c[0]),u.index=this._currentAnimeFrames.keyFrames.length,u.time=u.Frame,4!=n){for(var l=!1,h=0;h<this._currentAnimeFrames.keyFrames.length;h++)if(this._currentAnimeFrames.keyFrames[h].Frame===u.Frame){u=this._currentAnimeFrames.keyFrames[h],l=!0;break}var p=c[2].split(",");0===n?u.rot=new i.Vb(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]),-1*parseFloat(p[0])):1===n?u.scl=new i.Jc(parseFloat(p[0]),parseFloat(p[1]),parseFloat(p[2])):2===n&&(u.pos=new i.Jc(parseFloat(p[0]),parseFloat(p[1]),parseFloat(p[2]))),l||this._currentAnimeFrames.keyFrames.push(u)}else u.matrix=new i.ub,this._ParseMatrixData(u.matrix,c[2].split(",")),this._currentAnimeFrames.keyFrames.push(u)}}},{key:"_makeOutputAnimation",value:function(){var e=new a(this.options);e.fps=this.animTicksPerSecond,e.name=this._currentAnime.name,e.make(this._currentAnime.AnimeFrames),this.animations.push(e)}},{key:"assignAnimation",value:function(e,t){var r=e,n=t;if(r||(r=this.Meshes[0]),n||(n=this.animations[0]),!r||!n)return null;for(var a,o={fps:n.fps,name:n.name,length:n.length,hierarchy:[]},s=0;s<r.skeleton.bones.length;s++){a=!1;for(var c=0;c<n.hierarchy.length;c++)if(r.skeleton.bones[s].name===n.hierarchy[c].name){a=!0;var u=n.hierarchy[c].copy();if(u.parent=-1,r.skeleton.bones[s].parent&&"Bone"===r.skeleton.bones[s].parent.type)for(var l=0;l<o.hierarchy.length;l++)o.hierarchy[l].name===r.skeleton.bones[s].parent.name&&(u.parent=l,u.parentName=r.skeleton.bones[s].parent.name);o.hierarchy.push(u);break}if(!a){var h=n.hierarchy[0].copy();h.name=r.skeleton.bones[s].name,h.parent=-1;for(var p=0;p<h.keys.length;p++)h.keys[p].pos&&h.keys[p].pos.set(0,0,0),h.keys[p].scl&&h.keys[p].scl.set(1,1,1),h.keys[p].rot&&h.keys[p].rot.set(0,0,0,1);o.hierarchy.push(h)}}return r.geometry.animations||(r.geometry.animations=[]),r.geometry.animations.push(i.d.parseAnimation(o,r.skeleton.bones)),r.animationMixer||(r.animationMixer=new i.f(r)),o}},{key:"_ParseMatrixData",value:function(e,t){e.set(parseFloat(t[0]),parseFloat(t[4]),parseFloat(t[8]),parseFloat(t[12]),parseFloat(t[1]),parseFloat(t[5]),parseFloat(t[9]),parseFloat(t[13]),parseFloat(t[2]),parseFloat(t[6]),parseFloat(t[10]),parseFloat(t[14]),parseFloat(t[3]),parseFloat(t[7]),parseFloat(t[11]),parseFloat(t[15]))}}]),s}()}(),o=r(1);r.d(t,"GetX",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(c.a)(new s,e,t)}var i=String.fromCharCode;r.r(t);var a=r(0),o=r(6),s=function(e){this.manager=void 0===e?a.D:e};Object.assign(s.prototype,a.K.prototype,{load:function(e,t,r,n){var i=this,o=new a.L(i.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,t){var r=e.length,n=new Float32Array(r+t.length);return n.set(e),n.set(t,r),n}function r(e,t){var r=e.length,n=new Int32Array(r+t.length);return n.set(e),n.set(t,r),n}function n(e){for(var t="",r=new Uint8Array(e),n=0,a=r.length;a--;)t+=i(r[n++]);return t}var s=a.ob.decodeText(new Uint8Array(e,0,250)).split("\n");return-1===s[0].indexOf("xml")?s[2].includes("ASCII")?function(e){var t,r=[],n=[],i=[],o=[],s=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,c=/^(\d+)\s+([\s\d]*)/,u=/^POINTS /,l=/^POLYGONS /,h=/^TRIANGLE_STRIPS /,p=/^POINT_DATA[ ]+(\d+)/,d=/^CELL_DATA[ ]+(\d+)/,f=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,m=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,g=!1,v=!1,y=!1,b=!1,x=!1,w=!1,_=!1,T=e.split("\n");for(var E in T){var A=T[E];if(0===A.indexOf("DATASET")){var S=A.split(" ")[1];if("POLYDATA"!==S)throw new Error("Unsupported DATASET type: "+S)}else if(g)for(;null!==(t=s.exec(A));){var M=parseFloat(t[1]),L=parseFloat(t[2]),N=parseFloat(t[3]);n.push(M,L,N)}else if(v){if(null!==(t=c.exec(A))){var R=parseInt(t[1]),C=t[2].split(/\s+/);if(3<=R)for(var I=parseInt(C[0]),O=1,P=0;P<R-2;++P)F=parseInt(C[O]),k=parseInt(C[O+1]),r.push(I,F,k),O++}}else if(y){if(null!==(t=c.exec(A))){R=parseInt(t[1]),C=t[2].split(/\s+/);if(3<=R){var F,k;for(P=0;P<R-2;P++)1==P%2?(I=parseInt(C[P]),F=parseInt(C[P+2]),k=parseInt(C[P+1]),r.push(I,F,k)):(I=parseInt(C[P]),F=parseInt(C[P+1]),k=parseInt(C[P+2]),r.push(I,F,k))}}}else if(b||x)if(w)for(;null!==(t=s.exec(A));){var D=parseFloat(t[1]),U=parseFloat(t[2]),B=parseFloat(t[3]);i.push(D,U,B)}else if(_)for(;null!==(t=s.exec(A));){var z=parseFloat(t[1]),G=parseFloat(t[2]),j=parseFloat(t[3]);o.push(z,G,j)}null===l.exec(A)?null===u.exec(A)?null===h.exec(A)?null===p.exec(A)?null===d.exec(A)?null===f.exec(A)?null!==m.exec(A)&&(_=!0,w=!1,g=!1,v=!1,y=!1):(w=!0,_=!1,g=!1,v=!1,y=!1):(x=!0,g=!1,v=!1,y=!1):(b=!0,g=!1,v=!1,y=!1):(v=!1,g=!1,y=!0):(v=!1,g=!0,y=!1):(v=!0,g=!1,y=!1)}var V=new a.l;if(V.setIndex(r),V.addAttribute("position",new a.M(n,3)),o.length===n.length&&V.addAttribute("normal",new a.M(o,3)),i.length!==r.length)i.length===n.length&&V.addAttribute("color",new a.M(i,3));else{var H=(V=V.toNonIndexed()).attributes.position.count/3;if(i.length===3*H){var W=[];for(E=0;E<H;E++){D=i[3*E+0],U=i[3*E+1],B=i[3*E+2];W.push(D,U,B),W.push(D,U,B),W.push(D,U,B)}V.addAttribute("color",new a.M(W,3))}}return V}(n(e)):function(e){function t(e,t){for(var r=t,n=e[r],a=[];10!==n;)a.push(i(n)),n=e[++r];return{start:t,end:r,next:r+1,parsedString:a.join("")}}for(var r,n,o,s,c,u,l,h=new Uint8Array(e),p=new DataView(e),d=[],f=[],m=[],g=[],v=0;;){if(0===(l=(u=t(h,v)).parsedString).indexOf("DATASET")){var y=l.split(" ")[1];if("POLYDATA"!==y)throw new Error("Unsupported DATASET type: "+y)}else if(0===l.indexOf("POINTS")){for(g.push(l),r=4*(s=parseInt(l.split(" ")[1],10))*3,d=new Float32Array(3*s),n=u.next,o=0;o<s;o++)d[3*o]=p.getFloat32(n,!1),d[3*o+1]=p.getFloat32(n+4,!1),d[3*o+2]=p.getFloat32(n+8,!1),n+=12;u.next=u.next+r+1}else if(0===l.indexOf("TRIANGLE_STRIPS")){var b=parseInt(l.split(" ")[1],10);r=4*(E=parseInt(l.split(" ")[2],10)),m=new Uint32Array(3*E-9*b);var x=0;for(n=u.next,o=0;o<b;o++){var w=p.getInt32(n,!1),_=[];for(n+=4,c=0;c<w;c++)_.push(p.getInt32(n,!1)),n+=4;for(var T=0;T<w-2;T++)T%2?(m[x++]=_[T],m[x++]=_[T+2],m[x++]=_[T+1]):(m[x++]=_[T],m[x++]=_[T+1],m[x++]=_[T+2])}u.next=u.next+r+1}else if(0===l.indexOf("POLYGONS")){var E;b=parseInt(l.split(" ")[1],10);r=4*(E=parseInt(l.split(" ")[2],10)),m=new Uint32Array(3*E-9*b);x=0;for(n=u.next,o=0;o<b;o++){w=p.getInt32(n,!1),_=[];for(n+=4,c=0;c<w;c++)_.push(p.getInt32(n,!1)),n+=4;for(T=1;T<w-1;T++)m[x++]=_[0],m[x++]=_[T],m[x++]=_[T+1]}u.next=u.next+r+1}else if(0===l.indexOf("POINT_DATA")){for(s=parseInt(l.split(" ")[1],10),u=t(h,u.next),r=4*s*3,f=new Float32Array(3*s),n=u.next,o=0;o<s;o++)f[3*o]=p.getFloat32(n,!1),f[3*o+1]=p.getFloat32(n+4,!1),f[3*o+2]=p.getFloat32(n+8,!1),n+=12;u.next+=r}if((v=u.next)>=h.byteLength)break}var A=new a.l;return A.setIndex(new a.k(m,1)),A.addAttribute("position",new a.k(d,3)),f.length===d.length&&A.addAttribute("normal",new a.k(f,3)),A}(e):function(e){function n(e){var t,r,n,i,a,o,s="undefined"==typeof Uint8Array?Array:Uint8Array,c=[],u=[],l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=l.length;for(t=0;t<h;t++)c[t]=l[t];for(t=0;t<h;++t)u[l.charCodeAt(t)]=t;if(u[45]=62,u[95]=63,0<(h=e.length)%4)throw new Error("Invalid string. Length must be a multiple of 4");o=new s(3*h/4-(a="="===e[h-2]?2:"="===e[h-1]?1:0)),n=0<a?h-4:h;var p=0;for(t=0,r=0;t<n;t+=4,r+=3)i=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],o[p++]=(16711680&i)>>16,o[p++]=(65280&i)>>8,o[p++]=255&i;return 2===a?(i=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,o[p++]=255&i):1==a&&(i=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,o[p++]=255&i>>8,o[p++]=255&i),o}function i(e,i){var a=0;if("UInt64"===c.attributes.header_type?a=8:"UInt32"===c.attributes.header_type&&(a=4),"binary"===e.attributes.format&&i){var s,u,l,h,p,d;if("Float32"===e.attributes.type)var f=new Float32Array;else if("Int64"===e.attributes.type)f=new Int32Array;u=(s=n(e["#text"]))[0];for(var m=1;m<a-1;m++)u|=s[m]<<m*a;h=(u+3)*a,d=h+=0<h%3?3-h%3:0,(p=[]).push(d),l=3*a;var g;for(m=0;m<u;m++){g=s[m*a+l];for(var v=1;v<a-1;v++)g|=s[m*a+l+v]<<8*v;d+=g,p.push(d)}for(m=0;m<p.length-1;m++)y=(y=new o.a.Inflate(s.slice(p[m],p[m+1]),{resize:!0,verify:!0}).decompress()).buffer,"Float32"===e.attributes.type?f=t(f,y=new Float32Array(y)):"Int64"===e.attributes.type&&(f=r(f,y=new Int32Array(y)));delete e["#text"],"Int64"===e.attributes.type&&"binary"===e.attributes.format&&(f=f.filter(function(e,t){if(1!=t%2)return!0}))}else{if("binary"!==e.attributes.format||i)if(e["#text"])var y=e["#text"].split(/\s+/).filter(function(e){if(""!==e)return e});else y=new Int32Array(0).buffer;else y=(y=n(e["#text"])).slice(a).buffer;if(delete e["#text"],"Float32"===e.attributes.type)f=new Float32Array(y);else if("Int32"===e.attributes.type)f=new Int32Array(y);else if("Int64"===e.attributes.type){f=new Int32Array(y);"binary"===e.attributes.format&&(f=f.filter(function(e,t){if(1!=t%2)return!0}))}}return f}var s=null;if(window.DOMParser)try{s=(new DOMParser).parseFromString(e,"text/xml")}catch(e){s=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if((s=new ActiveXObject("Microsoft.XMLDOM")).async=!1,!s.loadXML())throw new Error(s.parseError.reason+s.parseError.srcText)}catch(e){s=null}}var c=function e(t){var r={};if(1!==t.nodeType)3===t.nodeType&&(r=t.nodeValue.trim());else if(t.attributes&&0<t.attributes.length){r.attributes={};for(var n,i=0;i<t.attributes.length;i++)n=t.attributes.item(i),r.attributes[n.nodeName]=n.nodeValue.trim()}if(t.hasChildNodes())for(var a=0;a<t.childNodes.length;a++){var o=t.childNodes.item(a),s=o.nodeName;if(void 0===r[s])""!==(u=e(o))&&(r[s]=u);else{if(void 0===r[s].push){var c=r[s];r[s]=[c]}var u;""!==(u=e(o))&&r[s].push(u)}}return r}(s.documentElement),u=[],l=[],h=[];if(c.PolyData){for(var p,d=c.PolyData.Piece,f=c.attributes.hasOwnProperty("compressor"),m=["PointData","Points","Strips","Polys"],g=0,v=m.length;g<v;){if((p=d[m[g]])&&p.DataArray){if("[object Array]"===Object.prototype.toString.call(p.DataArray))var y=p.DataArray;else y=[p.DataArray];for(var b=0,x=y.length;b<x;)"#text"in y[b]&&0<y[b]["#text"].length&&(y[b].text=i(y[b],f)),b++;switch(m[g]){case"PointData":var w=parseInt(d.attributes.NumberOfPoints),_=p.attributes.Normals;if(0<w)for(var T=0,E=y.length;T<E;T++)if(_===y[T].attributes.Name){var A=y[T].attributes.NumberOfComponents;(l=new Float32Array(w*A)).set(y[T].text,0)}break;case"Points":if(0<(w=parseInt(d.attributes.NumberOfPoints))){A=p.DataArray.attributes.NumberOfComponents;(u=new Float32Array(w*A)).set(p.DataArray.text,0)}break;case"Strips":var S=parseInt(d.attributes.NumberOfStrips);if(0<S){var M=new Int32Array(p.DataArray[0].text.length),L=new Int32Array(p.DataArray[1].text.length);M.set(p.DataArray[0].text,0),L.set(p.DataArray[1].text,0);var N=S+M.length;h=new Uint32Array(3*N-9*S);var R,C=0;for(T=0,E=S;T<E;T++){R=[];for(var I=0,O=L[T],P=0;I<O-P;I++)R.push(M[I]),0<T&&(P=L[T-1]);var F=0;for(O=L[T],P=0;F<O-P-2;F++)F%2?(h[C++]=R[F],h[C++]=R[F+2],h[C++]=R[F+1]):(h[C++]=R[F],h[C++]=R[F+1],h[C++]=R[F+2]),0<T&&(P=L[T-1])}}break;case"Polys":var k=parseInt(d.attributes.NumberOfPolys);if(0<k){M=new Int32Array(p.DataArray[0].text.length),L=new Int32Array(p.DataArray[1].text.length);M.set(p.DataArray[0].text,0),L.set(p.DataArray[1].text,0);N=k+M.length;h=new Uint32Array(3*N-9*k);C=0;var D=0;for(T=0,E=k,P=0;T<E;){var U=[];for(I=0,O=L[T];I<O-P;)U.push(M[D++]),I++;for(F=1;F<O-P-1;)h[C++]=U[0],h[C++]=U[F],h[C++]=U[F+1],F++;P=L[++T-1]}}}}g++}var B=new a.l;return B.setIndex(new a.k(h,1)),B.addAttribute("position",new a.k(u,3)),l.length===u.length&&B.addAttribute("normal",new a.k(l,3)),B}throw new Error("Unsupported DATASET type")}(n(e))}});var c=r(1);r.d(t,"GetVTK",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.splitLayer=!1};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){u={vertex:[],pathVertex:[],z:e.z},c.push(u)}function r(e,r){void 0===u&&t(e),v.extruding?(u.vertex.push(e.x,e.y,e.z),u.vertex.push(r.x,r.y,r.z)):(u.pathVertex.push(e.x,e.y,e.z),u.pathVertex.push(r.x,r.y,r.z))}function n(e,t){return s.relative?t:t-e}function a(e,t){return s.relative?e+t:t}function o(e,t){var r=new i.l;r.addAttribute("position",new i.M(e,3));var n=new i.ib(r,t?h:l);n.name="layer"+d,y.add(n)}var s={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},c=[],u=void 0,l=new i.gb({color:16711680});l.name="path";var h=new i.gb({color:65280});h.name="extruded";for(var p=e.replace(/;.+/g,"").split("\n"),d=0;d<p.length;d++){var f=p[d].split(" "),m=f[0].toUpperCase(),g={};if(f.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));g[t]=r}}),"G0"===m||"G1"===m){var v={x:void 0===g.x?s.x:a(s.x,g.x),y:void 0===g.y?s.y:a(s.y,g.y),z:void 0===g.z?s.z:a(s.z,g.z),e:void 0===g.e?s.e:a(s.e,g.e),f:void 0===g.f?s.f:a(s.f,g.f)};0<n(s.e,v.e)&&(v.extruding=0<n(s.e,v.e),(null==u||v.z!=u.z)&&t(v)),r(s,v),s=v}else if("G2"===m||"G3"===m);else if("G90"===m)s.relative=!1;else if("G91"===m)s.relative=!0;else if("G92"===m){(v=s).x=void 0===g.x?v.x:g.x,v.y=void 0===g.y?v.y:g.y,v.z=void 0===g.z?v.z:g.z,v.e=void 0===g.e?v.e:g.e,s=v}}var y=new i.R;if(y.name="gcode",this.splitLayer)for(d=0;d<c.length;d++)o((b=c[d]).vertex,!0),o(b.pathVertex,!1);else{var b,x=[],w=[];for(d=0;d<c.length;d++)b=c[d],x=x.concat(b.vertex),w=w.concat(b.pathVertex);o(x,!0),o(w,!1)}return y.quaternion.setFromEuler(new i.J(-Math.PI/2,0,0)),y}};var o=r(1);r.d(t,"GetGCode",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}r.r(t);var i=r(0),a=r(8),o=function(e){this.manager=void 0===e?i.D:e,this.hdrLoader=new a.a,this.type=i.Hc};o.prototype.load=function(e,t,r,n){function a(t,r,n,a){new i.L(s.manager).setPath(s.path).setResponseType("arraybuffer").load(e[t],function(e){c++;var n=s.hdrLoader._parser(e);if(n){if(void 0!==n.data){var a=new i.B(n.data,n.width,n.height);a.type=o.type,a.encoding=o.encoding,a.format=o.format,a.minFilter=o.minFilter,a.magFilter=o.magFilter,a.generateMipmaps=o.generateMipmaps,o.images[t]=a}6===c&&(o.needsUpdate=!0,r&&r(o))}},n,a)}Array.isArray(e)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(e),e=t,t=r,r=n,n=arguments[4]);var o=new i.u;switch(o.type=this.type,o.type){case i.Hc:o.encoding=i.dc,o.format=i.Xb,o.minFilter=i.Eb,o.magFilter=i.Eb,o.generateMipmaps=!1;break;case i.N:o.encoding=i.jb,o.format=i.fc,o.minFilter=i.kb,o.magFilter=i.kb,o.generateMipmaps=!1;break;case i.S:o.encoding=i.jb,o.format=i.fc,o.minFilter=i.kb,o.magFilter=i.kb,o.generateMipmaps=!1}for(var s=this,c=0,u=0;u<e.length;u++)a(u,t,r,n);return o},o.prototype.setPath=function(e){return this.path=e,this},o.prototype.setDataType=function(e){return this.type=e,this.hdrLoader.setDataType(e),this},o.prototype.setType=function(e){return console.warn("THREE.HDRCubeTextureLoader: .setType() has been renamed to .setDataType()."),this.setDataType(e)};var s=r(1);r.d(t,"GetHDRCubeTexture",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}r.r(t);var i=r(0),a=r(5),o=function(e){this.manager=void 0===e?i.D:e};o.prototype={constructor:o,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){for(var t in n.files)if(t.substr(-e.length)===e)return n.files[t]}var r=new i.pb;r.setURLModifier(function(e){var r=t(e);if(r){console.log("Loading",e);var n=new Blob([r.asArrayBuffer()],{type:"application/octet-stream"});return URL.createObjectURL(n)}return e});var n=new JSZip(e);if(n.files["doc.kml"]){var o=(new DOMParser).parseFromString(n.files["doc.kml"].asText(),"application/xml").querySelector("Placemark Model Link href");if(o)return new a.a(r).parse(n.files[o.textContent].asText())}else for(var s in console.warn("KMZLoader: Missing doc.kml file."),n.files){if("dae"===s.split(".").pop().toLowerCase())return new a.a(r).parse(n.files[s].asText())}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new i.R}}};var s=r(1);r.d(t,"GetKMZ",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(c.a)(new o,e,t)}var i=Math.max;r.r(t);var a=r(0),o=function(e){a.q.call(this,e),this._parser=o.parse};o.prototype=Object.create(a.q.prototype),o.prototype.constructor=o,o.parse=function(e,t){var r=new s(e,1);return{mipmaps:r.mipmaps(t),width:r.pixelWidth,height:r.pixelHeight,format:r.glInternalFormat,isCubemap:6===r.numberOfFaces,mipmapCount:r.numberOfMipmapLevels}};var s=function(){function e(t,r){this.arrayBuffer=t;var n=new Uint8Array(this.arrayBuffer,0,12);if(171===n[0]&&75===n[1]&&84===n[2]&&88===n[3]&&32===n[4]&&49===n[5]&&49===n[6]&&187===n[7]&&13===n[8]&&10===n[9]&&26===n[10]&&10===n[11]){var a=Uint32Array.BYTES_PER_ELEMENT,o=new DataView(this.arrayBuffer,12,13*a),s=67305985===o.getUint32(0,!0);return this.glType=o.getUint32(1*a,s),this.glTypeSize=o.getUint32(2*a,s),this.glFormat=o.getUint32(3*a,s),this.glInternalFormat=o.getUint32(4*a,s),this.glBaseInternalFormat=o.getUint32(5*a,s),this.pixelWidth=o.getUint32(6*a,s),this.pixelHeight=o.getUint32(7*a,s),this.pixelDepth=o.getUint32(8*a,s),this.numberOfArrayElements=o.getUint32(9*a,s),this.numberOfFaces=o.getUint32(10*a,s),this.numberOfMipmapLevels=o.getUint32(11*a,s),this.bytesOfKeyValueData=o.getUint32(12*a,s),0!==this.glType?void console.warn("only compressed formats currently supported"):(this.numberOfMipmapLevels=i(1,this.numberOfMipmapLevels),0===this.pixelHeight||0!==this.pixelDepth?void console.warn("only 2D textures currently supported"):0===this.numberOfArrayElements?this.numberOfFaces===r?void(this.loadType=e.COMPRESSED_2D):void console.warn("number of faces expected"+r+", but found "+this.numberOfFaces):void console.warn("texture arrays not currently supported"))}console.error("texture missing KTX identifier")}return e.prototype.mipmaps=function(t){for(var r,n=[],a=e.HEADER_LEN+this.bytesOfKeyValueData,o=this.pixelWidth,s=this.pixelHeight,c=t?this.numberOfMipmapLevels:1,u=0;u<c;u++){r=new Int32Array(this.arrayBuffer,a,1)[0],a+=4;for(var l,h=0;h<this.numberOfFaces;h++)l=new Uint8Array(this.arrayBuffer,a,r),n.push({data:l,width:o,height:s}),a+=r,a+=3-(r+3)%4;o=i(1,.5*o),s=i(1,.5*s)}return n},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}(),c=r(1);r.d(t,"GetKTX",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.availableExtensions=[]};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){for(var t={id:e.getAttribute("id"),basematerials:[]},n=e.querySelectorAll("base"),i=0;i<n.length;i++){var a=r(n[i]);t.basematerials.push(a)}return t}function r(e){return{name:e.getAttribute("name"),displaycolor:e.getAttribute("displaycolor")}}function n(e){for(var t=[],r=e.querySelectorAll("component"),n=0;n<r.length;n++){var i=a(r[n]);t.push(i)}return t}function a(e){var t={objectId:e.getAttribute("objectid")},r=e.getAttribute("transform");return r&&(t.transform=o(r)),t}function o(e){var t=[];e.split(" ").forEach(function(e){t.push(parseFloat(e))});var r=new i.ub;return r.set(t[0],t[3],t[6],t[9],t[1],t[4],t[7],t[10],t[2],t[5],t[8],t[11],0,0,0,1),r}function s(e){var t={type:e.getAttribute("type")},r=e.getAttribute("id");r&&(t.id=r);var i=e.getAttribute("pid");i&&(t.pid=i);var a=e.getAttribute("pindex");a&&(t.pindex=a);var o=e.getAttribute("thumbnail");o&&(t.thumbnail=o);var s=e.getAttribute("partnumber");s&&(t.partnumber=s);var c=e.getAttribute("name");c&&(t.name=c);var u=e.querySelector("mesh");u&&(t.mesh=function(e){for(var t={},r=[],n=e.querySelectorAll("vertices vertex"),i=0;i<n.length;i++){var a=n[i],o=a.getAttribute("x"),s=a.getAttribute("y"),c=a.getAttribute("z");r.push(parseFloat(o),parseFloat(s),parseFloat(c))}for(t.vertices=new Float32Array(r.length),i=0;i<r.length;i++)t.vertices[i]=r[i];var u=[],l=[],h=e.querySelectorAll("triangles triangle");for(i=0;i<h.length;i++){var p=h[i],d=p.getAttribute("v1"),f=p.getAttribute("v2"),m=p.getAttribute("v3"),g=p.getAttribute("p1"),v=p.getAttribute("p2"),y=p.getAttribute("p3"),b=p.getAttribute("pid");l.push(parseInt(d,10),parseInt(f,10),parseInt(m,10));var x={};g&&(x.p1=parseInt(g,10)),v&&(x.p2=parseInt(v,10)),y&&(x.p3=parseInt(y,10)),b&&(x.pid=b),0<Object.keys(x).length&&u.push(x)}for(t.triangleProperties=u,t.triangles=new Uint32Array(l.length),i=0;i<l.length;i++)t.triangles[i]=l[i];return t}(u));var l=e.querySelector("components");return l&&(t.components=n(l)),t}function c(e){var r={},n=e.querySelector("basematerials");n&&(r.basematerials=t(n)),r.object={};for(var i=e.querySelectorAll("object"),a=0;a<i.length;a++){var o=s(i[a]);r.object[o.id]=o}return r}function u(e){var t={unit:e.getAttribute("unit")||"millimeter"},r=e.querySelectorAll("metadata");r&&(t.metadata=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],i=n.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(i)&&(t[i]=n.textContent)}return t}(r));var n=e.querySelector("resources");n&&(t.resources=c(n));var i=e.querySelector("build");return i&&(t.build=function(e){for(var t=[],r=e.querySelectorAll("item"),n=0;n<r.length;n++){var i=r[n],a={objectId:i.getAttribute("objectid")},s=i.getAttribute("transform");s&&(a.transform=o(s)),t.push(a)}return t}(i)),t}function l(e,t,r,n){var a,o=new i.l;o.setIndex(new i.k(e.triangles,1)),o.addAttribute("position",new i.k(e.vertices,3));for(var s=r.resources.basematerials,c=e.triangleProperties,u=0,l=0,d=-1,f=0,m=c.length;f<m;f++){var g=c[f],v=g.pid;s&&s.id===v&&(-1===d&&(d=g.p1),d===g.p1?l+=3:(o.addGroup(u,l,d),u+=l,l=3,d=g.p1))}if(0<o.groups.length&&function(e){for(var t=e.groups.sort(function(e,t){return e.materialIndex===t.materialIndex?e.start-t.start:e.materialIndex-t.materialIndex}),r=e.index,n=r.itemSize,i=r.array,a=0,o=new i.constructor(i.length),s=0;s<t.length;s++){var c=t[s],u=c.count*n,l=c.start*n,h=i.subarray(l,l+u);o.set(h,a),a+=u}i.set(o);var p=0;for(s=0;s<t.length;s++)(c=t[s]).start=p,p+=c.count;var d=t[0];for(e.groups=[d],s=1;s<t.length;s++)c=t[s],d.materialIndex===c.materialIndex?d.count+=c.count:(d=c,e.groups.push(d))}(o),o.computeBoundingSphere(),s&&s.id===n.pid){var y=n.pindex;a=h(w=s.basematerials[y],t,r,n,p)}if(0<o.groups.length){var b=o.groups;a=[];for(f=0,m=b.length;f<m;f++){var x=b[f],w=s.basematerials[x.materialIndex];a.push(h(w,t,r,n,p))}}return void 0===a&&(a=new i.yb({color:11184895,flatShading:!0})),new i.vb(o,a)}function h(e,t,r,n,i){return void 0===e.build?(e.build=i(e,t,r,n),e.build):e.build}function p(e){var t=new i.yb({flatShading:!0});t.name=e.name;var r=e.displaycolor,n=r.substring(0,7);return t.color.setStyle(n),t.color.convertSRGBToLinear(),9===r.length&&(t.opacity=parseInt(r.charAt(7)+r.charAt(8),16)/255),t}function d(e,t,r){for(var n=new i.R,a=0;a<e.length;a++){var o=e[a],s=t[o.objectId];void 0===s&&(f(o.objectId,t,r),s=t[o.objectId]);var c=s.clone(),u=o.transform;u&&c.applyMatrix(u),n.add(c)}return n}function f(e,t,r){var n=r.resources.object[e];if(n.mesh){var i=n.mesh;(function(e,t,r){if(e){for(var n,i=[],a=Object.keys(e),o=0;o<a.length;o++){n=a[o];for(var s=0;s<m.availableExtensions.length;s++)(c=m.availableExtensions[s]).ns===n&&i.push(c)}var c;for(o=0;o<i.length;o++)(c=i[o]).apply(r,e[c.ns],t)}})(r.extensions,i,r.xml),t[n.id]=h(i,t,r,n,l)}else{var a=n.components;t[n.id]=h(a,t,r,n,d)}}var m=this,g=function(e){var t,r,n=null,a=null,o=[],s=[],c=[],l=[],h={},p={};try{n=new JSZip(e)}catch(e){if(e instanceof ReferenceError)return console.error("THREE.3MFLoader: jszip missing and file is compressed."),null}for(a in n.files)a.match(/\_rels\/.rels$/)?t=a:a.match(/^3D\/.*\.model$/)?o.push(a):a.match(/^3D\/Metadata\/.*\.xml$/)?s.push(a):a.match(/^3D\/Textures\/.*/)?c.push(a):a.match(/^3D\/Other\/.*/)&&l.push(a);var d=new Uint8Array(n.file(t).asArrayBuffer());r=function(e){var t=(new DOMParser).parseFromString(e,"application/xml").querySelector("Relationship");return{target:t.getAttribute("Target"),id:t.getAttribute("Id"),type:t.getAttribute("Type")}}(i.ob.decodeText(d));for(var f=0;f<o.length;f++){var m=o[f],g=new Uint8Array(n.file(m).asArrayBuffer()),v=i.ob.decodeText(g),y=(new DOMParser).parseFromString(v,"application/xml");"model"!==y.documentElement.nodeName.toLowerCase()&&console.error("THREE.3MFLoader: Error loading 3MF - no 3MF document found: ",m);var b,x=y.querySelector("model"),w={};for(f=0;f<x.attributes.length;f++)(b=x.attributes[f]).name.match(/^xmlns:(.+)$/)&&(w[b.value]=RegExp.$1);var _=u(x);_.xml=x,0<Object.keys(w).length&&(_.extensions=w),h[m]=_}var T;for(f=0;f<c.length;f++)p[T=c[f]]=n.file(T).asBinary();return{rels:r,model:h,printTicket:{},texture:p,other:{}}}(e);return function(e,t,r){for(var n=new i.R,a=r.model[t.target.substring(1)].build,o=0;o<a.length;o++){var s=a[o],c=e[s.objectId],u=s.transform;u&&c.applyMatrix(u),n.add(c)}return n}(function(e){for(var t=g.model,r={},n=Object.keys(t),i=0;i<n.length;i++)for(var a=t[n[i]],o=Object.keys(a.resources.object),s=0;s<o.length;s++)f(o[s],r,a);return r}(),g.rels,g)},addExtension:function(e){this.availableExtensions.push(e)}};var o=r(1);r.d(t,"Get3MF",function(){return n})},function(e,t,r){"use strict";function n(e){this.IFF=e}function i(e){this.IFF=e}function a(){this.debugger=new s}function o(e){this.dv=new DataView(e),this.offset=0}function s(){this.active=!1,this.depth=0,this.formList=[]}function c(e){return e%2}function u(e){return e.length+1+(c(e.length+1)?1:0)}function l(e){this.textureLoader=e}function h(e){this.textureLoader=e}function p(){}function d(e,t){return Object(v.a)(new g,e,t)}r.r(t);var f=r(0);n.prototype={constructor:n,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),t=this.IFF.reader.getUint32();switch(t>this.IFF.reader.dv.byteLength-this.IFF.reader.offset&&(this.IFF.reader.offset-=4,t=this.IFF.reader.getUint16()),this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=t,e){case"FORM":this.IFF.parseForm(t);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"AUVO":case"STCK":case"PROC":case"VALU":case"FUNC":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NVSK":case"NCRD":case"WRPW":case"WRPH":case"NMOD":case"NPRW":case"NPLA":case"NODS":case"VERS":case"ENUM":case"TAG ":case"OPAC":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"GLOW":case"GVAL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"SURF":this.IFF.parseSurfaceLwo2(t);break;case"CLIP":this.IFF.parseClipLwo2(t);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===t?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(t);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(t);break;case"PNTS":this.IFF.parsePoints(t);break;case"VMAP":this.IFF.parseVertexMapping(t);break;case"AUVU":case"AUVN":this.IFF.reader.skip(t-1),this.IFF.reader.getVariableLengthIndex();break;case"POLS":this.IFF.parsePolygonList(t);break;case"TAGS":this.IFF.parseTagStrings(t);break;case"PTAG":this.IFF.parsePolygonTagMapping(t);break;case"VMAD":this.IFF.parseVertexMapping(t,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var r=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=r;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===t?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(t);break;case"SMAN":var n=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(0>n);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.reader.skip(2);break;case"TMAP":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(t);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;case"BLOK":break;default:this.IFF.parseUnknownCHUNK(e,t)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},i.prototype={constructor:i,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),t=this.IFF.reader.getUint32();switch(this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=t,e){case"FORM":this.IFF.parseForm(t);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"STCK":case"VALU":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NCRD":case"NMOD":case"NSEL":case"NPRW":case"NPLA":case"VERS":case"ENUM":case"TAG ":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"GLOW":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===t?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(t);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(t);break;case"PNTS":this.IFF.parsePoints(t);break;case"VMAP":this.IFF.parseVertexMapping(t);break;case"POLS":this.IFF.parsePolygonList(t);break;case"TAGS":this.IFF.parseTagStrings(t);break;case"PTAG":this.IFF.parsePolygonTagMapping(t);break;case"VMAD":this.IFF.parseVertexMapping(t,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var r=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=r;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===t?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(t);break;case"SMAN":var n=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(0>n);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.currentSurface.attributes.imageMapIndex=this.IFF.reader.getUint32();break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(t);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;default:this.IFF.parseUnknownCHUNK(e,t)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},a.prototype={constructor:a,parse:function(e){if(this.reader=new o(e),this.tree={materials:{},layers:[],tags:[],textures:[]},this.currentLayer=this.tree,this.currentForm=this.tree,this.parseTopForm(),void 0!==this.tree.format){if("LWO2"===this.tree.format)for(this.parser=new n(this);!this.reader.endOfFile();)this.parser.parseBlock();else if("LWO3"===this.tree.format)for(this.parser=new i(this);!this.reader.endOfFile();)this.parser.parseBlock();return this.debugger.offset=this.reader.offset,this.debugger.closeForms(),this.tree}},parseTopForm(){if(this.debugger.offset=this.reader.offset,"FORM"===this.reader.getIDTag()){var e=this.reader.getUint32();this.debugger.dataOffset=this.reader.offset,this.debugger.length=e;var t=this.reader.getIDTag();return"LWO2"===t?this.tree.format=t:"LWO3"===t&&(this.tree.format=t),this.debugger.node=0,this.debugger.nodeID=t,void this.debugger.log()}console.warn("LWOLoader: Top-level FORM missing.")},parseForm(e){var t=this.reader.getIDTag();"ISEQ"===t||"ANIM"===t||"STCC"===t||"VPVL"===t||"VPRM"===t||"NROT"===t||"WRPW"===t||"WRPH"===t||"FUNC"===t||"FALL"===t||"OPAC"===t||"GRAD"===t||"ENVS"===t||"VMOP"===t||"VMBG"===t||"OMAX"===t||"STEX"===t||"CKBG"===t||"CKEY"===t||"VMLA"===t||"VMLB"===t?(this.debugger.skipped=!0,this.skipForm(e)):"META"===t||"NNDS"===t||"NODS"===t||"NDTA"===t||"ADAT"===t||"AOVS"===t||"BLOK"===t||"IBGC"===t||"IOPC"===t||"IIMG"===t||"TXTR"===t?(this.debugger.length=4,this.debugger.skipped=!0):"IFAL"===t||"ISCL"===t||"IPOS"===t||"IROT"===t||"IBMP"===t||"IUTD"===t||"IVTD"===t?this.parseTextureNodeAttribute(t):"ENVL"===t?this.parseEnvelope(e):"CLIP"===t?"LWO2"===this.tree.format?this.parseForm(e):this.parseClip(e):"STIL"===t?this.parseImage():"XREF"===t?(this.reader.skip(8),this.currentForm.referenceTexture={index:this.reader.getUint32(),refName:this.reader.getString()}):"IMST"===t?this.parseImageStateForm(e):"SURF"===t?this.parseSurfaceForm(e):"VALU"===t?this.parseValueForm(e):"NTAG"===t?this.parseSubNode(e):"ATTR"===t||"SATR"===t?this.setupForm("attributes",e):"NCON"===t?this.parseConnections(e):"SSHA"===t?(this.parentForm=this.currentForm,this.currentForm=this.currentSurface,this.setupForm("surfaceShader",e)):"SSHD"===t?this.setupForm("surfaceShaderData",e):"ENTR"===t?this.parseEntryForm(e):"IMAP"===t?this.parseImageMap(e):"TAMP"===t?this.parseXVAL("amplitude",e):"TMAP"===t?this.setupForm("textureMap",e):"CNTR"===t?this.parseXVAL3("center",e):"SIZE"===t?this.parseXVAL3("scale",e):"ROTA"===t?this.parseXVAL3("rotation",e):this.parseUnknownForm(t,e),this.debugger.node=0,this.debugger.nodeID=t,this.debugger.log()},setupForm(e,t){this.currentForm||(this.currentForm=this.currentNode),this.currentFormEnd=this.reader.offset+t,this.parentForm=this.currentForm,this.currentForm[e]?(console.warn("LWOLoader: form already exists on parent: ",e,this.currentForm),this.currentForm=this.currentForm[e]):(this.currentForm[e]={},this.currentForm=this.currentForm[e])},skipForm(e){this.reader.skip(e-4)},parseUnknownForm(e,t){console.warn("LWOLoader: unknown FORM encountered: "+e,t),function(e,t,r){console.log(f.ob.decodeText(new Uint8Array(e,t,r)))}(this.reader.dv.buffer,this.reader.offset,t-4),this.reader.skip(t-4)},parseSurfaceForm(e){this.reader.skip(8);var t=this.reader.getString(),r={attributes:{},connections:{},name:t,inputName:t,nodes:{},source:this.reader.getString()};this.tree.materials[t]=r,this.currentSurface=r,this.parentForm=this.tree.materials,this.currentForm=r,this.currentFormEnd=this.reader.offset+e},parseSurfaceLwo2(e){var t=this.reader.getString(),r={attributes:{},connections:{},name:t,nodes:{},source:this.reader.getString()};this.tree.materials[t]=r,this.currentSurface=r,this.parentForm=this.tree.materials,this.currentForm=r,this.currentFormEnd=this.reader.offset+e},parseSubNode(e){this.reader.skip(8);var t={name:this.reader.getString()};this.currentForm=t,this.currentNode=t,this.currentFormEnd=this.reader.offset+e},parseConnections(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm=this.currentSurface.connections},parseEntryForm(e){this.reader.skip(8);var t=this.reader.getString();this.currentForm=this.currentNode.attributes,this.setupForm(t,e)},parseValueForm(){this.reader.skip(8);var e=this.reader.getString();"double"===e?this.currentForm.value=this.reader.getUint64():"int"===e?this.currentForm.value=this.reader.getUint32():"vparam"===e?(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64()):"vparam3"===e&&(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64Array(3))},parseImageStateForm(){this.reader.skip(8),this.currentForm.mipMapLevel=this.reader.getFloat32()},parseImageMap(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm.maps||(this.currentForm.maps=[]);var t={};this.currentForm.maps.push(t),this.currentForm=t,this.reader.skip(10)},parseTextureNodeAttribute(e){this.reader.skip(28),this.reader.skip(20),"ISCL"===e?this.currentNode.scale=this.reader.getFloat32Array(3):"IPOS"===e?this.currentNode.position=this.reader.getFloat32Array(3):"IROT"===e?this.currentNode.rotation=this.reader.getFloat32Array(3):"IFAL"===e?this.currentNode.falloff=this.reader.getFloat32Array(3):"IBMP"===e?this.currentNode.amplitude=this.reader.getFloat32():"IUTD"===e?this.currentNode.uTiles=this.reader.getFloat32():"IVTD"===e&&(this.currentNode.vTiles=this.reader.getFloat32()),this.reader.skip(2)},parseEnvelope(e){this.reader.skip(e-4)},parseClip(e){if("FORM"===this.reader.getIDTag())return this.reader.skip(16),void(this.currentNode.fileName=this.reader.getString());this.reader.setOffset(this.reader.offset-4),this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.reader.skip(8);var t={index:this.reader.getUint32()};this.tree.textures.push(t),this.currentForm=t},parseClipLwo2(e){for(var t={index:this.reader.getUint32(),fileName:""};;){var r=this.reader.getIDTag(),n=this.reader.getUint16();if("STIL"===r){t.fileName=this.reader.getString();break}if(n>=e)break}this.tree.textures.push(t),this.currentForm=t},parseImage(){this.reader.skip(8),this.currentForm.fileName=this.reader.getString()},parseXVAL(e,t){var r=this.reader.offset+t-4;this.reader.skip(8),this.currentForm[e]=this.reader.getFloat32(),this.reader.setOffset(r)},parseXVAL3(e,t){var r=this.reader.offset+t-4;this.reader.skip(8),this.currentForm[e]={x:this.reader.getFloat32(),y:this.reader.getFloat32(),z:this.reader.getFloat32()},this.reader.setOffset(r)},parseObjectTag(){this.tree.objectTags||(this.tree.objectTags={}),this.tree.objectTags[this.reader.getIDTag()]={tagString:this.reader.getString()}},parseLayer(e){var t={number:this.reader.getUint16(),flags:this.reader.getUint16(),pivot:this.reader.getFloat32Array(3),name:this.reader.getString()};this.tree.layers.push(t),this.currentLayer=t;var r=16+u(this.currentLayer.name);this.currentLayer.parent=r<e?this.reader.getUint16():-1},parsePoints(e){this.currentPoints=[];for(var t=0;t<e/4;t+=3)this.currentPoints.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32())},parseVertexMapping(e,t){var r=this.reader.offset+e,n=this.reader.getString();if(this.reader.offset!==r){this.reader.setOffset(this.reader.offset-u(n));var i=this.reader.getIDTag();this.reader.getUint16();var a=this.reader.getString(),o=e-6-u(a);"TXUV"===i?this.parseUVMapping(a,r,t):"MORF"===i||"SPOT"===i?this.parseMorphTargets(a,r,i):"APSL"===i||"NORM"===i||"WGHT"===i||"MNVW"===i||"PICK"===i||"RGB "===i||"RGBA"===i?this.reader.skip(o):(console.warn("LWOLoader: unknown vertex map type: "+i),this.reader.skip(o))}else this.currentForm.UVChannel=n},parseUVMapping(e,t,r){for(var n=[],i=[],a=[];this.reader.offset<t;)n.push(this.reader.getVariableLengthIndex()),r&&i.push(this.reader.getVariableLengthIndex()),a.push(this.reader.getFloat32(),this.reader.getFloat32());r?(!this.currentLayer.discontinuousUVs&&(this.currentLayer.discontinuousUVs={}),this.currentLayer.discontinuousUVs[e]={uvIndices:n,polyIndices:i,uvs:a}):(!this.currentLayer.uvs&&(this.currentLayer.uvs={}),this.currentLayer.uvs[e]={uvIndices:n,uvs:a})},parseMorphTargets(e,t,r){var n=[],i=[];for(r="MORF"===r?"relative":"absolute";this.reader.offset<t;)n.push(this.reader.getVariableLengthIndex()),i.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32());this.currentLayer.morphTargets||(this.currentLayer.morphTargets={}),this.currentLayer.morphTargets[e]={indices:n,points:i,type:r}},parsePolygonList(e){for(var t=this.reader.offset+e,r=this.reader.getIDTag(),n=[],i=[];this.reader.offset<t;){var a=this.reader.getUint16();a&=1023,i.push(a);for(var o=0;o<a;o++)n.push(this.reader.getVariableLengthIndex())}var s={type:r,vertexIndices:n,polygonDimensions:i,points:this.currentPoints};1===i[0]?s.type="points":2===i[0]&&(s.type="lines"),this.currentLayer.geometry=s},parseTagStrings(e){this.tree.tags=this.reader.getStringArray(e)},parsePolygonTagMapping(e){var t=this.reader.offset+e;"SURF"===this.reader.getIDTag()?this.parseMaterialIndices(t):this.reader.skip(e-4)},parseMaterialIndices(e){for(this.currentLayer.geometry.materialIndices=[];this.reader.offset<e;){var t=this.reader.getVariableLengthIndex(),r=this.reader.getUint16();this.currentLayer.geometry.materialIndices.push(t,r)}},parseUnknownCHUNK(e,t){console.warn("LWOLoader: unknown chunk type: "+e+" length: "+t);var r=this.reader.getString(t);this.currentForm[e]=r}},o.prototype={constructor:o,size:function(){return this.dv.buffer.byteLength},setOffset(e){0<e&&e<this.dv.buffer.byteLength?this.offset=e:console.error("LWOLoader: invalid buffer offset")},endOfFile:function(){return!!(this.offset>=this.size())},skip:function(e){this.offset+=e},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint16:function(){var e=this.dv.getUint16(this.offset);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,!1);return this.offset+=4,e},getUint32:function(){var e=this.dv.getUint32(this.offset,!1);return this.offset+=4,e},getUint64:function(){return 4294967296*this.getUint32()+this.getUint32()},getFloat32:function(){var e=this.dv.getFloat32(this.offset,!1);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getVariableLengthIndex(){var e=this.getUint8();return 255===e?65536*this.getUint8()+256*this.getUint8()+this.getUint8():256*e+this.getUint8()},getIDTag(){return this.getString(4)},getString:function(e){if(0!==e){var t=[];if(e)for(var r=0;r<e;r++)t[r]=this.getUint8();else{for(var n,i=0;0!==n;)0!==(n=this.getUint8())&&t.push(n),i++;c(i+1)||this.getUint8()}return f.ob.decodeText(new Uint8Array(t))}},getStringArray:function(e){var t=this.getString(e);return(t=t.split("\0")).filter(Boolean)}},s.prototype={constructor:s,enable:function(){this.active=!0},log:function(){if(this.active){var e;switch(this.node){case 0:e="FORM";break;case 1:e="CHK";break;case 2:e="S-CHK"}console.log("| ".repeat(this.depth)+e,this.nodeID,`( ${this.offset} ) -> ( ${this.dataOffset+this.length} )`,0==this.node?" {":"",this.skipped?"SKIPPED":"",0==this.node&&this.skipped?"}":""),0!=this.node||this.skipped||(this.depth+=1,this.formList.push(this.dataOffset+this.length)),this.skipped=!1}},closeForms:function(){if(this.active)for(var e=this.formList.length-1;0<=e;e--)this.offset>=this.formList[e]&&(this.depth-=1,console.log("| ".repeat(this.depth)+"}"),this.formList.splice(-1,1))}};var m,g=function(e,t){this.manager=void 0===e?f.D:e,t=t||{},this.resourcePath=void 0===t.resourcePath?void 0:t.resourcePath};g.prototype={constructor:g,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,a=void 0===i.path?function(e,t){var r=e.indexOf(t);return-1===r?"./":e.substr(0,r)}(e,"Objects"):i.path,o=e.split(a).pop().split(".")[0],s=new f.L(this.manager);s.setPath(i.path),s.setResponseType("arraybuffer"),s.load(e,function(e){t(i.parse(e,a,o))},r,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},parse:function(e,t,r){return m=(new a).parse(e),new l(new f.yc(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin)).parse(r)}},l.prototype={constructor:l,parse:function(e){return this.materials=new h(this.textureLoader).parse(),this.defaultLayerName=e,this.meshes=this.parseLayers(),{materials:this.materials,meshes:this.meshes}},parseLayers(){var e=[],t=[],r=new p,n=this;return m.layers.forEach(function(i){var a=r.parse(i.geometry,i),o=n.parseMesh(a,i);e[i.number]=o,-1===i.parent?t.push(o):e[i.parent].add(o)}),this.applyPivots(t),t},parseMesh(e,t){var r,n=this.getMaterials(e.userData.matNames,t.geometry.type);return this.duplicateUVs(e,n),(r="points"===t.geometry.type?new f.Sb(e,n):"lines"===t.geometry.type?new f.ib(e,n):new f.vb(e,n)).name=t.name?t.name:this.defaultLayerName+"_layer_"+t.number,r.userData.pivot=t.pivot,r},applyPivots(e){e.forEach(function(e){e.traverse(function(e){var t=e.userData.pivot;if(e.position.x+=t[0],e.position.y+=t[1],e.position.z+=t[2],e.parent){var r=e.parent.userData.pivot;e.position.x-=r[0],e.position.y-=r[1],e.position.z-=r[2]}})})},getMaterials(e,t){var r=[],n=this;e.forEach(function(e,t){r[t]=n.getMaterialByName(e)}),("points"===t||"lines"===t)&&r.forEach(function(e,n){var i={color:e.color};"points"===t?(i.size=.1,i.map=e.map,i.morphTargets=e.morphTargets,r[n]=new f.Tb(i)):"lines"==t&&(r[n]=new f.gb(i))});var i=r.filter(Boolean);return 1===i.length?i[0]:r},getMaterialByName(e){return this.materials.filter(function(t){return t.name===e})[0]},duplicateUVs(e,t){var r=!1;Array.isArray(t)?t.forEach(function(e){e.aoMap&&(r=!0)}):t.aoMap&&(r=!0),r&&e.addAttribute("uv2",new f.k(e.attributes.uv.array,2))}},h.prototype={constructor:h,parse:function(){var e=[];for(var t in this.textures={},m.materials)"LWO3"===m.format?e.push(this.parseMaterial(m.materials[t],t,m.textures)):"LWO2"===m.format&&e.push(this.parseMaterialLwo2(m.materials[t],t,m.textures));return e},parseMaterial(e,t,r){var n={name:t,side:this.getSide(e.attributes),flatShading:this.getSmooth(e.attributes)},i=this.parseConnections(e.connections,e.nodes),a=this.parseTextureNodes(i.maps);this.parseAttributeImageMaps(i.attributes,r,a,e.maps);var o=this.parseAttributes(i.attributes,a);return this.parseEnvMap(i,a,o),n=Object.assign(a,n),n=Object.assign(n,o),new(this.getMaterialType(i.attributes))(n)},parseMaterialLwo2(e,t){var r={name:t,side:this.getSide(e.attributes),flatShading:this.getSmooth(e.attributes)},n=this.parseAttributes(e.attributes,{});return r=Object.assign(r,n),new f.yb(r)},getSide(e){if(!e.side)return f.h;switch(e.side){case 0:case 1:return f.h;case 2:return f.P;case 3:return f.F}},getSmooth:e=>!e.smooth||!e.smooth,parseConnections(e,t){var r={maps:{}},n=e.inputName,i=e.inputNodeName,a=e.nodeName,o=this;return n.forEach(function(e,n){if("Material"===e){var a=o.getNodeByRefName(i[n],t);r.attributes=a.attributes,r.envMap=a.fileName,r.name=i[n]}}),a.forEach(function(e,a){e===r.name&&(r.maps[n[a]]=o.getNodeByRefName(i[a],t))}),r},getNodeByRefName(e,t){for(var r in t)if(t[r].refName===e)return t[r]},parseTextureNodes(e){var t={};for(var r in e){var n=e[r],i=n.fileName;if(!i)return;var a=this.loadTexture(i);void 0!==n.widthWrappingMode&&(a.wrapS=this.getWrappingType(n.widthWrappingMode)),void 0!==n.heightWrappingMode&&(a.wrapT=this.getWrappingType(n.heightWrappingMode)),"Color"==r?t.map=a:"Roughness"==r?(t.roughnessMap=a,t.roughness=.5):"Specular"==r?(t.specularMap=a,t.specular=16777215):"Luminous"==r?(t.emissiveMap=a,t.emissive=8421504):"Luminous Color"==r?t.emissive=8421504:"Metallic"==r?(t.metalnessMap=a,t.metalness=.5):"Transparency"==r||"Alpha"==r?(t.alphaMap=a,t.transparent=!0):"Normal"==r?(t.normalMap=a,void 0!==n.amplitude&&(t.normalScale=new f.Ic(n.amplitude,n.amplitude))):"Bump"==r&&(t.bumpMap=a)}return t.roughnessMap&&t.specularMap&&delete t.specularMap,t},parseAttributeImageMaps(e,t,r){for(var n in e){var i=e[n];if(i.maps){var a=i.maps[0],o=this.getTexturePathByIndex(a.imageIndex,t);if(!o)return;var s=this.loadTexture(o);void 0!==a.wrap&&(s.wrapS=this.getWrappingType(a.wrap.w)),void 0!==a.wrap&&(s.wrapT=this.getWrappingType(a.wrap.h)),"Color"==n?r.map=s:"Diffuse"==n?r.aoMap=s:"Roughness"==n?(r.roughnessMap=s,r.roughness=1):"Specular"==n?(r.specularMap=s,r.specular=16777215):"Luminosity"==n?(r.emissiveMap=s,r.emissive=8421504):"Metallic"==n?(r.metalnessMap=s,r.metalness=1):"Transparency"==n||"Alpha"==n?(r.alphaMap=s,r.transparent=!0):"Normal"==n?r.normalMap=s:"Bump"==n&&(r.bumpMap=s)}}},parseAttributes(e,t){var r={};return r.color=e.Color&&!t.map?(new f.o).fromArray(e.Color.value):new f.o,e.Transparency&&0!==e.Transparency.value&&(r.opacity=1-e.Transparency.value,r.transparent=!0),e["Bump Height"]&&(r.bumpScale=.1*e["Bump Height"].value),e["Refraction Index"]&&(r.refractionRatio=1/e["Refraction Index"].value),this.parsePhysicalAttributes(r,e,t),this.parseStandardAttributes(r,e,t),this.parsePhongAttributes(r,e,t),r},parsePhysicalAttributes(e,t){t.Clearcoat&&0<t.Clearcoat.value&&(e.clearCoat=t.Clearcoat.value,t["Clearcoat Gloss"]&&(e.clearCoatRoughness=.5*(1-t["Clearcoat Gloss"].value)))},parseStandardAttributes(e,t,r){t.Luminous&&(e.emissiveIntensity=t.Luminous.value,e.emissive=t["Luminous Color"]&&!r.emissive?(new f.o).fromArray(t["Luminous Color"].value):new f.o(8421504)),t.Roughness&&!r.roughnessMap&&(e.roughness=t.Roughness.value),t.Metallic&&!r.metalnessMap&&(e.metalness=t.Metallic.value)},parsePhongAttributes(e,t,r){t.Diffuse&&e.color.multiplyScalar(t.Diffuse.value),t.Reflection&&(e.reflectivity=t.Reflection.value,e.combine=f.a),t.Luminosity&&(e.emissiveIntensity=t.Luminosity.value,e.emissive=r.emissiveMap||r.map?new f.o(8421504):e.color),t.Roughness||!t.Specular||r.specularMap||(t["Color Highlight"]?e.specular=(new f.o).setScalar(t.Specular.value).lerp(e.color.clone().multiplyScalar(t.Specular.value),t["Color Highlight"].value):e.specular=(new f.o).setScalar(t.Specular.value)),e.specular&&t.Glossiness&&(e.shininess=7+Math.pow(2,12*t.Glossiness.value+2))},parseEnvMap(e,t,r){if(e.envMap){var n=this.loadTexture(e.envMap);r.transparent&&.999>r.opacity?(n.mapping=f.I,void 0!==r.reflectivity&&(delete r.reflectivity,delete r.combine),void 0!==r.metalness&&delete r.metalness):n.mapping=f.H,t.envMap=n}},getTexturePathByIndex(e){var t="";return m.textures?(m.textures.forEach(function(r){r.index===e&&(t=r.fileName)}),t):t},loadTexture(e){return e?this.textureLoader.load(e,void 0,void 0,function(){console.warn("LWOLoader: non-standard resource hierarchy. Use `resourcePath` parameter to specify root content directory.")}):null},getWrappingType:e=>0===e?(console.warn('LWOLoader: "Reset" texture wrapping type is not supported in three.js'),f.n):1===e?f.mc:2===e?f.Cb:3===e?f.n:void 0,getMaterialType:e=>e.Clearcoat&&0<e.Clearcoat.value?f.zb:e.Roughness?f.Ab:f.yb},p.prototype={constructor:p,parse(e,t){var r=new f.l;r.addAttribute("position",new f.M(e.points,3));var n=this.splitIndices(e.vertexIndices,e.polygonDimensions);return r.setIndex(n),this.parseGroups(r,e),r.computeVertexNormals(),this.parseUVs(r,t,n),this.parseMorphTargets(r,t,n),r.translate(-t.pivot[0],-t.pivot[1],-t.pivot[2]),r},splitIndices(e,t){var r=[],n=0;return t.forEach(function(t){if(4>t)for(var i=0;i<t;i++)r.push(e[n+i]);else if(4===t)r.push(e[n],e[n+1],e[n+2],e[n],e[n+2],e[n+3]);else if(4<t){for(i=1;i<t-1;i++)r.push(e[n],e[n+i],e[n+i+1]);console.warn("LWOLoader: polygons with greater than 4 sides are not supported")}n+=t}),r},parseGroups(e,t){var r=m.tags,n=[],i=3;"lines"===t.type&&(i=2),"points"===t.type&&(i=1);for(var a,o,s=this.splitMaterialIndices(t.polygonDimensions,t.materialIndices),c=0,u={},l=0,h=0,p=0;p<s.length;p+=2){var d;if(o=s[p+1],0==p&&(n[c]=r[o]),void 0===a&&(a=o),o!==a)u[r[a]]?d=u[r[a]]:(d=c,u[r[a]]=c,n[c]=r[a],c++),e.addGroup(l,h,d),l+=h,a=o,h=0;h+=i}0<e.groups.length&&(u[r[o]]?d=u[r[o]]:(d=c,u[r[o]]=c,n[c]=r[o]),e.addGroup(l,h,d));e.userData.matNames=n},splitMaterialIndices(e,t){var r=[];return e.forEach(function(e,n){if(3>=e)r.push(t[2*n],t[2*n+1]);else if(4===e)r.push(t[2*n],t[2*n+1],t[2*n],t[2*n+1]);else for(var i=0;i<e-2;i++)r.push(t[2*n],t[2*n+1])}),r},parseUVs(e,t){var r=Array.from(Array(2*e.attributes.position.count),function(){return 0});for(var n in t.uvs){var i=t.uvs[n].uvs;t.uvs[n].uvIndices.forEach(function(e,t){r[2*e]=i[2*t],r[2*e+1]=i[2*t+1]})}e.addAttribute("uv",new f.M(r,2))},parseMorphTargets(e,t){var r=0;for(var n in t.morphTargets){var i=e.attributes.position.array.slice();e.morphAttributes.position||(e.morphAttributes.position=[]);var a=t.morphTargets[n].points,o=t.morphTargets[n].indices,s=t.morphTargets[n].type;o.forEach(function(e,t){"relative"===s?(i[3*e]+=a[3*t],i[3*e+1]+=a[3*t+1],i[3*e+2]+=a[3*t+2]):(i[3*e]=a[3*t],i[3*e+1]=a[3*t+1],i[3*e+2]=a[3*t+2])}),e.morphAttributes.position[r]=new f.M(i,3),e.morphAttributes.position[r].name=n,r++}}};var v=r(1);r.d(t,"GetLWO",function(){return d})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(){var e=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];return function(t){console.time("MD2Loader");for(var r=new DataView(t),n={},a=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],o=0;o<a.length;o++)n[a[o]]=r.getInt32(4*o,!0);if(844121161===n.ident&&8===n.version){if(n.offset_end===r.byteLength){for(var s=new i.l,c=[],u=n.offset_st,l=(o=0,n.num_st);o<l;o++){var h=r.getInt16(u+0,!0),p=r.getInt16(u+2,!0);c.push(h/n.skinwidth,1-p/n.skinheight),u+=4}u=n.offset_tris;var d=[],f=[];for(o=0,l=n.num_tris;o<l;o++)d.push(r.getUint16(u+0,!0),r.getUint16(u+2,!0),r.getUint16(u+4,!0)),f.push(r.getUint16(u+6,!0),r.getUint16(u+8,!0),r.getUint16(u+10,!0)),u+=12;var m=new i.Jc,g=new i.Jc,v=[],y=[];u=n.offset_frames;for(o=0,l=n.num_frames;o<l;o++){g.set(r.getFloat32(u+0,!0),r.getFloat32(u+4,!0),r.getFloat32(u+8,!0)),m.set(r.getFloat32(u+12,!0),r.getFloat32(u+16,!0),r.getFloat32(u+20,!0)),u+=24;for(var b,x=0;16>x&&0!==(b=r.getUint8(u+x,!0));x++)v[x]=b;var w={name:String.fromCharCode.apply(null,v),vertices:[],normals:[]};u+=16;for(x=0;x<n.num_vertices;x++){var _=r.getUint8(u++,!0),T=r.getUint8(u++,!0),E=r.getUint8(u++,!0),A=e[r.getUint8(u++,!0)];_=_*g.x+m.x,T=T*g.y+m.y,E=E*g.z+m.z,w.vertices.push(_,E,T),w.normals.push(A[0],A[2],A[1])}y.push(w)}var S=[],M=[],L=[],N=y[0].vertices,R=y[0].normals;for(o=0,l=d.length;o<l;o++){_=N[U=3*d[o]],T=N[U+1],E=N[U+2];S.push(_,T,E);var C=R[U],I=R[U+1],O=R[U+2];M.push(C,I,O);h=c[U=2*f[o]],p=c[U+1];L.push(h,p)}s.addAttribute("position",new i.M(S,3)),s.addAttribute("normal",new i.M(M,3)),s.addAttribute("uv",new i.M(L,2));var P=[],F=[];for(o=0,l=y.length;o<l;o++){var k=(w=y[o]).name;if(0<w.vertices.length){S=[],x=0;for(var D=d.length;x<D;x++){var U=3*d[x];_=w.vertices[U],T=w.vertices[U+1],E=w.vertices[U+2];S.push(_,T,E)}var B=new i.M(S,3);B.name=k,P.push(B)}if(0<w.normals.length){for(M=[],x=0,D=d.length;x<D;x++){U=3*d[x],C=w.normals[U],I=w.normals[U+1],O=w.normals[U+2];M.push(C,I,O)}var z=new i.M(M,3);z.name=k,F.push(z)}}return s.morphAttributes.position=P,s.morphAttributes.normal=F,s.animations=i.d.CreateClipsFromMorphTargetSequences(y,10),console.timeEnd("MD2Loader"),s}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")}}()};var o=r(1);r.d(t,"GetMD2",function(){return n})},function(e,t,r){"use strict";function n(e,t){return GenericLoader(new AssimpJSONLoader,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,crossOrigin:"anonymous",load:function(e,t,r,n){var a=this,o=void 0===a.path?i.ob.extractUrlBase(e):a.path,s=new i.L(this.manager);s.setPath(a.path),s.load(e,function(e){var r=JSON.parse(e),i=r.__metadata__;if(void 0!==i){if("assimp2json"!==i.format)return void n("THREE.AssimpJSONLoader: Not an assimp2json scene.");if(100>i.version&&200<=i.version)return void n("THREE.AssimpJSONLoader: Unsupported assimp2json file format version.")}t(a.parse(r,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e,t){for(var r=Array(e.length),n=0;n<e.length;++n)r[n]=t.call(this,e[n]);return r}var n=new i.yc(this.manager);n.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);var a=r(e.meshes,function(e){var t,r,n,a=new i.l,o=[],s=e.vertices||[],c=e.normals||[],u=e.texturecoords||[],l=e.colors||[];for(u=u[0]||[],t=0,r=e.faces.length;t<r;t++)n=e.faces[t],o.push(n[0],n[1],n[2]);return a.setIndex(o),a.addAttribute("position",new i.M(s,3)),0<c.length&&a.addAttribute("normal",new i.M(c,3)),0<u.length&&a.addAttribute("uv",new i.M(u,2)),0<l.length&&a.addAttribute("color",new i.M(l,3)),a.computeBoundingSphere(),a}),o=r(e.materials,function(e){var t=new i.yb;for(var r in e.properties){var a=e.properties[r],o=a.key,s=a.value;switch(o){case"$tex.file":var c=a.semantic;if(1===c||2===c||4===c||5===c||6===c){var u;1===c?u="map":2===c?u="specularMap":4===c?u="emissiveMap":5===c?u="bumpMap":6===c&&(u="normalMap");var l=n.load(s);l.wrapS=l.wrapT=i.mc,t[u]=l}break;case"?mat.name":t.name=s;break;case"$clr.diffuse":t.color.fromArray(s);break;case"$clr.specular":t.specular.fromArray(s);break;case"$clr.emissive":t.emissive.fromArray(s);break;case"$mat.shininess":t.shininess=s;break;case"$mat.shadingm":t.flatShading=!(1!==s);break;case"$mat.opacity":1>s&&(t.opacity=s,t.transparent=!0)}}return t});return function e(t,r,n,a){var o,s,c=new i.Kb;for(c.name=r.name||"",c.matrix=(new i.ub).fromArray(r.transformation).transpose(),c.matrix.decompose(c.position,c.quaternion,c.scale),o=0;r.meshes&&o<r.meshes.length;o++)s=r.meshes[o],c.add(new i.vb(n[s],a[t.meshes[s].materialindex]));for(o=0;r.children&&o<r.children.length;o++)c.add(e(t,r.children[o],n,a));return c}(e,e.rootnode,a,o)}};var o=r(1);r.d(t,"GetAssimpJSON",function(){return n}),r.d(t,"AssimpJSONLoader",function(){return a}),r.d(t,"GenericLoader",function(){return o.a})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,crossOrigin:"anonymous",load:function(e,t,r,n){var a=this,o=void 0===this.path?i.ob.extractUrlBase(e):this.path,s=new i.L(this.manager);s.setPath(this.path),s.load(e,function(e){t(a.parse(e,o))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setTexturePath:function(e){return console.warn("THREE.MTLLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var r,n=e.split("\n"),i={},o=/\s+/,s={},c=0;c<n.length;c++)if(0!==(r=(r=n[c]).trim()).length&&"#"!==r.charAt(0)){var u=r.indexOf(" "),l=0<=u?r.substring(0,u):r;l=l.toLowerCase();var h=0<=u?r.substring(u+1):"";if(h=h.trim(),"newmtl"===l)i={name:h},s[h]=i;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var p=h.split(o,3);i[l]=[parseFloat(p[0]),parseFloat(p[1]),parseFloat(p[2])]}else i[l]=h}var d=new a.MaterialCreator(this.resourcePath||t,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(s),d}},a.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:i.P,this.wrap=this.options&&this.options.wrap?this.options.wrap:i.mc},a.MaterialCreator.prototype={constructor:a.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r],i={};for(var a in t[r]=i,n){var o=!0,s=n[a],c=a.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1)}o&&(i[c]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){function t(e,t){if(!a[e]){var n=r.getTextureParams(t,a),i=r.loadTexture(function(e,t){return"string"!=typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}(r.baseUrl,n.url));i.repeat.copy(n.scale),i.offset.copy(n.offset),i.wrapS=r.wrap,i.wrapT=r.wrap,a[e]=i}}var r=this,n=this.materialsInfo[e],a={name:e,side:this.side};for(var o in n){var s,c=n[o];if(""!==c)switch(o.toLowerCase()){case"kd":a.color=(new i.o).fromArray(c);break;case"ks":a.specular=(new i.o).fromArray(c);break;case"ke":a.emissive=(new i.o).fromArray(c);break;case"map_kd":t("map",c);break;case"map_ks":t("specularMap",c);break;case"map_ke":t("emissiveMap",c);break;case"norm":t("normalMap",c);break;case"map_bump":case"bump":t("bumpMap",c);break;case"map_d":t("alphaMap",c),a.transparent=!0;break;case"ns":a.shininess=parseFloat(c);break;case"d":1>(s=parseFloat(c))&&(a.opacity=s,a.transparent=!0);break;case"tr":s=parseFloat(c),this.options&&this.options.invertTrProperty&&(s=1-s),0<s&&(a.opacity=1-s,a.transparent=!0)}}return this.materials[e]=new i.yb(a),this.materials[e]},getTextureParams:function(e,t){var r,n={scale:new i.Ic(1,1),offset:new i.Ic(0,0)},a=e.split(/\s+/);return 0<=(r=a.indexOf("-bm"))&&(t.bumpScale=parseFloat(a[r+1]),a.splice(r,2)),0<=(r=a.indexOf("-s"))&&(n.scale.set(parseFloat(a[r+1]),parseFloat(a[r+2])),a.splice(r,4)),0<=(r=a.indexOf("-o"))&&(n.offset.set(parseFloat(a[r+1]),parseFloat(a[r+2])),a.splice(r,4)),n.url=a.join(" ").trim(),n},loadTexture:function(e,t,r,n,a){var o,s=i.nb.Handlers.get(e),c=void 0===this.manager?i.D:this.manager;return null===s&&(s=new i.yc(c)),s.setCrossOrigin&&s.setCrossOrigin(this.crossOrigin),o=s.load(e,r,n,a),void 0!==t&&(o.mapping=t),o}};var o=r(1);r.d(t,"GetMTL",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.load(e,function(e){t(a.parse(JSON.parse(e)))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){var t=new i.l,r=e.indices,n=e.positions,a=e.normals,o=e.uvs;t.setIndex(r);for(var s=2,c=n.length;s<c;s+=3)n[s]=-n[s];if(t.addAttribute("position",new i.M(n,3)),a){for(s=2,c=a.length;s<c;s+=3)a[s]=-a[s];t.addAttribute("normal",new i.M(a,3))}o&&t.addAttribute("uv",new i.M(o,2));var u=e.subMeshes;if(u){var l;for(s=0,c=u.length;s<c;s++)l=u[s],t.addGroup(l.indexStart,l.indexCount)}return t}return function(e,r){for(var n={},a=new i.nc,o=e.cameras,s=0,c=o.length;s<c;s++){var u=o[s],l=new i.Pb(u.fov/Math.PI*180,1.33,u.minZ,u.maxZ);l.name=u.name,l.position.fromArray(u.position),u.rotation&&l.rotation.fromArray(u.rotation),n[u.id]=l}var h=e.lights;for(s=0,c=h.length;s<c;s++){var p;switch((u=h[s]).type){case 0:p=new i.Rb;break;case 1:p=new i.E;break;case 2:p=new i.vc;break;case 3:p=new i.T}p.name=u.name,u.position&&p.position.set(u.position[0],u.position[1],-u.position[2]),p.color.fromArray(u.diffuse),u.groundColor&&p.groundColor.fromArray(u.groundColor),u.intensity&&(p.intensity=u.intensity),n[u.id]=p,a.add(p)}var d=e.meshes;for(s=0,c=d.length;s<c;s++){var f;if((u=d[s]).indices){var m=t(u);f=new i.vb(m,r[u.materialId])}else f=new i.R;f.name=u.name,f.position.set(u.position[0],u.position[1],-u.position[2]),f.rotation.fromArray(u.rotation),u.rotationQuaternion&&f.quaternion.fromArray(u.rotationQuaternion),f.scale.fromArray(u.scaling),u.parentId?n[u.parentId].add(f):a.add(f),n[u.id]=f}return a}(e,function(e){for(var t={},r=0,n=e.materials.length;r<n;r++){var a=e.materials[r],o=new i.yb;o.name=a.name,o.color.fromArray(a.diffuse),o.emissive.fromArray(a.emissive),o.specular.fromArray(a.specular),o.shininess=a.specularPower,o.opacity=a.alpha,t[a.id]=o}if(e.multiMaterials)for(r=0,n=e.multiMaterials.length;r<n;r++)a=e.multiMaterials[r],console.warn("THREE.BabylonLoader: Multi materials not yet supported."),t[a.id]=new i.yb;return t}(e))}};var o=r(1);r.d(t,"GetBabylon",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}var i=Math.max;r.r(t);var a=r(0),o=function(e){a.q.call(this,e),this._parser=o.parse};o.prototype=Object.create(a.q.prototype),o.prototype.constructor=o,o.parse=function(e,t){function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function n(e,t,r,n){for(var i=r*n*4,a=new Uint8Array(e,t,i),o=new Uint8Array(i),s=0,c=0,u=0;u<n;u++)for(var l,h=0;h<r;h++){l=a[c];var p=a[++c],d=a[++c],f=a[++c];c++,o[s]=d,o[++s]=p,o[++s]=l,o[++s]=f,s++}return o}var o={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},s=r("DXT1"),c=r("DXT3"),u=r("DXT5"),l=r("ETC1"),h=new Int32Array(e,0,31);if(542327876!==h[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),o;if(4&!h[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),o;var p,d=h[21],f=!1;switch(d){case s:p=8,o.format=a.lc;break;case c:p=16,o.format=a.ac;break;case u:p=16,o.format=a.bc;break;case l:p=8,o.format=a.ic;break;default:if(!(32===h[22]&&16711680&h[23]&&65280&h[24]&&255&h[25]&&4278190080&h[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",function(e){return String.fromCharCode(255&e,255&e>>8,255&e>>16,255&e>>24)}(d)),o;f=!0,p=64,o.format=a.Xb}o.mipmapCount=1,131072&h[2]&&!1!==t&&(o.mipmapCount=i(1,h[7]));var m=h[28];if(o.isCubemap=!!(512&m),o.isCubemap&&(!(1024&m)||!(2048&m)||!(4096&m)||!(8192&m)||!(16384&m)||!(32768&m)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),o;o.width=h[4],o.height=h[3];for(var g=h[1]+4,v=o.isCubemap?6:1,y=0;y<v;y++)for(var b=o.width,x=o.height,w=0;w<o.mipmapCount;w++){if(f)var _=(T=n(e,g,b,x)).length;else{_=i(4,b)/4*i(4,x)/4*p;var T=new Uint8Array(e,g,_)}var E={data:T,width:b,height:x};o.mipmaps.push(E),g+=_,b=i(b>>1,1),x=i(x>>1,1)}return o};var s=r(1);r.d(t,"GetDDS",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}r.r(t);var i=r(0),a=r(7),o=function(){function e(e){if(void 0===a.a)throw new Error("THREE.VRMLoader: Import GLTFLoader.");this.manager=void 0===e?i.D:e,this.gltfLoader=new a.a(this.manager)}return e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this;this.gltfLoader.load(e,function(e){i.parse(e,t)},r,n)},setCrossOrigin:function(e){return this.glTFLoader.setCrossOrigin(e),this},setPath:function(e){return this.glTFLoader.setPath(e),this},setResourcePath:function(e){return this.glTFLoader.setResourcePath(e),this},setDRACOLoader:function(e){return this.glTFLoader.setDRACOLoader(e),this},parse:function(e,t){t(e)}},e}(),s=r(1);r.d(t,"GetVRM",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.reversed=!1};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){var t,r=[];e.forEach(function(e){"m"===e.type.toLowerCase()?(t=[e],r.push(t)):"z"!==e.type.toLowerCase()&&t.push(e)});var n=[];return r.forEach(function(e){var t={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};n.push(t);for(var r=e.length-1;0<r;r--){var i=e[r];t={type:i.type};void 0!==i.x2&&void 0!==i.y2?(t.x1=i.x2,t.y1=i.y2,t.x2=i.x1,t.y2=i.y1):void 0!==i.x1&&void 0!==i.y1&&(t.x1=i.x1,t.y1=i.y1),t.x=e[r-1].x,t.y=e[r-1].y,n.push(t)}}),n}return"undefined"==typeof opentype?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(e,r){for(var n=Math.round,i={},a=1e5/(72*(e.unitsPerEm||2048)),o=e.encoding.cmap.glyphIndexMap,s=Object.keys(o),c=0;c<s.length;c++){var u=s[c],l=e.glyphs.glyphs[o[u]];if(void 0!==u){var h={ha:n(l.advanceWidth*a),x_min:n(l.xMin*a),x_max:n(l.xMax*a),o:""};r&&(l.path.commands=t(l.path.commands)),l.path.commands.forEach(function(e){"c"===e.type.toLowerCase()&&(e.type="b"),h.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(h.o+=n(e.x*a)+" "+n(e.y*a)+" "),void 0!==e.x1&&void 0!==e.y1&&(h.o+=n(e.x1*a)+" "+n(e.y1*a)+" "),void 0!==e.x2&&void 0!==e.y2&&(h.o+=n(e.x2*a)+" "+n(e.y2*a)+" ")}),i[String.fromCodePoint(l.unicode)]=h}}return{glyphs:i,familyName:e.getEnglishName("fullName"),ascender:n(e.ascender*a),descender:n(e.descender*a),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(opentype.parse(e),this.reversed)}};var o=r(1);r.d(t,"GetTTF",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(V.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};a.prototype={constructor:a,crossOrigin:"anonymous",load:function(e,t,r,n){var a=this,o=void 0===this.path?i.ob.extractUrlBase(e):this.path,s=new i.L(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.load(e,function(e){t(a.parse(e,o))},r,n)},parse:function(e,t){this.group=new i.R,this.position=0,this.materials=[],this.meshes=[],this.readFile(e,t);for(var r=0;r<this.meshes.length;r++)this.group.add(this.meshes[r]);return this.group},readFile:function(e,t){var r=new DataView(e),n=this.readChunk(r);if(n.id===s||n.id===c||n.id===o)for(var i=this.nextChunk(r,n);0!==i;){if(i===u){var a=this.readDWord(r);this.debugMessage("3DS file version: "+a)}else i===f?(this.resetPosition(r),this.readMeshData(r,t)):this.debugMessage("Unknown main chunk: "+i.toString(16));i=this.nextChunk(r,n)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(e,t){for(var r=this.readChunk(e),n=this.nextChunk(e,r);0!==n;){if(n===m){var i=+this.readDWord(e);this.debugMessage("Mesh Version: "+i)}else if(n===g){var a=this.readFloat(e);this.debugMessage("Master scale: "+a),this.group.scale.set(a,a,a)}else n===k?(this.debugMessage("Named Object"),this.resetPosition(e),this.readNamedObject(e)):n===v?(this.debugMessage("Material"),this.resetPosition(e),this.readMaterialEntry(e,t)):this.debugMessage("Unknown MDATA chunk: "+n.toString(16));n=this.nextChunk(e,r)}},readNamedObject:function(e){var t=this.readChunk(e),r=this.readString(e,64);t.cur=this.position;for(var n=this.nextChunk(e,t);0!==n;){if(n===D){this.resetPosition(e);var i=this.readMesh(e);i.name=r,this.meshes.push(i)}else this.debugMessage("Unknown named object chunk: "+n.toString(16));n=this.nextChunk(e,t)}this.endChunk(t)},readMaterialEntry:function(e,t){for(var r=this.readChunk(e),n=this.nextChunk(e,r),a=new i.yb;0!==n;){if(n===y)a.name=this.readString(e,64),this.debugMessage("   Name: "+a.name);else if(n===A)this.debugMessage("   Wireframe"),a.wireframe=!0;else if(n===S){var o=this.readByte(e);a.wireframeLinewidth=o,this.debugMessage("   Wireframe Thickness: "+o)}else if(n===T)a.side=i.F,this.debugMessage("   DoubleSided");else if(n===E)this.debugMessage("   Additive Blending"),a.blending=i.b;else if(n===x)this.debugMessage("   Diffuse Color"),a.color=this.readColor(e);else if(n===w)this.debugMessage("   Specular Color"),a.specular=this.readColor(e);else if(n===b)this.debugMessage("   Ambient color"),a.color=this.readColor(e);else if(n===_){var s=this.readWord(e);a.shininess=s,this.debugMessage("   Shininess : "+s)}else n===M?(this.debugMessage("   ColorMap"),this.resetPosition(e),a.map=this.readMap(e,t)):n===N?(this.debugMessage("   BumpMap"),this.resetPosition(e),a.bumpMap=this.readMap(e,t)):n===L?(this.debugMessage("   OpacityMap"),this.resetPosition(e),a.alphaMap=this.readMap(e,t)):n===R?(this.debugMessage("   SpecularMap"),this.resetPosition(e),a.specularMap=this.readMap(e,t)):this.debugMessage("   Unknown material chunk: "+n.toString(16));n=this.nextChunk(e,r)}this.endChunk(r),this.materials[a.name]=a},readMesh:function(e){var t=this.readChunk(e),r=this.nextChunk(e,t),n=new i.l,a=[],o=new i.yb,s=new i.vb(n,o);for(s.name="mesh";0!==r;){if(r===U){var c=this.readWord(e);this.debugMessage("   Vertex: "+c);for(var u=[],l=0;l<c;l++)u.push(this.readFloat(e)),u.push(this.readFloat(e)),u.push(this.readFloat(e));n.addAttribute("position",new i.M(u,3))}else if(r===B)this.resetPosition(e),this.readFaceArray(e,s);else if(r===G){var h=this.readWord(e);this.debugMessage("   UV: "+h);for(a=[],l=0;l<h;l++)a.push(this.readFloat(e)),a.push(this.readFloat(e));n.addAttribute("uv",new i.M(a,2))}else if(r===j){this.debugMessage("   Tranformation Matrix (TODO)");var p=[];for(l=0;12>l;l++)p[l]=this.readFloat(e);var d=new i.ub;d.elements[0]=p[0],d.elements[1]=p[6],d.elements[2]=p[3],d.elements[3]=p[9],d.elements[4]=p[2],d.elements[5]=p[8],d.elements[6]=p[5],d.elements[7]=p[11],d.elements[8]=p[1],d.elements[9]=p[7],d.elements[10]=p[4],d.elements[11]=p[10],d.elements[12]=0,d.elements[13]=0,d.elements[14]=0,d.elements[15]=1,d.transpose();var f=new i.ub;f.getInverse(d,!0),n.applyMatrix(f),d.decompose(s.position,s.quaternion,s.scale)}else this.debugMessage("   Unknown mesh chunk: "+r.toString(16));r=this.nextChunk(e,t)}return this.endChunk(t),n.computeVertexNormals(),s},readFaceArray:function(e,t){var r=this.readChunk(e),n=this.readWord(e);this.debugMessage("   Faces: "+n);for(var i=[],a=0;a<n;++a)i.push(this.readWord(e),this.readWord(e),this.readWord(e)),this.readWord(e);for(t.geometry.setIndex(i);this.position<r.end;){if((r=this.readChunk(e)).id===z){this.debugMessage("      Material Group"),this.resetPosition(e);var o=this.readMaterialGroup(e),s=this.materials[o.name];void 0!==s&&(t.material=s,""===s.name&&(s.name=t.name))}else this.debugMessage("      Unknown face array chunk: "+r.toString(16));this.endChunk(r)}this.endChunk(r)},readMap:function(e,t){var r=this.readChunk(e),n=this.nextChunk(e,r),a={},o=new i.yc(this.manager);for(o.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);0!==n;){if(n===C){var s=this.readString(e,128);a=o.load(s),this.debugMessage("      File: "+t+s)}else n===P?(a.offset.x=this.readFloat(e),this.debugMessage("      OffsetX: "+a.offset.x)):n===F?(a.offset.y=this.readFloat(e),this.debugMessage("      OffsetY: "+a.offset.y)):n===I?(a.repeat.x=this.readFloat(e),this.debugMessage("      RepeatX: "+a.repeat.x)):n===O?(a.repeat.y=this.readFloat(e),this.debugMessage("      RepeatY: "+a.repeat.y)):this.debugMessage("      Unknown map chunk: "+n.toString(16));n=this.nextChunk(e,r)}return this.endChunk(r),a},readMaterialGroup:function(e){this.readChunk(e);var t=this.readString(e,64),r=this.readWord(e);this.debugMessage("         Name: "+t),this.debugMessage("         Faces: "+r);for(var n=[],i=0;i<r;++i)n.push(this.readWord(e));return{name:t,index:n}},readColor:function(e){var t=this.readChunk(e),r=new i.o;if(t.id===h||t.id===p){var n=this.readByte(e),a=this.readByte(e),o=this.readByte(e);r.setRGB(n/255,a/255,o/255),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else if(t.id===l||t.id===d){n=this.readFloat(e),a=this.readFloat(e),o=this.readFloat(e);r.setRGB(n,a,o),this.debugMessage("      Color: "+r.r+", "+r.g+", "+r.b)}else this.debugMessage("      Unknown color chunk: "+t.toString(16));return this.endChunk(t),r},readChunk:function(e){var t={};return t.cur=this.position,t.id=this.readWord(e),t.size=this.readDWord(e),t.end=t.cur+t.size,t.cur+=6,t},endChunk:function(e){this.position=e.end},nextChunk:function(e,t){if(t.cur>=t.end)return 0;this.position=t.cur;try{var r=this.readChunk(e);return t.cur+=r.size,r.id}catch(t){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(e){var t=e.getUint8(this.position,!0);return this.position+=1,t},readFloat:function(e){try{var t=e.getFloat32(this.position,!0);return this.position+=4,t}catch(t){this.debugMessage(t+" "+this.position+" "+e.byteLength)}},readInt:function(e){var t=e.getInt32(this.position,!0);return this.position+=4,t},readShort:function(e){var t=e.getInt16(this.position,!0);return this.position+=2,t},readDWord:function(e){var t=e.getUint32(this.position,!0);return this.position+=4,t},readWord:function(e){var t=e.getUint16(this.position,!0);return this.position+=2,t},readString:function(e,t){for(var r,n="",i=0;i<t&&(r=this.readByte(e));i++)n+=String.fromCharCode(r);return n},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},debugMessage:function(e){this.debug&&console.log(e)}};var o=19789,s=15786,c=49725,u=2,l=16,h=17,p=18,d=19,f=15677,m=15678,g=256,v=45055,y=40960,b=40976,x=40992,w=41008,_=41024,T=41089,E=41091,A=41093,S=41095,M=41472,L=41488,N=41520,R=41476,C=41728,I=41812,O=41814,P=41816,F=41818,k=16384,D=16640,U=16656,B=16672,z=16688,G=16704,j=16736,V=r(1);r.d(t,"GetTDS",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(m.a)(new f,e,t)}var i=Math.tan,a=Math.acos,o=Math.sin,s=Math.cos,c=Math.abs,u=Math.sqrt,l=Math.max,h=Math.min,p=Math.PI;r.r(t);var d=r(0),f=function(e){this.manager=void 0===e?d.D:e};f.prototype={constructor:f,load:function(e,t,r,n){var i=this,a=new d.L(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){for(var t=new d.qc,n=new d.Ic,i=new d.Ic,a=new d.Ic,o=!0,s=!1,c=e.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),u=0,l=c.length;u<l;u++){var h=c[u],p=h.charAt(0),g=h.substr(1).trim();switch(1==o&&(s=!0,o=!1),p){case"M":for(var v=0,y=(w=m(g)).length;v<y;v+=2)n.x=w[v+0],n.y=w[v+1],i.x=n.x,i.y=n.y,0==v?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"H":for(v=0,y=(w=m(g)).length;v<y;v++)n.x=w[v],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"V":for(v=0,y=(w=m(g)).length;v<y;v++)n.y=w[v],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"L":for(v=0,y=(w=m(g)).length;v<y;v+=2)n.x=w[v+0],n.y=w[v+1],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"C":for(v=0,y=(w=m(g)).length;v<y;v+=6)t.bezierCurveTo(w[v+0],w[v+1],w[v+2],w[v+3],w[v+4],w[v+5]),i.x=w[v+2],i.y=w[v+3],n.x=w[v+4],n.y=w[v+5],0==v&&1==s&&a.copy(n);break;case"S":for(v=0,y=(w=m(g)).length;v<y;v+=4)t.bezierCurveTo(f(n.x,i.x),f(n.y,i.y),w[v+0],w[v+1],w[v+2],w[v+3]),i.x=w[v+0],i.y=w[v+1],n.x=w[v+2],n.y=w[v+3],0==v&&1==s&&a.copy(n);break;case"Q":for(v=0,y=(w=m(g)).length;v<y;v+=4)t.quadraticCurveTo(w[v+0],w[v+1],w[v+2],w[v+3]),i.x=w[v+0],i.y=w[v+1],n.x=w[v+2],n.y=w[v+3],0==v&&1==s&&a.copy(n);break;case"T":for(v=0,y=(w=m(g)).length;v<y;v+=2){var b=f(n.x,i.x),x=f(n.y,i.y);t.quadraticCurveTo(b,x,w[v+0],w[v+1]),i.x=b,i.y=x,n.x=w[v+0],n.y=w[v+1],0==v&&1==s&&a.copy(n)}break;case"A":for(v=0,y=(w=m(g)).length;v<y;v+=7)_=n.clone(),n.x=w[v+5],n.y=w[v+6],i.x=n.x,i.y=n.y,r(t,w[v],w[v+1],w[v+2],w[v+3],w[v+4],_,n),0==v&&1==s&&a.copy(n);break;case"m":for(v=0,y=(w=m(g)).length;v<y;v+=2)n.x+=w[v+0],n.y+=w[v+1],i.x=n.x,i.y=n.y,0==v?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"h":for(v=0,y=(w=m(g)).length;v<y;v++)n.x+=w[v],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"v":for(v=0,y=(w=m(g)).length;v<y;v++)n.y+=w[v],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"l":for(v=0,y=(w=m(g)).length;v<y;v+=2)n.x+=w[v+0],n.y+=w[v+1],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0==v&&1==s&&a.copy(n);break;case"c":for(v=0,y=(w=m(g)).length;v<y;v+=6)t.bezierCurveTo(n.x+w[v+0],n.y+w[v+1],n.x+w[v+2],n.y+w[v+3],n.x+w[v+4],n.y+w[v+5]),i.x=n.x+w[v+2],i.y=n.y+w[v+3],n.x+=w[v+4],n.y+=w[v+5],0==v&&1==s&&a.copy(n);break;case"s":for(v=0,y=(w=m(g)).length;v<y;v+=4)t.bezierCurveTo(f(n.x,i.x),f(n.y,i.y),n.x+w[v+0],n.y+w[v+1],n.x+w[v+2],n.y+w[v+3]),i.x=n.x+w[v+0],i.y=n.y+w[v+1],n.x+=w[v+2],n.y+=w[v+3],0==v&&1==s&&a.copy(n);break;case"q":for(v=0,y=(w=m(g)).length;v<y;v+=4)t.quadraticCurveTo(n.x+w[v+0],n.y+w[v+1],n.x+w[v+2],n.y+w[v+3]),i.x=n.x+w[v+0],i.y=n.y+w[v+1],n.x+=w[v+2],n.y+=w[v+3],0==v&&1==s&&a.copy(n);break;case"t":for(v=0,y=(w=m(g)).length;v<y;v+=2){b=f(n.x,i.x),x=f(n.y,i.y);t.quadraticCurveTo(b,x,n.x+w[v+0],n.y+w[v+1]),i.x=b,i.y=x,n.x+=w[v+0],n.y+=w[v+1],0==v&&1==s&&a.copy(n)}break;case"a":var w,_;for(v=0,y=(w=m(g)).length;v<y;v+=7)_=n.clone(),n.x+=w[v+5],n.y+=w[v+6],i.x=n.x,i.y=n.y,r(t,w[v],w[v+1],w[v+2],w[v+3],w[v+4],_,n),0==v&&1==s&&a.copy(n);break;case"Z":case"z":t.currentPath.autoClose=!0,0<t.currentPath.curves.length&&(n.copy(a),t.currentPath.currentPoint.copy(n),o=!0);break;default:console.warn(h)}s=!1}return t}function r(e,t,r,i,a,h,d,f){i=i*p/180,t=c(t),r=c(r);var m=(d.x-f.x)/2,g=(d.y-f.y)/2,v=s(i)*m+o(i)*g,y=-o(i)*m+s(i)*g,b=t*t,x=r*r,w=v*v,_=y*y,T=w/b+_/x;if(1<T){var E=u(T);b=(t*=E)*t,x=(r*=E)*r}var A=b*_+x*w,S=u(l(0,(b*x-A)/A));a===h&&(S=-S);var M=S*t*y/r,L=-S*r*v/t,N=s(i)*M-o(i)*L+(d.x+f.x)/2,R=o(i)*M+s(i)*L+(d.y+f.y)/2,C=n(1,0,(v-M)/t,(y-L)/r),I=n((v-M)/t,(y-L)/r,(-v-M)/t,(-y-L)/r)%(2*p);e.currentPath.absellipse(N,R,t,r,C,C+I,0===h,i)}function n(e,t,r,n){var i=u(e*e+t*t)*u(r*r+n*n),o=a(l(-1,h(1,(e*r+t*n)/i)));return 0>e*n-t*r&&(o=-o),o}function i(e,t){function r(r,n,i){void 0===i&&(i=function(e){return e}),e.hasAttribute(r)&&(t[n]=i(e.getAttribute(r))),""!==e.style[r]&&(t[n]=i(e.style[r]))}function n(e){return l(0,h(1,e))}function i(e){return l(0,e)}return t=Object.assign({},t),r("fill","fill"),r("fill-opacity","fillOpacity",n),r("stroke","stroke"),r("stroke-opacity","strokeOpacity",n),r("stroke-width","strokeWidth",i),r("stroke-linejoin","strokeLineJoin"),r("stroke-linecap","strokeLineCap"),r("stroke-miterlimit","strokeMiterLimit",i),t}function f(e,t){return e-(t-e)}function m(e){for(var t,r=e.split(/[\s,]+|(?=\s?[+\-])/),n=0;n<r.length;n++){if((t=r[n]).indexOf(".")!==t.lastIndexOf("."))for(var i=t.split("."),a=2;a<i.length;a++)r.splice(n+a-1,0,"0."+i[a]);r[n]=parseFloat(t)}return r}function g(e){var t=e.elements;return u(t[0]*t[0]+t[1]*t[1])}function v(e){var t=e.elements;return u(t[3]*t[3]+t[4]*t[4])}console.log("THREE.SVGLoader");var y=[],b=[],x=new d.tb,w=new d.tb,_=new d.tb,T=new d.tb,E=new d.Ic,A=new d.Jc,S=new d.tb;console.time("THREE.SVGLoader: DOMParser");var M=(new DOMParser).parseFromString(e,"image/svg+xml");console.timeEnd("THREE.SVGLoader: DOMParser"),console.time("THREE.SVGLoader: Parse"),function e(r,n){if(1===r.nodeType){var a=function(e){if(!e.hasAttribute("transform"))return null;var t=function(e){for(var t,r=new d.tb,n=x,i=e.getAttribute("transform").split(")"),o=i.length-1;0<=o;o--)if(""!==(t=i[o].trim())){var s=t.indexOf("("),c=t.length;if(0<s&&s<c){var u=t.substr(0,s),l=m(t.substr(s+1,c-s-1));switch(n.identity(),u){case"translate":if(1<=l.length){var h=l[0],f=h;2<=l.length&&(f=l[1]),n.translate(h,f)}break;case"rotate":if(1<=l.length){var g,v=0,y=0;g=-l[0]*p/180,3<=l.length&&(v=l[1],y=l[2]),w.identity().translate(-v,-y),_.identity().rotate(g),T.multiplyMatrices(_,w),w.identity().translate(v,y),n.multiplyMatrices(w,T)}break;case"scale":if(1<=l.length){var b=l[0],E=b;2<=l.length&&(E=l[1]),n.scale(b,E)}break;case"skewX":1===l.length&&n.set(1,a(l[0]*p/180),0,0,1,0,0,0,1);break;case"skewY":1===l.length&&n.set(1,0,0,a(l[0]*p/180),1,0,0,0,1);break;case"matrix":6===l.length&&n.set(l[0],l[2],l[4],l[1],l[3],l[5],0,0,1)}}r.premultiply(n)}return r}(e);return 0<b.length&&t.premultiply(b[b.length-1]),S.copy(t),b.push(t),t}(r),o=null;switch(r.nodeName){case"svg":break;case"g":n=i(r,n);break;case"path":n=i(r,n),r.hasAttribute("d")&&(o=t(r));break;case"rect":n=i(r,n),o=function(e){var t=parseFloat(e.getAttribute("x")||0),r=parseFloat(e.getAttribute("y")||0),n=parseFloat(e.getAttribute("rx")||0),i=parseFloat(e.getAttribute("ry")||0),a=parseFloat(e.getAttribute("width")),o=parseFloat(e.getAttribute("height")),s=new d.qc;return s.moveTo(t+2*n,r),s.lineTo(t+a-2*n,r),(0!==n||0!==i)&&s.bezierCurveTo(t+a,r,t+a,r,t+a,r+2*i),s.lineTo(t+a,r+o-2*i),(0!==n||0!==i)&&s.bezierCurveTo(t+a,r+o,t+a,r+o,t+a-2*n,r+o),s.lineTo(t+2*n,r+o),(0!==n||0!==i)&&s.bezierCurveTo(t,r+o,t,r+o,t,r+o-2*i),s.lineTo(t,r+2*i),(0!==n||0!==i)&&s.bezierCurveTo(t,r,t,r,t+2*n,r),s}(r);break;case"polygon":n=i(r,n),o=function(e){var t=new d.qc,r=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,n,i){var a=parseFloat(n),o=parseFloat(i);0===r?t.moveTo(a,o):t.lineTo(a,o),r++}),t.currentPath.autoClose=!0,t}(r);break;case"polyline":n=i(r,n),o=function(e){var t=new d.qc,r=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,n,i){var a=parseFloat(n),o=parseFloat(i);0===r?t.moveTo(a,o):t.lineTo(a,o),r++}),t.currentPath.autoClose=!1,t}(r);break;case"circle":n=i(r,n),o=function(e){var t=parseFloat(e.getAttribute("cx")),r=parseFloat(e.getAttribute("cy")),n=parseFloat(e.getAttribute("r")),i=new d.Ob;i.absarc(t,r,n,0,2*p);var a=new d.qc;return a.subPaths.push(i),a}(r);break;case"ellipse":n=i(r,n),o=function(e){var t=parseFloat(e.getAttribute("cx")),r=parseFloat(e.getAttribute("cy")),n=parseFloat(e.getAttribute("rx")),i=parseFloat(e.getAttribute("ry")),a=new d.Ob;a.absellipse(t,r,n,i,0,2*p);var o=new d.qc;return o.subPaths.push(a),o}(r);break;case"line":n=i(r,n),o=function(e){var t=parseFloat(e.getAttribute("x1")),r=parseFloat(e.getAttribute("y1")),n=parseFloat(e.getAttribute("x2")),i=parseFloat(e.getAttribute("y2")),a=new d.qc;return a.moveTo(t,r),a.lineTo(n,i),a.currentPath.autoClose=!1,a}(r);break;default:console.log(r)}o&&(void 0!==n.fill&&"none"!==n.fill&&o.color.setStyle(n.fill),function(e,t){function r(e){A.set(e.x,e.y,1).applyMatrix3(t),e.set(A.x,A.y)}for(var n=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),i=e.subPaths,a=0,o=i.length;a<o;a++)for(var s,c=i[a].curves,u=0;u<c.length;u++)(s=c[u]).isLineCurve?(r(s.v1),r(s.v2)):s.isCubicBezierCurve?(r(s.v0),r(s.v1),r(s.v2),r(s.v3)):s.isQuadraticBezierCurve?(r(s.v0),r(s.v1),r(s.v2)):s.isEllipseCurve&&(n&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),E.set(s.aX,s.aY),r(E),s.aX=E.x,s.aY=E.y,s.xRadius*=g(t),s.yRadius*=v(t))}(o,S),y.push(o),o.userData={node:r,style:n});for(var s=r.childNodes,c=0;c<s.length;c++)e(s[c],n);a&&(b.pop(),0<b.length?S.copy(b[b.length-1]):S.identity())}}(M.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4});var L={paths:y,xml:M.documentElement};return console.timeEnd("THREE.SVGLoader: Parse"),L}},f.getStrokeStyle=function(e,t,r,n,i){return{strokeColor:t=void 0===t?"#000":t,strokeWidth:e=void 0===e?1:e,strokeLineJoin:r=void 0===r?"miter":r,strokeLineCap:n=void 0===n?"butt":n,strokeMiterLimit:i=void 0===i?4:i}},f.pointsToStroke=function(e,t,r,n){var i=[],a=[],o=[];if(0===f.pointsToStrokeWithBuffers(e,t,r,n,i,a,o))return null;var s=new d.l;return s.addAttribute("position",new d.M(i,3)),s.addAttribute("normal",new d.M(a,3)),s.addAttribute("uv",new d.M(o,2)),s},f.pointsToStrokeWithBuffers=function(){var e=new d.Ic,t=new d.Ic,r=new d.Ic,n=new d.Ic,i=new d.Ic,o=new d.Ic,s=new d.Ic,u=new d.Ic,l=new d.Ic,h=new d.Ic,f=new d.Ic,m=new d.Ic,g=new d.Ic,v=new d.Ic,y=new d.Ic,b=new d.Ic,x=new d.Ic;return function(d,w,_,T,E,A,S,M){function L(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function N(e,t,r){E&&(E[X]=e.x,E[X+1]=e.y,E[X+2]=0,A&&(A[X]=0,A[X+1]=0,A[X+2]=1),X+=3,S&&(S[Y]=t,S[Y+1]=r,Y+=2)),J+=3}function R(i,o,s,u,l){e.copy(o).sub(i).normalize(),t.copy(s).sub(i).normalize();var h=p,d=e.dot(t);1>c(d)&&(h=c(a(d))),h/=_,r.copy(o);for(var f=0,m=_-1;f<m;f++)n.copy(r).rotateAround(i,h),N(r,u,l),N(n,u,l),N(i,u,.5),r.copy(n);N(n,u,l),N(s,u,l),N(i,u,.5)}function C(){N(l,H,1),N(u,H,0),N(m,Z,0),N(l,H,1),N(m,Z,1),N(g,Z,0)}function I(e,t,r){t?e?(N(l,H,1),N(u,H,0),N(m,Z,0),N(l,H,1),N(m,Z,0),N(b,Z,1),N(m,r,0),N(v,r,0),N(b,r,.5)):(N(l,H,1),N(u,H,0),N(g,Z,1),N(u,H,0),N(b,Z,0),N(g,Z,1),N(g,r,1),N(y,r,0),N(b,r,.5)):e?(N(m,r,0),N(v,r,0),N(k,r,.5)):(N(g,r,1),N(y,r,0),N(k,r,.5))}function O(e,t){t&&(e?(N(l,H,1),N(u,H,0),N(m,Z,0),N(l,H,1),N(m,Z,0),N(b,Z,1),N(m,H,0),N(k,Z,.5),N(b,Z,1),N(k,Z,.5),N(v,H,0),N(b,Z,1)):(N(l,H,1),N(u,H,0),N(g,Z,1),N(u,H,0),N(b,Z,0),N(g,Z,1),N(g,H,1),N(b,Z,0),N(k,Z,.5),N(k,Z,.5),N(b,Z,0),N(y,H,1)))}function P(i,a,o,s,c,u){switch(w.strokeLineCap){case"round":c?R(i,o,a,u,.5):R(i,a,o,u,.5);break;case"square":if(c)e.subVectors(a,i),t.set(e.y,-e.x),r.addVectors(e,t).add(i),n.subVectors(t,e).add(i),s?(r.toArray(E,3),n.toArray(E,0),n.toArray(E,9)):(r.toArray(E,3),r.toArray(E,9),n.toArray(E,0));else{e.subVectors(o,i),t.set(e.y,-e.x),r.addVectors(e,t).add(i),n.subVectors(t,e).add(i);var l=E.length;s?(r.toArray(E,l-3),n.toArray(E,l-6),n.toArray(E,l-12)):(r.toArray(E,l-6),n.toArray(E,l-3),n.toArray(E,l-12))}}}_=void 0===_?12:_,T=void 0===T?.001:T,M=void 0===M?0:M;var F=(d=function(e){for(var t=!1,r=1,n=e.length-1;r<n;r++)if(e[r].distanceTo(e[r+1])<T){t=!0;break}if(!t)return e;var i=[e[0]];for(r=1,n=e.length-1;r<n;r++)e[r].distanceTo(e[r+1])>=T&&i.push(e[r]);return i.push(e[e.length-1]),i}(d)).length;if(2>F)return 0;var k,D,U,B,z,G=d[0].equals(d[F-1]),j=d[0],V=w.strokeWidth/2,H=0,W=!1,J=0,X=3*M,Y=2*M;L(d[0],d[1],e).multiplyScalar(V),u.copy(d[0]).sub(e),l.copy(d[0]).add(e),h.copy(u),f.copy(l);for(var q=1;q<F;q++){k=d[q],D=q===F-1?G?d[1]:void 0:d[q+1];var K=e;L(j,k,K),r.copy(K).multiplyScalar(V),m.copy(k).sub(r),g.copy(k).add(r);var Z=H+1/(F-1);if(U=!1,void 0!==D){L(k,D,t),r.copy(t).multiplyScalar(V),v.copy(k).sub(r),y.copy(k).add(r),B=!0,r.subVectors(D,j),0>K.dot(r)&&(B=!1),1===q&&(W=B),r.subVectors(D,k),r.normalize();var Q=c(K.dot(r));if(0!==Q){var $=V/Q;r.multiplyScalar(-$),n.subVectors(k,j),i.copy(n).setLength($).add(r),b.copy(i).negate();var ee=i.length(),te=n.length();n.divideScalar(te),o.subVectors(D,k);var re=o.length();switch(o.divideScalar(re),n.dot(b)<te&&o.dot(b)<re&&(U=!0),x.copy(i).add(k),b.add(k),z=!1,U?B?(y.copy(b),g.copy(b)):(v.copy(b),m.copy(b)):C(),w.strokeLineJoin){case"bevel":I(B,U,Z);break;case"round":O(B,U),B?R(k,m,v,Z,0):R(k,y,g,Z,1);break;case"miter":case"miter-clip":default:var ne=V*w.strokeMiterLimit/ee;if(1>ne){if("miter-clip"!==w.strokeLineJoin){I(B,U,Z);break}O(B,U),B?(o.subVectors(x,m).multiplyScalar(ne).add(m),s.subVectors(x,v).multiplyScalar(ne).add(v),N(m,Z,0),N(o,Z,0),N(k,Z,.5),N(k,Z,.5),N(o,Z,0),N(s,Z,0),N(k,Z,.5),N(s,Z,0),N(v,Z,0)):(o.subVectors(x,g).multiplyScalar(ne).add(g),s.subVectors(x,y).multiplyScalar(ne).add(y),N(g,Z,1),N(o,Z,1),N(k,Z,.5),N(k,Z,.5),N(o,Z,1),N(s,Z,1),N(k,Z,.5),N(s,Z,1),N(y,Z,1))}else U?(B?(N(l,H,1),N(u,H,0),N(x,Z,0),N(l,H,1),N(x,Z,0),N(b,Z,1)):(N(l,H,1),N(u,H,0),N(x,Z,1),N(u,H,0),N(b,Z,0),N(x,Z,1)),B?v.copy(x):y.copy(x)):B?(N(m,Z,0),N(x,Z,0),N(k,Z,.5),N(k,Z,.5),N(x,Z,0),N(v,Z,0)):(N(g,Z,1),N(x,Z,1),N(k,Z,.5),N(k,Z,.5),N(x,Z,1),N(y,Z,1)),z=!0}}else C()}else C();G||q!==F-1||P(d[0],h,f,B,!0,H),H=Z,j=k,u.copy(v),l.copy(y)}if(G){if(U&&E){var ie=x,ae=b;W!==B&&(ie=b,ae=x),B?(ae.toArray(E,0),ae.toArray(E,9),z&&ie.toArray(E,3)):(ae.toArray(E,3),ae.toArray(E,9),z&&ie.toArray(E,0))}}else P(k,m,g,B,!1,Z);return J}}();var m=r(1);r.d(t,"GetSVG",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(e){try{t(a.parse(e))}catch(e){n&&n(e)}},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,t,r){for(var n=0,i=e.length;n<i;n++)if(e[n]!==t.getUint8(r+n,!1))return!1;return!0}var r=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(e);return function(e){var r;if(50,84+50*(r=new DataView(e)).getUint32(80,!0)===r.byteLength)return!0;for(var n=[115,111,108,105,100],i=0;5>i;i++)if(t(n,r,i))return!1;return!0}(r)?function(e){for(var t,r,n,a,o,s,c,u,l=new DataView(e),h=l.getUint32(80,!0),p=!1,d=0;70>d;d++)1129270351==l.getUint32(d,!1)&&82==l.getUint8(d+4)&&61==l.getUint8(d+5)&&(p=!0,a=[],o=l.getUint8(d+6)/255,s=l.getUint8(d+7)/255,c=l.getUint8(d+8)/255,u=l.getUint8(d+9)/255);for(var f=new i.l,m=[],g=[],v=0;v<h;v++){var y=84+50*v,b=l.getFloat32(y,!0),x=l.getFloat32(y+4,!0),w=l.getFloat32(y+8,!0);if(p){var _=l.getUint16(y+48,!0);0==(32768&_)?(t=(31&_)/31,r=(31&_>>5)/31,n=(31&_>>10)/31):(t=o,r=s,n=c)}for(var T,E=1;3>=E;E++)T=y+12*E,m.push(l.getFloat32(T,!0)),m.push(l.getFloat32(T+4,!0)),m.push(l.getFloat32(T+8,!0)),g.push(b,x,w),p&&a.push(t,r,n)}return f.addAttribute("position",new i.k(new Float32Array(m),3)),f.addAttribute("normal",new i.k(new Float32Array(g),3)),p&&(f.addAttribute("color",new i.k(new Float32Array(a),3)),f.hasColors=!0,f.alpha=u),f}(r):function(e){for(var t,r=new i.l,n=/facet([\s\S]*?)endfacet/g,a=0,o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,s=new RegExp("vertex"+o+o+o,"g"),c=new RegExp("normal"+o+o+o,"g"),u=[],l=[],h=new i.Jc;null!==(t=n.exec(e));){for(var p=0,d=0,f=t[0];null!==(t=c.exec(f));)h.x=parseFloat(t[1]),h.y=parseFloat(t[2]),h.z=parseFloat(t[3]),d++;for(;null!==(t=s.exec(f));)u.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),l.push(h.x,h.y,h.z),p++;1!=d&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+a),3!=p&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+a),a++}return r.addAttribute("position",new i.M(u,3)),r.addAttribute("normal",new i.M(l,3)),r}(function(e){return"string"==typeof e?e:i.ob.decodeText(new Uint8Array(e))}(e))}};var o=r(1);r.d(t,"GetSTL",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){i.q.call(this,e),this._parser=a.parse};a.prototype=Object.create(i.q.prototype),a.prototype.constructor=a,a.parse=function(e,t){var r=new Uint32Array(e,0,13),n={buffer:e,header:r,loadMipmaps:t};return 55727696===r[0]?a._parseV3(n):559044176===r[11]?a._parseV2(n):void console.error("THREE.PVRLoader: Unknown PVR format.")},a._parseV3=function(e){var t,r,n=e.header,o=n[12],s=n[2],c=n[6],u=n[7],l=n[10],h=n[11];return 0===s?(t=2,r=i.jc):1===s?(t=2,r=i.Yb):2===s?(t=4,r=i.kc):3===s?(t=4,r=i.Zb):console.error("THREE.PVRLoader: Unsupported PVR format:",s),e.dataPtr=52+o,e.bpp=t,e.format=r,e.width=u,e.height=c,e.numSurfaces=l,e.numMipmaps=h,e.isCubemap=6===l,a._extract(e)},a._parseV2=function(e){var t,r,n=e.header,o=n[0],s=n[1],c=n[2],u=n[3],l=n[4],h=n[10],p=n[12],d=255&l,f=0<h;return 25==d?(r=f?i.Zb:i.kc,t=4):24==d?(r=f?i.Yb:i.jc,t=2):console.error("THREE.PVRLoader: Unknown PVR format:",d),e.dataPtr=o,e.bpp=t,e.format=r,e.width=c,e.height=s,e.numSurfaces=p,e.numMipmaps=u+1,e.isCubemap=6===p,a._extract(e)},a._extract=function(e){var t,r={mipmaps:[],width:e.width,height:e.height,format:e.format,mipmapCount:e.numMipmaps,isCubemap:e.isCubemap},n=e.buffer,i=e.dataPtr,a=e.bpp,o=e.numSurfaces,s=0,c=0,u=0,l=0,h=0;2===a?(c=8,u=4):(c=4,u=4),t=c*u*a/8,r.mipmaps.length=e.numMipmaps*o;for(var p=0;p<e.numMipmaps;){var d=e.width>>p,f=e.height>>p;2>(l=d/c)&&(l=2),2>(h=f/u)&&(h=2),s=l*h*t;for(var m=0;m<o;m++){var g=new Uint8Array(n,i,s);r.mipmaps[m*e.numMipmaps+p]={data:g,width:d,height:f},i+=s}p++}return r};var o=r(1);r.d(t,"GetPVR",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}var i=Math.ceil;r.r(t);var a=r(0),o=function(){function e(){if(null===o){var e=new ArrayBuffer(2),t=new Uint8Array(e),r=new Uint16Array(e);t[0]=170,t[1]=187,o=43707===r[0]}return o}function t(t,r,n,i,a){var o,s=r.BYTES_PER_ELEMENT;if(a===e()||1===s)o=new r(t,n,i);else{var u=new DataView(t,n,i*s),l=c[r.name],h=0;for(o=new r(i);h<i;h++)o[h]=u[l](h*s,!a)}return o}function r(e){var r=new Uint8Array(e),n=r[0],a=r[1],o=!!(1&a>>7),c=1&a>>6,u=1==(1&a>>5),l=31&a,h=0,p=0;if(u?(h=(r[2]<<16)+(r[3]<<8)+r[4],p=(r[5]<<16)+(r[6]<<8)+r[7]):(h=r[2]+(r[3]<<8)+(r[4]<<16),p=r[5]+(r[6]<<8)+(r[7]<<16)),0===n)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==n)throw new Error("PRWM decoder: Unsupported format version: "+n);if(!o){if(0!=c)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!=p)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var d,f,m,g,v,y,b,x,w=8,_={};for(x=0;x<l;x++){for(d="";w<r.length&&(f=r[w],w++,0!==f);)d+=String.fromCharCode(f);m=1&(a=r[w])>>7,g=1+(3&a>>4),y=t(e,v=s[15&a],w=4*i(++w/4),g*h,u),w+=v.BYTES_PER_ELEMENT*g*h,_[d]={type:m,cardinality:g,values:y}}return w=4*i(w/4),b=null,o&&(b=t(e,1==c?Uint32Array:Uint16Array,w,p,u)),{version:n,attributes:_,indices:b}}function n(e){this.manager=void 0===e?a.D:e}var o=null,s=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],c={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};return n.prototype={constructor:n,load:function(t,r,n,i){var o=this,s=new a.L(o.manager);s.setPath(o.path),s.setResponseType("arraybuffer"),t=t.replace(/\*/g,e()?"be":"le"),s.load(t,function(e){r(o.parse(e))},n,i)},setPath:function(e){return this.path=e,this},parse:function(e){var t,n,i=r(e),o=Object.keys(i.attributes),s=new a.l;for(n=0;n<o.length;n++)t=i.attributes[o[n]],s.addAttribute(o[n],new a.k(t.values,t.cardinality,t.normalized));return null!==i.indices&&s.setIndex(new a.k(i.indices,1)),s}},n.isBigEndianPlatform=function(){return e()},n}(),s=r(1);r.d(t,"GetPRWM",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.propertyNameMapping={}};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function t(e){function t(e,t){var r={type:e[0]};return"list"===r.type?(r.name=e[3],r.countType=e[1],r.itemType=e[2]):r.name=e[1],r.name in t&&(r.name=t[r.name]),r}var r="",n=0,i=/ply([\s\S]*)end_header\r?\n/.exec(e);null!==i&&(r=i[1],n=i[0].length);for(var a,o,s,c,u={comments:[],elements:[],headerLength:n},l=r.split("\n"),p=0;p<l.length;p++)""!==(c=(c=l[p]).trim())&&(o=(s=c.split(/\s+/)).shift(),c=s.join(" "),"format"===o?(u.format=s[0],u.version=s[1]):"comment"===o?u.comments.push(c):"element"===o?(null!=a&&u.elements.push(a),(a={}).name=s[0],a.count=parseInt(s[1]),a.properties=[]):"property"===o?a.properties.push(t(s,h.propertyNameMapping)):console.log("unhandled",o,s));return void 0!==a&&u.elements.push(a),u}function r(e,t){return"char"===t||"uchar"===t||"short"===t||"ushort"===t||"int"===t||"uint"===t||"int8"===t||"uint8"===t||"int16"===t||"uint16"===t||"int32"===t||"uint32"===t?parseInt(e):"float"===t||"double"===t||"float32"===t||"float64"===t?parseFloat(e):void 0}function n(e,t){for(var n=t.split(/\s+/),i={},a=0;a<e.length;a++)if("list"===e[a].type){for(var o=[],s=r(n.shift(),e[a].countType),c=0;c<s;c++)o.push(r(n.shift(),e[a].itemType));i[e[a].name]=o}else i[e[a].name]=r(n.shift(),e[a].type);return i}function a(e,t){var r,i={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},a="";null!==(r=/end_header\s([\s\S]*)$/.exec(e))&&(a=r[1]);for(var c,u=a.split("\n"),l=0,h=0,p=0;p<u.length;p++)if(""!==(c=(c=u[p]).trim())){h>=t.elements[l].count&&(l++,h=0);var d=n(t.elements[l].properties,c);s(i,t.elements[l].name,d),h++}return o(i)}function o(e){var t=new i.l;return 0<e.indices.length&&t.setIndex(e.indices),t.addAttribute("position",new i.M(e.vertices,3)),0<e.normals.length&&t.addAttribute("normal",new i.M(e.normals,3)),0<e.uvs.length&&t.addAttribute("uv",new i.M(e.uvs,2)),0<e.colors.length&&t.addAttribute("color",new i.M(e.colors,3)),0<e.faceVertexUvs.length&&(t=t.toNonIndexed()).addAttribute("uv",new i.M(e.faceVertexUvs,2)),t.computeBoundingSphere(),t}function s(e,t,r){if("vertex"===t)e.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&e.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r&&e.uvs.push(r.s,r.t),"red"in r&&"green"in r&&"blue"in r&&e.colors.push(r.red/255,r.green/255,r.blue/255);else if("face"===t){var n=r.vertex_indices||r.vertex_index,i=r.texcoord;3===n.length?(e.indices.push(n[0],n[1],n[2]),i&&6===i.length&&(e.faceVertexUvs.push(i[0],i[1]),e.faceVertexUvs.push(i[2],i[3]),e.faceVertexUvs.push(i[4],i[5]))):4===n.length&&(e.indices.push(n[0],n[1],n[3]),e.indices.push(n[1],n[2],n[3]))}}function c(e,t,r,n){return"int8"===r||"char"===r?[e.getInt8(t),1]:"uint8"===r||"uchar"===r?[e.getUint8(t),1]:"int16"===r||"short"===r?[e.getInt16(t,n),2]:"uint16"===r||"ushort"===r?[e.getUint16(t,n),2]:"int32"===r||"int"===r?[e.getInt32(t,n),4]:"uint32"===r||"uint"===r?[e.getUint32(t,n),4]:"float32"===r||"float"===r?[e.getFloat32(t,n),4]:"float64"===r||"double"===r?[e.getFloat64(t,n),8]:void 0}function u(e,t,r,n){for(var i,a={},o=0,s=0;s<r.length;s++)if("list"===r[s].type){var u=[],l=(i=c(e,t+o,r[s].countType,n))[0];o+=i[1];for(var h=0;h<l;h++)i=c(e,t+o,r[s].itemType,n),u.push(i[0]),o+=i[1];a[r[s].name]=u}else i=c(e,t+o,r[s].type,n),a[r[s].name]=i[0],o+=i[1];return[a,o]}var l,h=this;if(e instanceof ArrayBuffer){var p=i.ob.decodeText(new Uint8Array(e)),d=t(p);l="ascii"===d.format?a(p,d):function(e,t){for(var r,n={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},i="binary_little_endian"===t.format,a=new DataView(e,t.headerLength),c=0,l=0;l<t.elements.length;l++)for(var h=0;h<t.elements[l].count;h++){c+=(r=u(a,c,t.elements[l].properties,i))[1];var p=r[0];s(n,t.elements[l].name,p)}return o(n)}(e,d)}else l=a(e,t(e));return l}};var o=r(1);r.d(t,"GetPLY",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.load(e,function(e){t(a.parse(JSON.parse(e)))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){var t={};for(var r in e){var n,a=e[r],o=a.type,s=a.components;"float32"===o?n=new i.M(a.data,s):"uint8"===o?n=new i.Ec(a.data,s):"uint16"===o?n=new i.Cc(a.data,s):console.log('THREE.PlayCanvasLoader: Array type "%s" not yet supported.',o),t[r]=n}e._attributes=t}function r(e){var t=new i.l;t.setIndex(e.indices);var r=o.vertices[e.vertices]._attributes;for(var n in r){var a=r[n];"texCoord0"==n&&(n="uv"),t.addAttribute(n,a)}e._geometry=t}function n(e){var t=o.nodes[e.node],r=o.meshes[e.mesh];void 0===t._geometries&&(t._geometries=[]),t._geometries.push(r._geometry)}function a(e){var t=new i.R,r=e._geometries;if(void 0!==r)for(var n,a=new i.yb,o=0,s=r.length;o<s;o++)n=r[o],t.add(new i.vb(n,a));for(o=0,s=e.rotation.length;o<s;o++)e.rotation[o]*=Math.PI/180;t.name=e.name,t.position.fromArray(e.position),t.quaternion.setFromEuler((new i.J).fromArray(e.rotation)),t.scale.fromArray(e.scale),e._object=t}for(var o=e.model,s=0,c=o.vertices.length;s<c;s++)t(o.vertices[s]);for(s=0,c=o.meshes.length;s<c;s++)r(o.meshes[s]);for(s=0,c=o.meshInstances.length;s<c;s++)n(o.meshInstances[s]);for(s=0,c=o.nodes.length;s<c;s++)a(o.nodes[s]);var u;for(s=0,c=o.parents.length;s<c;s++)-1===(u=o.parents[s])||o.nodes[u]._object.add(o.nodes[s]._object);return o.nodes[0]._object}};var o=r(1);r.d(t,"GetPlayCanvas",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function n(e,t){var r=parseInt(m[g].substr(e,t));if(r){var n=function(e,t){return"s"+Math.min(e,t)+"e"+Math.max(e,t)}(y,r);void 0===f[n]&&(p.push([y-1,r-1,1]),f[n]=p.length-1)}}for(var a,o,s,c,u,l={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},h=[],p=[],d={},f={},m=e.split("\n"),g=0,v=m.length;g<v;g++)if("ATOM"===m[g].substr(0,4)||"HETATM"===m[g].substr(0,6))a=parseFloat(m[g].substr(30,7)),o=parseFloat(m[g].substr(38,7)),s=parseFloat(m[g].substr(46,7)),c=parseInt(m[g].substr(6,5))-1,""===(u=t(m[g].substr(76,2)).toLowerCase())&&(u=t(m[g].substr(12,2)).toLowerCase()),h[c]=[a,o,s,l[u],r(u)],void 0===d[u]?d[u]=1:d[u]+=1;else if("CONECT"===m[g].substr(0,6)){var y=parseInt(m[g].substr(6,5));n(11,5),n(16,5),n(21,5),n(26,5)}return function(){var e,t,r={geometryAtoms:new i.l,geometryBonds:new i.l,json:{atoms:h,bonds:p}},n=r.geometryAtoms,a=r.geometryBonds,o=[],s=[],c=[];for(e=0,t=h.length;e<t;e++){var u=h[e],l=u[0],d=u[1],f=u[2];o.push(l,d,f);var m=u[3][0]/255,g=u[3][1]/255,v=u[3][2]/255;s.push(m,g,v)}for(e=0,t=p.length;e<t;e++){var y=p[e],b=y[0],x=y[1];c.push(o[3*b+0]),c.push(o[3*b+1]),c.push(o[3*b+2]),c.push(o[3*x+0]),c.push(o[3*x+1]),c.push(o[3*x+2])}return n.addAttribute("position",new i.M(o,3)),n.addAttribute("color",new i.M(s,3)),a.addAttribute("position",new i.M(c,3)),r}()}};var o=r(1);r.d(t,"GetPDB",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e,this.littleEndian=!0};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(r){try{t(a.parse(r,e))}catch(e){if(!n)throw e;n(e)}},r,n)},setPath:function(e){return this.path=e,this},parse:function(e,t){var r=i.ob.decodeText(new Uint8Array(e)),n=function(e){var t={},r=e.search(/[\r\n]DATA\s(\S*)\s/i),n=/[\r\n]DATA\s(\S*)\s/i.exec(e.substr(r-1));if(t.data=n[1],t.headerLen=n[0].length+r,t.str=e.substr(0,t.headerLen),t.str=t.str.replace(/\#.*/gi,""),t.version=/VERSION (.*)/i.exec(t.str),t.fields=/FIELDS (.*)/i.exec(t.str),t.size=/SIZE (.*)/i.exec(t.str),t.type=/TYPE (.*)/i.exec(t.str),t.count=/COUNT (.*)/i.exec(t.str),t.width=/WIDTH (.*)/i.exec(t.str),t.height=/HEIGHT (.*)/i.exec(t.str),t.viewpoint=/VIEWPOINT (.*)/i.exec(t.str),t.points=/POINTS (.*)/i.exec(t.str),null!==t.version&&(t.version=parseFloat(t.version[1])),null!==t.fields&&(t.fields=t.fields[1].split(" ")),null!==t.type&&(t.type=t.type[1].split(" ")),null!==t.width&&(t.width=parseInt(t.width[1])),null!==t.height&&(t.height=parseInt(t.height[1])),null!==t.viewpoint&&(t.viewpoint=t.viewpoint[1]),null!==t.points&&(t.points=parseInt(t.points[1],10)),null===t.points&&(t.points=t.width*t.height),null!==t.size&&(t.size=t.size[1].split(" ").map(function(e){return parseInt(e,10)})),null!==t.count)t.count=t.count[1].split(" ").map(function(e){return parseInt(e,10)});else{t.count=[];for(var i=0,a=t.fields.length;i<a;i++)t.count.push(1)}t.offset={};var o=0;for(i=0,a=t.fields.length;i<a;i++)"ascii"===t.data?t.offset[t.fields[i]]=i:(t.offset[t.fields[i]]=o,o+=t.size[i]);return t.rowSize=o,t}(r),a=[],o=[],s=[];if("ascii"===n.data)for(var c=n.offset,u=r.substr(n.headerLen).split("\n"),l=0,h=u.length;l<h;l++)if(""!==u[l]){var p=u[l].split(" ");if(void 0!==c.x&&(a.push(parseFloat(p[c.x])),a.push(parseFloat(p[c.y])),a.push(parseFloat(p[c.z]))),void 0!==c.rgb){var d=parseFloat(p[c.rgb]);s.push((255&d>>16)/255,(255&d>>8)/255,(255&d>>0)/255)}void 0!==c.normal_x&&(o.push(parseFloat(p[c.normal_x])),o.push(parseFloat(p[c.normal_y])),o.push(parseFloat(p[c.normal_z])))}if("binary_compressed"!==n.data){if("binary"===n.data)for(var f=new DataView(e,n.headerLen),m=(c=n.offset,l=0,0);l<n.points;l++,m+=n.rowSize)void 0!==c.x&&(a.push(f.getFloat32(m+c.x,this.littleEndian)),a.push(f.getFloat32(m+c.y,this.littleEndian)),a.push(f.getFloat32(m+c.z,this.littleEndian))),void 0!==c.rgb&&(s.push(f.getUint8(m+c.rgb+2)/255),s.push(f.getUint8(m+c.rgb+1)/255),s.push(f.getUint8(m+c.rgb+0)/255)),void 0!==c.normal_x&&(o.push(f.getFloat32(m+c.normal_x,this.littleEndian)),o.push(f.getFloat32(m+c.normal_y,this.littleEndian)),o.push(f.getFloat32(m+c.normal_z,this.littleEndian)));var g=new i.l;0<a.length&&g.addAttribute("position",new i.M(a,3)),0<o.length&&g.addAttribute("normal",new i.M(o,3)),0<s.length&&g.addAttribute("color",new i.M(s,3)),g.computeBoundingSphere();var v=new i.Tb({size:.005});0<s.length?v.vertexColors=i.Mc:v.color.setHex(16777215*Math.random());var y=new i.Sb(g,v),b=t.split("").reverse().join("");return b=(b=/([^\/]*)/.exec(b))[1].split("").reverse().join(""),y.name=b,y}console.error("THREE.PCDLoader: binary_compressed files are not supported")}};var o=r(1);r.d(t,"GetPCD",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(s.a)(new o,e,t)}var i=String.fromCharCode;r.r(t);var a=r(0),o=function(){function e(){this.id=0,this.data=null,this.namespace=0,this.flags=0}function t(){}var r=!0;t.prototype={set:function(e,t){this[e]=t},get:function(e,t){return this.hasOwnProperty(e)?this[e]:t}};var n=function(t){this.manager=void 0===t?a.D:t,this.trunk=new a.Kb,this.materialFactory=void 0,this._url="",this._baseDir="",this._data=void 0,this._ptr=0,this._version=[],this._streaming=!1,this._optimized_for_accuracy=!1,this._compression=0,this._bodylen=4294967295,this._blocks=[new e],this._accuracyMatrix=!1,this._accuracyGeo=!1,this._accuracyProps=!1};return n.prototype={constructor:n,load:function(e,t,r,n){var i=this;this._url=e,this._baseDir=e.substr(0,e.lastIndexOf("/")+1);var o=new a.L(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){var t=e.byteLength;for(this._ptr=0,this._data=new DataView(e),this._parseHeader(),0!=this._compression&&console.error("compressed AWD not supported"),this._streaming||this._bodylen==e.byteLength-this._ptr||console.error("AWDLoader: body len does not match file length",this._bodylen,t-this._ptr);this._ptr<t;)this.parseNextBlock();return this.trunk},parseNextBlock:function(){var t,r,n=this.readU32(),i=this.readU8(),a=this.readU8(),o=this.readU8(),s=this.readU32();1===a?t=this.parseMeshData():22===a?t=this.parseContainer():23===a?t=this.parseMeshInstance():81===a?t=this.parseMaterial():82===a?t=this.parseTexture():101===a?t=this.parseSkeleton():112===a?t=this.parseMeshPoseAnimation(!1):113===a?t=this.parseVertexAnimationSet():102===a?t=this.parseSkeletonPose():103===a?t=this.parseSkeletonAnimation():122===a?t=this.parseAnimatorSet():this._ptr+=s,this._blocks[n]=r=new e,r.data=t,r.id=n,r.namespace=i,r.flags=o},_parseHeader:function(){var e=this._version;if(4282180!=(this.readU8()<<16|this.readU8()<<8|this.readU8()))throw new Error("AWDLoader - bad magic");e[0]=this.readU8(),e[1]=this.readU8();var t=this.readU16();this._streaming=1==(1&t),2===e[0]&&1===e[1]&&(this._accuracyMatrix=2==(2&t),this._accuracyGeo=4==(4&t),this._accuracyProps=8==(8&t)),this._geoNrType=this._accuracyGeo?8:7,this._matrixNrType=this._accuracyMatrix?8:7,this._propsNrType=this._accuracyProps?8:7,this._optimized_for_accuracy=2==(2&t),this._compression=this.readU8(),this._bodylen=this.readU32()},parseContainer:function(){var e=new a.Kb,t=this.readU32(),r=this.parseMatrix4();return e.name=this.readUTF(),e.applyMatrix(r),(this._blocks[t].data||this.trunk).add(e),this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:4}),e.extra=this.parseUserAttributes(),e},parseMeshInstance:function(){var e,t,r,n,i,o,s,c,u,l,h,p,d;for(o=this.readU32(),c=this.parseMatrix4(),e=this.readUTF(),s=this.readU32(),p=this.readU16(),r=this.getBlock(s),u=[],d=0;d<p;d++)h=this.readU32(),l=this.getBlock(h),u.push(l);if(i=[],1<(n=r.length))for(t=new a.Kb,d=0;d<n;d++){var f=new a.vb(r[d]);i.push(f),t.add(f)}else t=new a.vb(r[0]),i.push(t);t.applyMatrix(c),t.name=e,(this.getBlock(o)||this.trunk).add(t);var m=u.length,g=Math.max(n,m);for(d=0;d<g;d++)i[d%n].material=u[d%m];return this.parseProperties(null),t.extra=this.parseUserAttributes(),t},parseMaterial:function(){var e,t,r,n,i,o;for(e=this.readUTF(),t=this.readU8(),o=this.readU8(),r=this.parseProperties({1:3,2:23,11:21,12:7,13:21}),0;0<o;)this.readU16(),this.parseProperties(null),this.parseUserAttributes();if(i=this.parseUserAttributes(),void 0!==this.materialFactory&&(n=this.materialFactory(e)))return n;if(n=new a.yb,1===t)n.color.setHex(r.get(1,13421772));else if(2===t){var s=r.get(2,0);n.map=this.getBlock(s)}return n.extra=i,n.alphaThreshold=r.get(12,0),n.repeat=r.get(13,!1),n},parseTexture:function(){var e,t,r=this.readUTF();if(0===this.readU8()){t=this.readU32();var n=this.readUTFBytes(t);console.log(n),(e=this.loadTexture(n)).userData={},e.userData.name=r}return this.parseProperties(null),this.parseUserAttributes(),e},loadTexture:function(e){var t=new a.xc;return new a.V(this.manager).load(this._baseDir+e,function(e){t.image=e,t.needsUpdate=!0}),t},parseSkeleton:function(){this.readUTF();var e=this.readU16(),t=[],r=0;for(this.parseProperties(null);r<e;){var n,i;this.readU16(),(n=new a.i).parent=this.readU16()-1,n.name=this.readUTF(),i=this.parseMatrix4(),n.skinMatrix=i,this.parseProperties(null),this.parseUserAttributes(),t.push(n),r++}return this.parseUserAttributes(),t},parseSkeletonPose:function(){this.readUTF();var e=this.readU16();this.parseProperties(null);for(var t=[],r=0;r<e;){var n;n=1===this.readU8()?this.parseMatrix4():new a.ub,t[r]=n,r++}return this.parseUserAttributes(),t},parseSkeletonAnimation:function(){this.readUTF();var e,t,r,n=[],i=this.readU16();this.parseProperties(null);for(var a=0;a<i;)t=this.readU32(),e=this.readU16(),r=this._blocks[t].data,n.push({pose:r,duration:e}),a++;if(0!==n.length)return this.parseUserAttributes(),n},parseVertexAnimationSet:function(){this.readUTF();for(var e,t=this.readU16(),r=(this.parseProperties({1:5}),0),n=[];r<t;)e=this.readU32(),n.push(this._blocks[e].data),r++;return this.parseUserAttributes(),n},parseAnimatorSet:function(){this.readUTF();var e,t,r=this.readU16(),n=this.parseProperties({1:23});e=this.readU32();for(var i=this.readU16(),a=[],o=0;o<i;o++)a.push(this.readU32());this.readU16(),this.readU8();this.parseUserAttributes(),this.parseUserAttributes();var s,c=[];for(o=0;o<a.length;o++)c.push(this._blocks[a[o]].data);for(t=this._blocks[e].data,1==r&&(s={animationSet:t,skeleton:this._blocks[n.get(1,0)].data}),o=0;o<c.length;o++)c[o].animator=s;return s},parseMeshData:function(){var e,t,r=this.readUTF(),n=this.readU16(),i=0,o=[];for(this.parseProperties({1:this._geoNrType,2:this._geoNrType});i<n;){var s,c,u;for((e=new a.l).name=r,o.push(e),s=this.readU32(),c=this._ptr+s,this.parseProperties({1:this._geoNrType,2:this._geoNrType});this._ptr<c;){var l=0,h=this.readU8(),p=(this.readU8(),this.readU32()),d=p+this._ptr;if(1===h)for(t=new Float32Array(p/12*3),u=new a.k(t,3),e.addAttribute("position",u),l=0;this._ptr<d;)t[l]=-this.readF32(),t[l+1]=this.readF32(),t[l+2]=this.readF32(),l+=3;else if(2===h)for(t=new Uint16Array(p/2),u=new a.k(t,1),e.setIndex(u),l=0;this._ptr<d;)t[l+1]=this.readU16(),t[l]=this.readU16(),t[l+2]=this.readU16(),l+=3;else if(3===h)for(t=new Float32Array(p/8*2),u=new a.k(t,2),e.addAttribute("uv",u),l=0;this._ptr<d;)t[l]=this.readF32(),t[l+1]=1-this.readF32(),l+=2;else if(4===h)for(t=new Float32Array(p/12*3),u=new a.k(t,3),e.addAttribute("normal",u),l=0;this._ptr<d;)t[l]=-this.readF32(),t[l+1]=this.readF32(),t[l+2]=this.readF32(),l+=3;else this._ptr=d}this.parseUserAttributes(),e.computeBoundingSphere(),i++}return this.parseUserAttributes(),o},parseMeshPoseAnimation:function(e){var t,r,n,i,a,o,s,c,u,l=1,h=0,p={},d=[],f=(this.readUTF(),this.readU32()),m=this.getBlock(f);if(null!==m){for((o=m.geometry).morphTargets=[],e||(l=this.readU16()),t=this.readU16(),s=this.readU16(),c=0;c<s;)d.push(this.readU16()),c++;for(u=this.parseProperties({1:21,2:21}),p.looping=u.get(1,!0),p.stitchFinalFrame=u.get(2,!1),r=0;r<l;){for(this.readU16(),n=0;n<t;)for(c=0,i=this.readU32(),a=this._ptr+i;c<s;){if(1===d[c]){var g=new Float32Array(i/4);for(o.morphTargets.push({array:g}),h=0;this._ptr<a;)g[h]=this.readF32(),g[h+1]=this.readF32(),g[h+2]=this.readF32(),h+=3;n++}else this._ptr=a;c++}r++}return this.parseUserAttributes(),null}console.log("parseMeshPoseAnimation target mesh not found at:",f)},getBlock:function(e){return this._blocks[e].data},parseMatrix4:function(){var e=new a.ub,t=e.elements;return t[0]=this.readF32(),t[1]=this.readF32(),t[2]=this.readF32(),t[3]=0,t[4]=this.readF32(),t[5]=this.readF32(),t[6]=this.readF32(),t[7]=0,t[8]=this.readF32(),t[9]=this.readF32(),t[10]=this.readF32(),t[11]=0,t[12]=-this.readF32(),t[13]=this.readF32(),t[14]=this.readF32(),t[15]=1,e},parseProperties:function(e){var r=this.readU32(),n=this._ptr+r,i=new t;if(e)for(;this._ptr<n;){var a,o=this.readU16(),s=this.readU32();e.hasOwnProperty(o)?(a=e[o],i.set(o,this.parseAttrValue(a,s))):this._ptr+=s}return i},parseUserAttributes:function(){return this._ptr=this.readU32()+this._ptr,null},parseAttrValue:function(e,t){var r,n;if(1===e?(r=1,n=this.readI8):2===e?(r=2,n=this.readI16):3===e?(r=4,n=this.readI32):21===e||4===e?(r=1,n=this.readU8):5===e?(r=2,n=this.readU16):6===e||23===e?(r=4,n=this.readU32):7===e?(r=4,n=this.readF32):8===e?(r=8,n=this.readF64):(41===e||42===e||43===e||44===e||45===e||46===e||47===e)&&(r=8,n=this.readF64),r<t){var i,a,o;for(i=[],a=0,o=t/r;a<o;)i.push(n.call(this)),a++;return i}return n.call(this)},readU8:function(){return this._data.getUint8(this._ptr++)},readI8:function(){return this._data.getInt8(this._ptr++)},readU16:function(){var e=this._data.getUint16(this._ptr,r);return this._ptr+=2,e},readI16:function(){var e=this._data.getInt16(this._ptr,r);return this._ptr+=2,e},readU32:function(){var e=this._data.getUint32(this._ptr,r);return this._ptr+=4,e},readI32:function(){var e=this._data.getInt32(this._ptr,r);return this._ptr+=4,e},readF32:function(){var e=this._data.getFloat32(this._ptr,r);return this._ptr+=4,e},readF64:function(){var e=this._data.getFloat64(this._ptr,r);return this._ptr+=8,e},readUTF:function(){var e=this.readU16();return this.readUTFBytes(e)},readUTFBytes:function(e){for(var t,n=[],a=0;n.length<e;)if(128>(t=this._data.getUint8(this._ptr++,r)))n[a++]=i(t);else if(191<t&&224>t){var o=this._data.getUint8(this._ptr++,r);n[a++]=i((31&t)<<6|63&o)}else{o=this._data.getUint8(this._ptr++,r);var s=this._data.getUint8(this._ptr++,r);n[a++]=i((15&t)<<12|(63&o)<<6|63&s)}return n.join("")}},n}(),s=r(1);r.d(t,"GetAWD",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(c.a)(new s,e,t)}var i=Math.abs,a=Math.max;r.r(t);var o=r(0),s=function(e){this.manager=void 0===e?o.D:e};s.prototype={constructor:s,crossOrigin:"anonymous",load:function(e,t,r,n){var i=this,a=void 0===i.path?o.ob.extractUrlBase(e):i.path,s=new o.L(this.manager);s.setPath(i.path),s.setResponseType("arraybuffer"),s.load(e,function(e){t(i.parse(e,a))},r,n)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){function r(e){return Te<<e}function n(e){return Ee<<e}function s(e,t){var r=new o.i;for(var n in r.matrix.copy(e.matrix),r.matrixWorld.copy(e.matrixWorld),r.position.copy(e.position),r.quaternion.copy(e.quaternion),r.scale.copy(e.scale),t.nodeCount++,r.name="bone_"+e.name+t.nodeCount.toString(),t.nodeToBoneMap[e.name]||(t.nodeToBoneMap[e.name]=[]),t.nodeToBoneMap[e.name].push(r),e.children){var i=s(e.children[n],t);r.add(i)}return r}function c(e,t){for(var r=[],n=0;n<e.length;n++)r.push({i:e[n],w:t[n]});for(r.sort(function(e,t){return t.w-e.w});4>r.length;)r.push({i:0,w:0});4<r.length&&(r.length=4);var i=0;for(n=0;4>n;n++)i+=r[n].w*r[n].w;i=Math.sqrt(i);for(n=0;4>n;n++)r[n].w/=i,e[n]=r[n].i,t[n]=r[n].w}function u(e,t){if(0==e.name.indexOf("bone_"+t))return e;for(var r in e.children){var n=u(e.children[r],t);if(n)return n}}function l(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(e){if(0!=this.mBones.length){for(var t=[],r=[],n=e.findNode(this.mBones[0].mName);n.mParent&&n.mParent.isBone;)n=n.mParent;var i=s(n.toTHREE(e),e);this.threeNode.add(i);for(var a=0;a<this.mBones.length;a++)if(l=u(i,this.mBones[a].mName)){var c=l;t.push(c),r.push(this.mBones[a].mOffsetMatrix.toTHREE())}else{if(!(n=e.findNode(this.mBones[a].mName)))return;i=s(n.toTHREE(e),e);this.threeNode.add(i);var l;c=l=u(i,this.mBones[a].mName);t.push(c),r.push(this.mBones[a].mOffsetMatrix.toTHREE())}var h=new o.rc(t,r);this.threeNode.bind(h,new o.ub),this.threeNode.material.skinning=!0}},this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t,r,n=new o.l;if(t=e.mMaterials[this.mMaterialIndex]?e.mMaterials[this.mMaterialIndex].toTHREE(e):new o.xb,n.setIndex(new o.k(new Uint32Array(this.mIndexArray),1)),n.addAttribute("position",new o.k(this.mVertexBuffer,3)),this.mNormalBuffer&&0<this.mNormalBuffer.length&&n.addAttribute("normal",new o.k(this.mNormalBuffer,3)),this.mColorBuffer&&0<this.mColorBuffer.length&&n.addAttribute("color",new o.k(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&0<this.mTexCoordsBuffers[0].length&&n.addAttribute("uv",new o.k(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&0<this.mTexCoordsBuffers[1].length&&n.addAttribute("uv1",new o.k(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&0<this.mTangentBuffer.length&&n.addAttribute("tangents",new o.k(this.mTangentBuffer,3)),this.mBitangentBuffer&&0<this.mBitangentBuffer.length&&n.addAttribute("bitangents",new o.k(this.mBitangentBuffer,3)),0<this.mBones.length){for(var i=[],a=[],s=0;s<this.mBones.length;s++)for(var u,l=0;l<this.mBones[s].mWeights.length;l++)(u=this.mBones[s].mWeights[l])&&(!i[u.mVertexId]&&(i[u.mVertexId]=[]),!a[u.mVertexId]&&(a[u.mVertexId]=[]),i[u.mVertexId].push(u.mWeight),a[u.mVertexId].push(parseInt(s)));for(var s in a)c(a[s],i[s]);var h=[],p=[];for(s=0;s<i.length;s++)for(l=0;4>l;l++)i[s]&&a[s]?(h.push(i[s][l]),p.push(a[s][l])):(h.push(0),p.push(0));n.addAttribute("skinWeight",new o.k(new Float32Array(h),Oe)),n.addAttribute("skinIndex",new o.k(new Float32Array(p),Oe))}return 0==this.mBones.length&&(r=new o.vb(n,t)),0<this.mBones.length&&(r=new o.sc(n,t)).normalizeSkinWeights(),this.threeNode=r,r}}function h(){this.mNumIndices=0,this.mIndices=[]}function p(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new o.Jc(this.x,this.y,this.z)}}function d(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new o.o(this.r,this.g,this.b)}}function f(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new o.Vb(this.x,this.y,this.z,this.w)}}function m(){this.mVertexId=0,this.mWeight=0}function g(){this.data=[],this.toString=function(){var e="";return this.data.forEach(function(t){e+=String.fromCharCode(t)}),e.replace(/[^\x20-\x7E]+/g,"")}}function v(){this.mTime=0,this.mValue=null}function y(){this.mTime=0,this.mValue=null}function b(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(e){if(this.threeNode)return this.threeNode;var t=new o.Kb;t.name=this.mName,t.matrix=this.mTransformation.toTHREE();for(var r=0;r<this.mChildren.length;r++)t.add(this.mChildren[r].toTHREE(e));for(r=0;r<this.mMeshes.length;r++)t.add(e.mMeshes[this.mMeshes[r]].toTHREE(e));return this.threeNode=t,t.matrix.decompose(t.position,t.quaternion,t.scale),t}}function x(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function w(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var e=new Uint8Array(this.mData).buffer,t=new DataView(e),r=t.getFloat32(0,!0),n=t.getFloat32(4,!0),i=t.getFloat32(8,!0);return new o.o(r,n,i)},this.dataAsFloat=function(){var e=new Uint8Array(this.mData).buffer;return new DataView(e).getFloat32(0,!0)},this.dataAsBool=function(){var e=new Uint8Array(this.mData).buffer;return!!new DataView(e).getFloat32(0,!0)},this.dataAsString=function(){var e=new g;return e.data=this.mData,e.toString()},this.dataAsMap=function(){var e=new g;e.data=this.mData;var t=e.toString();return-1!=(t=t.replace(/\\/g,"/")).indexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),ae.load(t)}}function _(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(){for(var e=new o.yb,t=0;t<this.mProperties.length;t++)if("float"==Fe[this.mProperties[t].mKey]&&(e[Pe[this.mProperties[t].mKey]]=this.mProperties[t].dataAsFloat()),"color"==Fe[this.mProperties[t].mKey]&&(e[Pe[this.mProperties[t].mKey]]=this.mProperties[t].dataAsColor()),"bool"==Fe[this.mProperties[t].mKey]&&(e[Pe[this.mProperties[t].mKey]]=this.mProperties[t].dataAsBool()),"string"==Fe[this.mProperties[t].mKey]&&(e[Pe[this.mProperties[t].mKey]]=this.mProperties[t].dataAsString()),"map"==Fe[this.mProperties[t].mKey]){var r=this.mProperties[t];r.mSemantic==Ne&&(e.map=this.mProperties[t].dataAsMap()),r.mSemantic==Re&&(e.normalMap=this.mProperties[t].dataAsMap()),r.mSemantic==Ie&&(e.lightMap=this.mProperties[t].dataAsMap()),r.mSemantic==Ce&&(e.alphaMap=this.mProperties[t].dataAsMap())}return e.ambient.r=.53,e.ambient.g=.53,e.ambient.b=.53,e.color.r=1,e.color.g=1,e.color.b=1,e}}function T(e,t,r){var n=new o.Jc,i=1-r;return n.x=e.x*r+t.x*i,n.y=e.y*r+t.y*i,n.z=e.z*r+t.z*i,n}function E(e,t,r){return e.clone().slerp(t,1-r)}function A(e,t,r,n){if(1==e.length)return e[0].mValue.toTHREE();for(var a,o=1/0,s=null,c=null,u=0;u<e.length;u++)(a=i(e[u].mTime-t))<o&&e[u].mTime<=t&&(o=a,s=e[u],c=e[u+1]);if(!s)return null;if(c){var l=c.mTime-s.mTime,h=(s.mTime-t)/l;return n(s.mValue.toTHREE(),c.mValue.toTHREE(),h)}(c=e[0].clone()).mTime+=r;l=c.mTime-s.mTime,h=(s.mTime-t)/l;return n(s.mValue.toTHREE(),c.mValue.toTHREE(),h)}function S(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(e){function t(t){t.mTime/=e}e||(e=1),this.mPositionKeys.forEach(t),this.mRotationKeys.forEach(t),this.mScalingKeys.forEach(t)},this.sortKeys=function(){function e(e,t){return e.mTime-t.mTime}this.mPositionKeys.sort(e),this.mRotationKeys.sort(e),this.mScalingKeys.sort(e)},this.getLength=function(){return a(a.apply(null,this.mPositionKeys.map(function(e){return e.mTime})),a.apply(null,this.mRotationKeys.map(function(e){return e.mTime})),a.apply(null,this.mScalingKeys.map(function(e){return e.mTime})))},this.toTHREE=function(e){this.sortKeys();for(var t=this.getLength(),r=new oe.KeyFrameTrack,n=0;n<t;n+=.05){var i=new o.ub,a=n,s=A(this.mPositionKeys,a,t,T),c=A(this.mScalingKeys,a,t,T),u=A(this.mRotationKeys,a,t,E);i.compose(s,u,c);var l=new oe.KeyFrame(a,i);r.addKey(l)}r.target=e.findNode(this.mNodeName).toTHREE();var h=[r];if(e.nodeToBoneMap[this.mNodeName]){var p;for(n=0;n<e.nodeToBoneMap[this.mNodeName].length;n++)(p=r.clone()).target=e.nodeToBoneMap[this.mNodeName][n],h.push(p)}return h}}function M(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(e){var t=new oe.Animation;for(var r in this.mChannels){this.mChannels[r].init(this.mTicksPerSecond);var n=this.mChannels[r].toTHREE(e);for(var i in n)n[i].init(),t.addTrack(n[i])}return t.length=a.apply(null,t.tracks.map(function(e){return e.length})),t}}function L(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function N(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function R(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}function C(){this.versionMajor=0,this.versionMinor=0,this.versionRevision=0,this.compileFlags=0,this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(e,t){if(t||(t=this.mRootNode),t.mName==e)return t;for(var r,n=0;n<t.mChildren.length;n++)if(r=this.findNode(e,t.mChildren[n]))return r;return null},this.toTHREE=function(){this.nodeCount=0,function(e){for(var t in e.mMeshes){var r=e.mMeshes[t];for(var n in r.mBones){var i=e.findNode(r.mBones[n].mName);i&&(i.isBone=!0)}}}(this);var e=this.mRootNode.toTHREE(this);for(var t in this.mMeshes)this.mMeshes[t].hookupSkeletons(this);if(0<this.mAnimations.length)var r=this.mAnimations[0].toTHREE(this);return{object:e,animation:r}}}function I(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var e=new o.ub,t=0;4>t;++t)for(var r=0;4>r;++r)e.elements[4*t+r]=this.elements[r][t];return e}}function O(e){var t=e.getFloat32(e.readOffset,ke);return e.readOffset+=4,t}function P(e){var t=e.getFloat64(e.readOffset,ke);return e.readOffset+=8,t}function F(e){var t=e.getUint8(e.readOffset);return e.readOffset+=1,t}function k(e){var t=e.getUint16(e.readOffset,ke);return e.readOffset+=2,t}function D(e){var t=e.getUint32(e.readOffset,ke);return e.readOffset+=4,t}function U(e){var t=e.getUint32(e.readOffset,ke);return e.readOffset+=4,t}function B(e){var t=new p;return t.x=O(e),t.y=O(e),t.z=O(e),t}function z(e){var t=new d;return t.r=O(e),t.g=O(e),t.b=O(e),t}function G(e){var t=new g,r=D(e);return e.ReadBytes(t.data,1,r),t.toString()}function j(e){var t=new m;return t.mVertexId=D(e),t.mWeight=O(e),t}function V(e){for(var t=new I,r=0;4>r;++r)for(var n=0;4>n;++n)t.elements[r][n]=O(e);return t}function H(e){var t=new v;return t.mTime=P(e),t.mValue=B(e),t}function W(e){var t=new y;return t.mTime=P(e),t.mValue=function(e){var t=new f;return t.w=O(e),t.x=O(e),t.y=O(e),t.z=O(e),t}(e),t}function J(e,t,r){for(var n=0;n<r;n++)t[n]=H(e)}function X(e,t,r){return e.Seek(sizeof(t)*r,De)}function Y(e){if(!e)throw"asset failed"}function q(e,t){return Y(U(e)==me),U(e),t.mName=G(e),t.mNumWeights=D(e),t.mOffsetMatrix=V(e),se?X(e,t.mWeights,t.mNumWeights):(t.mWeights=[],function(e,t,r){for(var n=0;n<r;n++)t[n]=j(e)}(e,t.mWeights,t.mNumWeights)),t}function K(e,t){Y(U(e)==pe),U(e),t.mPrimitiveTypes=D(e),t.mNumVertices=D(e),t.mNumFaces=D(e),t.mNumBones=D(e),t.mMaterialIndex=D(e),t.mNumUVComponents=[];var i=D(e);i&xe&&(se?X(e,t.mVertices,t.mNumVertices):(t.mVertices=[],t.mVertexBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De))),i&we&&(se?X(e,t.mNormals,t.mNumVertices):(t.mNormals=[],t.mNormalBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De))),i&_e&&(se?(X(e,t.mTangents,t.mNumVertices),X(e,t.mBitangents,t.mNumVertices)):(t.mTangents=[],t.mTangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De),t.mBitangents=[],t.mBitangentBuffer=e.subArray32(e.readOffset,e.readOffset+3*t.mNumVertices*4),e.Seek(3*t.mNumVertices*4,De)));for(var a=0;a<Ae&&i&n(a);++a)se?X(e,t.mColors[a],t.mNumVertices):(t.mColors[a]=[],t.mColorBuffer=e.subArray32(e.readOffset,e.readOffset+4*t.mNumVertices*4),e.Seek(4*t.mNumVertices*4,De));t.mTexCoordsBuffers=[];for(a=0;a<Se&&i&r(a);++a)if(t.mNumUVComponents[a]=D(e),se)X(e,t.mTextureCoords[a],t.mNumVertices);else{t.mTextureCoords[a]=[],t.mTexCoordsBuffers[a]=[];for(var o=0;o<t.mNumVertices;o++)t.mTexCoordsBuffers[a].push(O(e)),t.mTexCoordsBuffers[a].push(O(e)),O(e)}if(se)D(e);else{t.mFaces=[],t.mIndexArray=[];for(var s,c=0;c<t.mNumFaces;++c){(s=t.mFaces[c]=new h).mNumIndices=k(e),s.mIndices=[];for(var u=0;u<s.mNumIndices;++u)s.mIndices[u]=65536>t.mNumVertices?k(e):D(e);if(3===s.mNumIndices)t.mIndexArray.push(s.mIndices[0]),t.mIndexArray.push(s.mIndices[1]),t.mIndexArray.push(s.mIndices[2]);else{if(4!==s.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");t.mIndexArray.push(s.mIndices[0]),t.mIndexArray.push(s.mIndices[1]),t.mIndexArray.push(s.mIndices[2]),t.mIndexArray.push(s.mIndices[2]),t.mIndexArray.push(s.mIndices[3]),t.mIndexArray.push(s.mIndices[0])}}}if(t.mNumBones){t.mBones=[];for(u=0;u<t.mNumBones;++u)t.mBones[u]=new x,q(e,t.mBones[u])}}function Z(e,t){Y(U(e)==be),U(e),t.mKey=G(e),t.mSemantic=D(e),t.mIndex=D(e),t.mDataLength=D(e),t.mType=D(e),t.mData=[],e.ReadBytes(t.mData,1,t.mDataLength)}function Q(e,t){if(Y(U(e)==ye),U(e),t.mNumAllocated=t.mNumProperties=D(e),t.mNumProperties){t.mProperties&&delete t.mProperties,t.mProperties=[];for(var r=0;r<t.mNumProperties;++r)t.mProperties[r]=new w,Z(e,t.mProperties[r])}}function $(e,t){Y(U(e)==de),U(e),t.mNodeName=G(e),t.mNumPositionKeys=D(e),t.mNumRotationKeys=D(e),t.mNumScalingKeys=D(e),t.mPreState=D(e),t.mPostState=D(e),t.mNumPositionKeys&&(se?X(e,t.mPositionKeys,t.mNumPositionKeys):(t.mPositionKeys=[],J(e,t.mPositionKeys,t.mNumPositionKeys))),t.mNumRotationKeys&&(se?X(e,t.mRotationKeys,t.mNumRotationKeys):(t.mRotationKeys=[],function(e,t,r){for(var n=0;n<r;n++)t[n]=W(e)}(e,t.mRotationKeys,t.mNumRotationKeys))),t.mNumScalingKeys&&(se?X(e,t.mScalingKeys,t.mNumScalingKeys):(t.mScalingKeys=[],J(e,t.mScalingKeys,t.mNumScalingKeys)))}function ee(e,t){if(Y(U(e)==ge),U(e),t.mName=G(e),t.mDuration=P(e),t.mTicksPerSecond=P(e),t.mNumChannels=D(e),t.mNumChannels){t.mChannels=[];for(var r=0;r<t.mNumChannels;++r)t.mChannels[r]=new S,$(e,t.mChannels[r])}}function te(e,t){Y(U(e)==he),U(e),t.mWidth=D(e),t.mHeight=D(e),e.ReadBytes(t.achFormatHint,1,4),se||(t.mHeight?(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth*t.mHeight*4)):(t.pcData=[],e.ReadBytes(t.pcData,1,t.mWidth)))}function re(e,t){Y(U(e)==le),U(e),t.mName=G(e),t.mType=D(e),t.mType!=Me&&(t.mAttenuationConstant=O(e),t.mAttenuationLinear=O(e),t.mAttenuationQuadratic=O(e)),t.mColorDiffuse=z(e),t.mColorSpecular=z(e),t.mColorAmbient=z(e),t.mType==Le&&(t.mAngleInnerCone=O(e),t.mAngleOuterCone=O(e))}function ne(e,t){Y(U(e)==ue),U(e),t.mName=G(e),t.mPosition=B(e),t.mLookAt=B(e),t.mUp=B(e),t.mHorizontalFOV=O(e),t.mClipPlaneNear=O(e),t.mClipPlaneFar=O(e),t.mAspect=O(e)}function ie(e,t){if(Y(U(e)==fe),U(e),t.mFlags=D(e),t.mNumMeshes=D(e),t.mNumMaterials=D(e),t.mNumAnimations=D(e),t.mNumTextures=D(e),t.mNumLights=D(e),t.mNumCameras=D(e),t.mRootNode=new b,t.mRootNode=function e(t,r,n){Y(U(t)==ve),U(t);var i=new b;if(i.mParent=r,i.mDepth=n,i.mName=G(t),i.mTransformation=V(t),i.mNumChildren=D(t),i.mNumMeshes=D(t),i.mNumMeshes){i.mMeshes=[];for(var a=0;a<i.mNumMeshes;++a)i.mMeshes[a]=D(t)}if(i.mNumChildren){var o;for(i.mChildren=[],a=0;a<i.mNumChildren;++a)o=e(t,i,n++),i.mChildren[a]=o}return i}(e,null,0),t.mNumMeshes){t.mMeshes=[];for(var r=0;r<t.mNumMeshes;++r)t.mMeshes[r]=new l,K(e,t.mMeshes[r])}if(t.mNumMaterials){t.mMaterials=[];for(r=0;r<t.mNumMaterials;++r)t.mMaterials[r]=new _,Q(e,t.mMaterials[r])}if(t.mNumAnimations){t.mAnimations=[];for(r=0;r<t.mNumAnimations;++r)t.mAnimations[r]=new M,ee(e,t.mAnimations[r])}if(t.mNumTextures){t.mTextures=[];for(r=0;r<t.mNumTextures;++r)t.mTextures[r]=new L,te(e,t.mTextures[r])}if(t.mNumLights){t.mLights=[];for(r=0;r<t.mNumLights;++r)t.mLights[r]=new N,re(e,t.mLights[r])}if(t.mNumCameras){t.mCameras=[];for(r=0;r<t.mNumCameras;++r)t.mCameras[r]=new R,ne(e,t.mCameras[r])}}var ae=new o.yc(this.manager);ae.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);var oe={KeyFrame:function(e,t){this.time=e,this.matrix=t.clone(),this.position=new o.Jc,this.quaternion=new o.Vb,this.scale=new o.Jc(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new oe.KeyFrame(this.time,this.matrix)},this.lerp=function(e,t){var r=(t-=this.time)/(e.time-this.time),n=1-r,i=this.position,a=this.quaternion,o=e.position,s=e.quaternion;return oe.KeyFrame.tempAniPos.x=i.x*n+o.x*r,oe.KeyFrame.tempAniPos.y=i.y*n+o.y*r,oe.KeyFrame.tempAniPos.z=i.z*n+o.z*r,oe.KeyFrame.tempAniQuat.set(a.x,a.y,a.z,a.w),oe.KeyFrame.tempAniQuat.slerp(s,r),oe.KeyFrame.tempAniMatrix.compose(oe.KeyFrame.tempAniPos,oe.KeyFrame.tempAniQuat,oe.KeyFrame.tempAniScale)}}};oe.KeyFrame.tempAniPos=new o.Jc,oe.KeyFrame.tempAniQuat=new o.Vb,oe.KeyFrame.tempAniScale=new o.Jc(1,1,1),oe.KeyFrame.tempAniMatrix=new o.ub,oe.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(e){this.keys.push(e)},this.init=function(){if(this.sortKeys(),this.length=0<this.keys.length?this.keys[this.keys.length-1].time:0,this.fps)for(var e=0;e<this.length*this.fps;e++)for(var t=0;t<this.keys.length;t++){if(this.keys[t].time==e){this._accelTable[e]=t;break}if(this.keys[t].time<e/this.fps&&this.keys[t+1]&&this.keys[t+1].time>=e/this.fps){this._accelTable[e]=t;break}}},this.parseFromThree=function(e){var t=e.fps;this.target=e.node;for(var r=e.hierarchy[0].keys,n=0;n<r.length;n++)this.addKey(new oe.KeyFrame(n/t||r[n].time,r[n].targets[0].data));this.init()},this.parseFromCollada=function(e){for(var t=e.keys,r=this.fps,n=0;n<t.length;n++)this.addKey(new oe.KeyFrame(n/r||t[n].time,t[n].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(e,t){return e.time-t.time},this.clone=function(){var e=new oe.KeyFrameTrack;e.target=this.target,e.time=this.time,e.length=this.length;for(var t=0;t<this.keys.length;t++)e.addKey(this.keys[t].clone());return e.init(),e},this.reTarget=function(e,t){t||(t=oe.TrackTargetNodeNameCompare),this.target=t(e,this.target)},this.keySearchAccel=function(e){return e*=this.fps,e=Math.floor(e),this._accelTable[e]||0},this.setTime=function(e){e=i(e),this.length&&(e=e%this.length+.05);for(var t=null,r=null,n=this.keySearchAccel(e);n<this.keys.length;n++){if(this.keys[n].time==e){t=this.keys[n],r=this.keys[n];break}if(this.keys[n].time<e&&this.keys[n+1]&&this.keys[n+1].time>e){t=this.keys[n],r=this.keys[n+1];break}if(this.keys[n].time<e&&n==this.keys.length-1){t=this.keys[n],(r=this.keys[0].clone()).time+=this.length+.05;break}}return t&&r&&t!==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.lerp(r,e)),void(this.target.matrixWorldNeedsUpdate=!0)):t&&r&&t==r?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(t.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},oe.TrackTargetNodeNameCompare=function(e,t){return function e(t,r){if(t.name==r)return t;for(var n,i=0;i<t.children.length;i++)if(n=e(t.children[i],r))return n;return null}(e,t.name)},oe.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(e){this.tracks.push(e),this.length=a(e.length,this.length)},this.setTime=function(e){this.time=e;for(var t=0;t<this.tracks.length;t++)this.tracks[t].setTime(e)},this.clone=function(e,t){t||(t=oe.TrackTargetNodeNameCompare);var r=new oe.Animation;r.target=e;for(var n,i=0;i<this.tracks.length;i++)(n=this.tracks[i].clone()).reTarget(e,t),r.addTrack(n);return r}};var se,ce,ue=4660,le=4661,he=4662,pe=4663,de=4664,fe=4665,me=4666,ge=4667,ve=4668,ye=4669,be=4670,xe=1,we=2,_e=4,Te=256,Ee=65536,Ae=1,Se=4,Me=1,Le=3,Ne=1,Re=6,Ce=8,Ie=10,Oe=4,Pe={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},Fe={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"},ke=!0,De=0,Ue=1;//! A directional light source has a well-defined direction
//! but is infinitely far away. That's quite a good
//! approximation for sun light.
//! A point light source has a well-defined position
//! in space but no direction - it emits light in all
//! directions. A normal bulb is a point light.
//! A spot light source emits light in a specific
//! angle. It has a position and a direction it is pointing to.
//! A good example for a spot light is a light spot in
//! sport arenas.
//! The generic light level of the world, including the bounces
//! of all other lightsources.
//! Typically, there's at most one ambient light in a scene.
//! This light type doesn't have a valid position, direction, or
//! other properties, just a color.
return function(e){var t=new C,r=new DataView(e);if(function(e){e.readOffset=0,e.Seek=function(t,r){r==De&&(e.readOffset+=t),r==Ue&&(e.readOffset=t)},e.ReadBytes=function(e,t,r){for(var n=0;n<t*r;n++)e[n]=F(this)},e.subArray32=function(e,t){var r=this.buffer.slice(e,t);return new Float32Array(r)},e.subArrayUint16=function(e,t){var r=this.buffer.slice(e,t);return new Uint16Array(r)},e.subArrayUint8=function(e,t){var r=this.buffer.slice(e,t);return new Uint8Array(r)},e.subArrayUint32=function(e,t){var r=this.buffer.slice(e,t);return new Uint32Array(r)}}(r),r.Seek(44,De),t.versionMajor=D(r),t.versionMinor=D(r),t.versionRevision=D(r),t.compileFlags=D(r),se=0<k(r),ce=0<k(r),se)throw"Shortened binaries are not supported!";if(r.Seek(256,De),r.Seek(128,De),r.Seek(64,De),ce){var n=U(r),i=r.FileSize()-r.Tell(),a=[];r.Read(a,1,i);var o=[];uncompress(o,n,a,i),ie(new ArrayBuffer(o),t)}else ie(r,t);return t.toTHREE()}(e)}};var c=r(1);r.d(t,"GetAssimp",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(){function e(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||0>=r.groupCount)&&this.materials.splice(r.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&0<t.length?t[t.length-1]:"",smooth:void 0===r?this.smooth:r.smooth,groupStart:void 0===r?0:r.groupEnd,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){return 0<this.materials.length?this.materials[this.materials.length-1]:void 0},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&1<this.materials.length)for(var r=this.materials.length-1;0<=r;r--)0>=this.materials[r].groupCount&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var n=r.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(0<=r?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(0<=r?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(0<=r?r-1:r+t/2)},addVertex:function(e,t,r){var n=this.vertices,i=this.object.geometry.vertices;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals,i=this.object.geometry.normals;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addColor:function(e,t,r){var n=this.colors,i=this.object.geometry.colors;i.push(n[e+0],n[e+1],n[e+2]),i.push(n[t+0],n[t+1],n[t+2]),i.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs,i=this.object.geometry.uvs;i.push(n[e+0],n[e+1]),i.push(n[t+0],n[t+1]),i.push(n[r+0],n[r+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,i,a,o,s,c){var u=this.vertices.length,l=this.parseVertexIndex(e,u),h=this.parseVertexIndex(t,u),p=this.parseVertexIndex(r,u);if(this.addVertex(l,h,p),void 0!==n&&""!==n){var d=this.uvs.length;l=this.parseUVIndex(n,d),h=this.parseUVIndex(i,d),p=this.parseUVIndex(a,d),this.addUV(l,h,p)}if(void 0!==o&&""!==o){var f=this.normals.length;l=this.parseNormalIndex(o,f),h=o===s?l:this.parseNormalIndex(s,f),p=o===c?l:this.parseNormalIndex(c,f),this.addNormal(l,h,p)}0<this.colors.length&&this.addColor(l,h,p)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,n=e.length;r<n;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,n=this.uvs.length,i=0,a=e.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(e[i],r));var o=0;for(a=t.length;o<a;o++)this.addUVLine(this.parseUVIndex(t[o],n))}};return e.startObject("",!1),e}function t(e){this.manager=void 0===e?i.D:e,this.materials=null}var r=/^[og]\s*(.+)?/,n=/^mtllib /,a=/^usemtl /;return t.prototype={constructor:t,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(this.path),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(t){console.time("OBJLoader");var o=new e;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var s=t.split("\n"),c="",u="",l=[],h=0,p=s.length;h<p;h++)if(0!==(c=(c=s[h]).trimLeft()).length&&"#"!==(u=c.charAt(0)))if("v"===u){var d=c.split(/\s+/);switch(d[0]){case"v":o.vertices.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3])),7<=d.length&&o.colors.push(parseFloat(d[4]),parseFloat(d[5]),parseFloat(d[6]));break;case"vn":o.normals.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]));break;case"vt":o.uvs.push(parseFloat(d[1]),parseFloat(d[2]))}}else if("f"===u){for(var f,m=c.substr(1).trim().split(/\s+/),g=[],v=0,y=m.length;v<y;v++)if(0<(f=m[v]).length){var b=f.split("/");g.push(b)}var x=g[0];for(v=1,y=g.length-1;v<y;v++){var w=g[v],_=g[v+1];o.addFace(x[0],w[0],_[0],x[1],w[1],_[1],x[2],w[2],_[2])}}else if("l"===u){var T=c.substring(1).trim().split(" "),E=[],A=[];if(-1===c.indexOf("/"))E=T;else for(var S,M=0,L=T.length;M<L;M++)""!==(S=T[M].split("/"))[0]&&E.push(S[0]),""!==S[1]&&A.push(S[1]);o.addLineGeometry(E,A)}else if("p"===u){var N=c.substr(1).trim().split(" ");o.addPointGeometry(N)}else if(null!==(l=r.exec(c))){var R=(" "+l[0].substr(1).trim()).substr(1);o.startObject(R)}else if(a.test(c))o.object.startMaterial(c.substring(7).trim(),o.materialLibraries);else if(n.test(c))o.materialLibraries.push(c.substring(7).trim());else{if("s"!==u){if("\0"===c)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+c+'"')}if(1<(l=c.split(" ")).length){var C=l[1].trim().toLowerCase();o.object.smooth="0"!==C&&"off"!==C}else o.object.smooth=!0;(W=o.object.currentMaterial())&&(W.smooth=o.object.smooth)}o.finalize();var I=new i.R;I.materialLibraries=[].concat(o.materialLibraries);for(h=0,p=o.objects.length;h<p;h++){var O=o.objects[h],P=O.geometry,F=O.materials,k="Line"===P.type,D="Points"===P.type,U=!1;if(0!==P.vertices.length){var B,z=new i.l;z.addAttribute("position",new i.M(P.vertices,3)),0<P.normals.length?z.addAttribute("normal",new i.M(P.normals,3)):z.computeVertexNormals(),0<P.colors.length&&(U=!0,z.addAttribute("color",new i.M(P.colors,3))),0<P.uvs.length&&z.addAttribute("uv",new i.M(P.uvs,2));for(var G=[],j=0,V=F.length;j<V;j++){var H=F[j],W=void 0;if(null!==this.materials)if(W=this.materials.create(H.name),!k||!W||W instanceof i.gb){if(D&&W&&!(W instanceof i.Tb)){var J=new i.Tb({size:10,sizeAttenuation:!1});i.qb.prototype.copy.call(J,W),J.color.copy(W.color),J.map=W.map,J.lights=!1,W=J}}else{var X=new i.gb;i.qb.prototype.copy.call(X,W),X.color.copy(W.color),X.lights=!1,W=X}W||((W=k?new i.gb:D?new i.Tb({size:1,sizeAttenuation:!1}):new i.yb).name=H.name),W.flatShading=!H.smooth,W.vertexColors=U?i.Mc:i.Hb,G.push(W)}if(1<G.length){for(j=0,V=F.length;j<V;j++)H=F[j],z.addGroup(H.groupStart,H.groupCount,j);B=k?new i.ib(z,G):D?new i.Sb(z,G):new i.vb(z,G)}else B=k?new i.ib(z,G[0]):D?new i.Sb(z,G[0]):new i.vb(z,G[0]);B.name=O.name,I.add(B)}}return console.timeEnd("OBJLoader"),I}},t}(),o=r(1);r.d(t,"GetOBJ",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(c.a)(new s,e,t)}var i=Math.max,a=Math.min;r.r(t);var o=r(0),s=function(){function e(e){return/primitive/i.test(e)||"Subpart"===e}function t(e,t){this.line=e,this.lineLength=e.length,this.currentCharIndex=0,this.currentChar=" ",this.lineNumber=t}function r(e,t){return e.colourCode===t.colourCode?0:e.colourCode<t.colourCode?-1:1}function n(e,t,n){e.sort(r);for(var i=[],a=[],s=[],c=new o.l,u=null,l=0,h=0,p=0,d=e.length;p<d;p++){var f=e[p],m=f.v0,g=f.v1;if(i.push(m.x,m.y,m.z,g.x,g.y,g.z),3===t){i.push(f.v2.x,f.v2.y,f.v2.z);var v=f.n0||f.faceNormal,y=f.n1||f.faceNormal,b=f.n2||f.faceNormal;a.push(v.x,v.y,v.z),a.push(y.x,y.y,y.z),a.push(b.x,b.y,b.z)}u===f.material?h+=t:(null!==u&&c.addGroup(l,h,s.length-1),s.push(f.material),u=f.material,l=p*t,h=t)}0<h&&c.addGroup(l,1/0,s.length-1),c.addAttribute("position",new o.M(i,3)),3===t&&c.addAttribute("normal",new o.M(a,3));var x=null;if(2===t?x=new o.ib(c,s):3==t&&(x=new o.vb(c,s)),n){x.isConditionalLine=!0;for(var w=new Float32Array(3*e.length*2),_=new Float32Array(3*e.length*2),T=new Float32Array(3*e.length*2),E=0,A=e.length;E<A;E++){var S=e[E],M=S.c0,L=S.c1,N=(m=S.v0,g=S.v1,3*E*2);w[N+0]=M.x,w[N+1]=M.y,w[N+2]=M.z,w[N+3]=M.x,w[N+4]=M.y,w[N+5]=M.z,_[N+0]=L.x,_[N+1]=L.y,_[N+2]=L.z,_[N+3]=L.x,_[N+4]=L.y,_[N+5]=L.z,T[N+0]=g.x-m.x,T[N+1]=g.y-m.y,T[N+2]=g.z-m.z,T[N+3]=g.x-m.x,T[N+4]=g.y-m.y,T[N+5]=g.z-m.z}c.addAttribute("control0",new o.k(w,3,!1)),c.addAttribute("control1",new o.k(_,3,!1)),c.addAttribute("direction",new o.k(T,3,!1))}return x}function s(e){this.manager=void 0===e?o.D:e,this.parseScopesStack=null,this.path="",this.materials=[],this.subobjectCache={},this.fileMap=null,this.setMaterials([this.parseColourMetaDirective(new t("Main_Colour CODE 16 VALUE #FF8080 EDGE #333333")),this.parseColourMetaDirective(new t("Edge_Colour CODE 24 VALUE #A0A0A0 EDGE #333333"))]),this.separateObjects=!1,this.smoothNormals=!0}var c=new o.Jc,u=new o.Jc;return t.prototype={constructor:t,seekNonSpace:function(){for(;this.currentCharIndex<this.lineLength;){if(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar)return;this.currentCharIndex++}},getToken:function(){for(var e=this.currentCharIndex++;this.currentCharIndex<this.lineLength&&(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar);)this.currentCharIndex++;var t=this.currentCharIndex;return this.seekNonSpace(),this.line.substring(e,t)},getRemainingString:function(){return this.line.substring(this.currentCharIndex,this.lineLength)},isAtTheEnd:function(){return this.currentCharIndex>=this.lineLength},setToEnd:function(){this.currentCharIndex=this.lineLength},getLineNumberString:function(){return 0<=this.lineNumber?" at line "+this.lineNumber:""}},s.FINISH_TYPE_DEFAULT=0,s.FINISH_TYPE_CHROME=1,s.FINISH_TYPE_PEARLESCENT=2,s.FINISH_TYPE_RUBBER=3,s.FINISH_TYPE_MATTE_METALLIC=4,s.FINISH_TYPE_METAL=5,s.FILE_LOCATION_AS_IS=0,s.FILE_LOCATION_TRY_PARTS=1,s.FILE_LOCATION_TRY_P=2,s.FILE_LOCATION_TRY_MODELS=3,s.FILE_LOCATION_TRY_RELATIVE=4,s.FILE_LOCATION_TRY_ABSOLUTE=5,s.FILE_LOCATION_NOT_FOUND=6,s.prototype={constructor:s,load:function(e,t,r,n){this.fileMap||(this.fileMap={});var i=this,a=new o.L(this.manager);a.setPath(this.path),a.load(e,function(r){i.processObject(r,t,null,e)},r,n)},parse:function(e,t,r){this.processObject(e,r,null,t)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.parseScopesStack=[],this.newParseScopeLevel(e),this.getCurrentParseScope().isFromParse=!1,this.materials=e,this},setFileMap:function(e){return this.fileMap=e,this},newParseScopeLevel:function(e){var t={};if(e)for(var r,n=0,i=e.length;n<i;n++)t[(r=e[n]).userData.code]=r;var a=this.getCurrentParseScope(),s={lib:t,url:null,subobjects:null,numSubobjects:0,subobjectIndex:0,inverted:!1,category:null,keywords:null,currentFileName:null,mainColourCode:a?a.mainColourCode:"16",mainEdgeColourCode:a?a.mainEdgeColourCode:"24",currentMatrix:new o.ub,matrix:new o.ub,isFromParse:!0,triangles:null,lineSegments:null,conditionalSegments:null,startingConstructionStep:!1};return this.parseScopesStack.push(s),s},removeScopeLevel:function(){return this.parseScopesStack.pop(),this},addMaterial:function(e){var t=this.getCurrentParseScope().lib;return t[e.userData.code]||this.materials.push(e),t[e.userData.code]=e,this},getMaterial:function(e){if(e.startsWith("0x2")){var r=e.substring(3);return this.parseColourMetaDirective(new t("Direct_Color_"+r+" CODE -1 VALUE #"+r+" EDGE #"+r))}for(var n,i=this.parseScopesStack.length-1;0<=i;i--)if(n=this.parseScopesStack[i].lib[e])return n;return null},getParentParseScope:function(){return 1<this.parseScopesStack.length?this.parseScopesStack[this.parseScopesStack.length-2]:null},getCurrentParseScope:function(){return 0<this.parseScopesStack.length?this.parseScopesStack[this.parseScopesStack.length-1]:null},parseColourMetaDirective:function(e){var r=null,n=16711935,c=16711935,u=1,l=!1,h=0,p=s.FINISH_TYPE_DEFAULT,d=!0,f=null,m=e.getToken();if(!m)throw'LDrawLoader: Material name was expected after "!COLOUR tag'+e.getLineNumberString()+".";for(var g=null;g=e.getToken();)switch(g.toUpperCase()){case"CODE":r=e.getToken();break;case"VALUE":if((n=e.getToken()).startsWith("0x"))n="#"+n.substring(2);else if(!n.startsWith("#"))throw"LDrawLoader: Invalid colour while parsing material"+e.getLineNumberString()+".";break;case"EDGE":if((c=e.getToken()).startsWith("0x"))c="#"+c.substring(2);else if(!c.startsWith("#")){if(!(f=this.getMaterial(c)))throw"LDrawLoader: Invalid edge colour while parsing material"+e.getLineNumberString()+".";f=f.userData.edgeMaterial}break;case"ALPHA":if(u=parseInt(e.getToken()),isNaN(u))throw"LDrawLoader: Invalid alpha value in material definition"+e.getLineNumberString()+".";1>(u=i(0,a(1,u/255)))&&(l=!0);break;case"LUMINANCE":if(h=parseInt(e.getToken()),isNaN(h))throw"LDrawLoader: Invalid luminance value in material definition"+t.getLineNumberString()+".";h=i(0,a(1,h/255));break;case"CHROME":p=s.FINISH_TYPE_CHROME;break;case"PEARLESCENT":p=s.FINISH_TYPE_PEARLESCENT;break;case"RUBBER":p=s.FINISH_TYPE_RUBBER;break;case"MATTE_METALLIC":p=s.FINISH_TYPE_MATTE_METALLIC;break;case"METAL":p=s.FINISH_TYPE_METAL;break;case"MATERIAL":e.setToEnd();break;default:throw'LDrawLoader: Unknown token "'+g+'" while parsing material'+e.getLineNumberString()+"."}var v=null;switch(p){case s.FINISH_TYPE_DEFAULT:v=new o.Ab({color:n,roughness:.3,envMapIntensity:.3,metalness:0});break;case s.FINISH_TYPE_PEARLESCENT:var y=new o.o(n),b=y.getHSL({h:0,s:0,l:0});b.h=(b.h+.5)%1,b.l=a(1,b.l+.7*(1-b.l)),y.setHSL(b.h,b.s,b.l),v=new o.yb({color:n,specular:y,shininess:10,reflectivity:.3});break;case s.FINISH_TYPE_CHROME:v=new o.Ab({color:n,roughness:0,metalness:1});break;case s.FINISH_TYPE_RUBBER:v=new o.Ab({color:n,roughness:.9,metalness:0}),d=!1;break;case s.FINISH_TYPE_MATTE_METALLIC:v=new o.Ab({color:n,roughness:.8,metalness:.4});break;case s.FINISH_TYPE_METAL:v=new o.Ab({color:n,roughness:.2,metalness:.85})}return v.transparent=l,v.premultipliedAlpha=!0,v.opacity=u,v.depthWrite=!l,v.polygonOffset=!0,v.polygonOffsetFactor=1,v.userData.canHaveEnvMap=d,0!==h&&v.emissive.set(v.color).multiplyScalar(h),f||((f=new o.gb({color:c,transparent:l,opacity:u,depthWrite:!l})).userData.code=r,f.name=m+" - Edge",f.userData.canHaveEnvMap=!1,f.userData.conditionalEdgeMaterial=new o.pc({vertexShader:"\n\tattribute vec3 control0;\n\tattribute vec3 control1;\n\tattribute vec3 direction;\n\tvarying float discardFlag;\n\n\t#include <common>\n\t#include <color_pars_vertex>\n\t#include <fog_pars_vertex>\n\t#include <logdepthbuf_pars_vertex>\n\t#include <clipping_planes_pars_vertex>\n\tvoid main() {\n\t\t#include <color_vertex>\n\n\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t\tgl_Position = projectionMatrix * mvPosition;\n\n\t\t// Transform the line segment ends and control points into camera clip space\n\t\tvec4 c0 = projectionMatrix * modelViewMatrix * vec4( control0, 1.0 );\n\t\tvec4 c1 = projectionMatrix * modelViewMatrix * vec4( control1, 1.0 );\n\t\tvec4 p0 = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\tvec4 p1 = projectionMatrix * modelViewMatrix * vec4( position + direction, 1.0 );\n\n\t\tc0.xy /= c0.w;\n\t\tc1.xy /= c1.w;\n\t\tp0.xy /= p0.w;\n\t\tp1.xy /= p1.w;\n\n\t\t// Get the direction of the segment and an orthogonal vector\n\t\tvec2 dir = p1.xy - p0.xy;\n\t\tvec2 norm = vec2( -dir.y, dir.x );\n\n\t\t// Get control point directions from the line\n\t\tvec2 c0dir = c0.xy - p1.xy;\n\t\tvec2 c1dir = c1.xy - p1.xy;\n\n\t\t// If the vectors to the controls points are pointed in different directions away\n\t\t// from the line segment then the line should not be drawn.\n\t\tfloat d0 = dot( normalize( norm ), normalize( c0dir ) );\n\t\tfloat d1 = dot( normalize( norm ), normalize( c1dir ) );\n\t\tdiscardFlag = float( sign( d0 ) != sign( d1 ) );\n\n\t\t#include <logdepthbuf_vertex>\n\t\t#include <clipping_planes_vertex>\n\t\t#include <fog_vertex>\n\t}\n\t",fragmentShader:"\n\tuniform vec3 diffuse;\n\tuniform float opacity;\n\tvarying float discardFlag;\n\n\t#include <common>\n\t#include <color_pars_fragment>\n\t#include <fog_pars_fragment>\n\t#include <logdepthbuf_pars_fragment>\n\t#include <clipping_planes_pars_fragment>\n\tvoid main() {\n\n\t\tif ( discardFlag > 0.5 ) discard;\n\n\t\t#include <clipping_planes_fragment>\n\t\tvec3 outgoingLight = vec3( 0.0 );\n\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t\t#include <logdepthbuf_fragment>\n\t\t#include <color_fragment>\n\t\toutgoingLight = diffuseColor.rgb; // simple shader\n\t\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t\t#include <premultiplied_alpha_fragment>\n\t\t#include <tonemapping_fragment>\n\t\t#include <encodings_fragment>\n\t\t#include <fog_fragment>\n\t}\n\t",uniforms:{diffuse:{value:new o.o(c)},opacity:{value:u}},transparent:l,depthWrite:!l}),f.userData.conditionalEdgeMaterial.userData.canHaveEnvMap=!1),v.userData.code=r,v.name=m,v.userData.edgeMaterial=f,v},objectParse:function(r){function n(e,t){var r=e.getToken();t||"16"!==r||(r=d),t&&"24"===r&&(r=f);var n=C.getMaterial(r);if(!n)throw'LDrawLoader: Unknown colour code "'+r+'" is used'+e.getLineNumberString()+" but it was not defined previously.";return n}function i(e){var t=new o.Jc(parseFloat(e.getToken()),parseFloat(e.getToken()),parseFloat(e.getToken()));return C.separateObjects||t.applyMatrix4(m.currentMatrix),t}var a,l,h,p=this.getParentParseScope(),d=p.mainColourCode,f=p.mainEdgeColourCode,m=this.getCurrentParseScope(),g=[],v=null,y=null;-1!==r.indexOf("\r\n")&&(r=r.replace(/\r\n/g,"\n"));var b=r.split("\n"),x=b.length,w=0,_=!1,T=null,E=null,A=!1,S=!0,M=!1,L=!0,N="",R=!1,C=this;for(w=0;w<x;w++){var I=b[w];if(0!==I.length){if(_){I.startsWith("0 FILE ")?(this.subobjectCache[T.toLowerCase()]=E,T=I.substring(7),E=""):E+=I+"\n";continue}var O=new t(I,w+1);if(O.seekNonSpace(),O.isAtTheEnd())continue;var P=O.getToken();switch(P){case"0":var F=O.getToken();if(F)switch(F){case"!LDRAW_ORG":if(N=O.getToken(),!_)m.triangles=[],m.lineSegments=[],m.conditionalSegments=[],m.type=N,(!p.isFromParse||C.separateObjects&&!e(N))&&(m.groupObject=new o.R,m.groupObject.userData.startingConstructionStep=m.startingConstructionStep),0>(Z=m.matrix).determinant()&&(C.separateObjects&&e(N)||!C.separateObjects)&&(m.inverted=!m.inverted),a=m.triangles,l=m.lineSegments,h=m.conditionalSegments;break;case"!COLOUR":(U=this.parseColourMetaDirective(O))?this.addMaterial(U):console.warn("LDrawLoader: Error parsing material"+O.getLineNumberString());break;case"!CATEGORY":v=O.getToken();break;case"!KEYWORDS":var k=O.getRemainingString().split(",");0<k.length&&(!y&&(y=[]),k.forEach(function(e){y.push(e.trim())}));break;case"FILE":0<w&&(_=!0,T=O.getRemainingString(),E="",A=!1,S=!0);break;case"BFC":for(;!O.isAtTheEnd();){var D=O.getToken();"CERTIFY"===D||"NOCERTIFY"===D?(A="CERTIFY"===D,S=!0):"CW"===D||"CCW"===D?S="CCW"===D:"INVERTNEXT"===D?M=!0:"CLIP"===D||"NOCLIP"===D?L="CLIP"===D:console.warn('THREE.LDrawLoader: BFC directive "'+D+'" is unknown.')}break;case"STEP":R=!0}break;case"1":var U=n(O),B=parseFloat(O.getToken()),z=parseFloat(O.getToken()),G=parseFloat(O.getToken()),j=parseFloat(O.getToken()),V=parseFloat(O.getToken()),H=parseFloat(O.getToken()),W=parseFloat(O.getToken()),J=parseFloat(O.getToken()),X=parseFloat(O.getToken()),Y=parseFloat(O.getToken()),q=parseFloat(O.getToken()),K=parseFloat(O.getToken()),Z=(new o.ub).set(j,V,H,B,W,J,X,z,Y,q,K,G,0,0,0,1),Q=O.getRemainingString().trim().replace(/\\/g,"/");C.fileMap[Q]?Q=C.fileMap[Q]:Q.startsWith("s/")?Q="parts/"+Q:Q.startsWith("48/")&&(Q="p/"+Q),g.push({material:U,matrix:Z,fileName:Q,originalFileName:Q,locationState:s.FILE_LOCATION_AS_IS,url:null,triedLowerCase:!1,inverted:M!==m.inverted,startingConstructionStep:R}),M=!1;break;case"2":var $={material:(U=n(O,!0)).userData.edgeMaterial,colourCode:U.userData.code,v0:i(O),v1:i(O)};l.push($);break;case"5":$={material:(U=n(O,!0)).userData.edgeMaterial.userData.conditionalEdgeMaterial,colourCode:U.userData.code,v0:i(O),v1:i(O),c0:i(O),c1:i(O)};h.push($);break;case"3":U=n(O);var ee=!A||!L;1==(S!==m.inverted)?(te=i(O),re=i(O),ne=i(O)):(ne=i(O),re=i(O),te=i(O)),c.subVectors(re,te),u.subVectors(ne,re),ae=(new o.Jc).crossVectors(c,u).normalize(),a.push({material:U,colourCode:U.userData.code,v0:te,v1:re,v2:ne,faceNormal:ae,n0:null,n1:null,n2:null}),1==ee&&a.push({material:U,colourCode:U.userData.code,v0:te,v1:ne,v2:re,faceNormal:ae,n0:null,n1:null,n2:null});break;case"4":var te,re,ne,ie,ae;U=n(O),ee=!A||!L;1==(S!==m.inverted)?(te=i(O),re=i(O),ne=i(O),ie=i(O)):(ie=i(O),ne=i(O),re=i(O),te=i(O)),c.subVectors(re,te),u.subVectors(ne,re),ae=(new o.Jc).crossVectors(c,u).normalize(),a.push({material:U,colourCode:U.userData.code,v0:te,v1:re,v2:ne,faceNormal:ae,n0:null,n1:null,n2:null}),a.push({material:U,colourCode:U.userData.code,v0:te,v1:ne,v2:ie,faceNormal:ae,n0:null,n1:null,n2:null}),1==ee&&(a.push({material:U,colourCode:U.userData.code,v0:te,v1:ne,v2:re,faceNormal:ae,n0:null,n1:null,n2:null}),a.push({material:U,colourCode:U.userData.code,v0:te,v1:ie,v2:ne,faceNormal:ae,n0:null,n1:null,n2:null}));break;default:throw'LDrawLoader: Unknown line type "'+P+'"'+O.getLineNumberString()+"."}}}_&&(this.subobjectCache[T.toLowerCase()]=E),m.category=v,m.keywords=y,m.subobjects=g,m.numSubobjects=g.length,m.subobjectIndex=0},computeConstructionSteps:function(e){var t=0;e.traverse(e=>{e.isGroup&&(e.userData.startingConstructionStep&&t++,e.userData.constructionStep=t)}),e.userData.numConstructionSteps=t+1},processObject:function(t,r,i,a){function l(){if(++y===m.subobjects.length+1)h();else{var e=m.subobjects[m.subobjectIndex];Promise.resolve().then(function(){p(e)}),m.subobjectIndex++}}function h(){f.smoothNormals&&"Part"===m.type&&function(e,t){function r(e){return`${~~(100*e.x)},${~~(100*e.y)},${~~(100*e.z)}`}function n(e,t){return`${r(e)}_${r(t)}`}for(var i=new Set,a={},o={},s=[],c=0,u=t.length;c<u;c++){var l=t[c],h=l.v0,p=l.v1;i.add(n(h,p)),i.add(n(p,h))}for(c=0,u=e.length;c<u;c++){y=e[c];for(var d=0,f=3;d<f;d++){var m=(d+1)%3,g=n(h=y[`v${w=d}`],p=y[`v${m}`]);i.has(g)||(a[g]=y,o[g]=y)}}for(;;){var v=Object.keys(a);if(0===v.length)break;c=0;for(var y,b=[o[v[0]]];c<b.length;){y=b[c],c++;var x=y.faceNormal;null===y.n0&&(y.n0=x.clone(),s.push(y.n0)),null===y.n1&&(y.n1=x.clone(),s.push(y.n1)),null===y.n2&&(y.n2=x.clone(),s.push(y.n2));for(d=0,f=3;d<f;d++){var w;m=(d+1)%3;delete a[g=n(h=y[`v${w=d}`],p=y[`v${m}`])];var _=n(p,h),T=o[_];if(T){if(.25>Math.abs(T.faceNormal.dot(y.faceNormal)))continue;_ in a&&(b.push(T),delete a[_]);for(var E=0;E<3;E++){var A=E,S=(E+1)%3;if(n(T[`v${A}`],T[`v${S}`])===_){if(null===T[`n${A}`]){var M=y[`n${m}`];T[`n${A}`]=M,M.add(T.faceNormal)}if(null===T[`n${S}`]){M=y[`n${w}`];T[`n${S}`]=M,M.add(T.faceNormal)}break}}}}}}for(c=0,u=s.length;c<u;c++)s[c].normalize()}(m.triangles,m.lineSegments);var t=!g.isFromParse;if(f.separateObjects&&!e(m.type)||t){const e=m.groupObject;0<m.triangles.length&&e.add(n(m.triangles,3)),0<m.lineSegments.length&&e.add(n(m.lineSegments,2)),0<m.conditionalSegments.length&&e.add(n(m.conditionalSegments,2,!0)),g.groupObject&&(e.name=m.fileName,e.userData.category=m.category,e.userData.keywords=m.keywords,m.matrix.decompose(e.position,e.quaternion,e.scale),g.groupObject.add(e))}else{for(var i,a=f.separateObjects,o=g.lineSegments,s=g.conditionalSegments,l=g.triangles,h=m.lineSegments,p=m.conditionalSegments,d=m.triangles,v=0,y=h.length;v<y;v++)i=h[v],a&&(i.v0.applyMatrix4(m.matrix),i.v1.applyMatrix4(m.matrix)),o.push(i);var b;for(v=0,y=p.length;v<y;v++)b=p[v],a&&(b.v0.applyMatrix4(m.matrix),b.v1.applyMatrix4(m.matrix),b.c0.applyMatrix4(m.matrix),b.c1.applyMatrix4(m.matrix)),s.push(b);var x;for(v=0,y=d.length;v<y;v++)x=d[v],a&&(x.v0=x.v0.clone().applyMatrix4(m.matrix),x.v1=x.v1.clone().applyMatrix4(m.matrix),x.v2=x.v2.clone().applyMatrix4(m.matrix),c.subVectors(x.v1,x.v0),u.subVectors(x.v2,x.v1),x.faceNormal.crossVectors(c,u).normalize()),l.push(x)}f.removeScopeLevel(),g.isFromParse||f.computeConstructionSteps(m.groupObject),r&&r(m.groupObject)}function p(e){m.mainColourCode=e.material.userData.code,m.mainEdgeColourCode=e.material.userData.edgeMaterial.userData.code,m.currentFileName=e.originalFileName;var t=f.subobjectCache[e.originalFileName.toLowerCase()];if(t)f.processObject(t,function(t){d(t,e),l()},e,a);else{var r=e.fileName,n=s.FILE_LOCATION_NOT_FOUND;switch(e.locationState){case s.FILE_LOCATION_AS_IS:n=e.locationState+1;break;case s.FILE_LOCATION_TRY_PARTS:r="parts/"+r,n=e.locationState+1;break;case s.FILE_LOCATION_TRY_P:r="p/"+r,n=e.locationState+1;break;case s.FILE_LOCATION_TRY_MODELS:r="models/"+r,n=e.locationState+1;break;case s.FILE_LOCATION_TRY_RELATIVE:r=a.substring(0,a.lastIndexOf("/")+1)+r,n=e.locationState+1;break;case s.FILE_LOCATION_TRY_ABSOLUTE:e.triedLowerCase?n=s.FILE_LOCATION_NOT_FOUND:(e.fileName=e.fileName.toLowerCase(),r=e.fileName,e.triedLowerCase=!0,n=s.FILE_LOCATION_AS_IS);break;case s.FILE_LOCATION_NOT_FOUND:return void console.warn('LDrawLoader: Subobject "'+e.originalFileName+'" could not be found.')}e.locationState=n,e.url=r;var i=new o.L(f.manager);i.setPath(f.path),i.load(r,function(t){f.processObject(t,function(t){d(t,e),l()},e,a)},void 0,function(t){!function(e,t){p(t)}(0,e)},e)}}function d(e,t){return null===e?void p(t):void(f.fileMap[t.originalFileName]=t.url)}var f=this,m=f.newParseScopeLevel();m.url=a;var g=f.getParentParseScope();i&&(m.currentMatrix.multiplyMatrices(g.currentMatrix,i.matrix),m.matrix.copy(i.matrix),m.inverted=i.inverted,m.startingConstructionStep=i.startingConstructionStep);var v=g.currentFileName;null!==v&&(v=g.currentFileName.toLowerCase()),void 0===f.subobjectCache[v]&&(f.subobjectCache[v]=t),f.objectParse(t);var y=0;l()}},s}(),c=r(1);r.d(t,"GetLDraw",function(){return n})},function(e,t,r){"use strict";function n(e,t){return Object(o.a)(new a,e,t)}r.r(t);var i=r(0),a=function(e){this.manager=void 0===e?i.D:e};a.prototype={constructor:a,load:function(e,t,r,n){var a=this,o=new i.L(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.load(e,function(e){t(a.parse(e))},r,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e){for(var t,n="AMF Material",a=e.attributes.id.textContent,o={r:1,g:1,b:1,a:1},s=null,c=0;c<e.childNodes.length;c++)"metadata"===(t=e.childNodes[c]).nodeName&&void 0!==t.attributes.type?"name"===t.attributes.type.value&&(n=t.textContent):"color"===t.nodeName&&(o=r(t));return s=new i.yb({flatShading:!0,color:new i.o(o.r,o.g,o.b),name:n}),1!==o.a&&(s.transparent=!0,s.opacity=o.a),{id:a,material:s}}function r(e){for(var t,r={r:1,g:1,b:1,a:1},n=0;n<e.childNodes.length;n++)"r"===(t=e.childNodes[n]).nodeName?r.r=t.textContent:"g"===t.nodeName?r.g=t.textContent:"b"===t.nodeName?r.b=t.textContent:"a"===t.nodeName&&(r.a=t.textContent);return r}function n(e){var t={name:"",triangles:[],materialid:null},r=e.firstElementChild;for(void 0!==e.attributes.materialid&&(t.materialId=e.attributes.materialid.nodeValue);r;){if("metadata"===r.nodeName)void 0!==r.attributes.type&&"name"===r.attributes.type.value&&(t.name=r.textContent);else if("triangle"===r.nodeName){var n=r.getElementsByTagName("v1")[0].textContent,i=r.getElementsByTagName("v2")[0].textContent,a=r.getElementsByTagName("v3")[0].textContent;t.triangles.push(n,i,a)}r=r.nextElementSibling}return t}function a(e){for(var t=[],r=[],n=e.firstElementChild;n;){if("vertex"===n.nodeName)for(var i=n.firstElementChild;i;){if("coordinates"===i.nodeName){var a=i.getElementsByTagName("x")[0].textContent,o=i.getElementsByTagName("y")[0].textContent,s=i.getElementsByTagName("z")[0].textContent;t.push(a,o,s)}else if("normal"===i.nodeName){var c=i.getElementsByTagName("nx")[0].textContent,u=i.getElementsByTagName("ny")[0].textContent,l=i.getElementsByTagName("nz")[0].textContent;r.push(c,u,l)}i=i.nextElementSibling}n=n.nextElementSibling}return{vertices:t,normals:r}}function o(e){for(var t=e.attributes.id.textContent,i={name:"amfobject",meshes:[]},o=null,s=e.firstElementChild;s;){if("metadata"===s.nodeName)void 0!==s.attributes.type&&"name"===s.attributes.type.value&&(i.name=s.textContent);else if("color"===s.nodeName)o=r(s);else if("mesh"===s.nodeName){for(var c=s.firstElementChild,u={vertices:[],normals:[],volumes:[],color:o};c;){if("vertices"===c.nodeName){var l=a(c);u.normals=u.normals.concat(l.normals),u.vertices=u.vertices.concat(l.vertices)}else"volume"===c.nodeName&&u.volumes.push(n(c));c=c.nextElementSibling}i.meshes.push(u)}s=s.nextElementSibling}return{id:t,obj:i}}var s,c,u=function(e){var t=new DataView(e);if("PK"===String.fromCharCode(t.getUint8(0),t.getUint8(1))){var r=null,n=null;console.log("THREE.AMFLoader: Loading Zip");try{r=new JSZip(e)}catch(t){if(t instanceof ReferenceError)return console.log("THREE.AMFLoader: jszip missing and file is compressed."),null}for(n in r.files)if(".amf"===n.toLowerCase().substr(-4))break;console.log("THREE.AMFLoader: Trying to load file asset: "+n),t=new DataView(r.file(n).asArrayBuffer())}var a=i.ob.decodeText(t),o=(new DOMParser).parseFromString(a,"application/xml");return"amf"===o.documentElement.nodeName.toLowerCase()?o:(console.log("THREE.AMFLoader: Error loading AMF - no AMF document found."),null)}(e),l="",h="",p=function(e){var t=1,r="millimeter";void 0!==e.documentElement.attributes.unit&&(r=e.documentElement.attributes.unit.value.toLowerCase());var n={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==n[r]&&(t=n[r]),console.log("THREE.AMFLoader: Unit scale: "+t),t}(u),d={},f={},m=u.documentElement.childNodes;for(s=0;s<m.length;s++){var g=m[s];if("metadata"===g.nodeName)void 0!==g.attributes.type&&("name"===g.attributes.type.value?l=g.textContent:"author"===g.attributes.type.value&&(h=g.textContent));else if("material"===g.nodeName){var v=t(g);d[v.id]=v.material}else if("object"===g.nodeName){var y=o(g);f[y.id]=y.obj}}var b=new i.R,x=new i.yb({color:11184895,flatShading:!0});for(var w in b.name=l,b.userData.author=h,b.userData.loader="AMF",f){var _=f[w],T=_.meshes,E=new i.R;for(E.name=_.name||"",s=0;s<T.length;s++){var A=x,S=T[s],M=new i.M(S.vertices,3),L=null;if(S.normals.length&&(L=new i.M(S.normals,3)),S.color){var N=S.color;(A=x.clone()).color=new i.o(N.r,N.g,N.b),1!==N.a&&(A.transparent=!0,A.opacity=N.a)}var R=S.volumes;for(c=0;c<R.length;c++){var C=R[c],I=new i.l,O=A;I.setIndex(C.triangles),I.addAttribute("position",M.clone()),L&&I.addAttribute("normal",L.clone()),void 0!==d[C.materialId]&&(O=d[C.materialId]),I.scale(p,p,p),E.add(new i.vb(I,O.clone()))}}b.add(E)}return b}};var o=r(1);r.d(t,"GetAMF",function(){return n})}]);